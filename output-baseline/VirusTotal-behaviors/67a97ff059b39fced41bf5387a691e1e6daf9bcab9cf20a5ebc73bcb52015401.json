{
    "data":  {
                 "tags":  [
                              "IDLE",
                              "DETECT_DEBUG_ENVIRONMENT"
                          ],
                 "files_written":  [
                                       "\\Device\\ConDrv\\\\Connect"
                                   ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "fp2e7a.wpc.phicdn.net",
                                         "resolved_ips":  [
                                                              "192.229.221.95"
                                                          ]
                                     },
                                     {
                                         "hostname":  "fp2e7a.wpc.2be4.phicdn.net"
                                     }
                                 ],
                 "files_opened":  [
                                      "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\SYSTEM32\\apphelp.dll",
                                      "C:\\Windows\\SYSTEM32\\ntdll.dll",
                                      "C:\\Windows\\SYSTEM32\\ntmarta.dll",
                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                      "C:\\Windows\\SYSTEM32\\wintypes.dll",
                                      "C:\\Windows\\System32\\CoreMessaging.dll",
                                      "C:\\Windows\\System32\\CoreUIComponents.dll",
                                      "C:\\Windows\\System32\\KERNEL32.DLL",
                                      "C:\\Windows\\System32\\KERNELBASE.dll",
                                      "C:\\Windows\\System32\\TextInputFramework.dll",
                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
                                      "C:\\Windows\\system32\\IMM32.DLL",
                                      "C:\\Windows\\system32\\conhost.exe",
                                      "C:\\Windows\\system32\\dwmapi.dll",
                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                      "C:\\Windows\\system32\\rpcss.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll.Config",
                                      "\\Device\\ConDrv\\Server",
                                      "\\Device\\ConDrv\\\\Input",
                                      "\\Device\\ConDrv\\\\Output",
                                      "\\Device\\ConDrv\\\\Reference"
                                  ],
                 "registry_keys_opened":  [
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL"
                                          ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\SqlSetupBootstrapper.exe",
                                           "C:\\Windows\\System32\\wuapihost.exe",
                                           "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                           "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
                                       ],
                 "processes_injected":  [
                                            "\\\\?\\C:\\Windows\\system32\\wbem\\WMIADAP.EXE"
                                        ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link many functions at runtime",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link many functions at runtime"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1574.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to load missing DLLs",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "187"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "509"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "mbc":  [
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0040",
                                 "objective":  "Process",
                                 "behavior":  "Allocate Thread Local Storage",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate thread local storage"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0041",
                                 "objective":  "Process",
                                 "behavior":  "Set Thread Local Storage Value",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "set thread local storage value"
                                              }
                                          ]
                             }
                         ],
                 "files_dropped":  [
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER29CA.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER29CA.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER29DB.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER29DB.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2AB4.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2AB5.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2AB4.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2AB5.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2B04.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2B04.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2B05.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2B05.tmp.txt"
                                       }
                                   ],
                 "verdict_confidence":  99,
                 "command_executions":  [
                                            "\"%SAMPLEPATH%\\SqlSetupBootstrapper.exe\" ",
                                            "C:\\Windows\\System32\\wuapihost.exe -Embedding"
                                        ],
                 "memory_dumps":  [
                                      {
                                          "file_name":  "00000000.00000002.1377288573.00007FF7904E7000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "32768",
                                          "base_address":  "140701254709248",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377203470.0000027C777D0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "40960",
                                          "base_address":  "2733603880960",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000000.1137661761.00007FF7904D0000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "4096",
                                          "base_address":  "140701254615040",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377218291.00007FF7904D0000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "4096",
                                          "base_address":  "140701254615040",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377203470.0000027C777DC000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "16384",
                                          "base_address":  "2733603930112",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000000.1137705122.00007FF7904E7000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "32768",
                                          "base_address":  "140701254709248",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000000.00000000.1137688045.00007FF7904DC000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "28672",
                                          "base_address":  "140701254664192",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377176150.000000EF1B4FC000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "16384",
                                          "base_address":  "1026955395072",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377255021.00007FF7904E3000.00000004.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "4096",
                                          "base_address":  "140701254692864",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000000.1137696464.00007FF7904E3000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "8192",
                                          "base_address":  "140701254692864",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377197129.0000027C77740000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "4096",
                                          "base_address":  "2733603291136",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377264297.00007FF7904E4000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "4096",
                                          "base_address":  "140701254696960",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377228862.00007FF7904D1000.00000020.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "45056",
                                          "base_address":  "140701254619136",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377247286.00007FF7904DD000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "24576",
                                          "base_address":  "140701254668288",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377183763.0000027C776D0000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "4096",
                                          "base_address":  "2733602832384",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000000.1137670372.00007FF7904D1000.00000020.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "45056",
                                          "base_address":  "140701254619136",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1377238054.00007FF7904DC000.00000004.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                          "size":  "4096",
                                          "base_address":  "140701254664192",
                                          "stage":  "MEM_STAGE_EXIT"
                                      }
                                  ],
                 "files_deleted":  [
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER29CA.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER29DB.tmp.WERInternalMetadata.xml",
                                       "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2AB4.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2B04.tmp.txt",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2AB5.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2B05.tmp.txt"
                                   ],
                 "processes_terminated":  [
                                              "C:\\Windows\\System32\\wuapihost.exe"
                                          ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2944",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3248",
                                                                 "name":  "%SAMPLEPATH%\\SqlSetupBootstrapper.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "620",
                                            "name":  "C:\\Windows\\System32\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "836",
                                                                 "name":  "C:\\Windows\\System32\\wuapihost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "7772",
                                            "name":  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "7780",
                                                                 "name":  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
                                                             }
                                                         ]
                                        }
                                    ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "20.99.133.109",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.229.211.108",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate thread local storage",
                                               "description":  "host-interaction/thread/tls",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate thread local storage\n    namespace: host-interaction/thread/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Process::Allocate Thread Local Storage [C0040]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6\n  features:\n    - or:\n      - api: kernel32.TlsAlloc\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get thread local storage value",
                                               "description":  "host-interaction/process",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get thread local storage value\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - and:\n      - api: kernel32.TlsGetValue\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set thread local storage value",
                                               "description":  "host-interaction/thread/tls",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set thread local storage value\n    namespace: host-interaction/thread/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Set Thread Local Storage Value [C0041]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000AE21\n  features:\n    - and:\n      - api: kernel32.TlsSetValue\n      - optional:\n        - match: allocate thread local storage\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "print debug messages",
                                               "description":  "host-interaction/log/debug/write-event",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: print debug messages\n    namespace: host-interaction/log/debug/write-event\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - or:\n      - api: DbgPrint\n      - api: kernel32.OutputDebugString\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link many functions at runtime",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - os: linux\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n"
                                           },
                                           {
                                               "id":  "871",
                                               "description":  "Sample execution stops while process was sleeping (likely an evasion)",
                                               "match_data":  [
                                                                  "Thread delayed"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "415",
                                               "description":  "PE file has an executable .text section and no other executable section",
                                               "match_data":  [
                                                                  "Section: .text IMAGE_SCN_CNT_CODE, IMAGE_SCN_MEM_EXECUTE, IMAGE_SCN_MEM_READ"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "509",
                                               "description":  "Reads software policies",
                                               "match_data":  [
                                                                  "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#registry_keys_opened",
                                                                "value":  "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "431",
                                               "description":  "PE /OLE file has a valid certificate with Microsoft as Issuer",
                                               "match_data":  [
                                                                  "Valid certificate with Microsoft Issuer"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "411",
                                               "description":  "PE file contains a mix of data directories often seen in goodware",
                                               "match_data":  [
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_IMPORT",
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_RESOURCE",
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_BASERELOC",
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_DEBUG",
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG",
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_IAT"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "715",
                                               "description":  "Classification label",
                                               "match_data":  [
                                                                  "clean1.winEXE@2/0@0/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "626",
                                               "description":  "Sample tries to load a library which is not present or installed on the analysis machine, adding the library might reveal more behavior",
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "229",
                                               "description":  "Spawns processes",
                                               "match_data":  [
                                                                  "C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe C:\\Users\\user\\Desktop\\SqlSetupBootstrapper.exe",
                                                                  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "419",
                                               "description":  "PE file has a high image base, often used for DLLs",
                                               "match_data":  [
                                                                  "Image base 0x100400000 \u003e 0x60000000"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "406",
                                               "description":  "Contains modern PE file flags such as dynamic base (ASLR) or NX",
                                               "match_data":  [
                                                                  "HIGH_ENTROPY_VA, DYNAMIC_BASE, NX_COMPAT, TERMINAL_SERVER_AWARE"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "187",
                                               "description":  "Tries to load missing DLLs",
                                               "match_data":  [
                                                                  "sqlsetupbootstrapper.dll"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "95",
                                               "description":  "Creates mutexes",
                                               "match_data":  [
                                                                  "\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:7780:120:WilError_01"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "149",
                                               "description":  "Program does not show much activity (idle)",
                                               "match_data":  [
                                                                  "no activity detected"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "404",
                                               "description":  "PE / OLE file has a valid certificate",
                                               "match_data":  [
                                                                  "certificate valid"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "416",
                                               "description":  "PE file contains a valid data directory to section mapping",
                                               "match_data":  [
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_IMPORT is in: .rdata",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_RESOURCE is in: .rsrc",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_BASERELOC is in: .reloc",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG is in: .rdata",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_IAT is in: .rdata"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "203",
                                               "description":  "Binary contains paths to debug symbols",
                                               "match_data":  [
                                                                  "SqlSetupBootstrapper.pdb{{GCTL source: SqlSetupBootstrapper.exe",
                                                                  "SqlSetupBootstrapper.pdb source: SqlSetupBootstrapper.exe"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "412",
                                               "description":  "PE file contains a debug data directory",
                                               "match_data":  [
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_DEBUG"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           }
                                       ],
                 "verdicts":  [
                                  "CLEAN"
                              ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link many functions at runtime",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link many functions at runtime"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1574.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Tries to load missing DLLs",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "187"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "509"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
