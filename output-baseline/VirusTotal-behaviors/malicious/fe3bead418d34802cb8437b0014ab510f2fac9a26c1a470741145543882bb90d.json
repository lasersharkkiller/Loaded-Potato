{
    "data":  {
                 "processes_created":  [
                                           "C:\\Users\\Mason\\AppData\\Local\\Temp\\rundll32.exe",
                                           "C:\\WINDOWS\\mssecsvc.exe"
                                       ],
                 "modules_loaded":  [
                                        "c:\\windows\\system32\\shcore.dll",
                                        "c:\\windows\\system32\\cryptbase.dll",
                                        "c:\\windows\\system32\\imm32.dll",
                                        "c:\\windows\\system32\\mpr.dll",
                                        "c:\\users\\mason\\appdata\\local\\temp\\e2739e0b80c60f40e8b0c43ba70ff8nalysis_subject.dll",
                                        "c:\\windows\\system32\\shell32.dll",
                                        "c:\\windows\\system32\\cryptsp.dll",
                                        "c:\\windows\\system32\\setupapi.dll",
                                        "c:\\windows\\system32\\sfc.dll",
                                        "c:\\windows\\system32\\rsaenh.dll",
                                        "c:\\windows\\system32\\ole32.dll",
                                        "c:\\windows\\system32\\windows.storage.dll",
                                        "c:\\windows\\system32\\ntdll.dll",
                                        "c:\\windows\\system32\\kernelbase.dll",
                                        "c:\\windows\\system32\\apphelp.dll",
                                        "c:\\windows\\system32\\powrprof.dll",
                                        "c:\\windows\\system32\\propsys.dll",
                                        "c:\\windows\\system32\\kernel.appcore.dll",
                                        "c:\\windows\\system32\\msvcrt.dll",
                                        "c:\\windows\\system32\\sechost.dll",
                                        "c:\\windows\\system32\\wow64.dll",
                                        "c:\\windows\\system32\\umpdc.dll",
                                        "c:\\windows\\system32\\sspicli.dll",
                                        "c:\\windows\\system32\\msvcp_win.dll",
                                        "c:\\windows\\system32\\bcryptprimitives.dll",
                                        "c:\\windows\\system32\\aclayers.dll",
                                        "c:\\windows\\system32\\netapi32.dll",
                                        "c:\\windows\\system32\\shlwapi.dll",
                                        "c:\\windows\\system32\\profapi.dll",
                                        "c:\\windows\\system32\\wow64win.dll",
                                        "c:\\windows\\system32\\ucrtbase.dll",
                                        "c:\\windows\\system32\\winspool.drv",
                                        "c:\\windows\\system32\\gdi32.dll",
                                        "c:\\windows\\system32\\kernel32.dll",
                                        "c:\\windows\\system32\\cfgmgr32.dll",
                                        "c:\\windows\\system32\\combase.dll",
                                        "c:\\windows\\system32\\win32u.dll",
                                        "c:\\windows\\system32\\bcrypt.dll",
                                        "c:\\windows\\system32\\wow64cpu.dll",
                                        "c:\\windows\\system32\\oleaut32.dll",
                                        "c:\\windows\\system32\\user32.dll",
                                        "c:\\windows\\system32\\sfc_os.dll",
                                        "c:\\windows\\system32\\rpcrt4.dll",
                                        "c:\\windows\\system32\\psapi.dll",
                                        "c:\\windows\\system32\\gdi32full.dll",
                                        "c:\\windows\\system32\\advapi32.dll",
                                        "c:\\windows\\system32\\iphlpapi.dll",
                                        "c:\\windows\\system32\\ws2_32.dll",
                                        "c:\\windows\\system32\\samcli.dll",
                                        "c:\\windows\\system32\\wininet.dll",
                                        "c:\\windows\\system32\\nsi.dll",
                                        "c:\\windows\\system32\\msvcp60.dll",
                                        "c:\\windows\\system32\\winnsi.dll",
                                        "c:\\windows\\system32\\winhttp.dll",
                                        "c:\\windows\\system32\\ondemandconnroutehelper.dll",
                                        "c:\\windows\\system32\\mswsock.dll",
                                        "c:\\windows\\system32\\iertutil.dll",
                                        "c:\\windows\\system32\\dhcpcsvc6.dll",
                                        "c:\\windows\\system32\\dhcpcsvc.dll",
                                        "c:\\windows\\system32\\dnsapi.dll",
                                        "kernel32",
                                        "ole32",
                                        "MSCTF",
                                        "SspiCli",
                                        "OLEAUT32",
                                        "rpcrt4",
                                        "877d3314c61fca0368c041fe38776d35.exe",
                                        "ADVAPI32",
                                        "CLBCatQ",
                                        "CRYPTBASE"
                                    ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1059",
                                                     "signature_description":  "Apparent Internal Usage of CMD.EXE"
                                                 }
                                             ],
                 "mutexes_opened":  [
                                        "Local\\ShimViewer"
                                    ],
                 "signature_matches":  [
                                           {
                                               "id":  "0",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "extract resource via kernel32 functions",
                                               "description":  "executable/resource",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: LoadResource",
                                                                  "api: SizeofResource",
                                                                  "api: FindResource"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n"
                                           },
                                           {
                                               "id":  "1",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain an embedded PE file",
                                               "description":  "executable/subfile/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n"
                                           },
                                           {
                                               "id":  "2",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Windows",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "FILE_WRITE_DATA",
                                                                  "GENERIC_WRITE",
                                                                  "api: CreateFile"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                                           },
                                           {
                                               "id":  "4",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against ZLIB",
                                               "description":  "linking/static/zlib",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "regex: /inflate .* Copyright/"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against ZLIB\n    namespace: linking/static/zlib\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Data::Compression Library [C0060]\n    examples:\n      - 6cc148363200798a12091b97a17181a1\n  features:\n    - or:\n      - string: /deflate .* Copyright/\n      - string: /inflate .* Copyright/\n"
                                           },
                                           {
                                               "id":  "5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create process on Windows",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: CreateProcess"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n"
                                           }
                                       ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "6160",
                                            "name":  "C:\\Users\\Mason\\AppData\\Local\\Temp\\rundll32.exe"
                                        },
                                        {
                                            "process_id":  "5640",
                                            "name":  "C:\\WINDOWS\\mssecsvc.exe"
                                        },
                                        {
                                            "process_id":  "6520",
                                            "name":  "C:\\WINDOWS\\mssecsvc.exe"
                                        },
                                        {
                                            "process_id":  "2256",
                                            "name":  "13f43b565119f43f7155f96cafa8b05d.exe",
                                            "time_offset":  28663
                                        }
                                    ],
                 "files_opened":  [
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\877d3314c61fca0368c041fe38776d35.exe.dll",
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\877d3314c61fca0368c041fe38776d35.exe.dll.manifest"
                                  ],
                 "verdicts":  [
                                  "MALWARE",
                                  "TROJAN"
                              ],
                 "command_executions":  [
                                            "C:\\Users\\Mason\\AppData\\Local\\Temp\\rundll32.exe e2739e0b80c60f40e8b0c43ba70ff8nalysis_subject.dll",
                                            "C:\\WINDOWS\\mssecsvc.exe",
                                            "C:\\WINDOWS\\mssecsvc.exe -m security"
                                        ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "20.223.44.11",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "mbc":  [
                             {
                                 "id":  "B0023",
                                 "objective":  "Execution",
                                 "behavior":  "Install Additional Program",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0052",
                                 "objective":  "File System",
                                 "behavior":  "Writes File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "2"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0060",
                                 "objective":  "Data",
                                 "behavior":  "Compression Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "4"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "5"
                                              }
                                          ]
                             }
                         ],
                 "services_created":  [
                                          "mssecsvc2.0"
                                      ],
                 "services_started":  [
                                          "mssecsvc2.0"
                                      ],
                 "attack_techniques":  {
                                           "T1059":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Apparent Internal Usage of CMD.EXE"
                                                         }
                                                     ]
                                       }
             }
}
