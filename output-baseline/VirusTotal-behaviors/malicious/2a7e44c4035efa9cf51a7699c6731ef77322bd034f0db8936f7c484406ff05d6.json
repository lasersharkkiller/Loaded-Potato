{
    "data":  {
                 "calls_highlighted":  [
                                           "GetTickCount",
                                           "C:\\Users\\a.monaldo\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                           "kernel32.LoadLibraryExW",
                                           "kernel32.GetSystemDirectoryW"
                                       ],
                 "processes_terminated":  [
                                              "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                              "%SAMPLEPATH%\\5531e69bae1958fecf77492ce5091225.exe",
                                              "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe",
                                              "2304 - C:\\Users\\azure\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                          ],
                 "files_opened":  [
                                      "c:\\users\\keecfmwgj\\desktop\\milmonjey.txt.exe",
                                      "C:\\Windows\\system32\\powrprof.dll",
                                      "C:\\Windows\\System32\\wshtcpip.dll",
                                      "C:\\Windows\\System32\\wship6.dll",
                                      "C:\\Windows\\System32\\wshqos.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem",
                                      "C:\\Users\\\u003cUSER\u003e\\Downloads\\2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                      "C:\\Windows\\system32\\apphelp.dll",
                                      "\\SystemRoot\\AppPatch\\AppPatch64\\sysmain.sdb",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\",
                                      "C:\\Users\\",
                                      "C:\\Users\\\u003cUSER\u003e\\",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\",
                                      "C:\\Windows\\system32\\netapi32.dll",
                                      "C:\\Windows\\system32\\netutils.dll",
                                      "C:\\Windows\\system32\\srvcli.dll",
                                      "C:\\Windows\\system32\\wkscli.dll",
                                      "PIPE\\wkssvc",
                                      "C:\\Windows\\system32\\SAMCLI.DLL",
                                      "C:\\Windows\\system32\\SAMLIB.dll",
                                      "PIPE\\samr",
                                      "C:\\Windows\\system32\\mswsock.dll",
                                      "\\Device\\Afd\\Endpoint",
                                      "C:\\Windows\\system32",
                                      "\\Device\\KsecDD",
                                      "\\Sessions\\1\\BaseNamedObjects",
                                      "C:\\Windows",
                                      "C:\\Windows\\System32\\WSHTCPIP.DLL",
                                      "\\\\?\\PIPE\\NETLOGON",
                                      "\\Device\\NamedPipe\\lsass",
                                      "C:\\Users\\user\\AppData\\Roaming\\NTSystem\\",
                                      "C:\\Users\\user\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                      "C:\\Users\\user\\Desktop\\executable.exe",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\SYSTEM32\\CRYPTBASE.DLL",
                                      "C:\\Windows\\SYSTEM32\\NETUTILS.DLL",
                                      "C:\\Windows\\SYSTEM32\\SAMCLI.DLL",
                                      "C:\\Windows\\SYSTEM32\\SAMLIB.dll",
                                      "C:\\Windows\\SYSTEM32\\WINMMBASE.dll",
                                      "C:\\Windows\\SYSTEM32\\WKSCLI.DLL",
                                      "C:\\Windows\\SYSTEM32\\apphelp.dll",
                                      "C:\\Windows\\SYSTEM32\\bcrypt.dll",
                                      "C:\\Windows\\SYSTEM32\\netapi32.dll",
                                      "C:\\Windows\\SYSTEM32\\ntdll.dll",
                                      "C:\\Windows\\SYSTEM32\\userenv.dll",
                                      "C:\\Windows\\SYSTEM32\\winmm.dll",
                                      "C:\\Windows\\SYSTEM32\\winmmbase.dll",
                                      "C:\\Windows\\System32\\KERNEL32.DLL",
                                      "C:\\Windows\\System32\\KERNELBASE.dll",
                                      "C:\\Windows\\System32\\en-US\\mswsock.dll.mui",
                                      "C:\\Windows\\System32\\en-US\\wshqos.dll.mui",
                                      "C:\\Windows\\System32\\mswsock.dll",
                                      "C:\\Windows\\system32\\177a90f056af65952f6814ebf9fece954c7b14d51e82e99f58d54247e1f1d331AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                                      "C:\\Windows\\system32\\281bb3690253726c2931e6beb4df2276d1fd08a1f7d5732462c49c52d15468caAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                                      "C:\\Windows\\system32\\3fce5024ce8f529166169d7703773396c895d93b21729df8d8f652904f754e85AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                                      "C:\\Windows\\system32\\525c760fd0e5da08aa12626068cfc16a4478947783c010052f17bb1729390250AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                                      "C:\\Windows\\system32\\IMM32.DLL",
                                      "NUL",
                                      "\\\\computer\\PIPE\\samr",
                                      "\\pipe\\wkssvc"
                                  ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "PEB access",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "access PEB ldr_data",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get kernel32 base address",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get kernel32 base address\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm\n    examples:\n      - 67f8302a2fd28d15f62d6d20d748bfe350334e5353cbdef112bd1f8231b5599d:0x406936\n  features:\n    - and:\n      # PEB -\u003e PEB.Ldr -\u003e PEB_LDR_DATA.InLoadOrderModuleList.Flink\n      - match: access PEB ldr_data\n      # -\u003e current module -\u003e ntdll\n      - count(offset(0)): 2\n      # -\u003e kernel32 -\u003e LDR_DATA_TABLE_ENTRY.DllBase\n      - or:\n        - and:\n          - arch: i386\n          - offset: 0x18 = LDR_DATA_TABLE_ENTRY.DllBase\n        - and:\n          - arch: amd64\n          - offset: 0x30 = LDR_DATA_TABLE_ENTRY.DllBase\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html"
                                                            },
                                                            {
                                                                "ref":  "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using DES",
                                               "description":  "data-manipulation/encryption/des",
                                               "authors":  [
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using DES\n    namespace: data-manipulation/encryption/des\n    authors:\n      - \"@_re_fox\"\n    scope: basic block\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]\n      - Cryptography::Encrypt Data::3DES [C0027.004]\n    examples:\n      - 91a12a4cf437589ba70b1687f5acad19:0x47F5E8\n  features:\n    - or:\n      - bytes: 0e 04 0d 01 02 0f 0b 08 03 0a 06 0c 05 09 00 07 00 0f 07 04 0e 02 0d 01 0a 06 0c 0b 09 05 03 08 04 01 0e 08 0d 06 02 0b 0f 0c 09 07 03 0a 05 00 0f 0c 08 02 04 09 01 07 05 0b 03 0e 0a 00 06 0d = SBOX S1\n      - bytes: 0f 01 08 0e 06 0b 03 04 09 07 02 0d 0c 00 05 0a 03 0d 04 07 0f 02 08 0e 0c 00 01 0a 06 09 0b 05 00 0e 07 0b 0a 04 0d 01 05 08 0c 06 09 03 02 0f 0d 08 0a 01 03 0f 04 02 0b 06 07 0c 00 05 0e 09 = SBOX S2\n      - bytes: 0a 00 09 0e 06 03 0f 05 01 0d 0c 07 0b 04 02 08 0d 07 00 09 03 04 06 0a 02 08 05 0e 0c 0b 0f 01 0d 06 04 09 08 0f 03 00 0b 01 02 0c 05 0a 0e 07 01 0a 0d 00 06 09 08 07 04 0f 0e 03 0b 05 02 0c = SBOX S3\n      - bytes: 07 0d 0e 03 00 06 09 0a 01 02 08 05 0b 0c 04 0f 0d 08 0b 05 06 0f 00 03 04 07 02 0c 01 0a 0e 09 0a 06 09 00 0c 0b 07 0d 0f 01 03 0e 05 02 08 04 03 0f 00 06 0a 01 0d 08 09 04 05 0b 0c 07 02 0e = SBOX S4\n      - bytes: 02 0c 04 01 07 0a 0b 06 08 05 03 0f 0d 00 0e 09 0e 0b 02 0c 04 07 0d 01 05 00 0f 0a 03 09 08 06 04 02 01 0b 0a 0d 07 08 0f 09 0c 05 06 03 00 0e 0b 08 0c 07 01 0e 02 0d 06 0f 00 09 0a 04 05 03 = SBOX S5\n      - bytes: 0c 01 0a 0f 09 02 06 08 00 0d 03 04 0e 07 05 0b 0a 0f 04 02 07 0c 09 05 06 01 0d 0e 00 0b 03 08 09 0e 0f 05 02 08 0c 03 07 00 04 0a 01 0d 0b 06 04 03 02 0c 09 05 0f 0a 0b 0e 01 07 06 00 08 0d = SBOX S6\n      - bytes: 04 0b 02 0e 0f 00 08 0d 03 0c 09 07 05 0a 06 01 0d 00 0b 07 04 09 01 0a 0e 03 05 0c 02 0f 08 06 01 04 0b 0d 0c 03 07 0e 0a 0f 06 08 00 05 09 02 06 0b 0d 08 01 04 0a 07 09 05 00 0f 0e 02 03 0c = SBOX S7\n      - bytes: 0d 02 08 04 06 0f 0b 01 0a 09 03 0e 05 00 0c 07 01 0f 0d 08 0a 03 07 04 0c 05 06 0b 00 0e 09 02 07 0b 04 01 09 0c 0e 02 00 06 0a 0d 0f 03 05 08 02 01 0e 07 04 0a 08 0d 0f 0c 09 00 03 05 06 0b = SBOX S8\n      - bytes: 39 31 29 21 19 11 09 01 3a 32 2a 22 1a 12 0a 02 3b 33 2b 23 1b 13 0b 03 3c 34 2c 24 3f 37 2f 27 1f 17 0f 07 3e 36 2e 26 1e 16 0e 06 3d 35 2d 25 1d 15 0d 05 1c 14 0c 04  = PC1\n      - bytes: 0e 11 0b 18 01 05 03 1c 0f 06 15 0a 17 13 0c 04 1a 08 10 07 1b 14 0d 02 29 34 1f 25 2f 37 1e 28 33 2d 21 30 2c 31 27 38 22 35 2e 2a 32 24 1d 20  = PC2\n      - bytes: 3a 32 2a 22 1a 12 0a 02 3c 34 2c 24 1c 14 0c 04 3e 36 2e 26 1e 16 0e 06 40 38 30 28 20 18 10 08 39 31 29 21 19 11 09 01 3b 33 2b 23 1b 13 0b 03 3d 35 2d 25 1d 15 0d 05 3f 37 2f 27 1f 17 0f 07 = Initial Permutation\n      - bytes: 28 08 30 10 38 18 40 20 27 07 2f 0f 37 17 3f 1f 26 06 2e 0e 36 16 3e 1e 25 05 2d 0d 35 15 3d 1d 24 04 2c 0c 34 14 3c 1c 23 03 2b 0b 33 13 3b 1b 22 02 2a 0a 32 12 3a 1a 21 01 29 09 31 11 39 19 = Final Permutation\n      - bytes: 20 01 02 03 04 05 04 05 06 07 08 09 08 09 0a 0b 0c 0d 0c 0d 0e 0f 10 11 10 11 12 13 14 15 14 15 16 17 18 19 18 19 1a 1b 1c 1d 1c 1d 1e 1f 20 01 = DES Expansion\n      - bytes: 10 07 14 15 1d 0c 1c 11 01 0f 17 1a 05 12 1f 0a 02 08 18 0e 20 1b 03 09 13 0d 1e 06 16 0b 04 19 = PBOX\n      - and:\n        - description: DES RawProcessBlock\n        - number: 0x18\n        - number: 0x10\n        - number: 0x8\n        - number: 0x3f\n        - characteristic: nzxor\n        - count(mnemonic(shr)): 8 or more\n        - mnemonic: ror\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using AES via x86 extensions",
                                               "description":  "data-manipulation/encryption/aes",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using AES via x86 extensions\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]\n      - Cryptography::Encrypt Data::AES [C0027.001]\n  features:\n    - or:\n      - mnemonic: aesenc = Perform One Round of an AES Encryption Flow\n      - mnemonic: vaesenc\n      - mnemonic: aesenclast = Perform Last Round of an AES Encryption Flow\n      - mnemonic: vaesenclast\n      - mnemonic: aesimc = Perform the AES InvMixColumn Transformation\n      - mnemonic: vaesimc\n      - mnemonic: aeskeygenassist = AES Round Key Generation Assist\n      - mnemonic: vaeskeygenassist\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Windows",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using Base64",
                                               "description":  "data-manipulation/encoding/base64",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using Base64\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::Base64 [C0026.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314889C\n      - 074072B261FC27B65C72671F13510C05:0x100049B2\n      - 5DB2D2BE20D59AA0BE6709A6850F1775:0x18001CC30\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - and:\n        - mnemonic: shl\n        - mnemonic: shr\n        - number: 0x3F = modulo 64\n        - or:\n          - number: 0x3D = \u0027=\u0027\n          - number: 0x3D3D = \u0027==\u0027\n        - match: contain loop\n        - optional:\n          - number: 2\n          - number: 3\n          - number: 4\n          - number: 6\n          - number: 0xF\n          - string: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n      - api: System.Convert::ToBase64String\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "hash data using fnv",
                                               "description":  "can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "@_re_fox",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: hash data using fnv\n    namespace: data-manipulation/hashing/fnv\n    authors:\n      - moritz.raabe@mandiant.com\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    description: can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0\n    scope: function\n    mbc:\n      - Data::Non-Cryptographic Hash::FNV [C0030.005]\n    references:\n      - https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\n      - http://isthe.com/chongo/tech/comp/fnv/\n      - https://create.stephan-brumme.com/fnv-hash/\n    examples:\n      - ad4229879180e267f431ac6666b6a0a2:0x14007B4D4\n  features:\n    - and:\n      - optional:\n        - characteristic: loop\n        - number: 0xcbf29ce484222325 = FNV_offset_basis, unused by FNV-0\n        - number: 0x811c9dc5 = FNV_offset_basis, unused by FNV-0\n      - or:\n        - number: 0x100000001b3 = FNV prime\n        - number: 0x01000193 = FNV prime\n      - basic block:\n        # FNV-1 hash does multiply then XOR\n        # FNV-1a hash does XOR then multiply\n        - and:\n          - characteristic: nzxor\n          - or:\n            - mnemonic: imul\n            - mnemonic: mul\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function"
                                                            },
                                                            {
                                                                "ref":  "http://isthe.com/chongo/tech/comp/fnv/"
                                                            },
                                                            {
                                                                "ref":  "https://create.stephan-brumme.com/fnv-hash/"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference AES constants",
                                               "description":  "data-manipulation/encryption/aes",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference AES constants\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n  features:\n    - or:\n      - bytes: 50 a7 f4 51 53 65 41 7e = d-0\n      - bytes: 63 7c 77 7b f2 6b 6f c5 = s-box\n      - bytes: 52 09 6a d5 30 36 a5 38 = inv-s-box\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "decrypt data using AES via x86 extensions",
                                               "description":  "data-manipulation/encryption/aes",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: decrypt data using AES via x86 extensions\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Defense Evasion::Deobfuscate/Decode Files or Information [T1140]\n    mbc:\n      - Cryptography::Decrypt Data::AES [C0031.001]\n    examples:\n      - 66602B5FAB602CB4E6F754748D249542:0x4097D0\n  features:\n    - or:\n      - mnemonic: aesdec = Perform One Round of an AES Decryption Flow\n      - mnemonic: vaesdec\n      - mnemonic: aesdeclast = Perform Last Round of an AES Decryption Flow\n      - mnemonic: vaesdeclast\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using RC4 PRGA",
                                               "description":  "data-manipulation/encryption/rc4",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple\n      - count(basic blocks): 4 or more\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate PE sections",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "@Ana06"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    scope: function\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      - offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header-\u003ee_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - basic block:\n        - and:\n          - offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n          - offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n          - offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://0x00sec.org/t/reflective-dll-injection/3080"
                                                            },
                                                            {
                                                                "ref":  "https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "authenticate HMAC",
                                               "description":  "data-manipulation/hmac",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: authenticate HMAC\n    namespace: data-manipulation/hmac\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Cryptography::Hashed Message Authentication Code [C0061]\n    references:\n      - https://tools.ietf.org/html/rfc2104\n      - https://tools.ietf.org/html/rfc4634\n      - https://github.com/ogay/hmac\n    examples:\n      - mimikatz.exe_:0x403408\n  features:\n    - and:\n      # block-sized inner padding, consisting of repeated bytes valued 0x36\n      - number: 0x36 = inner padding byte value\n      # block-sized outer padding, consisting of repeated bytes valued 0x5c\n      - number: 0x5C = outer padding byte value\n      - match: contain loop\n      - count(characteristic(nzxor)): 2 or more\n      - optional:\n        - description: block size\n        - number: 64 = MD5, SHA-1, SHA-224, or SHA-256\n        - number: 128 = SHA-384 or SHA-512\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://tools.ietf.org/html/rfc2104"
                                                            },
                                                            {
                                                                "ref":  "https://tools.ietf.org/html/rfc4634"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/ogay/hmac"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "parse credit card information",
                                               "description":  "collection/credit-card",
                                               "authors":  [
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: parse credit card information\n    namespace: collection/credit-card\n    authors:\n      - \"@_re_fox\"\n    scope: function\n    mbc:\n      - Data::Check String [C0019]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x402860\n  features:\n    - and:\n      - 3 or more:\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x5E = \u0027^\u0027 (Track 1 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3D = \u0027=\u0027 (Track 2 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x25 = \u0027%\u0027 (Track 1 start sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x42 = \u0027B\u0027 (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x44 = \u0027D\u0027 (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3F = \u0027?\u0027 (Track 1 \u0026 2 end sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3B = \u0027;\u0027 (Track 2 start sentinel)\n      - not:\n        - description: if a function also compares these non-hex characters it\u0027s most likely NOT parsing CC data\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6D = \u0027m\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6E = \u0027n\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6F = \u0027o\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x70 = \u0027p\u0027\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check for software breakpoints",
                                               "description":  "anti-analysis/anti-debugging/debugger-detection",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check for software breakpoints\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Software Breakpoints [B0001.025]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SoftwareBreakpoints.cpp\n      - https://anti-debug.checkpoint.com/techniques/assembly.html\n    examples:\n      - al-khaser_x86.exe_:0x431020\n  features:\n    - and:\n      - or:\n        - instruction:\n          - mnemonic: cmp\n          - number: 0xCC = INT3\n        - and:\n          - description: INT3 (long form)\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xCD = INT3 (long form byte 1)\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x03 = INT3 (long form byte 2)\n      - match: contain loop\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/SoftwareBreakpoints.cpp"
                                                            },
                                                            {
                                                                "ref":  "https://anti-debug.checkpoint.com/techniques/assembly.html"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check HTTP status code",
                                               "description":  "communication/http/client",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check HTTP status code\n    namespace: communication/http/client\n    authors:\n      - \"@mr-tz\"\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Read Header [C0002.014]\n    examples:\n      - 54ac78733552a62d1d05ea4ba3fc604bb49fe000d7fc948da45335b726e64d75:0x10001a20\n  features:\n    - and:\n      - os: windows\n      - or:\n        - number: 0x20000013 = HTTP_QUERY_FLAG_NUMBER | HTTP_QUERY_STATUS_CODE\n        - number: 0x13 = HTTP_QUERY_STATUS_CODE\n      - optional:\n        - api: atoi\n        - api: wininet.HttpQueryInfo\n      - instruction:\n        - and:\n          - or:\n            - mnemonic: cmp\n            - mnemonic: test\n          - or:\n            - number: 200 = OK\n            - number: 400 = Bad Request\n            - number: 401 = Unauthorized\n            - number: 403 = Forbidden\n            - number: 404 = Not Found\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "compiled with Go",
                                               "description":  "compiler/go",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: compiled with Go\n    namespace: compiler/go\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    examples:\n      - 49a34cfbeed733c24392c9217ef46bb6\n  features:\n    - or:\n      - string: /^Go build ID:/\n      - substring: \"go.buildid\"\n      - string: /^Go buildinf:/\n      - substring: \"go1.\"\n      - substring: \"runtime.main\"\n      - substring: \"main.main\"\n      - substring: \"runtime.gcWork\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference Base64 string",
                                               "description":  "data-manipulation/encoding/base64",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference Base64 string\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Data::Encode Data::Base64 [C0026.001]\n      - Data::Check String [C0019]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5\n      - 074072B261FC27B65C72671F13510C05\n      - 5DB2D2BE20D59AA0BE6709A6850F1775\n  features:\n    - string: /ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against wolfSSL",
                                               "description":  "linking/static/wolfssl",
                                               "authors":  [
                                                               "jakub.jozwiak@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against wolfSSL\n    namespace: linking/static/wolfssl\n    authors:\n      - jakub.jozwiak@mandiant.com\n    scope: file\n    mbc:\n      - Cryptography::Crypto Library [C0059]\n    references:\n      - https://www.wolfssl.com/\n      - https://github.com/wolfSSL/wolfssl/blob/2841b5c93b87311dadcf2278151df7453e56db96/wolfssl/internal.h#L4646\n    examples:\n      - 5789181cba467fa940cdce809b88b9bf7e0e9d4e079e32a68d2b911a8cc47da9\n  features:\n    - or:\n      - string: \"SSLeay wolfSSL compatibility\"\n      - string: \"wolfSSL_Init\"\n      - string: \"Please supply a buffer for error string\"\n      - 3 or more:\n        - substring: \"CLNTSRVR\"\n        - substring: \"server finished\"\n        - substring: \"client finished\"\n        - substring: \"DOGNGRD\"\n        - substring: \"DOWNGRD\"\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://www.wolfssl.com/"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/wolfSSL/wolfssl/blob/2841b5c93b87311dadcf2278151df7453e56db96/wolfssl/internal.h#L4646"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2310",
                                               "description":  "(Process #3) ntlhost.exe opens an outgoing TCP connection to host \"45.159.189.105:80\".",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2311",
                                               "description":  "(Process #2) ntlhost.exe opens an outgoing TCP connection to host \"45.159.189.105:80\".",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2312",
                                               "description":  "(Process #2) ntlhost.exe starts a TCP server listening on port 49160.",
                                               "severity":  "IMPACT_SEVERITY_LOW",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2313",
                                               "description":  "(Process #3) ntlhost.exe starts a TCP server listening on port 49158.",
                                               "severity":  "IMPACT_SEVERITY_LOW",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2314",
                                               "description":  "(Process #1) milmonjey.txt.exe drops file \"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\".",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6"
                                                            },
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" "
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2315",
                                               "description":  "Executes dropped file \"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\".",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" "
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2317",
                                               "description":  "(Process #1) milmonjey.txt.exe resolves 40 API functions by name.",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2318",
                                               "description":  "(Process #2) ntlhost.exe resolves 50 API functions by name.",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2319",
                                               "description":  "(Process #3) ntlhost.exe resolves 48 API functions by name.",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2309",
                                               "description":  "File \"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" has a double file extension.",
                                               "severity":  "IMPACT_SEVERITY_HIGH",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2196",
                                               "description":  "(Process #3) ntlhost.exe has a thread which sleeps more than 5 minutes.",
                                               "severity":  "IMPACT_SEVERITY_LOW",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_4",
                                               "description":  "(Process #2) ntlhost.exe reads data from clipboard.",
                                               "severity":  "IMPACT_SEVERITY_MEDIUM",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_3",
                                               "description":  "(Process #2) ntlhost.exe tries to detect \"wine\" by calling GetProcAddress() on \"wine_get_version\".",
                                               "severity":  "IMPACT_SEVERITY_LOW",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2",
                                               "description":  "(Process #1) milmonjey.txt.exe starts (process #2) ntlhost.exe with a hidden window.",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6"
                                                            },
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" "
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_1",
                                               "description":  "(Process #1) milmonjey.txt.exe adds \"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" to Windows startup via registry.",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6"
                                                            },
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" "
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            },
                                                            {
                                                                "ref":  "#registry_keys_set",
                                                                "value":  "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_0",
                                               "description":  "(Process #1) milmonjey.txt.exe tries to detect \"wine\" by calling GetProcAddress() on \"wine_get_version\".",
                                               "severity":  "IMPACT_SEVERITY_LOW",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2325",
                                               "description":  "(Process #2) ntlhost.exe captures keyboard and potentially exfiltrates data.",
                                               "severity":  "IMPACT_SEVERITY_HIGH",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2324",
                                               "description":  "Embedded file \"\" is a known clean file.",
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2689367b205c16ce32ed4200942b8b8b1e262dfc70d9bc9fbc77c49699a4f1df"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2326",
                                               "description":  "(Process #3) ntlhost.exe captures keyboard and potentially exfiltrates data.",
                                               "severity":  "IMPACT_SEVERITY_HIGH",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2321",
                                               "description":  "Reputation analysis labels the URL \"http://45.159.189.105/bot/onlin...a8e35e\u0026guid=Q9IATRKPRH\\kEecfMwgj\" which was contacted by (process #2) ntlhost.exe as C2/Generic-A.",
                                               "severity":  "IMPACT_SEVERITY_HIGH",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2320",
                                               "description":  "Reputation analysis labels the sample itself as Mal/Generic-S.",
                                               "severity":  "IMPACT_SEVERITY_HIGH",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_2323",
                                               "description":  "Reputation analysis labels the contacted IP address 45.159.189.105 as C2/Generic-A.",
                                               "severity":  "IMPACT_SEVERITY_HIGH"
                                           },
                                           {
                                               "id":  "vti_match_2322",
                                               "description":  "Reputation analysis labels the URL \"http://45.159.189.105/bot/regex\" which was contacted by (process #2) ntlhost.exe as C2/Generic-A.",
                                               "severity":  "IMPACT_SEVERITY_HIGH",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_270",
                                               "description":  "(Process #3) ntlhost.exe tries to detect \"wine\" by calling GetProcAddress() on \"wine_get_version\".",
                                               "severity":  "IMPACT_SEVERITY_LOW",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "vti_match_271",
                                               "description":  "(Process #3) ntlhost.exe reads data from clipboard.",
                                               "severity":  "IMPACT_SEVERITY_MEDIUM",
                                               "refs":  [
                                                            {
                                                                "ref":  "#files_dropped",
                                                                "value":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b"
                                                            },
                                                            {
                                                                "ref":  "#process_tree",
                                                                "value":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                                            }
                                                        ]
                                           }
                                       ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "POLICY-OTHER HTTP request by IPv4 address attempt",
                                        "rule_category":  "policy-violation",
                                        "rule_id":  "1:50447",
                                        "alert_severity":  "info",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "45.159.189.105",
                                                              "dest_port":  80
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_references":  [
                                                                "https://www.w3.org/Protocols/rfc2616/rfc2616-sec15.html"
                                                            ],
                                        "rule_raw":  "alert tcp any any -\u003e any $HTTP_PORTS ( msg:\"POLICY-OTHER HTTP request by IPv4 address attempt\"; flow:to_server,established; http_header; content:\"Host:\",fast_pattern,nocase; pcre:\"/^Host\\x3a\\s*(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\\s*:?\\s*\\d*\\s*$/ims\"; service:http; reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec15.html; classtype:policy-violation; sid:50447; rev:1; )"
                                    },
                                    {
                                        "rule_msg":  "(http_inspect) backslash character appears in the path portion of a URI",
                                        "rule_category":  "not-suspicious",
                                        "rule_id":  "119:9",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "45.159.189.105",
                                                              "dest_port":  80
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:119; sid:9; rev:3; msg:\"(http_inspect) backslash character appears in the path portion of a URI\"; metadata: rule-type preproc; service:http; classtype:not-suspicious;)"
                                    },
                                    {
                                        "rule_msg":  "ET USER_AGENTS Go HTTP Client User-Agent",
                                        "rule_category":  "Misc activity",
                                        "rule_id":  "1:2024897",
                                        "alert_severity":  "low",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "45.159.189.105",
                                                              "dest_port":  80,
                                                              "hostname":  "45.159.189.105",
                                                              "url":  "http://45.159.189.105/bot/regex"
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET any (msg:\"ET USER_AGENTS Go HTTP Client User-Agent\"; flow:established,to_server; http.user_agent; content:\"Go-http-client\"; nocase; fast_pattern; classtype:misc-activity; sid:2024897; rev:2; metadata:attack_target Client_Endpoint, created_at 2017_10_23, deployment Perimeter, former_category USER_AGENTS, signature_severity Major, updated_at 2020_08_13;)"
                                    }
                                ],
                 "files_written":  [
                                       "c:\\users\\keecfmwgj\\appdata\\roaming\\ntsystem",
                                       "c:\\users\\keecfmwgj\\appdata\\roaming\\ntsystem\\ntlhost.exe",
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                       "\\Sessions\\1\\BaseNamedObjects",
                                       "\\\\?\\PIPE\\NETLOGON",
                                       "C:\\Users\\user\\AppData\\Roaming\\NTSystem",
                                       "C:\\Users\\user\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                   ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "crt.sectigo.com",
                                         "resolved_ips":  [
                                                              "91.199.212.52"
                                                          ]
                                     }
                                 ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\5531e69bae1958fecf77492ce5091225.exe",
                                           "%USERPROFILE%\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                           "%SAMPLEPATH%\\2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe",
                                           "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                           "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                       ],
                 "modules_loaded":  [
                                        "%SAMPLEPATH%\\5531e69bae1958fecf77492ce5091225.exe",
                                        "%USERPROFILE%\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                        "%SAMPLEPATH%\\2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe",
                                        "kernel32.dll",
                                        "advapi32.dll",
                                        "ntdll.dll",
                                        "winmm.dll",
                                        "ws2_32.dll",
                                        "API-MS-Win-Core-LocalRegistry-L1-1-0.dll",
                                        "powrprof.dll",
                                        "C:\\Windows\\System32\\wshtcpip.dll",
                                        "C:\\Windows\\System32\\wship6.dll",
                                        "C:\\Windows\\System32\\wshqos.dll",
                                        "advapi32",
                                        "userenv.dll",
                                        "API-MS-Win-Security-SDDL-L1-1-0.dll",
                                        "API-MS-Win-Security-LSALookup-L1-1-0.dll",
                                        "netapi32.dll",
                                        "SAMLIB.dll",
                                        "RPCRT4.dll",
                                        "user32",
                                        "C:\\Windows\\system32\\mswsock.dll",
                                        "API-MS-Win-Security-LSALookup-L1-1-0",
                                        "kernel32",
                                        "SAMLIB",
                                        "rpcrt4",
                                        "SspiCli",
                                        "cryptbase",
                                        "netutils",
                                        "winmm",
                                        "ntdll",
                                        "ADVAPI32",
                                        "API-MS-Win-Core-LocalRegistry-L1-1-0",
                                        "logoncli",
                                        "powrprof",
                                        "ws2_32",
                                        "apphelp",
                                        "netapi32",
                                        "RPCRT4",
                                        "userenv",
                                        "secur32",
                                        "API-MS-Win-Security-SDDL-L1-1-0"
                                    ],
                 "memory_pattern_urls":  [
                                             "http://45.159.189.105/bot/online?key=ff57427f477132df80e6d599aee7b24401cc56f10c1dcec7c6fc0bc2e9a8e35e\u0026guid=Q9IATRKPRH\\kEecfMwgj",
                                             "http://45.159.189.105/bot/regex"
                                         ],
                 "registry_keys_opened":  [
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
                                              "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ntlhost.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\14685EAE",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\16DB881C",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\00000014",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000001",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000002",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000003",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000004",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000005",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000006",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\00000007",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000001",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000002",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000003",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000004",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000005",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000006",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000007",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000008",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000009",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000010",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000011",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000012",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000013",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Winsock\\Setup Migration\\Providers\\Tcpip",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Setup Migration\\Providers",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\S-1-5-21-1015118539-3749460369-599379286-1001",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\System\\DNSclient",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Display",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Error Message Instrument\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\WinSock2\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Winsock2\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\afunix\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup"
                                          ],
                 "verdict_confidence":  1,
                 "files_deleted":  [
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7DC6.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7E16.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7E36.tmp.txt",
                                       "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                   ],
                 "tags":  [
                              "DIRECT_CPU_CLOCK_ACCESS",
                              "RUNTIME_MODULES",
                              "PERSISTENCE",
                              "DETECT_DEBUG_ENVIRONMENT"
                          ],
                 "verdict_labels":  [
                                        "C2/Generic-A",
                                        "Mal/Generic-S"
                                    ],
                 "processes_injected":  [
                                            "%SAMPLEPATH%\\5531e69bae1958fecf77492ce5091225.exe",
                                            "%USERPROFILE%\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                            "%SAMPLEPATH%\\2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe"
                                        ],
                 "http_conversations":  [
                                            {
                                                "url":  "http://45.159.189.105/bot/online?key=ff57427f477132df80e6d599aee7b24401cc56f10c1dcec7c6fc0bc2e9a8e35e\u0026guid=Q9IATRKPRH\\kEecfMwgj",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Go-http-client/1.1",
                                                                        "Host":  "45.159.189.105",
                                                                        "Accept-Encoding":  "gzip"
                                                                    },
                                                "response_headers":  {
                                                                         "Date":  "Thu, 20 Apr 2023 08:02:57 GMT",
                                                                         "Server":  "nginx/1.14.2",
                                                                         "Content-Length":  "2",
                                                                         "Content-Type":  "text/plain; charset=utf-8",
                                                                         "Connection":  "keep-alive"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://45.159.189.105/bot/regex",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Go-http-client/1.1",
                                                                        "Host":  "45.159.189.105",
                                                                        "Accept-Encoding":  "gzip"
                                                                    },
                                                "response_headers":  {
                                                                         "Date":  "Thu, 20 Apr 2023 08:02:57 GMT",
                                                                         "Server":  "nginx/1.14.2",
                                                                         "Content-Length":  "633",
                                                                         "Content-Type":  "text/plain; charset=utf-8",
                                                                         "Connection":  "keep-alive"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://45.159.189.105/bot/online?key=ff57427f477132df80e6d599aee7b24401cc56f10c1dcec7c6fc0bc2e9a8e35e\u0026guid=Q9IATRKPRH\\kEecfMwgj",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Go-http-client/1.1",
                                                                        "Host":  "45.159.189.105",
                                                                        "Accept-Encoding":  "gzip"
                                                                    },
                                                "response_headers":  {
                                                                         "Date":  "Thu, 20 Apr 2023 08:01:48 GMT",
                                                                         "Server":  "nginx/1.14.2",
                                                                         "Content-Length":  "2",
                                                                         "Content-Type":  "text/plain; charset=utf-8",
                                                                         "Connection":  "keep-alive"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://45.159.189.105/bot/regex",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Go-http-client/1.1",
                                                                        "Host":  "45.159.189.105",
                                                                        "Accept-Encoding":  "gzip"
                                                                    },
                                                "response_headers":  {
                                                                         "Date":  "Thu, 20 Apr 2023 08:01:48 GMT",
                                                                         "Server":  "nginx/1.14.2",
                                                                         "Content-Length":  "633",
                                                                         "Content-Type":  "text/plain; charset=utf-8",
                                                                         "Connection":  "keep-alive"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://45.159.189.105/bot/online?key=ff57427f477132df80e6d599aee7b24401cc56f10c1dcec7c6fc0bc2e9a8e35e\u0026guid=Q9IATRKPRH\\kEecfMwgj",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Go-http-client/1.1",
                                                                        "Host":  "45.159.189.105",
                                                                        "Accept-Encoding":  "gzip"
                                                                    },
                                                "response_headers":  {
                                                                         "Date":  "Thu, 20 Apr 2023 08:03:59 GMT",
                                                                         "Server":  "nginx/1.14.2",
                                                                         "Content-Length":  "2",
                                                                         "Content-Type":  "text/plain; charset=utf-8",
                                                                         "Connection":  "keep-alive"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://45.159.189.105/bot/regex",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Go-http-client/1.1",
                                                                        "Host":  "45.159.189.105",
                                                                        "Accept-Encoding":  "gzip"
                                                                    },
                                                "response_headers":  {
                                                                         "Date":  "Thu, 20 Apr 2023 08:03:59 GMT",
                                                                         "Server":  "nginx/1.14.2",
                                                                         "Content-Length":  "633",
                                                                         "Content-Type":  "text/plain; charset=utf-8",
                                                                         "Connection":  "keep-alive"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://45.159.189.105/bot/regex",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "user-agent":  "Go-http-client/1.1",
                                                                        "accept-encoding":  "gzip",
                                                                        "host":  "45.159.189.105"
                                                                    }
                                            },
                                            {
                                                "url":  "http://45.159.189.105/bot/online?key=ff57427f477132df80e6d599aee7b24401cc56f10c1dcec7c6fc0bc2e9a8e35e\u0026guid=azure-PC\\azure",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "user-agent":  "Go-http-client/1.1",
                                                                        "accept-encoding":  "gzip",
                                                                        "host":  "45.159.189.105"
                                                                    }
                                            },
                                            {
                                                "url":  "http://crt.sectigo.com/SectigoPublicCodeSigningCAR36.crt",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Microsoft-CryptoAPI/6.1",
                                                                        "Host":  "crt.sectigo.com"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "1566",
                                                                         "Content-Type":  "application/pkix-cert"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://www.microsoft.com/pki/certs/MicCodSigPCA_08-31-2010.crt",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Microsoft-CryptoAPI/6.1",
                                                                        "Host":  "www.microsoft.com"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "1472",
                                                                         "Content-Type":  "application/octet-stream"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://crt.sectigo.com/SectigoPublicCodeSigningRootR46.p7c",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Microsoft-CryptoAPI/6.1",
                                                                        "Host":  "crt.sectigo.com"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "2848",
                                                                         "Content-Type":  "application/pkcs7-mime"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://www.microsoft.com/pki/certs/MicrosoftTimeStampPCA.crt",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Microsoft-CryptoAPI/6.1",
                                                                        "Host":  "www.microsoft.com"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "1547",
                                                                         "Content-Type":  "application/octet-stream"
                                                                     },
                                                "response_status_code":  200
                                            }
                                        ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2264",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                                        },
                                        {
                                            "process_id":  "2672",
                                            "name":  "%SAMPLEPATH%",
                                            "time_offset":  2
                                        },
                                        {
                                            "process_id":  "2052",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2828",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2144",
                                                                 "name":  "%SAMPLEPATH%\\5531e69bae1958fecf77492ce5091225.exe",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "2080",
                                                                                      "name":  "%USERPROFILE%\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "1892",
                                            "name":  "\"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                        },
                                        {
                                            "process_id":  "3740",
                                            "name":  "\"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" ",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3824",
                                                                 "name":  "C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "1800",
                                            "name":  "2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2304",
                                                                 "name":  "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                                                 "time_offset":  86
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "520",
                                            "name":  "b4aa37d127e5e360613d510d1a8365dd.28668",
                                            "time_offset":  784,
                                            "children":  [
                                                             {
                                                                 "process_id":  "1992",
                                                                 "name":  "ba750f83b0c569ebc3b4ddbb3da78fea.exe",
                                                                 "time_offset":  856
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "7416",
                                            "name":  "C:\\Users\\user\\Desktop\\executable.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "8156",
                                                                 "name":  "C:\\Users\\user\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "7436",
                                            "name":  "\"C:\\Users\\user\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                        },
                                        {
                                            "process_id":  "2364",
                                            "name":  "\"C:\\Users\\user\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" "
                                        }
                                    ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "T1060,RunKey",
                                                                                             "UtcTime":  "1674082301",
                                                                                             "Details":  "C:\\Users\\azure\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                                                                             "ProcessGuid":  "{574CBD14-77DC-63C8-B100-000000003000}",
                                                                                             "EventID":  "13",
                                                                                             "ProcessId":  "1800",
                                                                                             "Image":  "C:\\Users\\azure\\Downloads\\2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe",
                                                                                             "EventType":  "SetValue",
                                                                                             "TargetObject":  "HKU\\S-1-5-21-4270068108-2931534202-3907561125-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "8b5db9da5732dc549b0e8b56fe5933d7c95ed760f3ac20568ab95347ef8c5bcc",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "CurrentVersion Autorun Keys Modification",
                                                    "rule_description":  "Detects modification of autostart extensibility point (ASEP) in registry.",
                                                    "rule_author":  "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "EXE",
                                                                                             "CreationUtcTime":  "1674082271",
                                                                                             "UtcTime":  "1674082271",
                                                                                             "EventID":  "11",
                                                                                             "ProcessGuid":  "{574CBD14-77DC-63C8-B100-000000003000}",
                                                                                             "ProcessId":  "1800",
                                                                                             "Image":  "C:\\Users\\azure\\Downloads\\2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe",
                                                                                             "TargetFilename":  "C:\\Users\\azure\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "low",
                                                    "rule_id":  "b5386a23355681c43cfbd2f2ccfe4b16ed45324d0d7b5583487a9f302ee1e427",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Creation of an Executable by an Executable",
                                                    "rule_description":  "Detects the creation of an executable by another executable",
                                                    "rule_author":  "frack113"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "f9c50298c31c4f832377cbc3805f78dcf568835d7138c21088e56a2c5768f935",
                                                                                             "Path":  "",
                                                                                             "ScriptBlockId":  "4345201d-0c35-40fe-acc9-ae2b981123ac",
                                                                                             "MessageTotal":  "1",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "5572c8188426269a10ccb41fc8e9c8445391ac38a0917621b0a1ee05ec99aac9",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Change PowerShell Policies to an Insecure Level - PowerShell",
                                                    "rule_description":  "Detects use of Set-ExecutionPolicy to set insecure policies",
                                                    "rule_author":  "frack113"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                                                                             "Path":  "",
                                                                                             "ScriptBlockId":  "8fe3efbd-853a-44c8-a79e-7fae9a574596",
                                                                                             "MessageTotal":  "1",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                                                                             "MessageTotal":  "1",
                                                                                             "ScriptBlockId":  "667efede-0083-4509-b112-8287a2f25803",
                                                                                             "Path":  "",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                                                                             "Path":  "",
                                                                                             "ScriptBlockId":  "4a0b66fa-b2f1-4fb5-9a0e-a402ec92b474",
                                                                                             "MessageTotal":  "1",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                                                                             "Path":  "",
                                                                                             "ScriptBlockId":  "14fd127e-f3a9-4ac0-9228-0963d661a09e",
                                                                                             "MessageTotal":  "1",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                                                                             "MessageTotal":  "1",
                                                                                             "ScriptBlockId":  "0425096d-a6cd-4556-90f8-946ad7751f3d",
                                                                                             "Path":  "",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                                                                             "Path":  "",
                                                                                             "ScriptBlockId":  "cd3d000a-36a2-4d4e-a4fe-0149972fec47",
                                                                                             "MessageTotal":  "1",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "ScriptBlockText":  "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                                                                             "MessageTotal":  "1",
                                                                                             "ScriptBlockId":  "e6fcd68c-555b-4658-8380-c9ada1bc4208",
                                                                                             "Path":  "",
                                                                                             "MessageNumber":  "1",
                                                                                             "EventID":  "4104"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "low",
                                                    "rule_id":  "1f7f8b1e9005dd4d64cb9d30ed53ee94f68fb96262fbd72f7a0266881149c79f",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Suspicious Get-WmiObject",
                                                    "rule_description":  "The infrastructure for management data and operations that enables local and remote management of Windows personal computers and servers",
                                                    "rule_author":  "frack113"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "T1060,RunKey",
                                                                                             "UtcTime":  "1674109489",
                                                                                             "Details":  "C:\\Users\\george\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                                                                             "ProcessGuid":  "{C784477D-E1F4-63C8-2906-000000001F00}",
                                                                                             "EventID":  "13",
                                                                                             "ProcessId":  "7416",
                                                                                             "Image":  "C:\\Users\\george\\Desktop\\executable.exe",
                                                                                             "EventType":  "SetValue",
                                                                                             "TargetObject":  "HKU\\S-1-5-21-1015118539-3749460369-599379286-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "8b5db9da5732dc549b0e8b56fe5933d7c95ed760f3ac20568ab95347ef8c5bcc",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "CurrentVersion Autorun Keys Modification",
                                                    "rule_description":  "Detects modification of autostart extensibility point (ASEP) in registry.",
                                                    "rule_author":  "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "EXE",
                                                                                             "CreationUtcTime":  "1674109429",
                                                                                             "UtcTime":  "1674109429",
                                                                                             "EventID":  "11",
                                                                                             "ProcessGuid":  "{C784477D-E1F4-63C8-2906-000000001F00}",
                                                                                             "ProcessId":  "7416",
                                                                                             "Image":  "C:\\Users\\george\\Desktop\\executable.exe",
                                                                                             "TargetFilename":  "C:\\Users\\george\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "low",
                                                    "rule_id":  "b5386a23355681c43cfbd2f2ccfe4b16ed45324d0d7b5583487a9f302ee1e427",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Creation of an Executable by an Executable",
                                                    "rule_description":  "Detects the creation of an executable by another executable",
                                                    "rule_author":  "frack113"
                                                }
                                            ],
                 "files_dropped":  [
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\NTSystem"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7DC6.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7DC6.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7E16.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7E16.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7E36.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER7E36.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                       },
                                       {
                                           "sha256":  "2689367b205c16ce32ed4200942b8b8b1e262dfc70d9bc9fbc77c49699a4f1df",
                                           "type":  "TEXT"
                                       },
                                       {
                                           "sha256":  "de32b3c0549fde0dc5ac435a89f16a87832a0632b6602e75f552d07074081577",
                                           "type":  "TEXT"
                                       },
                                       {
                                           "path":  "c:\\users\\keecfmwgj\\appdata\\roaming\\ntsystem\\ntlhost.exe",
                                           "sha256":  "71d31ff0e38bda4f3a8e468177379ac3a103fce974c38213a2d06cf45f4c1d3b",
                                           "type":  "PE_EXE"
                                       },
                                       {
                                           "path":  "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                           "sha256":  "3afb2884d3de9eefe587c5457e82b01849a2781b710b06486c32f28f4d4d1e49"
                                       },
                                       {
                                           "path":  "/msdownload/update/v3/static/trustedr/en/authrootstl.cab",
                                           "sha256":  "95b0a5acc5bf70d3abdfd091d0c9f9063aa4fde65bd34dbf16786082e1992e72",
                                           "type":  "CAB",
                                           "download_url":  "ctldl.windowsupdate.comhttp://ctldl.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab?a40ffc241029adff"
                                       },
                                       {
                                           "path":  "C:\\Users\\user\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                           "sha256":  "9c5f6b73444b5c3712f5ef0fe617b95d3cc76f56c2170669a10e2560005c4d23",
                                           "type":  "PE_EXE"
                                       }
                                   ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "a83f:8110:6c00:6c00:2c00:2d00:3300:3600",
                                        "destination_port":  53,
                                        "transport_layer_protocol":  "UDP"
                                    },
                                    {
                                        "destination_ip":  "20.99.133.109",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "13.107.4.50",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.159.189.105",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.216.147.78",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.159.189.105"
                                    }
                                ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKU\\%SID%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem",
                                               "value":  "%USERPROFILE%\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                           },
                                           {
                                               "key":  "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem",
                                               "value":  "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-4270068108-2931534202-3907561125-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem",
                                               "value":  "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-4270068108-2931534202-3907561125-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.exe\\OpenWithProgids\\exefile",
                                               "value":  "Binary Data"
                                           },
                                           {
                                               "key":  "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\NTSystem",
                                               "value":  "C:\\Users\\user\\AppData\\Roaming\\NTSystem\\ntlhost.exe"
                                           }
                                       ],
                 "verdicts":  [
                                  "UNKNOWN_VERDICT",
                                  "MALWARE",
                                  "CLEAN"
                              ],
                 "command_executions":  [
                                            "%SAMPLEPATH%",
                                            "\"%SAMPLEPATH%\\5531e69bae1958fecf77492ce5091225.exe\" ",
                                            "%USERPROFILE%\\AppData\\Roaming\\NTSystem\\ntlhost.exe",
                                            "\"%SAMPLEPATH%\\2a7e44c4035efa9cf51a7699c6731ef77322bd034f0db8936f7c484406ff05d6.exe\" "
                                        ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "access PEB ldr_data",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "access PEB ldr_data"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get kernel32 base address",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get kernel32 base address"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encode data using XOR"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using DES",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encrypt data using DES"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using AES via x86 extensions",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encrypt data using AES via x86 extensions"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using Base64",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encode data using Base64"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference AES constants",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference AES constants"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1140",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "decrypt data using AES via x86 extensions",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "decrypt data using AES via x86 extensions"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using RC4 PRGA",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encrypt data using RC4 PRGA"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference Base64 string",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference Base64 string"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1060",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "(Process #1) milmonjey.txt.exe adds \"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" to Windows startup via registry.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_1"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1045",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "(Process #2) ntlhost.exe resolves 50 API functions by name.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2317"
                                                                  },
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2319"
                                                                  },
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2318"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "(Process #3) ntlhost.exe tries to detect \"wine\" by calling GetProcAddress() on \"wine_get_version\".",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_0"
                                                                  },
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_3"
                                                                  },
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_270"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1056",
                                                     "severity":  "IMPACT_SEVERITY_HIGH",
                                                     "signature_description":  "(Process #2) ntlhost.exe captures keyboard and potentially exfiltrates data.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2326"
                                                                  },
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2325"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1115",
                                                     "severity":  "IMPACT_SEVERITY_MEDIUM",
                                                     "signature_description":  "(Process #3) ntlhost.exe reads data from clipboard.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_4"
                                                                  },
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_271"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1036",
                                                     "severity":  "IMPACT_SEVERITY_HIGH",
                                                     "signature_description":  "File \"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" has a double file extension.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2309"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1112",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "(Process #1) milmonjey.txt.exe adds \"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" to Windows startup via registry.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_1"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1119",
                                                     "severity":  "IMPACT_SEVERITY_HIGH",
                                                     "signature_description":  "(Process #2) ntlhost.exe captures keyboard and potentially exfiltrates data.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2326"
                                                                  },
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2325"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1143",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "(Process #1) milmonjey.txt.exe starts (process #2) ntlhost.exe with a hidden window.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "vti_match_2"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "The process attempted to dynamically load a malicious function"
                                                 },
                                                 {
                                                     "id":  "T1140",
                                                     "signature_description":  "Detected an attempt to pull out some data from the binary image"
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "The process tried to load dynamically one or more functions."
                                                 },
                                                 {
                                                     "id":  "T1027.009",
                                                     "signature_description":  "The process has executed a dropped binary"
                                                 },
                                                 {
                                                     "id":  "T1089",
                                                     "signature_description":  "The process has tried to suspend a sandbox-related thread (possible sandbox evasion attempt)"
                                                 },
                                                 {
                                                     "id":  "T1070",
                                                     "signature_description":  "Network activity detected but not expressed in API logs"
                                                 },
                                                 {
                                                     "id":  "T1027.009",
                                                     "signature_description":  "Drops interesting files and uses them"
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates an autostart registry key"
                                                 },
                                                 {
                                                     "id":  "T1036",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates files inside the user directory"
                                                 },
                                                 {
                                                     "id":  "T1518.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "May try to detect the virtual machine to hinder analysis (VM artifact strings found in memory)"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies"
                                                 }
                                             ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "access PEB ldr_data",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "access PEB ldr_data"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get kernel32 base address",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get kernel32 base address"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process attempted to dynamically load a malicious function"
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process tried to load dynamically one or more functions."
                                                         }
                                                     ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encode data using XOR"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using DES",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encrypt data using DES"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using AES via x86 extensions",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encrypt data using AES via x86 extensions"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using Base64",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encode data using Base64"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference AES constants",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "reference AES constants"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using RC4 PRGA",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encrypt data using RC4 PRGA"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference Base64 string",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "reference Base64 string"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1140":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "decrypt data using AES via x86 extensions",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "decrypt data using AES via x86 extensions"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Detected an attempt to pull out some data from the binary image"
                                                         }
                                                     ],
                                           "T1060":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "(Process #1) milmonjey.txt.exe adds \"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" to Windows startup via registry.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_1"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1045":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "(Process #2) ntlhost.exe resolves 50 API functions by name.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2317"
                                                                          },
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2319"
                                                                          },
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2318"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1497":  [
                                                         {
                                                             "severity":  "LOW",
                                                             "description":  "(Process #3) ntlhost.exe tries to detect \"wine\" by calling GetProcAddress() on \"wine_get_version\".",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_0"
                                                                          },
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_3"
                                                                          },
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_270"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1056":  [
                                                         {
                                                             "severity":  "HIGH",
                                                             "description":  "(Process #2) ntlhost.exe captures keyboard and potentially exfiltrates data.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2326"
                                                                          },
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2325"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1115":  [
                                                         {
                                                             "severity":  "MEDIUM",
                                                             "description":  "(Process #3) ntlhost.exe reads data from clipboard.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_4"
                                                                          },
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_271"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1036":  [
                                                         {
                                                             "severity":  "HIGH",
                                                             "description":  "File \"C:\\Users\\kEecfMwgj\\Desktop\\milmonjey.txt.exe\" has a double file extension.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2309"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates files inside the user directory"
                                                         }
                                                     ],
                                           "T1112":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "(Process #1) milmonjey.txt.exe adds \"C:\\Users\\kEecfMwgj\\AppData\\Roaming\\NTSystem\\ntlhost.exe\" to Windows startup via registry.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_1"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1119":  [
                                                         {
                                                             "severity":  "HIGH",
                                                             "description":  "(Process #2) ntlhost.exe captures keyboard and potentially exfiltrates data.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2326"
                                                                          },
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2325"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1143":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "(Process #1) milmonjey.txt.exe starts (process #2) ntlhost.exe with a hidden window.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "vti_match_2"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1027.009":  [
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "The process has executed a dropped binary"
                                                             },
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "Drops interesting files and uses them"
                                                             }
                                                         ],
                                           "T1089":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process has tried to suspend a sandbox-related thread (possible sandbox evasion attempt)"
                                                         }
                                                     ],
                                           "T1070":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Network activity detected but not expressed in API logs"
                                                         }
                                                     ],
                                           "T1547.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Creates an autostart registry key"
                                                             }
                                                         ],
                                           "T1518.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "May try to detect the virtual machine to hinder analysis (VM artifact strings found in memory)"
                                                             }
                                                         ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies"
                                                         }
                                                     ]
                                       }
             }
}
