{
    "data":  {
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "182.45.22.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.233.246.117",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.252.13.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "110.38.110.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "61.113.103.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "200.38.254.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.252.13.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.226.139.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.131.249.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "24.4.199.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "133.91.124.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "206.69.179.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "110.38.110.118",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "200.38.254.53",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.226",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "52.123.75.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "186.54.204.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "140.206.75.186",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "175.160.198.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.226.139.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "87.195.92.184",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "140.206.75.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.233.246.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "206.69.179.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.104.123.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "133.91.124.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "97.36.138.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.233.246.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.233.246.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "110.38.110.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.252.13.45",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "54.150.202.80",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "200.38.254.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.28",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "206.240.97.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.228.231.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "87.195.92.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "81.247.85.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "97.36.138.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.157.186.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.131.249.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "197.31.211.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "133.91.124.85",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.233.246.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.226.139.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "197.31.211.151",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.104.123.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "133.91.124.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "175.160.198.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "206.240.97.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "206.240.97.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.157.186.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "87.195.92.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.201.158.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "128.50.160.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.228.231.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "87.195.92.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "81.247.85.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "81.247.85.209",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "52.123.75.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.226.139.243",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.123",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.201.158.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "41.198.211.196",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.45.22.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "81.247.85.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "206.240.97.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.252.13.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "175.160.198.16",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.252.13.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "140.206.75.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.45.22.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "52.123.75.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "206.69.179.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "41.198.211.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "128.50.160.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "110.38.110.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "41.198.211.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.233.246.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.201.158.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "61.113.103.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.226.139.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.131.249.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "97.36.138.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.188",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "133.91.124.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "140.206.75.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "128.50.160.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "24.4.199.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "197.31.211.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.83",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.201.158.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "81.247.85.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "54.150.202.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "200.38.254.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "81.247.85.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "41.198.211.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.157.186.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "110.38.110.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "200.38.254.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "175.160.198.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "81.247.85.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "186.54.204.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "24.4.199.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "133.91.124.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "97.36.138.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.228.231.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "24.4.199.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.252.13.7",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.157.186.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "214.111.199.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "175.160.198.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.104.123.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "24.4.199.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "128.50.160.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "41.198.211.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "52.123.75.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "128.50.160.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.201.158.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "54.150.202.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "52.123.75.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "133.91.124.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.226.139.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "24.4.199.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.45.22.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "87.195.92.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "128.50.160.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.131.249.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "61.113.103.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "87.195.92.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.131.249.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.228.231.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "121.27.15.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "140.206.75.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.228.231.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "61.113.103.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "140.206.75.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "110.38.110.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "197.31.211.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "54.150.202.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.104.123.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "186.54.204.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "54.150.202.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.252.13.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "200.38.254.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.39.52.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.104.123.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "186.54.204.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.201.158.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "200.38.254.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "54.150.202.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.168.131.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "124.250.1.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "110.38.110.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "197.31.211.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "24.4.199.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.226.139.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "52.123.75.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "186.54.204.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.228.231.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "41.198.211.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.184.37",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.229.211.108",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "195.164.131.205",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "195.164.131.17",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "55.153.240.227",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "149.130.11.134",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "command_executions":  [
                                            "%SAMPLEPATH%",
                                            "\"%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe\" ",
                                            "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe -m security",
                                            "C:\\WINDOWS\\tasksche.exe /i",
                                            "C:\\Windows\\System32\\wuapihost.exe -Embedding"
                                        ],
                 "files_written":  [
                                       "C:\\Windows\\tasksche.exe"
                                   ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\mssecsvc2.0\\Start",
                                               "value":  "DWORD (0x00000002)"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\mssecsvc2.0\\ImagePath",
                                               "value":  "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe -m security"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\services\\mssecsvc2.0\\Start",
                                               "value":  "DWORD (0x00000002)"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\services\\mssecsvc2.0\\ImagePath",
                                               "value":  "C:\\Users\\\u003cUSER\u003e\\Downloads\\27224344bcbd2e4b2baef34a42d5a68ae2ae0f666bedb4b2ab701c7ba3208c64.exe -m security"
                                           }
                                       ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "1088",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "1992",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2520",
                                            "name":  "%SAMPLEPATH%",
                                            "time_offset":  2
                                        },
                                        {
                                            "process_id":  "2604",
                                            "name":  "%SAMPLEPATH% -m security"
                                        },
                                        {
                                            "process_id":  "3320",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2900",
                                                                 "name":  "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3428",
                                                                                      "name":  "C:\\Windows\\tasksche.exe"
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "540",
                                            "name":  "C:\\Windows\\System32\\services.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2892",
                                                                 "name":  "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "620",
                                            "name":  "C:\\Windows\\System32\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1804",
                                                                 "name":  "C:\\Windows\\System32\\wuapihost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2976",
                                            "name":  "27224344bcbd2e4b2baef34a42d5a68ae2ae0f666bedb4b2ab701c7ba3208c64.exe"
                                        },
                                        {
                                            "process_id":  "2756",
                                            "name":  "ac65090d5737ab8436e2b25a246f0b30.exe",
                                            "time_offset":  31953
                                        }
                                    ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe",
                                           "C:\\Windows\\tasksche.exe",
                                           "C:\\Windows\\System32\\wuapihost.exe"
                                       ],
                 "verdict_confidence":  60,
                 "memory_pattern_urls":  [
                                             "http://cwwnhwhlz52maqm7.onion",
                                             "http://gx7ekbenv2riucmf.onion",
                                             "http://57g7spgrzlojinas.onion",
                                             "http://xxlvbrloxvriy2c5.onion",
                                             "http://76jdd2ir2embyv47.onion"
                                         ],
                 "mbc":  [
                             {
                                 "id":  "C0058",
                                 "objective":  "Data",
                                 "behavior":  "Modulo",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "calculate modulo 256 via x86 assembly"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0003.003",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Dynamic Analysis Evasion",
                                 "method":  "Delayed Execution",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delay execution"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.010",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create UDP Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create UDP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.020",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Argument Obfuscation",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.017",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Stack Strings",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.011",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create TCP Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create TCP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0038",
                                 "objective":  "Process",
                                 "behavior":  "Create Thread",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create thread"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0039",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Thread",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate thread"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0001.019",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Debugger Detection",
                                 "method":  "Process Environment Block",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "PEB access"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0016",
                                 "objective":  "File System",
                                 "behavior":  "Create File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.006",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.007",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Send Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "send data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0030.001",
                                 "objective":  "Command and Control",
                                 "behavior":  "C2 Communication",
                                 "method":  "Send Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "send data"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0030.002",
                                 "objective":  "Command and Control",
                                 "behavior":  "C2 Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0001.033",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Debugger Detection",
                                 "method":  "Timing/Delay Check QueryPerformanceCounter",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "check for time delay via QueryPerformanceCounter"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0046.002",
                                 "objective":  "Discovery",
                                 "behavior":  "Code Discovery",
                                 "method":  "Inspect Section Memory Permissions",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "inspect section memory permissions"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.001",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Set Socket Config",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "set socket configuration"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.012",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Get Socket Status",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get socket status"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.004",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Connect Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "connect TCP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.008",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "TCP Client",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "act as TCP client"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0021.003",
                                 "objective":  "Cryptography",
                                 "behavior":  "Generate Pseudo-random Sequence",
                                 "method":  "Use API",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "generate random numbers via WinAPI"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get file size"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "read file on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.009",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Initialize Winsock Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "initialize Winsock library"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0063",
                                 "objective":  "File System",
                                 "behavior":  "Move File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "move file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0002.012",
                                 "objective":  "Communication",
                                 "behavior":  "HTTP Communication",
                                 "method":  "Create Request",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create HTTP request"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0002.004",
                                 "objective":  "Communication",
                                 "behavior":  "HTTP Communication",
                                 "method":  "Open URL",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "connect to URL"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0023",
                                 "objective":  "Execution",
                                 "behavior":  "Install Additional Program",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain an embedded PE file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0025.007",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Conditional Execution",
                                 "method":  "Runs as Service",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "run as service"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0060",
                                 "objective":  "Data",
                                 "behavior":  "Compression Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "linked against ZLIB"
                                              }
                                          ]
                             }
                         ],
                 "windows_hidden":  [
                                        "ac65090d5737ab8436e2b25a246f0b30.exe -\u003e C:\\WINDOWS\\tasksche.exe /i"
                                    ],
                 "registry_keys_opened":  [
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl",
                                              "HKEY_CURRENT_USER\\Software",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_FIX_CHUNKED_PROXY_SCRIPT_DOWNLOAD_KB843289",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\5.0\\Cache",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_PERMIT_CACHE_FOR_AUTHENTICATED_FTP_KB910274",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_BYPASS_CACHE_FOR_CREDPOLICY_KB936611",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_INCLUDE_PORT_IN_SPN_KB908209",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WinHttp",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_COMPAT_USE_CONNECTION_BASED_NEGOTIATE_AUTH_KB2151543",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Internet Explorer\\Main",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\5.0\\Cache",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\EnableHttp1_1",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_USE_CNAME_FOR_SPN_KB911149",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_RETURN_FAILED_CONNECT_CONTENT_KB942615",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\5.0\\Cache",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_CLIENTAUTHCERTFILTER",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SecureProtocols",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\EnableHttp1_1",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_DIGEST_NO_EXTRAS_IN_URI",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\PeerDist\\Service",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_BUFFERBREAKING_818408",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SecureProtocols",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_ENABLE_PROXY_CACHE_REFRESH_KB2983228",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_HTTP_USERNAME_PASSWORD_DISABLE",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_DISABLE_UNICODE_HANDLE_CLOSING_CALLBACK",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_EXCLUDE_INVALID_CLIENT_CERT_KB929477",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\TabProcGrowth",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FrameTabWindow",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\RETRY_HEADERONLYPOST_ONCONNECTIONRESET",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_IGNORE_MAPPINGS_FOR_CREDPOLICY",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Internet Explorer\\Main\\FeatureControl",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_PRESERVE_SPACES_IN_FILENAMES_KB952730",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_SCH_SEND_AUX_RECORD_KB_2618444",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_MIME_HANDLING",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_USE_UTF8_FOR_BASIC_AUTH_KB967545",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_DISALLOW_NULL_IN_RESPONSE_HEADERS",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_ALWAYS_USE_DNS_FOR_SPN_KB3022771",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\WpadOverride",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyHttp1.1",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FrameMerging",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_SKIP_POST_RETRY_ON_INTERNETWRITEFILE_KB895954",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\SessionMerging",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\AdminTabProcs",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyHttp1.1",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_ENABLE_PASSPORT_SESSION_STORE_KB948608",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Internet Explorer",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\PeerDist\\Service",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_DISABLE_NOTIFY_UNVERIFIED_SPN_KB2385266"
                                          ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027.005",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "contain obfuscated stackstrings",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "contain obfuscated stackstrings"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1016",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get socket status",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get socket status"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get number of processors",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get number of processors"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get file size",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get file size"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "create service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "create service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "create service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "create service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "start service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "start service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "persist via Windows service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "persist via Windows service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "persist via Windows service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "persist via Windows service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "modify service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "modify service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "modify service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "modify service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1564.003",
                                                     "signature_description":  "Detected the creation of a hidden window (common execution hiding technique)"
                                                 },
                                                 {
                                                     "id":  "T1158",
                                                     "signature_description":  "Detected the creation of a non white-listed hidden or system file"
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "signature_description":  "The process originated ICMP traffic"
                                                 },
                                                 {
                                                     "id":  "T1050",
                                                     "signature_description":  "The process has tried to set its autorun on the system startup"
                                                 },
                                                 {
                                                     "id":  "T1112",
                                                     "signature_description":  "The process has tried to set its autorun on the system startup"
                                                 },
                                                 {
                                                     "id":  "T1060",
                                                     "signature_description":  "The process has tried to set its autorun on the system startup"
                                                 },
                                                 {
                                                     "id":  "T1059",
                                                     "signature_description":  "Apparent Internal Usage of CMD.EXE"
                                                 },
                                                 {
                                                     "id":  "T1027.009",
                                                     "signature_description":  "Drops interesting files and uses them"
                                                 },
                                                 {
                                                     "id":  "T1063",
                                                     "signature_description":  "It Tries to detect injection methods"
                                                 }
                                             ],
                 "services_started":  [
                                          "mssecsvc2.0"
                                      ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "files_deleted":  [
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1F1C.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1FE7.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2026.tmp.txt",
                                       "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2F97.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2FA8.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2FB9.tmp.txt"
                                   ],
                 "calls_highlighted":  [
                                           "GetTickCount",
                                           "GetTickCount64",
                                           "C:\\WINDOWS\\tasksche.exe /i"
                                       ],
                 "processes_terminated":  [
                                              "wmiadap.exe /F /T /R",
                                              "%SAMPLEPATH%",
                                              "C:\\Windows\\tasksche.exe",
                                              "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe",
                                              "C:\\Windows\\System32\\wuapihost.exe",
                                              "1540 - C:\\Users\\azure\\Downloads\\27224344bcbd2e4b2baef34a42d5a68ae2ae0f666bedb4b2ab701c7ba3208c64.exe -m security",
                                              "2264 - C:\\WINDOWS\\tasksche.exe /i"
                                          ],
                 "services_created":  [
                                          "mssecsvc2.0"
                                      ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "T1031,T1050",
                                                                                             "EventType":  "SetValue",
                                                                                             "EventID":  "13",
                                                                                             "Image":  "C:\\Windows\\system32\\services.exe",
                                                                                             "Details":  "C:\\Users\\YYmajCRepuyM\\AppData\\Local\\Temp\\43c2c8f55818d65118e632c9549898df.exe -m security",
                                                                                             "TargetObject":  "HKLM\\System\\CurrentControlSet\\services\\mssecsvc2.0\\ImagePath"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "high",
                                                    "rule_id":  "71686ca6fd31ecd29454e2d39e38be5c971f96ad539e461b7d1d79b85f90182a",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Service Binary in Suspicious Folder",
                                                    "rule_description":  "Detect the creation of a service with a service binary located in a suspicious directory",
                                                    "rule_author":  "Florian Roth (Nextron Systems), frack113"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "T1031,T1050",
                                                                                             "Details":  "C:\\Users\\YYmajCRepuyM\\AppData\\Local\\Temp\\43c2c8f55818d65118e632c9549898df.exe -m security",
                                                                                             "EventID":  "13",
                                                                                             "Image":  "C:\\Windows\\system32\\services.exe",
                                                                                             "EventType":  "SetValue",
                                                                                             "TargetObject":  "HKLM\\System\\CurrentControlSet\\services\\mssecsvc2.0\\ImagePath"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "a55e06a3fb02c5ab9e6338bc2b61d50ebaa7e4236c27862400b7633243f477be",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Service Binary in Uncommon Folder",
                                                    "rule_description":  "Detect the creation of a service with a service binary located in a uncommon directory",
                                                    "rule_author":  "Florian Roth (Nextron Systems)"
                                                }
                                            ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "calculate modulo 256 via x86 assembly",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delay execution",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@ramen0x3f"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create UDP socket",
                                               "description":  "communication/socket/udp/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create UDP socket\n    namespace: communication/socket/udp/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create UDP Socket [C0001.010]\n    examples:\n      - 203BD48BCC18434314AD60F4C8BC21E3D3422EB0624B22B827410F9BC63B4082:0x401240\n  features:\n    - or:\n      - and:\n        - count(number(2 = AF_INET/SOCK_DGRAM)): 2 or more\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n          - api: System.Net.Sockets.Socket::ctor\n      - api: System.Net.Sockets.UdpClient::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain obfuscated stackstrings",
                                               "description":  "anti-analysis/obfuscation/string/stackstring",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create TCP socket",
                                               "description":  "communication/socket/tcp",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - and:\n        - number: 6 = IPPROTO_TCP\n        - number: 1 = SOCK_STREAM\n        - number: 2 = AF_INET\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n          - api: System.Net.Sockets.Socket::ctor\n      - property/read: System.Net.Sockets.TcpClient::Client\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create thread",
                                               "description":  "host-interaction/thread/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate thread",
                                               "description":  "host-interaction/thread/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate thread\n    namespace: host-interaction/thread/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Terminate Thread [C0039]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003286\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x407E90\n  features:\n    - or:\n      - api: kernel32.TerminateThread\n      - api: PsTerminateSystemThread\n      - api: System.Threading.Thread.Abort\n      - api: pthread_terminate\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "PEB access",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data on socket",
                                               "description":  "communication/socket/receive",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recv\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n      - api: recvmsg\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "send data on socket",
                                               "description":  "communication/socket/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.send\n      - api: ws2_32.sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: send\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "send data",
                                               "description":  "communication : all known techniques for sending data to a potential C2 server",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: send data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n    description: all known techniques for sending data to a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Send Data [B0030.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n          - match: send data to Internet\n      - and:\n        - os: linux\n        - or: # Require network bound socket.\n          - match: create TCP socket\n          - match: create UDP socket\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data",
                                               "description":  "communication : all known techniques for receiving data from a potential C2 server",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check for time delay via QueryPerformanceCounter",
                                               "description":  "anti-analysis/anti-debugging/debugger-detection",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check for time delay via QueryPerformanceCounter\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4011e0\n  features:\n    - and:\n      - count(api(kernel32.QueryPerformanceCounter)): 2 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "inspect section memory permissions",
                                               "description":  "load-code/pe : translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants",
                                               "authors":  [
                                                               "@Ana06"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: inspect section memory permissions\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    description: \"translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants\"\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Discovery::Code Discovery::Inspect Section Memory Permissions [B0046.002]\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401480\n  features:\n    - and:\n      - os: windows\n      - 3 or more:\n        - and:\n          - number: 0x40000000 = IMAGE_SCN_MEM_READ\n          - number: 0x2 = PAGE_READONLY\n        - and:\n          - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x10 = PAGE_EXECUTE\n        - and:\n          - or:\n            - number: 0x60000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x20 = PAGE_EXECUTE_READ\n        - and:\n          - or:\n            - number: 0xC0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n          - number: 0x4 = PAGE_READWRITE\n        - and:\n          - or:\n            - number: 0xE0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n      - optional:\n        - number: 0x1 = PAGE_NOACCESS\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set socket configuration",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set socket configuration\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Set Socket Config [C0001.001]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.setsockopt\n      - api: ws2_32.ioctlsocket\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get socket status",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get socket status\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    mbc:\n      - Communication::Socket Communication::Get Socket Status [C0001.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - and:\n      - api: ws2_32.select\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "connect TCP socket",
                                               "description":  "communication/socket/tcp",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: connect TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::Socket Communication::Connect Socket [C0001.004]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - match: create TCP socket\n      - or:\n        - api: connect\n        - api: ws2_32.connect\n        - api: ws2_32.WSAConnect\n        - api: ConnectEx\n        - or:\n          - and:\n            # static\n            - basic block:\n              # candidate for GUID: WSAID_CONNECTEX/25a207b9-ddf3-4660-8ee9-76e58c74063e\n              - and:\n                - number: 0x25A207B9\n                - number: 0x4660DDF3\n                - number: 0xE576E98E\n                - number: 0x3E06748C\n            - basic block:\n              - and:\n                - api: WSAIoctl\n                - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n            - basic block:\n              - and:\n                - api: setsockopt\n                - number: 0xFFFF = SOL_SOCKET\n                - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n            # socket must be bound to ConnectEx\n            # https://gist.github.com/joeyadams/4158972\n            - api: bind\n          - and:\n            # dynamic\n            - call:\n              - and:\n                - api: WSAIoctl\n                - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n            - call:\n              - and:\n                - api: setsockopt\n                - number: 0xFFFF = SOL_SOCKET\n                - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n            # socket must be bound to ConnectEx\n            # https://gist.github.com/joeyadams/4158972\n            - api: bind\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "act as TCP client",
                                               "description":  "communication/tcp/client",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: act as TCP client\n    namespace: communication/tcp/client\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::Socket Communication::TCP Client [C0001.008]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - match: connect TCP socket\n      - api: System.Net.Sockets.TcpClient::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "generate random numbers via WinAPI",
                                               "description":  "data-manipulation/prng",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "johnk3r"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: generate random numbers via WinAPI\n    namespace: data-manipulation/prng\n    authors:\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Cryptography::Generate Pseudo-random Sequence::Use API [C0021.003]\n    examples:\n      - ba947eb07d8c823949316a97364d060f:0x1400031E0\n      - 3ca359f5085bb96a7950d4735b089ffe:0x403A80\n      - e59ffeaf7acb0c326e452fa30bb71a36:0x40403E\n      - 1195d0d18be9362fb8dd9e1738404c9d:0x404E90\n  features:\n    - and:\n      - or:\n        - api: BCryptGenRandom\n        - api: CryptGenRandom\n      - optional:\n        - api: BCryptOpenAlgorithmProvider\n        - api: BCryptCloseAlgorithmProvider\n        - api: CryptAquireContext\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get number of processors",
                                               "description":  "host-interaction/hardware/cpu",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get number of processors\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires property features\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361\n    examples:\n      - al-khaser_x86.exe_:0x432CB0\n  features:\n    - or:\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x64 = PEB-\u003eNumberOfProcessors\n          - and:\n            - arch: amd64\n            - number: 0xB8 = PEB-\u003eNumberOfProcessors\n      - property/read: System.Environment::ProcessorCount\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file size",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Windows",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "initialize Winsock library",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - and:\n      - api: ws2_32.WSAStartup\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get service handle",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create service",
                                               "description":  "host-interaction/service/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create service\n    namespace: host-interaction/service/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - and:\n      - api: advapi32.CreateService\n      - optional:\n        - api: advapi32.OpenSCManager\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "start service",
                                               "description":  "host-interaction/service/start",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: start service\n    namespace: host-interaction/service/start\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x401FA0\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - api: advapi32.StartService\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "persist via Windows service",
                                               "description":  "persistence/service",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: persist via Windows service\n    namespace: persistence/service\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - 9f012d7e3ae8f62370278e372691eb73b878fe2280b6083e1be637b278021855:0x40113A\n  features:\n    - or:\n      - and:\n        - or:\n          - basic block:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n          - call:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n        - optional:\n          - or:\n            - api: advapi32.OpenService\n            - api: advapi32.StartService\n      - and:\n        - match: host-interaction/process/create\n        - or:\n          - and:\n            - string: /^sc(|\\.exe)$/i\n            - string: /create /i\n          - string: /^sc(|\\.exe) create/i\n          - string: /New-Service /i\n      - and:\n        - match: \"set registry value\"\n        - string: /System\\\\(CurrentControlSet|ControlSet001)\\\\Services/i\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "move file",
                                               "description":  "host-interaction/file-system/move",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 1 = FO_MOVE\n          - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "extract resource via kernel32 functions",
                                               "description":  "executable/resource",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "modify service",
                                               "description":  "host-interaction/service/modify",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: modify service\n    namespace: host-interaction/service/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - 7D16EFD0078F22C17A4BD78B0F0CC468:0x401000\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - or:\n        - api: advapi32.ChangeServiceConfig\n        - api: advapi32.ChangeServiceConfig2\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create HTTP request",
                                               "description":  "communication/http/client",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create HTTP request\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::HTTP Communication::Create Request [C0002.012]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - or:\n        - api: wininet.InternetOpen\n        - api: System.Net.WebRequest::Create\n        - api: System.Net.WebRequest::CreateDefault\n        - api: System.Net.WebRequest::CreateHttp\n      - optional:\n        - api: wininet.InternetCloseHandle\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "connect to URL",
                                               "description":  "communication/http/client",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: connect to URL\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::HTTP Communication::Open URL [C0002.004]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - optional:\n        - match: create HTTP request\n      - api: wininet.InternetOpenUrl\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain an embedded PE file",
                                               "description":  "executable/subfile/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "run as service",
                                               "description":  "host-interaction/service",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: run as service\n    namespace: host-interaction/service\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Anti-Behavioral Analysis::Conditional Execution::Runs as Service [B0025.007]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_\n  features:\n    - or:\n      - export: ServiceMain\n      - function:\n        - or:\n          - api: RegisterServiceCtrlHandler\n          - api: RegisterServiceCtrlHandlerEx\n          - api: StartServiceCtrlDispatcher\n          - api: System.ServiceProcess.ServiceBase::Run\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against ZLIB",
                                               "description":  "linking/static/zlib",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against ZLIB\n    namespace: linking/static/zlib\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Data::Compression Library [C0060]\n    examples:\n      - 6cc148363200798a12091b97a17181a1\n  features:\n    - or:\n      - string: /deflate .* Copyright/\n      - string: /inflate .* Copyright/\n"
                                           }
                                       ],
                 "files_opened":  [
                                      "C:\\Windows\\system32\\Secur32.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files",
                                      "C:\\Windows\\system32\\api-ms-win-downlevel-advapi32-l2-1-0.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files\\counters.dat",
                                      "C:\\Windows\\system32\\winhttp.dll",
                                      "C:\\Windows\\system32\\webio.dll",
                                      "C:\\Windows\\system32\\mswsock.dll",
                                      "C:\\Windows\\System32\\wship6.dll",
                                      "\\Device\\Afd\\Endpoint",
                                      "C:\\Windows\\tasksche.exe"
                                  ],
                 "memory_pattern_domains":  [
                                                "cwwnhwhlz52maqm7.onion",
                                                "gx7ekbenv2riucmf.onion",
                                                "57g7spgrzlojinas.onion",
                                                "xxlvbrloxvriy2c5.onion",
                                                "76jdd2ir2embyv47.onion"
                                            ],
                 "modules_loaded":  [
                                        "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-03-30_01c4f6da599c61262916e58c6769da58_wannacry.exe",
                                        "Secur32.dll",
                                        "SHELL32.dll",
                                        "ADVAPI32.dll",
                                        "api-ms-win-downlevel-advapi32-l2-1-0.dll",
                                        "api-ms-win-downlevel-ole32-l1-1-0.dll",
                                        "WS2_32.dll",
                                        "winhttp.dll",
                                        "wship6",
                                        "IPHLPAPI",
                                        "api-ms-win-downlevel-ole32-l1-1-0",
                                        "api-ms-win-downlevel-advapi32-l2-1-0",
                                        "ole32",
                                        "SHELL32",
                                        "SspiCli",
                                        "WS2_32",
                                        "comctl32",
                                        "ADVAPI32",
                                        "kernel32",
                                        "apphelp",
                                        "mswsock",
                                        "winhttp",
                                        "profapi",
                                        "rpcrt4",
                                        "Secur32"
                                    ],
                 "verdict_labels":  [
                                        "WannaCry",
                                        "SMBScan"
                                    ],
                 "files_dropped":  [
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\INetCache"
                                       },
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\INetCache\\counters2.dat"
                                       },
                                       {
                                           "path":  "C:\\Windows\\tasksche.exe"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1F1C.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1F1C.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1FE7.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1FE7.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2026.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2026.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2F97.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2F97.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2FA8.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2FA8.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2FB9.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2FB9.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\Windows\\tasksche.exe",
                                           "sha256":  "356c86a9ae6c7273603bcbe7a60df8cdb386024419b1fd3660ea8cb3ea29a892",
                                           "type":  "PE_EXE"
                                       }
                                   ],
                 "attack_techniques":  {
                                           "T1027.005":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "contain obfuscated stackstrings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "contain obfuscated stackstrings"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1016":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get socket status",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get socket status"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get number of processors",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get number of processors"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get file size",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get file size"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1543.003":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "create service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "create service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "start service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "start service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "persist via Windows service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "persist via Windows service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "modify service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "modify service"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1569.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "create service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "create service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "persist via Windows service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "persist via Windows service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "modify service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "modify service"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1564.003":  [
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "Detected the creation of a hidden window (common execution hiding technique)"
                                                             }
                                                         ],
                                           "T1158":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Detected the creation of a non white-listed hidden or system file"
                                                         }
                                                     ],
                                           "T1095":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process originated ICMP traffic"
                                                         }
                                                     ],
                                           "T1050":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process has tried to set its autorun on the system startup"
                                                         }
                                                     ],
                                           "T1112":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process has tried to set its autorun on the system startup"
                                                         }
                                                     ],
                                           "T1060":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process has tried to set its autorun on the system startup"
                                                         }
                                                     ],
                                           "T1059":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Apparent Internal Usage of CMD.EXE"
                                                         }
                                                     ],
                                           "T1027.009":  [
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "Drops interesting files and uses them"
                                                             }
                                                         ],
                                           "T1063":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "It Tries to detect injection methods"
                                                         }
                                                     ]
                                       }
             }
}
