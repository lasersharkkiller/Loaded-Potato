{
    "data":  {
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "INDICATOR-COMPROMISE IRC nick change on non-standard port",
                                        "rule_category":  "trojan-activity",
                                        "rule_id":  "1:38933",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "94.140.120.193",
                                                              "dest_port":  8080
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e $EXTERNAL_NET !6666:7000 ( msg:\"INDICATOR-COMPROMISE IRC nick change on non-standard port\"; flow:to_server,established; isdataat:!99; content:\"NICK \",depth 5; metadata:policy max-detect-ips drop; service:irc; classtype:trojan-activity; sid:38933; rev:3; )"
                                    },
                                    {
                                        "rule_msg":  "INDICATOR-COMPROMISE IRC channel join on non-standard port",
                                        "rule_category":  "trojan-activity",
                                        "rule_id":  "1:20092",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "94.140.120.193",
                                                              "dest_port":  8080
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e $EXTERNAL_NET !6666:7000 ( msg:\"INDICATOR-COMPROMISE IRC channel join on non-standard port\"; flow:to_server,established; isdataat:!139; content:\"JOIN #\",depth 6; metadata:policy max-detect-ips drop; service:irc; classtype:trojan-activity; sid:20092; rev:10; )"
                                    },
                                    {
                                        "rule_msg":  "ET POLICY IRC Channel JOIN on non-standard port",
                                        "rule_category":  "A client was using an unusual port",
                                        "rule_id":  "1:2000348",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "94.140.120.193",
                                                              "dest_port":  8080
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://www.rfc-editor.org/rfc/rfc1459#section-4.2.1"
                                                            ],
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e $EXTERNAL_NET ![25,587,6666:7000,8076] (msg:\"ET POLICY IRC Channel JOIN on non-standard port\"; flow:established,to_server; dsize:\u003c64; content:\"JOIN \"; nocase; depth:5; pcre:\"/\u0026|#|\\+|!/R\"; reference:url,www.rfc-editor.org/rfc/rfc1459#section-4.2.1; classtype:unusual-client-port-connection; sid:2000348; rev:18; metadata:attack_target Client_and_Server, created_at 2010_07_30, deployment Perimeter, performance_impact Moderate, confidence Medium, signature_severity Informational, updated_at 2023_05_09, reviewed_at 2024_09_16; target:src_ip;)"
                                    },
                                    {
                                        "rule_msg":  "ET MALWARE ELF/Muhstik Botnet CnC Activity",
                                        "rule_category":  "Malware Command and Control Activity Detected",
                                        "rule_id":  "1:2034743",
                                        "alert_severity":  "high",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "94.140.120.193",
                                                              "dest_port":  8080
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://www.virustotal.com/gui/search/81fbe69a36650504b88756074a36c183",
                                                                "https://www.virustotal.com/gui/search/d20478a01344026a0ecd60b0b29e9bc1",
                                                                "https://blog.netlab.360.com/threat-alert-log4j-vulnerability-has-been-adopted-by-two-linux-botnets/"
                                                            ],
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e $EXTERNAL_NET 1024: (msg:\"ET MALWARE ELF/Muhstik Botnet CnC Activity\"; flow:established,to_server; content:\"NICK|20|\"; content:\"USER|20|\"; content:\"|3a|muhstik-\"; fast_pattern; pcre:\"/^[0-9]{8}$/Rm\"; reference:md5,81fbe69a36650504b88756074a36c183; reference:md5,d20478a01344026a0ecd60b0b29e9bc1; reference:url,blog.netlab.360.com/threat-alert-log4j-vulnerability-has-been-adopted-by-two-linux-botnets/; classtype:command-and-control; sid:2034743; rev:1; metadata:affected_product Linux, attack_target Client_Endpoint, created_at 2021_12_15, deployment Perimeter, malware_family Muhstik, confidence High, signature_severity Major, tag Description_Generated_By_Proofpoint_Nexus, updated_at 2021_12_15;)"
                                    }
                                ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "v.deutschland-zahlung.eu",
                                         "resolved_ips":  [
                                                              "94.140.120.193"
                                                          ]
                                     }
                                 ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "104",
                                            "name":  "lkt4mbq4ntkf",
                                            "children":  [
                                                             {
                                                                 "process_id":  "106",
                                                                 "name":  "sh",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "109",
                                                                                      "name":  "crontab"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "111",
                                                                                      "name":  "grep"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "112",
                                                                                      "name":  "grep"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "114",
                                                                                      "name":  "sh",
                                                                                      "children":  [
                                                                                                       {
                                                                                                           "process_id":  "116",
                                                                                                           "name":  "crontab"
                                                                                                       }
                                                                                                   ]
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "115",
                                                                                      "name":  "crontab"
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        }
                                    ],
                 "command_executions":  [
                                            "/bin/sh, [sh, -c, cat /etc/inittab2 \u003e /etc/inittab]",
                                            "/bin/sh, [sh, -c, echo \\0:2345:respawn:/dev/shm/analyzed_bin\\ \u003e\u003e /etc/inittab2]",
                                            "/bin/pidof, [pidof, -x, tcpdump]",
                                            "/bin/cp, [cp, -f, /root/analyzed_bin, /var/tmp/analyzed_bin]",
                                            "/bin/sh, [sh, -c, cat /etc/inittab | grep -v \\/var/tmp/analyzed_bin\\ \u003e /etc/inittab2]",
                                            "/bin/uname, [/bin/uname, -n]",
                                            "/bin/cp, [cp, -f, /root/analyzed_bin, /var/lock/analyzed_bin]",
                                            "/bin/cat, [cat, /etc/inittab2]",
                                            "/bin/sh, [sh, -c, echo \\0:2345:respawn:/var/lock/analyzed_bin\\ \u003e\u003e /etc/inittab2]",
                                            "/bin/sh, [sh, -c, cat /etc/inittab | grep -v \\/root/analyzed_bin\\ \u003e /etc/inittab2]",
                                            "/bin/sh, [sh, -c, echo \\0:2345:respawn:/root/analyzed_bin\\ \u003e\u003e /etc/inittab2]",
                                            "/usr/bin/crontab, [crontab, -]",
                                            "/bin/sh, [sh, -c, echo \\0:2345:respawn:/var/tmp/analyzed_bin\\ \u003e\u003e /etc/inittab2]",
                                            "/bin/sh, [sh, -c, pidof -x strace \u003e /dev/null]",
                                            "/bin/sh, [sh, -c, cp -f /root/analyzed_bin /var/tmp/analyzed_bin]",
                                            "/bin/sh, [sh, -c, crontab -l | grep /var/lock/analyzed_bin | grep -v \\no cron\\ || (crontab -l ; echo \\* * * * * /var/lock/analyzed_bin \u003e /dev/null 2\u003e\u00261 \u0026\\) | crontab -]",
                                            "/bin/sh, [sh, -c, crontab -l | grep /dev/shm/analyzed_bin | grep -v \\no cron\\ || (crontab -l ; echo \\* * * * * /dev/shm/analyzed_bin \u003e /dev/null 2\u003e\u00261 \u0026\\) | crontab -]",
                                            "/bin/grep, [grep, -v, /var/lock/analyzed_bin]",
                                            "/bin/sh, [sh, -c, rm -rf /etc/inittab2]",
                                            "/bin/sh, [sh, -c, cp -f /root/analyzed_bin /var/run/analyzed_bin]",
                                            "/bin/sh, [sh, -c, crontab -l | grep /root/analyzed_bin | grep -v \\no cron\\ || (crontab -l ; echo \\* * * * * /root/analyzed_bin \u003e /dev/null 2\u003e\u00261 \u0026\\) | crontab -]",
                                            "/bin/grep, [grep, /dev/shm/analyzed_bin]",
                                            "/bin/cp, [cp, -f, /root/analyzed_bin, /var/run/analyzed_bin]",
                                            "/bin/sh, [sh, -c, echo \\0:2345:respawn:/var/run/analyzed_bin\\ \u003e\u003e /etc/inittab2]",
                                            "/bin/pidof, [pidof, -x, strace]",
                                            "/bin/sh, [sh, -c, cat /etc/inittab | grep -v \\/var/lock/analyzed_bin\\ \u003e /etc/inittab2]",
                                            "/bin/sh, [sh, -c, pidof -x tcpdump \u003e /dev/null]",
                                            "/bin/sh, [sh, -c, touch -acmr /bin/ls /etc/inittab]",
                                            "/bin/rm, [rm, -rf, /etc/inittab2]",
                                            "/usr/bin/crontab, [crontab, -l]",
                                            "/bin/grep, [grep, /var/lock/analyzed_bin]",
                                            "/bin/sh, [sh, -c, crontab -l | grep /var/run/analyzed_bin | grep -v \\no cron\\ || (crontab -l ; echo \\* * * * * /var/run/analyzed_bin \u003e /dev/null 2\u003e\u00261 \u0026\\) | crontab -]",
                                            "/bin/grep, [grep, -v, /var/tmp/analyzed_bin]",
                                            "/bin/grep, [grep, -v, /var/run/analyzed_bin]",
                                            "/bin/cat, [cat, /etc/inittab]",
                                            "/bin/cp, [cp, -f, /root/analyzed_bin, /dev/shm/analyzed_bin]",
                                            "/bin/sh, [sh, -c, cp -f /root/analyzed_bin /var/lock/analyzed_bin]",
                                            "/bin/grep, [grep, -v, no cron]",
                                            "/bin/grep, [grep, /root/analyzed_bin]",
                                            "/bin/grep, [grep, -v, /dev/shm/analyzed_bin]",
                                            "/bin/grep, [grep, /var/run/analyzed_bin]",
                                            "/bin/sh, [sh, -c, crontab -r]",
                                            "/bin/grep, [grep, /var/tmp/analyzed_bin]",
                                            "/bin/sh, [sh, -c, cat /etc/inittab | grep -v \\/var/run/analyzed_bin\\ \u003e /etc/inittab2]",
                                            "/bin/grep, [grep, -v, /root/analyzed_bin]",
                                            "/bin/sh, [sh, -c, /bin/uname -n]",
                                            "/usr/bin/crontab, [crontab, -r]",
                                            "/bin/sh, [sh, -c, cat /etc/inittab | grep -v \\/dev/shm/analyzed_bin\\ \u003e /etc/inittab2]",
                                            "/bin/touch, [touch, -acmr, /bin/ls, /etc/inittab]",
                                            "/bin/sh, [sh, -c, cp -f /root/analyzed_bin /dev/shm/analyzed_bin]",
                                            "/bin/sh, [sh, -c, crontab -l | grep /var/tmp/analyzed_bin | grep -v \\no cron\\ || (crontab -l ; echo \\* * * * * /var/tmp/analyzed_bin \u003e /dev/null 2\u003e\u00261 \u0026\\) | crontab -]"
                                        ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "10.0.2.3",
                                        "destination_port":  53
                                    },
                                    {
                                        "destination_ip":  "94.140.120.193",
                                        "destination_port":  8080
                                    }
                                ],
                 "files_written":  [
                                       "/tmp/.bawtz",
                                       "/etc/inittab2",
                                       "/var/lock/analyzed_bin",
                                       "/var/run/analyzed_bin",
                                       "/dev/null",
                                       "/var/tmp/analyzed_bin",
                                       "/etc/inittab",
                                       "/dev/shm/analyzed_bin"
                                   ],
                 "sigma_analysis_results":  [
                                                {
                                                    "rule_level":  "medium",
                                                    "rule_id":  "0cbddc72cfb3b9426508057fbe3e7b0ed88990983f04ad15f9685e585ce7ae66",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Communication To Uncommon Destination Ports",
                                                    "rule_description":  "Detects programs that connect to uncommon destination ports",
                                                    "rule_author":  "Florian Roth (Nextron Systems)",
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "DestinationHostname":  "v.deutschland-zahlung.eu",
                                                                                             "DestinationPort":  "8080",
                                                                                             "Initiated":  "true",
                                                                                             "DestinationIp":  "94.140.120.193"
                                                                                         }
                                                                          }
                                                                      ]
                                                }
                                            ],
                 "files_deleted":  [
                                       "/etc/inittab2",
                                       "/var/lock/analyzed_bin",
                                       "0x7fcfeeb8",
                                       "0x7fb1aa98",
                                       "0x7f8cdd98",
                                       "0x7fb56558",
                                       "0x7fccc0a8"
                                   ],
                 "tags":  [
                              "OBFUSCATED",
                              "SELF_DELETE",
                              "EXECUTES_DROPPED_FILE"
                          ],
                 "files_opened":  [
                                      "/etc/hosts",
                                      "/lib/libc.so.6",
                                      "/etc/resolv.conf",
                                      "/lib/mips/libresolv.so.2",
                                      "/etc/rc.local",
                                      "/usr/bin/crontab",
                                      "/etc/nsswitch.conf",
                                      "/lib/libresolv.so.2",
                                      "/etc/ISP_name",
                                      "/etc/ld.so.cache",
                                      "/lib/tls/mips/libresolv.so.2",
                                      "/etc/Model_name",
                                      "/etc/inittab",
                                      "/lib/libnss_files.so.2",
                                      "/usr/sbin/nvram",
                                      "/etc/passwd",
                                      "/bin/crontab",
                                      "/bin/uname",
                                      "/etc/inittab2",
                                      "/root/analyzed_bin",
                                      "/etc/rc.conf",
                                      "/bin/nvram",
                                      "/lib/tls/libresolv.so.2"
                                  ]
             }
}
