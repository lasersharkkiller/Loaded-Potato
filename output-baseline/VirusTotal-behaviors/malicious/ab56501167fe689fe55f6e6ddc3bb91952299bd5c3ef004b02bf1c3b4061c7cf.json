{
    "data":  {
                 "processes_tree":  [
                                        {
                                            "process_id":  "2504",
                                            "name":  "%SANDBOX_DLL_LOADER_AMD64% %SAMPLEPATH% %WORKDIR% 483"
                                        },
                                        {
                                            "process_id":  "2700",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "5532",
                                            "name":  "\"C:\\Windows\\sysnative\\rundll32.exe\" \"C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll\",#1"
                                        },
                                        {
                                            "process_id":  "2996",
                                            "name":  "13f43b565119f43f7155f96cafa8b05d.exe",
                                            "time_offset":  6822,
                                            "children":  [
                                                             {
                                                                 "process_id":  "3024",
                                                                 "name":  "13f43b565119f43f7155f96cafa8b05d.exe",
                                                                 "time_offset":  6823
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "7560",
                                            "name":  "C:\\Windows\\System32\\loaddll64.exe loaddll64.exe \"C:\\Users\\user\\Desktop\\attachment.dll\"",
                                            "children":  [
                                                             {
                                                                 "process_id":  "7568",
                                                                 "name":  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                                                 "files_opened":  [
                                                                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                                                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                                                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                                                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
                                                                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
                                                                                      "C:\\Windows\\system32\\conhost.exe",
                                                                                      "C:\\Windows\\system32\\dwmapi.dll",
                                                                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                                                                      "C:\\Windows\\system32\\uxtheme.dll",
                                                                                      "C:\\Windows\\system32\\uxtheme.dll.Config"
                                                                                  ]
                                                             },
                                                             {
                                                                 "process_id":  "7608",
                                                                 "name":  "C:\\Windows\\System32\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\",#1",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "7620",
                                                                                      "name":  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\attachment.dll\",#1",
                                                                                      "files_opened":  [
                                                                                                           "C:\\Users\\user\\Desktop\\attachment.dll.123.Manifest",
                                                                                                           "C:\\Users\\user\\Desktop\\attachment.dll.124.Manifest",
                                                                                                           "C:\\Users\\user\\Desktop\\attachment.dll.2.Manifest",
                                                                                                           "C:\\Windows\\SYSTEM32\\ntmarta.dll",
                                                                                                           "C:\\Windows\\SYSTEM32\\wintypes.dll",
                                                                                                           "C:\\Windows\\System32\\CoreMessaging.dll",
                                                                                                           "C:\\Windows\\System32\\CoreUIComponents.dll",
                                                                                                           "C:\\Windows\\System32\\TextInputFramework.dll",
                                                                                                           "C:\\Windows\\System32\\en-US\\USER32.dll.mui",
                                                                                                           "C:\\Windows\\system32\\en-US\\rundll32.exe.mui",
                                                                                                           "C:\\Windows\\system32\\rpcss.dll",
                                                                                                           "C:\\Windows\\system32\\rundll32.exe"
                                                                                                       ]
                                                                                  }
                                                                              ],
                                                                 "files_opened":  [
                                                                                      "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                                                                                      "C:\\Windows\\system32\\"
                                                                                  ],
                                                                 "files_written":  [
                                                                                       "\\Device\\ConDrv\\\\Connect"
                                                                                   ]
                                                             }
                                                         ],
                                            "files_opened":  [
                                                                 "C:\\Users\\user\\Desktop\\attachment.dll",
                                                                 "C:\\Users\\user\\Desktop\\wksprtAS.dll",
                                                                 "C:\\Windows\\AppPatch\\sysmain.sdb",
                                                                 "C:\\Windows\\SYSTEM32\\apphelp.dll",
                                                                 "C:\\Windows\\SYSTEM32\\ntdll.dll",
                                                                 "C:\\Windows\\System32\\KERNEL32.DLL",
                                                                 "C:\\Windows\\System32\\KERNELBASE.dll",
                                                                 "C:\\Windows\\system32\\HID.DLL",
                                                                 "C:\\Windows\\system32\\IMM32.DLL",
                                                                 "C:\\Windows\\system32\\bcrypt.DLL",
                                                                 "C:\\Windows\\system32\\loaddll64.exe",
                                                                 "C:\\Windows\\system32\\pid.dll",
                                                                 "\\Device\\ConDrv\\Server",
                                                                 "\\Device\\ConDrv\\\\Reference",
                                                                 "\\Device\\KsecDD"
                                                             ],
                                            "files_written":  [
                                                                  "\\Device\\ConDrv\\\\Connect"
                                                              ]
                                        }
                                    ],
                 "mbc":  [
                             {
                                 "id":  "C0008",
                                 "objective":  "Memory",
                                 "behavior":  "Change Memory Protection",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "change memory protection"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate or change RWX memory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate or change RW memory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0016",
                                 "objective":  "File System",
                                 "behavior":  "Create File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using XOR"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using XOR"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate memory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0003.003",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Dynamic Analysis Evasion",
                                 "method":  "Delayed Execution",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delay execution"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0042",
                                 "objective":  "Process",
                                 "behavior":  "Create Mutex",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create mutex"
                                              }
                                          ]
                             },
                             {
                                 "id":  "F0004",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Disable or Evade Security Tools",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "patch Event Tracing for Windows function"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "execute shellcode via indirect call"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0043",
                                 "objective":  "Process",
                                 "behavior":  "Check Mutex",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "check mutex and exit"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "check mutex and exit"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "read file on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1082",
                                 "objective":  "Discovery",
                                 "behavior":  "System Information Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "query environment variable"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0052",
                                 "objective":  "File System",
                                 "behavior":  "Writes File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "write file on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1082",
                                 "objective":  "Discovery",
                                 "behavior":  "System Information Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get hostname"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "enumerate files on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1055.m04",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Process Injection",
                                 "method":  "Patch Process Command Line",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "patch process command line"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0002"
                             },
                             {
                                 "id":  "C0005.001"
                             }
                         ],
                 "files_written":  [
                                       "\\Device\\ConDrv\\\\Connect"
                                   ],
                 "tags":  [
                              "DETECT_DEBUG_ENVIRONMENT",
                              "LONG_SLEEPS",
                              "IDLE"
                          ],
                 "files_opened":  [
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.manifest",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.123.Manifest",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.124.Manifest",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.2.Manifest",
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\ac4dfae6461bc5c233ee66224a20f865.exe.dll",
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\ac4dfae6461bc5c233ee66224a20f865.exe.dll.manifest",
                                      "C:\\Windows\\system32",
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\wksprtAS.dll",
                                      "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                                      "C:\\Users\\user\\Desktop\\attachment.dll",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.2.Manifest",
                                      "C:\\Users\\user\\Desktop\\wksprtAS.dll",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\SYSTEM32\\apphelp.dll",
                                      "C:\\Windows\\SYSTEM32\\ntdll.dll",
                                      "C:\\Windows\\SYSTEM32\\ntmarta.dll",
                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                      "C:\\Windows\\SYSTEM32\\wintypes.dll",
                                      "C:\\Windows\\System32\\CoreMessaging.dll",
                                      "C:\\Windows\\System32\\CoreUIComponents.dll",
                                      "C:\\Windows\\System32\\KERNEL32.DLL",
                                      "C:\\Windows\\System32\\KERNELBASE.dll",
                                      "C:\\Windows\\System32\\TextInputFramework.dll",
                                      "C:\\Windows\\System32\\en-US\\USER32.dll.mui",
                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
                                      "C:\\Windows\\system32\\",
                                      "C:\\Windows\\system32\\HID.DLL",
                                      "C:\\Windows\\system32\\IMM32.DLL",
                                      "C:\\Windows\\system32\\bcrypt.DLL",
                                      "C:\\Windows\\system32\\conhost.exe",
                                      "C:\\Windows\\system32\\dwmapi.dll",
                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                      "C:\\Windows\\system32\\en-US\\rundll32.exe.mui",
                                      "C:\\Windows\\system32\\loaddll64.exe",
                                      "C:\\Windows\\system32\\pid.dll",
                                      "C:\\Windows\\system32\\rpcss.dll",
                                      "C:\\Windows\\system32\\rundll32.exe",
                                      "C:\\Windows\\system32\\uxtheme.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll.Config",
                                      "\\Device\\ConDrv\\Server",
                                      "\\Device\\ConDrv\\\\Reference",
                                      "\\Device\\KsecDD",
                                      "C:\\Users\\user\\Desktop\\library.dll",
                                      "C:\\Users\\user\\Desktop\\library.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll.2.Manifest"
                                  ],
                 "calls_highlighted":  [
                                           "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\ac4dfae6461bc5c233ee66224a20f865.exe.dll,DllMain"
                                       ],
                 "modules_loaded":  [
                                        "bcrypt",
                                        "CLBCatQ",
                                        "rpcrt4",
                                        "OLEAUT32",
                                        "kernel32",
                                        "CRYPTBASE",
                                        "SspiCli",
                                        "ole32",
                                        "apphelp",
                                        "pid",
                                        "ac4dfae6461bc5c233ee66224a20f865.exe",
                                        "MSCTF",
                                        "api-ms-win-core-localization-l1-2-1",
                                        "api-ms-win-core-fibers-l1-1-1",
                                        "api-ms-win-core-synch-l1-2-0",
                                        "bcryptprimitives",
                                        "ADVAPI32",
                                        "shlwapi"
                                    ],
                 "registry_keys_opened":  [
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableUmpdBufferSizeCheck",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\AppsUseLightTheme",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Input\\MaxResyncAttempts",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\OOBE\\LaunchUserOOBE",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\FontLink\\SystemLink",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\OLEAUT",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableMetaFiles",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\IsVailContainer",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Input",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Session Manager\\ResourcePolicies",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\OOBE",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Input\\ResyncResetTime",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\CTF\\Compatibility\\rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\OLE\\Tracing",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\cmd.exe",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\CTF\\DirectSwitchHotkeys",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\OLE",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Display",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\LanguagePack\\SurrogateFallback",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Error Message Instrument\\",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Ids",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\LanguagePack\\SurrogateFallback\\Segoe UI",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\LanguagePack\\DataStore_V1.0",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\loaddll64.exe",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\OEM",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\CTF\\"
                                          ],
                 "verdicts":  [
                                  "UNKNOWN_VERDICT",
                                  "MALWARE",
                                  "CLEAN"
                              ],
                 "files_dropped":  [
                                       {
                                           "path":  "/msdownload/update/v3/static/trustedr/en/authrootstl.cab",
                                           "sha256":  "b33efcb95235b98b48508e019afa4b7655e80cf071defabd8b2123fc8b29307f",
                                           "type":  "CAB",
                                           "download_url":  "ctldl.windowsupdate.comhttp://ctldl.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab?43892faba349e185"
                                       }
                                   ],
                 "mutexes_created":  [
                                         "\\Sessions\\1\\BaseNamedObjects\\{4368208F-BCAC-11D2-A919-00C04FB98638}"
                                     ],
                 "http_conversations":  [
                                            {
                                                "url":  "http://crt.sectigo.com/SectigoPublicCodeSigningCAR36.crt",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Microsoft-CryptoAPI/6.1",
                                                                        "Host":  "crt.sectigo.com"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "1566",
                                                                         "Content-Type":  "application/pkix-cert"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "http://crt.sectigo.com/SectigoPublicCodeSigningRootR46.p7c",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Microsoft-CryptoAPI/6.1",
                                                                        "Host":  "crt.sectigo.com"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "4515",
                                                                         "Content-Type":  "application/pkcs7-mime"
                                                                     },
                                                "response_status_code":  200
                                            }
                                        ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encode data using XOR"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1134",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "acquire debug privileges",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "acquire debug privileges"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link many functions at runtime",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link many functions at runtime"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1562.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "patch Event Tracing for Windows function",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "patch Event Tracing for Windows function"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query environment variable",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query environment variable"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get hostname",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get hostname"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate files on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "enumerate files on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "parse PE header",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "parse PE header"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "patch process command line",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "patch process command line"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "signature_description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "The process tried to load dynamically one or more functions."
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "signature_description":  "encode data using XOR"
                                                 },
                                                 {
                                                     "id":  "T1134",
                                                     "signature_description":  "acquire debug privileges"
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "link function at runtime on Windows"
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "link many functions at runtime"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "signature_description":  "query environment variable"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "signature_description":  "get hostname"
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "parse PE header"
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "signature_description":  "enumerate files on Windows"
                                                 },
                                                 {
                                                     "id":  "T1562.006",
                                                     "signature_description":  "patch Event Tracing for Windows function"
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "signature_description":  "patch process command line"
                                                 },
                                                 {
                                                     "id":  "T1063",
                                                     "signature_description":  "It Tries to detect injection methods"
                                                 },
                                                 {
                                                     "id":  "T1574.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to load missing DLLs",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "187"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1218.011",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Runs a DLL by calling functions",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "219"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Contains medium sleeps (\u003e= 30s)",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "1884"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "May sleep (evasive loops) to hinder dynamic analysis",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "307"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "509"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "verdict_confidence":  97,
                 "memory_dumps":  [
                                      {
                                          "file_name":  "00000000.00000002.1003439214.0000024A6DD20000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2518693314560",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013596494.0000015CB8190000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "1497737265152",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013540415.0000015CB7EFF000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "16384",
                                          "base_address":  "1497734574080",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013476485.0000004EE407E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "338833170432",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013534653.0000015CB7E70000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "1497733988352",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003474695.0000024A6DE60000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2518694625280",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1003197854.0000015CB7F22000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "90112",
                                          "base_address":  "1497734717440",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1013387134.0000015CB7F22000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "114688",
                                          "base_address":  "1497734717440",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013596494.0000015CB8194000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "24576",
                                          "base_address":  "1497737281536",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1013396429.0000015CB7F0F000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "1497734639616",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003367714.000000F1BB53B000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "20480",
                                          "base_address":  "1038229942272",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1013428816.0000015CB7F2C000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "73728",
                                          "base_address":  "1497734758400",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003538047.0000024A6DF50000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "53248",
                                          "base_address":  "2518695608320",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1013421532.0000015CB7F03000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "49152",
                                          "base_address":  "1497734590464",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003503916.0000024A6DEB0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "8192",
                                          "base_address":  "2518694952960",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003430190.000000F1BBAFF000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "1038235987968",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013520206.0000015CB7D10000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "1497732546560",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013463856.0000004EE3D8B000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "20480",
                                          "base_address":  "338830077952",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003503916.0000024A6DEB4000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2518694969344",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003538047.0000024A6DF5E000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "102400",
                                          "base_address":  "2518695665664",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013505210.0000004EE417E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "338834219008",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1013396429.0000015CB7F12000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "65536",
                                          "base_address":  "1497734651904",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013540415.0000015CB7EF0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "28672",
                                          "base_address":  "1497734512640",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013485509.0000004EE40FE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "338833694720",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013658004.0000015CBB2E0000.00000004.00000800.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "1497788973056",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013540415.0000015CB7EFA000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "16384",
                                          "base_address":  "1497734553600",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003403047.000000F1BB9FF000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "1038234939392",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013596494.0000015CB819C000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "12288",
                                          "base_address":  "1497737314304",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013631892.0000015CBADA0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "1497783468032",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013638115.0000015CBAE90000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "1497784451072",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003383687.000000F1BB8FE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "8192",
                                          "base_address":  "1038233886720",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013566823.0000015CB7F05000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "40960",
                                          "base_address":  "1497734598656",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1013441504.0000015CB7F12000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "65536",
                                          "base_address":  "1497734651904",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013638115.0000015CBAE93000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "12288",
                                          "base_address":  "1497784463360",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000000.00000002.1003492394.0000024A6DE80000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2518694756352",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013580704.0000015CB7F28000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "16384",
                                          "base_address":  "1497734742016",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013588144.0000015CB7F2D000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "69632",
                                          "base_address":  "1497734762496",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013625967.0000015CB97B0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "1497760464896",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000003.1003213041.0000015CB7F1B000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "28672",
                                          "base_address":  "1497734688768",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013528233.0000015CB7E50000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "1497733857280",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000003.00000002.1013573482.0000015CB7F16000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "49152",
                                          "base_address":  "1497734668288",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072357440.0000022F415E0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "12288",
                                          "base_address":  "2401983397888",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072349858.0000022F41550000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "2401982808064",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062242720.000000E042FFE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "8192",
                                          "base_address":  "963196739584",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062285228.000001E278E80000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2072202706944",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062309900.000001E278EE0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "8192",
                                          "base_address":  "2072203100160",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072305787.00000034B7AFF000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "226420060160",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062233603.000000E042EFB000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "20480",
                                          "base_address":  "963195678720",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072323710.00000034B7BFE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "226421104640",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072400636.0000022F41605000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "40960",
                                          "base_address":  "2401983549440",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072408735.0000022F41623000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2401983672320",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072448896.0000022F44420000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "2402031894528",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1062390365.0000022F41622000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "86016",
                                          "base_address":  "2401983668224",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1062412320.0000022F4161B000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "28672",
                                          "base_address":  "2401983639552",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062350940.000001E2791C4000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2072206131200",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072332213.0000022F413F0000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2401981366272",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072382810.0000022F415FC000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "32768",
                                          "base_address":  "2401983512576",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072341143.0000022F41530000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2401982676992",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072408735.0000022F41616000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "49152",
                                          "base_address":  "2401983619072",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1072224779.0000022F41624000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "106496",
                                          "base_address":  "2401983676416",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072357440.0000022F415EC000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "12288",
                                          "base_address":  "2401983447040",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1072261496.0000022F41604000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "45056",
                                          "base_address":  "2401983545344",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062350940.000001E2791C0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "12288",
                                          "base_address":  "2072206114816",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072382810.0000022F415F0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "45056",
                                          "base_address":  "2401983463424",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062264547.000000E0431FF000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "963198840832",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062274634.000001E278D40000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2072201396224",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072314094.00000034B7B7E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "8192",
                                          "base_address":  "226420580352",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072441649.0000022F443C0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2402031501312",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072464458.0000022F44930000.00000004.00000800.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2402037202944",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072296500.00000034B7A7B000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "20480",
                                          "base_address":  "226419519488",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062298468.000001E278EA0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2072202838016",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072434292.0000022F42ED0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2402009546752",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1072237008.0000022F41612000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "65536",
                                          "base_address":  "2401983602688",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072423447.0000022F41627000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "94208",
                                          "base_address":  "2401983688704",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1072268977.0000022F41623000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2401983672320",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072357440.0000022F415E4000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "24576",
                                          "base_address":  "2401983414272",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062309900.000001E278ED0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "53248",
                                          "base_address":  "2072203034624",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1072237008.0000022F41623000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2401983672320",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062309900.000001E278EDE000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "4096",
                                          "base_address":  "2072203091968",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000002.1072448896.0000022F44423000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "12288",
                                          "base_address":  "2402031906816",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062309900.000001E278EE3000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "81920",
                                          "base_address":  "2072203112448",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1072268977.0000022F41612000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "65536",
                                          "base_address":  "2401983602688",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000004.00000003.1072237008.0000022F4160F000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\rundll32.exe",
                                          "size":  "4096",
                                          "base_address":  "2401983590400",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1062251101.000000E0430FE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\System32\\loaddll64.exe",
                                          "size":  "8192",
                                          "base_address":  "963197788160",
                                          "stage":  "MEM_STAGE_EXIT"
                                      }
                                  ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "change memory protection",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: change memory protection\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Change Memory Protection [C0008]\n    examples:\n      - Practical Malware Analysis Lab 11-02.dll_:0x10001203\n  features:\n    - or:\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtProtectVirtualMemory\n      - api: ZwProtectVirtualMemory\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualProtect\"\n          - string: \"VirtualProtectEx\"\n          - string: \"NtProtectVirtualMemory\"\n          - string: \"ZwProtectVirtualMemory\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate or change RWX memory",
                                               "description":  "host-interaction/process/inject",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate or change RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x40 = PAGE_EXECUTE_READWRITE\n        # lea     r9d, [rcx+40h]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x40 = PAGE_EXECUTE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate or change RW memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org",
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate or change RW memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x4 = PAGE_READWRITE\n        # lea     r9d, [rcx+4]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x4 = PAGE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org",
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA  # ntdll.NtAllocateVirtualMemory\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualAlloc\"\n          - string: \"VirtualAllocEx\"\n          - string: \"VirtualAllocExNuma\"\n          - string: \"NtAllocateVirtualMemory\"\n          - string: \"ZwAllocateVirtualMemory\"\n          - string: \"NtMapViewOfSection\"\n          - string: \"ZwMapViewOfSection\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "acquire debug privileges",
                                               "description":  "host-interaction/process/modify",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: acquire debug privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    att\u0026ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401174\n  features:\n    - and:\n      - string: \"SeDebugPrivilege\"\n      - optional:\n        - match: modify access privileges\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delay execution",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@ramen0x3f"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - or:\n          - api: sleep\n          - api: usleep\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link many functions at runtime",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create mutex",
                                               "description":  "host-interaction/mutex",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: System.Threading.Mutex::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "patch Event Tracing for Windows function",
                                               "description":  "anti-analysis/anti-av",
                                               "authors":  [
                                                               "jakub.jozwiak@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: patch Event Tracing for Windows function\n    namespace: anti-analysis/anti-av\n    authors:\n      - jakub.jozwiak@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Defense Evasion::Impair Defenses::Disable or Modify Tools [T1562.001]\n    mbc:\n      - Defense Evasion::Disable or Evade Security Tools [F0004]\n    references:\n      - https://unprotect.it/technique/disabling-event-tracing-for-windows-etw/\n      - https://github.com/Mr-Un1k0d3r/AMSI-ETW-Patch/blob/main/patch-etw-x64.c\n    examples:\n      - 15835b6dd703e69d22d4ab941ccd5f6e78c3abc22ae123366da5e950eaa62e2b:0x180001D70\n  features:\n    - and:\n      - match: change memory protection\n      - or:\n        - string: \"EventWrite\"\n        - string: \"EtwEventWrite\"\n        - string: \"EtwEventWriteFull\"\n        - string: \"TraceEvent\"\n        - string: \"NtTraceEvent\"\n        - string: \"ZwTraceEvent\"\n        - string: \"NtTraceControl\"\n        - string: \"ZwTraceControl\"\n      - optional:\n        - match: write process memory\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://unprotect.it/technique/disabling-event-tracing-for-windows-etw/"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/Mr-Un1k0d3r/AMSI-ETW-Patch/blob/main/patch-etw-x64.c"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "execute shellcode via indirect call",
                                               "description":  "load-code/shellcode",
                                               "authors":  [
                                                               "ronnie.salomonsen@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: execute shellcode via indirect call\n    namespace: load-code/shellcode\n    authors:\n      - ronnie.salomonsen@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    mbc:\n      - Memory::Allocate Memory [C0007]\n  features:\n    - and:\n      - match: allocate or change RWX memory\n      - or:\n        - characteristic: indirect call\n        - characteristic: cross section flow\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check mutex and exit",
                                               "description":  "host-interaction/mutex",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check mutex and exit\n    namespace: host-interaction/mutex\n    authors:\n      - \"@_re_fox\"\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Check Mutex [C0043]\n      - Process::Terminate Process [C0018]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x402eb0\n      - Practical Malware Analysis Lab 11-03.dll_:0x10001410\n  features:\n    - and:\n      - match: create mutex\n      - or:\n        - api: ExitProcess\n        - api: exit\n        - api: _Exit\n        - api: _exit\n        - or:\n          - api: WaitForSingleObject\n          - and:\n            - api: GetLastError\n            - or:\n              - number: 2 = ERROR_FILE_NOT_FOUND\n              - number: 0xB7 = ERROR_ALREADY_EXISTS\n              - number: 5 = ERROR_ACCESS_DENIED\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Windows",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query environment variable",
                                               "description":  "host-interaction/environment-variable",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Windows",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get hostname",
                                               "description":  "host-interaction/os/hostname",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate files on Windows",
                                               "description":  "host-interaction/file-system/files/list",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate files on Windows\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    references:\n      - https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x4011E0\n      - Practical Malware Analysis Lab 20-02.exe_:0x401000\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x14000203C\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.FindFirstFile\n          - api: kernel32.FindFirstFileEx\n          - api: kernel32.FindFirstFileTransacted\n          - api: kernel32.FindFirstFileName\n          - api: kernel32.FindFirstFileNameTransacted\n        - or:\n          - api: kernel32.FindNextFile\n          - api: kernel32.FindNextFileName\n        - optional:\n          - api: kernel32.FindClose\n          - match: contain loop\n      - and:\n        - or:\n          - basic block:\n            - and:\n              - number: 1 = DIRECTORY_QUERY\n              - api: ntdll.NtOpenDirectoryObject\n          - call:\n            - and:\n              - number: 1 = DIRECTORY_QUERY\n              - api: ntdll.NtOpenDirectoryObject\n        - api: ntdll.NtQueryDirectoryObject\n        - optional:\n          - api: RtlAllocateHeap\n          - match: contain loop\n          - characteristic: indirect call\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "parse PE header",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "patch process command line",
                                               "description":  "anti-analysis/anti-forensic",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: patch process command line\n    namespace: anti-analysis/anti-forensic\n    authors:\n      - william.ballenthin@mandiant.com\n      - \"@_re_fox\"\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset features\n    att\u0026ck:\n      - Defense Evasion::Process Injection [T1055]\n    mbc:\n      - Defense Evasion::Process Injection::Patch Process Command Line [E1055.m04]\n    references:\n      - https://stackoverflow.com/q/24754844/87207\n      - https://blog.xpnsec.com/how-to-argue-like-cobalt-strike/\n    examples:\n      - e353d3fbfb5c3738a77a622adff9a416:0x401626\n  features:\n    - or:\n      - and:\n        - basic block:\n          # example:\n          #   mov     rbx, gs:60h\n          #   lea     r9, [rsp+4A0h+flOldProtect] ; lpflOldProtect\n          #   mov     edx, 8          ; dwSize\n          #   mov     rcx, [rbx+20h]\n          #   add     rcx, 70h ; \u0027p\u0027  ; lpAddress\n          #   lea     r8d, [rdx-4]    ; flNewProtect\n          #   call    cs:VirtualProtect\n          #   test    eax, eax\n          - and:\n            - arch: amd64\n            - characteristic: gs access\n            - offset: 0x60 = PEB\n            - offset: 0x20 = PEB-\u003eProcessParameters\n            - offset: 0x70 = PEB-\u003eProcessParameters-\u003eCommandLine\n            - api: VirtualProtect\n        - count(api(VirtualProtect)): 2 or more\n      - and:\n        - characteristic: indirect call\n        - api: GetProcAddress\n        - string: \"NtQueryInformationProcess\"\n        - api: ReadProcessMemory\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x10 = PEB-\u003eProcessParameters\n            - offset: 0x40 = PEB-\u003eProcessParameters-\u003eCommandLine\n          - and:\n            - arch: amd64\n            - offset: 0x20 = PEB-\u003eProcessParameters\n            - offset: 0x70 = PEB-\u003eProcessParameters-\u003eCommandLine\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://stackoverflow.com/q/24754844/87207"
                                                            },
                                                            {
                                                                "ref":  "https://blog.xpnsec.com/how-to-argue-like-cobalt-strike/"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "id":  "stealth_network",
                                               "name":  "stealth_network",
                                               "description":  "Network activity detected but not expressed in monitor API logs",
                                               "match_data":  [
                                                                  "{\"ip\": \"20.12.23.50\"}",
                                                                  "{\"ip\": \"40.83.240.146\"}",
                                                                  "{\"ip\": \"52.137.106.217\"}",
                                                                  "{\"ip\": \"20.211.142.183\"}",
                                                                  "{\"ip\": \"204.79.197.203\"}",
                                                                  "{\"ip\": \"23.12.67.101\"}",
                                                                  "{\"ip\": \"208.111.186.0\"}",
                                                                  "{\"ip\": \"13.85.23.206\"}",
                                                                  "{\"ip\": \"20.190.155.130\"}",
                                                                  "{\"ip\": \"23.215.15.132\"}",
                                                                  "{\"domain\": \"settings-win.data.microsoft.com\"}",
                                                                  "{\"domain\": \"settings-prod-ause-1.australiaeast.cloudapp.azure.com\"}",
                                                                  "{\"domain\": \"s-part-0010.t-0009.t-msedge.net\"}",
                                                                  "{\"domain\": \"www.msftconnecttest.com\"}",
                                                                  "{\"domain\": \"wpad.hostonly\"}",
                                                                  "{\"domain\": \"login.live.com\"}",
                                                                  "{\"domain\": \"fe3cr.delivery.mp.microsoft.com\"}",
                                                                  "{\"domain\": \"ctldl.windowsupdate.com\"}",
                                                                  "{\"domain\": \"cdn.onenote.net\"}",
                                                                  "{\"domain\": \"api.msn.com\"}",
                                                                  "{\"domain\": \"slscr.update.microsoft.com\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "queries_keyboard_layout",
                                               "name":  "queries_keyboard_layout",
                                               "description":  "Queries the keyboard layout",
                                               "match_data":  [
                                                                  "{\"type\": \"call\", \"pid\": 5532, \"cid\": 306}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "antidebug_setunhandledexceptionfilter",
                                               "name":  "antidebug_setunhandledexceptionfilter",
                                               "description":  "SetUnhandledExceptionFilter detected (possible anti-debug)",
                                               "match_data":  [
                                                                  "{\"type\": \"call\", \"pid\": 5532, \"cid\": 1}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "network_http",
                                               "name":  "network_http",
                                               "description":  "Performs some HTTP requests",
                                               "match_data":  [
                                                                  "{\"url\": \"http://www.msftconnecttest.com/connecttest.txt\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "871",
                                               "description":  "Sample execution stops while process was sleeping (likely an evasion)",
                                               "match_data":  [
                                                                  "Thread delayed"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "415",
                                               "description":  "PE file has an executable .text section and no other executable section",
                                               "match_data":  [
                                                                  "Section: .text IMAGE_SCN_CNT_CODE, IMAGE_SCN_MEM_EXECUTE, IMAGE_SCN_MEM_READ"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "509",
                                               "description":  "Reads software policies",
                                               "match_data":  [
                                                                  "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#registry_keys_opened",
                                                                "value":  "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "715",
                                               "description":  "Classification label",
                                               "match_data":  [
                                                                  "clean3.winDLL@6/0@0/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "381",
                                               "description":  "Disables application error messsages (SetErrorMode)",
                                               "match_data":  [
                                                                  "NOOPENFILEERRORBOX"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "626",
                                               "description":  "Sample tries to load a library which is not present or installed on the analysis machine, adding the library might reveal more behavior",
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "219",
                                               "description":  "Runs a DLL by calling functions",
                                               "match_data":  [
                                                                  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\attachment.dll\",#1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "229",
                                               "description":  "Spawns processes",
                                               "match_data":  [
                                                                  "C:\\Windows\\System32\\loaddll64.exe loaddll64.exe \"C:\\Users\\user\\Desktop\\attachment.dll\"",
                                                                  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                                                  "C:\\Windows\\System32\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\",#1",
                                                                  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\attachment.dll\",#1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "419",
                                               "description":  "PE file has a high image base, often used for DLLs",
                                               "match_data":  [
                                                                  "Image base 0x180000000 \u003e 0x60000000"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "406",
                                               "description":  "Contains modern PE file flags such as dynamic base (ASLR) or NX",
                                               "match_data":  [
                                                                  "HIGH_ENTROPY_VA, DYNAMIC_BASE, NX_COMPAT"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "187",
                                               "description":  "Tries to load missing DLLs",
                                               "match_data":  [
                                                                  "apphelp.dll",
                                                                  "pid.dll",
                                                                  "hid.dll",
                                                                  "bcrypt.dll"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "307",
                                               "description":  "May sleep (evasive loops) to hinder dynamic analysis",
                                               "match_data":  [
                                                                  "-120000s \u003e= -30000s"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "95",
                                               "description":  "Creates mutexes",
                                               "match_data":  [
                                                                  "\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:7568:120:WilError_01"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "149",
                                               "description":  "Program does not show much activity (idle)",
                                               "match_data":  [
                                                                  "no activity detected"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "1318",
                                               "description":  "Creates a process in suspended mode (likely to inject code)",
                                               "match_data":  [
                                                                  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\attachment.dll\",#1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "1884",
                                               "description":  "Contains medium sleeps (\u003e= 30s)",
                                               "match_data":  [
                                                                  "delay time: 120000"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "-1201512004",
                                               "description":  "Sigma detected: Unsigned DLL Loaded by RunDLL32/RegSvr32",
                                               "match_data":  [
                                                                  "Data: Company: -, Description: -, FileVersion: -, Hashes: SHA1=66FB63E6E49C2C201A0B6204E1D0269812A4B662,MD5=BC85062DE0F70AFD44BB072B0B71A8CC,SHA256=AB56501167FE689FE55F6E6DDC3BB91952299BD5C3EF004B02BF"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "199",
                                               "description":  "PE file contains sections with non-standard names",
                                               "match_data":  [
                                                                  "section name: _RDATA"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "412",
                                               "description":  "PE file contains a debug data directory",
                                               "match_data":  [
                                                                  "data directory type: IMAGE_DIRECTORY_ENTRY_DEBUG"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "219",
                                               "description":  "Runs a DLL by calling functions",
                                               "match_data":  [
                                                                  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\library.dll\",#1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "229",
                                               "description":  "Spawns processes",
                                               "match_data":  [
                                                                  "C:\\Windows\\System32\\loaddll64.exe loaddll64.exe \"C:\\Users\\user\\Desktop\\library.dll\"",
                                                                  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                                                  "C:\\Windows\\System32\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\library.dll\",#1",
                                                                  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\library.dll\",#1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "95",
                                               "description":  "Creates mutexes",
                                               "match_data":  [
                                                                  "\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:3724:120:WilError_01"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "1318",
                                               "description":  "Creates a process in suspended mode (likely to inject code)",
                                               "match_data":  [
                                                                  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\library.dll\",#1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           }
                                       ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "crt.sectigo.com",
                                         "resolved_ips":  [
                                                              "104.18.38.233"
                                                          ]
                                     }
                                 ],
                 "processes_terminated":  [
                                              "wmiadap.exe /F /T /R",
                                              "C:\\Windows\\System32\\loaddll64.exe",
                                              "C:\\Windows\\System32\\cmd.exe",
                                              "C:\\Windows\\System32\\rundll32.exe"
                                          ],
                 "processes_created":  [
                                           "\"C:\\Windows\\sysnative\\rundll32.exe\" \"C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll\",#1",
                                           "C:\\Windows\\System32\\loaddll64.exe loaddll64.exe \"C:\\Users\\user\\Desktop\\attachment.dll\"",
                                           "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                           "C:\\Windows\\System32\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\",#1",
                                           "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\attachment.dll\",#1",
                                           "C:\\Windows\\System32\\loaddll64.exe loaddll64.exe \"C:\\Users\\user\\Desktop\\library.dll\"",
                                           "C:\\Windows\\System32\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\library.dll\",#1",
                                           "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\library.dll\",#1"
                                       ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link many functions at runtime",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link many functions at runtime"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "parse PE header",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "parse PE header"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process tried to load dynamically one or more functions."
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "link function at runtime on Windows"
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "link many functions at runtime"
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "parse PE header"
                                                         }
                                                     ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encode data using XOR"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "encode data using XOR"
                                                         }
                                                     ],
                                           "T1134":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "acquire debug privileges",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "acquire debug privileges"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "acquire debug privileges"
                                                         }
                                                     ],
                                           "T1562.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "patch Event Tracing for Windows function",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "patch Event Tracing for Windows function"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query environment variable",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query environment variable"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get hostname",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get hostname"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "query environment variable"
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "get hostname"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "509"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate files on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "enumerate files on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "enumerate files on Windows"
                                                         }
                                                     ],
                                           "T1055":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "patch process command line",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "patch process command line"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "patch process command line"
                                                         }
                                                     ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                         }
                                                     ],
                                           "T1562.006":  [
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "patch Event Tracing for Windows function"
                                                             }
                                                         ],
                                           "T1063":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "It Tries to detect injection methods"
                                                         }
                                                     ],
                                           "T1574.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Tries to load missing DLLs",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "187"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1218.011":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Runs a DLL by calling functions",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "219"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1497":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Contains medium sleeps (\u003e= 30s)",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "1884"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "May sleep (evasive loops) to hinder dynamic analysis",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "307"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
