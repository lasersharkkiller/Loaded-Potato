{
    "data":  {
                 "modules_loaded":  [
                                        "api-ms-win-downlevel-advapi32-l1-1-0.dll",
                                        "CRYPTSP.dll",
                                        "ADVAPI32.dll",
                                        "SspiCli.dll",
                                        "USERENV.dll",
                                        "CRYPTBASE.dll",
                                        "API-MS-Win-Security-LSALookup-L1-1-0.dll"
                                    ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "3.72.225.3",
                                        "destination_port":  10391,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "files_opened":  [
                                      "\\Device\\Afd\\Endpoint",
                                      "C:\\Windows\\system32\\mswsock.dll",
                                      "C:\\Windows\\System32\\wshtcpip.dll",
                                      "C:\\Windows\\system32\\version.DLL",
                                      "C:\\Windows\\system32\\WINHTTP.dll",
                                      "C:\\Windows\\system32\\webio.dll",
                                      "C:\\Windows\\system32\\CRYPTSP.dll",
                                      "C:\\Windows\\system32\\rsaenh.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Crypto",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Crypto\\RSA",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Crypto\\RSA\\S-1-5-21-4270068108-2931534202-3907561125-1001",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Crypto\\RSA\\S-1-5-21-4270068108-2931534202-3907561125-1001\\bd92d27a61e9b9c8576c007ef5f46261_574cbd14-d75b-425c-a623-6adf5a9d77b1",
                                      "C:\\Windows\\system32\\MPR.dll",
                                      "C:\\Windows\\system32\\NETAPI32.dll",
                                      "C:\\Windows\\system32\\netutils.dll",
                                      "C:\\Windows\\system32\\srvcli.dll",
                                      "C:\\Windows\\system32\\wkscli.dll",
                                      "PIPE\\wkssvc",
                                      "C:\\Windows\\system32\\cscapi.dll",
                                      "C:\\Windows\\system32\\dhcpcsvc6.DLL",
                                      "C:\\Windows\\system32\\dhcpcsvc.DLL",
                                      "\\DEVICE\\NETBT_TCPIP_{C67AE938-2892-434B-892B-00272A4EB123}",
                                      "\\DEVICE\\NETBT_TCPIP_{846EE342-7039-11DE-9D20-806E6F6E6963}",
                                      "\\DEVICE\\NETBT_TCPIP_{3DFCAD32-1CDE-44FB-A9E1-D91126365830}"
                                  ],
                 "signature_matches":  [
                                           {
                                               "id":  "0",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: GetProcAddress"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - mehunhoff@google.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n        - api: ntdll.LdrGetProcedureAddressEx\n        - api: ntdll.LdrGetProcedureAddressForCaller\n        - api: MmGetSystemRoutineAddress\n"
                                           },
                                           {
                                               "id":  "1",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "tight loop",
                                                                  "nzxor"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "id":  "2",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "accept command line arguments",
                                               "description":  "host-interaction/cli",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: GetCommandLine"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: accept command line arguments\n    namespace: host-interaction/cli\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Execution::Command and Scripting Interpreter [T1059]\n    mbc:\n      - Execution::Command and Scripting Interpreter [E1059]\n    examples:\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\n  features:\n    - or:\n      - api: GetCommandLine\n      - api: CommandLineToArgv\n      - api: System.Environment::GetCommandLineArgs\n"
                                           },
                                           {
                                               "id":  "3",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contains PDB path",
                                               "description":  "executable/pe/pdb",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "regex: /:\\\\.*\\.pdb/"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n"
                                           },
                                           {
                                               "id":  "5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference Base64 string",
                                               "description":  "data-manipulation/encoding/base64",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "regex: /ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference Base64 string\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Data::Encode Data::Base64 [C0026.001]\n      - Data::Check String [C0019]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5\n      - 074072B261FC27B65C72671F13510C05\n      - 5DB2D2BE20D59AA0BE6709A6850F1775\n  features:\n    - string: /ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\n"
                                           }
                                       ],
                 "memory_pattern_urls":  [
                                             "tcp://3.72.225.3:10391"
                                         ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "0"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "1"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1059",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "accept command line arguments",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "2"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference Base64 string",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "5"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "memory_pattern_ips":  [
                                            "3.72.225.3"
                                        ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "crypto_plain_text":  [
                                           "?A!h^??\u000e?u+???2dF@_F:??UU}?\u001c?\u0010??",
                                           "???\f?\u0002?\u0001???\n???)?\u0001?\u000298637602236746130577518498087439????\f?\u0002?\u000b???????\f?\u0002?\u0019??\u0003?",
                                           "???\f?\u0002?\u0001???\n???)?\u0001?\u000298637602236746130577518498087439????\f?\u0002?\u000b???\u0011???\f?\u0002?\u000b???\u0013???\f?\u0002?\u000b???\u0012???\f?\u0002?\u000b???\u0016???\f?\u0002?\u000b???\u0015???\f?\u0002?\u000b???\u000b???\f?\u0002?\u000b???\r???\f?\u0002?\u000b???\n???\f?\u0002?\u000b???\f???\f?\u0002?\u000b???\u0017???\f?\u0002?\u000b???\u000e???\f?\u0002?\u000b???\u001e???",
                                           "???\f?\u0002?\u0001???\n???)?\u0001?\u000299598746511837516532052443240984????\f?\u0002?\u000b??\u0003????\f?\u0002?\u0019??\u0003?",
                                           "???\f?\u0002?\u0001???\n???)?\u0001?\u000299598746511837516532052443240984????\f?\u0002?\u0004???????\u0018?\u0004\u0001?eQ??x??x\u001bZ\u001a[rbi?",
                                           "???\f?\u0002?\u0001???\f???)?\u0001?\u000200361414645824634819366298832873??\u0002?? \u0004?\u001a?\u0005??x???}|\u0014?8\u003e??d\t\u000b?h\u0002k\r\u001a\u0014+U???\u0002?h\u0026????%????VL??V\n3?? ??q?\u0016??????Z?[z?-?E?-j\u0010???-\u0015?i?mz??t?v-iXqe?????}\t???{?????s?9?9?y??3??o\u0013\\? ???i\nB??",
                                           "???\f?\u0002?\u0001???\f???)?\u0001?\u000200361414645824634819366298832873????\f?\u0002?\u000b??\u0004V???\f?\u0002?\u000b??\u0004Z???\f?\u0002?\u000b??\u0004W???\f?\u0002?\u000b??\u0004Y???\f?\u0002?\u000b??\u0004X???\f?\u0002?\u000b??\u0004*???\f?\u0002?\u000b??\u0004%???\f?\u0002?\u000b??\u0004$???\f?\u0002?\u000b??\u0004\u0027???\f?\u0002?\u000b??\u0004)???\f?\u0002?\u000b??\u0004\u0026???\f?\u0002?\u000b??\u0004(???",
                                           "???\f?\u0002?\u0001??\u0003????)?\u0001?\u000269674177249673518577231396229371?",
                                           "???\f?\u0002?\u0001??\u0003????)?\u0001?\u000269674177249673518577231396229371????!?\u0001\u0004?C:\\Users\\\u003cUSER\u003e\\Downloads????\f?\u0002?\u0004???????\u0018?\u0004\u0001?eQ??x??x\u001bZ\u001a[rbi?",
                                           "???\f?\u0002?\u0001??\u0004\u001f???)?\u0001?\u000235193838734977341702009335101770?",
                                           "???\f?\u0002?\u0001??\u0004\u001f???)?\u0001?\u000235193838734977341702009335101770????\u0017?\u0001\u0004\u0012azure-PC\\\u003cUSER\u003e????\f?\u0002?\u0004???????\u0018?\u0004\u0001?eQ??x??x\u001bZ\u001a[rbi?",
                                           "???\f?\u0002?\u0001??\u0004#???)?\u0001?\u000255421257082811498310031056680902?",
                                           "???\f?\u0002?\u0001??\u0004#???)?\u0001?\u000255421257082811498310031056680902????\u0011?\u0001\u0004\u0010AZURE-PC????4?\u0001\u0004\u0011Windows 7 (6.1 Build 7601, Service Pack 1).????\f?\u0001\u0004\u0013x64????\u000e?\u0001\u0004\u0014en_US????\u0012?\u0001\u0004\u0016WORKGROUP????\f?\u0002\u0004\u0017???\u0001???\f?\u0002?\u0004???????\u0018?\u0004\u0001?eQ",
                                           "???\f?\u0002?\u0001??\u0003????)?\u0001?\u000206514791902430373862291938257361?",
                                           "???\f?\u0002?\u0001??\u0003????)?\u0001?\u000206514791902430373862291938257361?????@?\u0005????\f?\u0002\u0005|???\r???\u000e?\u0004\u0005?\u0002-4`\u00143???0?\u0001\u0005?Intel(R) PRO/1000 MT Network Connection????\f?\u0002\u0005z??\u0005????\f?\u0002\u0005????@???\u0018?\u0004\u0005?????????\u0018?????\u001f????\f?\u0004\u0005?\r??????\f?",
                                           "???\f?\u0002?\u0001??\u0003????)?\u0001?\u000263983420456071172346931295855961?",
                                           "???\f?\u0002?\u0001??\u0003????)?\u0001?\u000263983420456071172346931295855961????C@?\u0005????\f?\u0004\u0005????????\f?\u0004\u0005????????\f?\u0004\u0005???z\u0001???\u000b?\u0001?\n13????\f?\u0002\u0005????\n???B@?\u0005????\f?\u0004\u0005???????\f?\u0004\u0005????????\f?\u0004\u0005???\u0001???\n?\u0001?\n1????\f?\u0002\u0005???\u00012???B@?\u0005????\f?\u0004",
                                           "???\f?\u0002?\u0001???\n???)?\u0001?\u000240055130878234316533848362545449????\f?\u0002?\u000b??\u0007????\f?\u0002?\u0019??\u0003?",
                                           "???\f?\u0002?\u0001???\n???)?\u0001?\u000240055130878234316533848362545449????\f?\u0002?\u0004???????\u0018?\u0004\u0001?eQ??x??x\u001bZ\u001a[rbi?",
                                           "???\f?\u0002?\u0001???\f???)?\u0001?\u000288208609294803777170218211764107??\u0001\b? \u0004?\u001a?\u0001??x???`Tw8~?G?%??$\u0010%`??h?F?TB@\u0013`\u0013T\u0002\u001b??\u0026?$Z!]W?4??\u0012 ?l?e\\K_?{?i????_mm?\u0012\u0015q?`~`???\u0018??`S?xS\r\u0010?\u0005b????\r?}???_4;???9sf??3g??-??\u000e?$\b?\u0019?4M\u0010?\u0005??"
                                       ],
                 "mbc":  [
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1059",
                                 "objective":  "Execution",
                                 "behavior":  "Command and Scripting Interpreter",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "2"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.001",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "Base64",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "5"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0019",
                                 "objective":  "Data",
                                 "behavior":  "Check String",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "5"
                                              }
                                          ]
                             }
                         ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "SURICATA Applayer Protocol detection skipped",
                                        "rule_category":  "Generic Protocol Command Decode",
                                        "rule_id":  "1:2260003",
                                        "alert_severity":  "low",
                                        "rule_source":  "Suricata",
                                        "alert_context":  {
                                                              "dest_ip":  "3.72.225.3",
                                                              "dest_port":  10391
                                                          },
                                        "rule_url":  "https://www.openinfosecfoundation.org/",
                                        "rule_raw":  "alert ip any any -\u003e any any (msg:\"SURICATA Applayer Protocol detection skipped\"; flow:established; app-layer-event:applayer_proto_detection_skipped; flowint:applayer.anomaly.count,+,1; classtype:protocol-command-decode; sid:2260003; rev:1;)"
                                    },
                                    {
                                        "rule_msg":  "ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)",
                                        "rule_category":  "A Network Trojan was detected",
                                        "rule_id":  "1:2025644",
                                        "alert_severity":  "high",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "src_ip":  "3.72.225.3",
                                                              "src_port":  10391
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_raw":  "alert tcp $EXTERNAL_NET any -\u003e $HOME_NET any (msg:\"ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)\"; flow:from_server,established; content:\"|60 89 e5 31|\"; content:\"|64 8b|\"; distance:1; within:2; content:\"|30 8b|\"; distance:1; within:2; content:\"|0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff|\"; distance:1; within:13; content:\"|ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2|\"; within:15; content:\"|52 57 8b 52 10|\"; distance:1; within:5; classtype:trojan-activity; sid:2025644; rev:1; metadata:affected_product Any, attack_target Client_and_Server, created_at 2016_05_16, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, confidence Medium, signature_severity Critical, tag Metasploit, updated_at 2019_07_26;)"
                                    }
                                ],
                 "verdict_labels":  [
                                        "MetasploitShellcode"
                                    ],
                 "verdict_confidence":  70,
                 "processes_tree":  [
                                        {
                                            "process_id":  "2608",
                                            "name":  "%TEMP%\\2440DVIFU2APJAOT.exe"
                                        },
                                        {
                                            "process_id":  "2824",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2240",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                                        },
                                        {
                                            "process_id":  "2860",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        }
                                    ],
                 "calls_highlighted":  [
                                           "GetTickCount",
                                           "GetAdaptersAddresses"
                                       ],
                 "command_executions":  [
                                            " "
                                        ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "0"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "1"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference Base64 string",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "5"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1059":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "accept command line arguments",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "2"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
