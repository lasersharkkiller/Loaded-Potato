{
    "data":  {
                 "tags":  [
                              "DETECT_DEBUG_ENVIRONMENT",
                              "LONG_SLEEPS"
                          ],
                 "processes_created":  [
                                           "\"C:\\Users\\\u003cUSER\u003e\\Desktop\\program.exe\"",
                                           "${SamplePath}\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe",
                                           "C:\\DOCUME~1\\Miller\\LOCALS~1\\Temp\\oilrig.exe",
                                           "%SAMPLEPATH%\\.exe",
                                           "C:\\Windows\\System32\\wuapihost.exe",
                                           "%SAMPLEPATH%\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe",
                                           "C:\\Windows\\SysWOW64\\cmd.exe cmd /c sc create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" \u003e\u003e C:\\servicereg.log 2\u003e\u00261",
                                           "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                           "C:\\Windows\\SysWOW64\\sc.exe sc  create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" ",
                                           "C:\\Windows\\SysWOW64\\cmd.exe cmd /c sc start WvNwh \u003e\u003e C:\\servicestart.log 2\u003e\u00261",
                                           "C:\\Windows\\SysWOW64\\sc.exe sc  start WvNwh",
                                           "C:\\Users\\user\\Desktop\\file.exe"
                                       ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encode data using XOR"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1222",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "set file attributes",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "set file attributes"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027.005",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "contain obfuscated stackstrings",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "contain obfuscated stackstrings"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "access PEB ldr_data",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "access PEB ldr_data"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1057",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get process heap flags",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get process heap flags"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1057",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate processes",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "enumerate processes"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1518",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate processes",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "enumerate processes"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get file size",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get file size"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get common file path",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get common file path"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1059",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "accept command line arguments",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "accept command line arguments"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1134.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "impersonate user",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "impersonate user"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "persist via Windows service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "persist via Windows service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "persist via Windows service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "persist via Windows service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1112",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "delete registry value",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "delete registry value"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "start service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "start service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "create service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "create service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "create service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "create service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "modify service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "modify service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "modify service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "modify service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1007",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query service status",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query service status"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1012",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query or enumerate registry value",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query or enumerate registry value"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get file version info",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get file version info"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get hostname",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get hostname"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link many functions at runtime",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link many functions at runtime"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1497.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference anti-VM strings targeting Xen",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference anti-VM strings targeting Xen"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference Base64 string",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference Base64 string"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "signature_description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Uses sc.exe to modify the status of services",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "256"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Uses sc.exe to modify the status of services",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "256"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1574.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to load missing DLLs",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "187"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "May sleep (evasive loops) to hinder dynamic analysis",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "307"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1057",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Queries a list of all running processes",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "211"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "509"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "www.microsoft.com",
                                         "resolved_ips":  [
                                                              "23.216.81.152"
                                                          ]
                                     }
                                 ],
                 "registry_keys_opened":  [
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\wow32",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Session Manager\\ResourcePolicies",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableUmpdBufferSizeCheck",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableMetaFiles",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\LanmanWorkstation\\Parameters\\RpcCacheTimeout",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\996E.exe",
                                              "\\Registry\\MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "\\Registry\\Machine\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "\\REGISTRY\\MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\TransparentEnabled",
                                              "\\REGISTRY\\USER\\S-1-5-21-1482476501-1645522239-1417001333-500\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\VERSION.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\NETAPI32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\SHELL32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\comctl32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ntdll.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\KERNEL32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\GDI32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\USER32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Secur32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\RPCRT4.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ADVAPI32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\msvcrt.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\WS2HELP.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\WS2_32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\SHLWAPI.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\PSAPI.DLL",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ole32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\OLEAUT32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\winime32.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\IMM32.DLL",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\USP10.dll",
                                              "\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LPK.DLL",
                                              "\\REGISTRY\\MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\996E.exe\\RpcThreadPoolThrottle",
                                              "\\REGISTRY\\MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_USERSS-1-5-18\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\file.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\CCG",
                                              "HKEY_USERSS-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sc.exe",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\StateSeparation\\RedirectionMap\\Keys",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\OSDATA\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Display",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Error Message Instrument\\",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete"
                                          ],
                 "files_written":  [
                                       "C:\\Program Files\\Google\\Policies",
                                       "C:\\Program Files\\Google\\Temp\\GUMC927.tmp",
                                       "C:\\Program Files\\Google\\Temp\\GUMF047.tmp",
                                       "C:\\Program Files\\Google\\Temp\\GUM2B7C.tmp",
                                       "C:\\Program Files\\Google\\Temp\\GUM46B.tmp",
                                       "C:\\Windows\\Temp\\key8854321.pub",
                                       "C:\\servicereg.log",
                                       "C:\\servicestart.log",
                                       "\\Device\\ConDrv\\\\Connect",
                                       "c:\\windows\\temp\\key8854321.pub"
                                   ],
                 "processes_terminated":  [
                                              "${SamplePath}\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe",
                                              "%SAMPLEPATH%\\.exe",
                                              "C:\\Windows\\System32\\conhost.exe",
                                              "C:\\Windows\\System32\\wuapihost.exe",
                                              "%SAMPLEPATH%\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe",
                                              "C:\\Documents and Settings\\Administrator\\Local Settings\\Temp\\EB93A6\\996E.exe",
                                              "C:\\Windows\\SysWOW64\\cmd.exe",
                                              "C:\\Windows\\SysWOW64\\sc.exe"
                                          ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "mbc":  [
                             {
                                 "id":  "C0016",
                                 "objective":  "File System",
                                 "behavior":  "Create File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using XOR"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using XOR"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate memory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate or change RW memory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0003.003",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Dynamic Analysis Evasion",
                                 "method":  "Delayed Execution",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delay execution"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0065",
                                 "objective":  "Process",
                                 "behavior":  "Open Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "open process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create process on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0038",
                                 "objective":  "Process",
                                 "behavior":  "Create Thread",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create thread"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0036.004",
                                 "objective":  "Operating System",
                                 "behavior":  "Registry",
                                 "method":  "Create Registry Key",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open registry key"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0036.003",
                                 "objective":  "Operating System",
                                 "behavior":  "Registry",
                                 "method":  "Open Registry Key",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open registry key"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0050",
                                 "objective":  "File System",
                                 "behavior":  "Set File Attributes",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "set file attributes"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.020",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Argument Obfuscation",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.017",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Stack Strings",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0001.019",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Debugger Detection",
                                 "method":  "Process Environment Block",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "PEB access"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0052",
                                 "objective":  "File System",
                                 "behavior":  "Writes File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "write file on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0047",
                                 "objective":  "File System",
                                 "behavior":  "Delete File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delete file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "read file on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get file size"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get common file path"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1059",
                                 "objective":  "Execution",
                                 "behavior":  "Command and Scripting Interpreter",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "accept command line arguments"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0036.007",
                                 "objective":  "Operating System",
                                 "behavior":  "Registry",
                                 "method":  "Delete Registry Value",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delete registry value"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0036.001",
                                 "objective":  "Operating System",
                                 "behavior":  "Registry",
                                 "method":  "Set Registry Key",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "set registry value"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0036.006",
                                 "objective":  "Operating System",
                                 "behavior":  "Registry",
                                 "method":  "Query Registry Value",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "query or enumerate registry value"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get file version info"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.009",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Initialize Winsock Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "initialize Winsock library"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1082",
                                 "objective":  "Discovery",
                                 "behavior":  "System Information Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get hostname"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0011.001",
                                 "objective":  "Communication",
                                 "behavior":  "DNS Communication",
                                 "method":  "Resolve",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "resolve DNS"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0045",
                                 "objective":  "File System",
                                 "behavior":  "Copy File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "copy file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0040",
                                 "objective":  "Process",
                                 "behavior":  "Allocate Thread Local Storage",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate thread local storage"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0009",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Virtual Machine Detection",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "reference anti-VM strings targeting Xen"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.001",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "Base64",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "reference Base64 string"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0019",
                                 "objective":  "Data",
                                 "behavior":  "Check String",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "reference Base64 string"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0025.007",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Conditional Execution",
                                 "method":  "Runs as Service",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "run as service"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0002"
                             }
                         ],
                 "files_dropped":  [
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4A91.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4A91.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4BD9.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4BD9.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4C09.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4C09.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51C5.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51C5.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51D6.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51D6.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51E7.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51E7.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\servicereg.log",
                                           "sha256":  "596ccc911c1772735aac6a6b756a76d3d55bcecd006b980cf147090b2243fa7b",
                                           "type":  "TEXT",
                                           "process_name":  "C:\\Windows\\SysWOW64\\cmd.exe",
                                           "process_id":  "5992"
                                       },
                                       {
                                           "path":  "C:\\servicestart.log",
                                           "sha256":  "a6b54085ce0bb643f18228e0dc3d3f18fad5fd7d5ea9c088f8516038944046ff",
                                           "type":  "TEXT",
                                           "process_name":  "C:\\Windows\\SysWOW64\\cmd.exe",
                                           "process_id":  "6120"
                                       }
                                   ],
                 "files_deleted":  [
                                       "%USERPROFILE%\\AppData\\Local\\Microsoft\\Windows\\INetCache\\IE\\KLT1I0ZU\\update50[1].xml",
                                       "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4A91.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4BD9.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4C09.tmp.txt",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51C5.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51D6.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER51E7.tmp.txt",
                                       "C:\\Program Files\\Google\\Policies",
                                       "C:\\Program Files\\Google\\Temp\\GUMC927.tmp",
                                       "C:\\Program Files\\Google\\Temp\\GUMF047.tmp",
                                       "C:\\Program Files\\Google\\Temp\\GUM2B7C.tmp",
                                       "C:\\Program Files\\Google\\Temp\\GUM46B.tmp"
                                   ],
                 "command_executions":  [
                                            "\"${SamplePath}\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe\" ",
                                            "C:\\DOCUME~1\\Miller\\LOCALS~1\\Temp\\oilrig.exe",
                                            "\"c:\\documents and settings\\miller\\local settings\\temp\\oilrig.exe\"",
                                            "\"%SAMPLEPATH%\\.exe\" ",
                                            "C:\\Windows\\System32\\wuapihost.exe -Embedding",
                                            "\"%SAMPLEPATH%\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe\" ",
                                            " ",
                                            "\"C:\\Program Files\\Google\\Update\\GoogleUpdate.exe\" /svc",
                                            "\"C:\\Program Files\\Google\\Update\\1.3.36.372\\GoogleCrashHandler.exe\""
                                        ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org",
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA  # ntdll.NtAllocateVirtualMemory\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualAlloc\"\n          - string: \"VirtualAllocEx\"\n          - string: \"VirtualAllocExNuma\"\n          - string: \"NtAllocateVirtualMemory\"\n          - string: \"ZwAllocateVirtualMemory\"\n          - string: \"NtMapViewOfSection\"\n          - string: \"ZwMapViewOfSection\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate or change RW memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org",
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate or change RW memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x4 = PAGE_READWRITE\n        # lea     r9d, [rcx+4]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x4 = PAGE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delay execution",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@ramen0x3f"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - or:\n          - api: sleep\n          - api: usleep\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "open process",
                                               "authors":  [
                                                               "0x534a@mailbox.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: open process\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Open Process [C0065]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - or:\n      - api: kernel32.OpenProcess\n      - api: NtOpenProcess\n      - api: ZwOpenProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create process on Windows",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create thread",
                                               "description":  "host-interaction/thread/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open registry key",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set file attributes",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att\u0026ck:\n      - Defense Evasion::File and Directory Permissions Modification [T1222]\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015f0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n  features:\n    - or:\n      - api: kernel32.SetFileAttributes\n      - api: ZwSetInformationFile\n      - api: NtSetInformationFile\n      - api: System.IO.File::SetAttributes\n      - api: System.IO.File::SetCreationTime\n      - api: System.IO.File::SetCreationTimeUtc\n      - api: System.IO.File::SetLastAccessTime\n      - api: System.IO.File::SetLastAccessTimeUtc\n      - api: System.IO.File::SetLastWriteTime\n      - api: System.IO.File::SetLastWriteTimeUtc\n      - property/write: System.IO.FileSystemInfo::Attributes\n      - api: utime\n      - api: utimes\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain obfuscated stackstrings",
                                               "description":  "anti-analysis/obfuscation/string/stackstring",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "PEB access",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "access PEB ldr_data",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires offset features\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get process heap flags",
                                               "description":  "host-interaction/process",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get process heap flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att\u0026ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB-\u003eProcessHeap\n          - or:\n            - number: 0x40 = ProcessHeap-\u003eHeapFlags \u003e= Vista\n            - number: 0xC = ProcessHeap-\u003eHeapFlags \u003c Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB-\u003eProcessHeap\n          - or:\n            - number: 0x70 = ProcessHeap-\u003eHeapFlags \u003e= Vista\n            - number: 0x14 = ProcessHeap-\u003eHeapFlags \u003c Vista\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Windows",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "extract resource via kernel32 functions",
                                               "description":  "executable/resource",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate processes",
                                               "description":  "host-interaction/process/list",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n          - call:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete file",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      # static\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n      # dynamic\n      - call:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Windows",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file size",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get common file path",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "accept command line arguments",
                                               "description":  "host-interaction/cli",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: accept command line arguments\n    namespace: host-interaction/cli\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Execution::Command and Scripting Interpreter [T1059]\n    mbc:\n      - Execution::Command and Scripting Interpreter [E1059]\n    examples:\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\n  features:\n    - or:\n      - api: GetCommandLine\n      - api: CommandLineToArgv\n      - api: System.Environment::GetCommandLineArgs\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "impersonate user",
                                               "description":  "host-interaction/user",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: impersonate user\n    namespace: host-interaction/user\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Privilege Escalation::Access Token Manipulation::Token Impersonation/Theft [T1134.001]\n  features:\n    - or:\n      - api: advapi32.LogonUser\n      - and:\n        - api: userenv.LoadUserProfile\n        - optional:\n          - api: advapi32.GetUserName\n          - api: advapi32.GetUserNameEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get service handle",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "persist via Windows service",
                                               "description":  "persistence/service",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: persist via Windows service\n    namespace: persistence/service\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - 9f012d7e3ae8f62370278e372691eb73b878fe2280b6083e1be637b278021855:0x40113A\n  features:\n    - or:\n      - and:\n        - or:\n          - basic block:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n          - call:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n        - optional:\n          - or:\n            - api: advapi32.OpenService\n            - api: advapi32.StartService\n      - and:\n        - match: host-interaction/process/create\n        - or:\n          - and:\n            - string: /^sc(|\\.exe)$/i\n            - string: /create /i\n          - string: /^sc(|\\.exe) create/i\n          - string: /New-Service /i\n      - and:\n        - match: \"set registry value\"\n        - string: /System\\\\(CurrentControlSet|ControlSet001)\\\\Services/i\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete registry value",
                                               "description":  "host-interaction/registry/delete",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete registry value\n    namespace: host-interaction/registry/delete\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Defense Evasion::Modify Registry [T1112]\n    mbc:\n      - Operating System::Registry::Delete Registry Value [C0036.007]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4041A0\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegDeleteValue\n        - api: advapi32.RegDeleteKeyValue\n        - api: ZwDeleteValueKey\n        - api: NtDeleteValueKey\n        - api: RtlDeleteRegistryValue\n        - api: SHDeleteValue\n        - api: SHRegDeleteUSValue\n        - api: Microsoft.Win32.RegistryKey::DeleteValue\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "start service",
                                               "description":  "host-interaction/service/start",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: start service\n    namespace: host-interaction/service/start\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x401FA0\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - api: advapi32.StartService\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create service",
                                               "description":  "host-interaction/service/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create service\n    namespace: host-interaction/service/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - and:\n      - api: advapi32.CreateService\n      - optional:\n        - api: advapi32.OpenSCManager\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "modify service",
                                               "description":  "host-interaction/service/modify",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: modify service\n    namespace: host-interaction/service/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - 7D16EFD0078F22C17A4BD78B0F0CC468:0x401000\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - or:\n        - api: advapi32.ChangeServiceConfig\n        - api: advapi32.ChangeServiceConfig2\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set registry value",
                                               "description":  "host-interaction/registry/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query service status",
                                               "description":  "host-interaction/service",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query service status\n    namespace: host-interaction/service\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Service Discovery [T1007]\n    examples:\n      - 9DC209F66DA77858E362E624D0BE86B3:0x403C70\n  features:\n    - or:\n      - api: advapi32.QueryServiceStatusEx\n      - api: advapi32.QueryServiceStatus\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query or enumerate registry value",
                                               "description":  "host-interaction/registry",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file version info",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file version info\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x45E308\n  features:\n    - and:\n      - or:\n        - api: version.GetFileVersionInfo\n        - api: version.GetFileVersionInfoEx\n        - api: System.Diagnostics.FileVersionInfo::GetVersionInfo\n      - optional:\n        - description: retrieve specified version information from the version-information resource\n        - api: version.VerQueryValue\n        - or:\n          - api: version.GetFileVersionInfoSize\n          - api: version.GetFileVersionInfoSizeEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "initialize Winsock library",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - or:\n      - api: ws2_32.WSAStartup\n      - api: ws2_32.#115 = WSAStartup\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get hostname",
                                               "description":  "host-interaction/os/hostname",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve DNS",
                                               "description":  "communication/dns",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "johnk3r",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve DNS\n    namespace: communication/dns\n    authors:\n      - william.ballenthin@mandiant.com\n      - johnk3r\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::DNS Communication::Resolve [C0011.001]\n    examples:\n      - 17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0\n  features:\n    - or:\n      - api: gethostbyname\n      - api: ws2_32.gethostbyname\n      - api: ws2_32.#52 = gethostbyname\n      - api: DnsQuery_A\n      - api: DnsQuery_W\n      - api: DnsQuery_UTF8\n      - api: DnsQueryEx\n      - api: GetAddrInfo\n      - api: ws2_32.#24 = GetAddrInfoW\n      - api: GetAddrInfoEx\n      - api: getaddrinfo\n      - api: ws2_32.#98 = getaddrinfo\n      - api: getnameinfo\n      - api: ws2_32.#99 = getnameinfo\n      - api: gethostent\n      - api: System.Net.Dns::GetHostAddresses\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link many functions at runtime",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "copy file",
                                               "description":  "host-interaction/file-system/copy",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: LZCopy\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate thread local storage",
                                               "description":  "host-interaction/thread/tls",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate thread local storage\n    namespace: host-interaction/thread/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Process::Allocate Thread Local Storage [C0040]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6\n  features:\n    - or:\n      - api: kernel32.TlsAlloc\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against CPP standard library",
                                               "description":  "linking/static",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against CPP standard library\n    namespace: linking/static\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: file\n      dynamic: file\n    references:\n      - https://en.wikipedia.org/wiki/P._J._Plauger\n      - https://www.dinkumware.com/\n    examples:\n      - 03b236b23b1ec37c663527c1f53af3fe\n  features:\n    - or:\n      - string: \"Copyright (c) by P.J. Plauger, licensed by Dinkumware, Ltd. ALL RIGHTS RESERVED.\"\n      - string: \"Copyright (c) 1992-2004 by P.J. Plauger, licensed by Dinkumware, Ltd. ALL RIGHTS RESERVED.\"\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://en.wikipedia.org/wiki/P._J._Plauger"
                                                            },
                                                            {
                                                                "ref":  "https://www.dinkumware.com/"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference anti-VM strings targeting Xen",
                                               "description":  "anti-analysis/anti-vm/vm-detection",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference anti-VM strings targeting Xen\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att\u0026ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /^Xen/i\n      - string: /XenVMMXenVMM/i\n      - string: /xenservice.exe/i\n      - string: /XenVMMXenVMM/i\n      - string: /HVM domU/i\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference Base64 string",
                                               "description":  "data-manipulation/encoding/base64",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference Base64 string\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Data::Encode Data::Base64 [C0026.001]\n      - Data::Check String [C0019]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5\n      - 074072B261FC27B65C72671F13510C05\n      - 5DB2D2BE20D59AA0BE6709A6850F1775\n  features:\n    - string: /ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "run as service",
                                               "description":  "host-interaction/service",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: run as service\n    namespace: host-interaction/service\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Anti-Behavioral Analysis::Conditional Execution::Runs as Service [B0025.007]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_\n  features:\n    - or:\n      - export: ServiceMain\n      - function:\n        - or:\n          - api: RegisterServiceCtrlHandler\n          - api: RegisterServiceCtrlHandlerEx\n          - api: StartServiceCtrlDispatcher\n          - api: System.ServiceProcess.ServiceBase::Run\n"
                                           },
                                           {
                                               "id":  "stealth_network",
                                               "name":  "stealth_network",
                                               "description":  "Network activity detected but not expressed in monitor API logs",
                                               "match_data":  [
                                                                  "{\"ip\": \"13.64.180.106\"}",
                                                                  "{\"ip\": \"204.79.197.203\"}",
                                                                  "{\"ip\": \"192.229.211.108\"}",
                                                                  "{\"ip\": \"40.126.28.23\"}",
                                                                  "{\"ip\": \"23.79.187.180\"}",
                                                                  "{\"ip\": \"199.232.214.172\"}",
                                                                  "{\"ip\": \"23.215.55.141\"}",
                                                                  "{\"ip\": \"20.211.142.183\"}",
                                                                  "{\"domain\": \"slscr.update.microsoft.com\"}",
                                                                  "{\"domain\": \"glb.sls.prod.dcat.dsp.trafficmanager.net\"}",
                                                                  "{\"domain\": \"settings-win.data.microsoft.com\"}",
                                                                  "{\"domain\": \"settings-prod-ause-1.australiaeast.cloudapp.azure.com\"}",
                                                                  "{\"domain\": \"s-part-0010.t-0009.t-msedge.net\"}",
                                                                  "{\"domain\": \"wpad.hostonly\"}",
                                                                  "{\"domain\": \"www.msftconnecttest.com\"}",
                                                                  "{\"domain\": \"ctldl.windowsupdate.com\"}",
                                                                  "{\"domain\": \"_ldap._tcp.dc._msdcs.WORKGROUP.hostonly\"}",
                                                                  "{\"domain\": \"cdn.onenote.net\"}",
                                                                  "{\"domain\": \"login.live.com\"}",
                                                                  "{\"domain\": \"ocsp.digicert.com\"}",
                                                                  "{\"domain\": \"api.msn.com\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "antidebug_setunhandledexceptionfilter",
                                               "name":  "antidebug_setunhandledexceptionfilter",
                                               "description":  "SetUnhandledExceptionFilter detected (possible anti-debug)",
                                               "match_data":  [
                                                                  "{\"type\": \"call\", \"pid\": 4044, \"cid\": 20}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "stealth_timeout",
                                               "name":  "stealth_timeout",
                                               "description":  "Possible date expiration check, exits too soon after checking local time",
                                               "match_data":  [
                                                                  "{\"process\": \"program.exe, PID 4044\"}",
                                                                  "{\"type\": \"call\", \"pid\": 4044, \"cid\": 41}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "network_http",
                                               "name":  "network_http",
                                               "description":  "Performs some HTTP requests",
                                               "match_data":  [
                                                                  "{\"url\": \"http://www.msftconnecttest.com/connecttest.txt\"}",
                                                                  "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBSAUQYBMq2awn1Rh6Doh%2FsBYgFV7gQUA95QNVbRTLtm8KPiGxvDl7I90VUCEAJ0LqoXyo4hxxe7H%2Fz9DKA%3D\"}",
                                                                  "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBQ50otx%2Fh0Ztl%2Bz8SiPI7wEWVxDlQQUTiJUIBiV5uNu5g%2F6%2BrkS7QYXjzkCEA77flR%2B3w%2FxBpruV2lte6A%3D\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "procmem_yara",
                                               "name":  "procmem_yara",
                                               "description":  "Yara detections observed in process dumps, payloads or dropped files",
                                               "match_data":  [
                                                                  "{\"Hit\": \"PID 4044 trigged the Yara rule \u0027shellcode_get_eip\u0027 with data \u0027[\u0027{ E8 00 00 00 00 58 }\u0027]\u0027\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           },
                                           {
                                               "id":  "211",
                                               "description":  "Queries a list of all running processes",
                                               "match_data":  [
                                                                  "ProcessInformation"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "418",
                                               "description":  "Submission file is bigger than most known malware samples",
                                               "match_data":  [
                                                                  "File size 1611776 \u003e 1048576"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "9028",
                                               "description":  "Uses 32bit PE files",
                                               "match_data":  [
                                                                  "EXECUTABLE_IMAGE, 32BIT_MACHINE"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "1778",
                                               "description":  "Initial sample is implementing a service and should be registered / started as service",
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "415",
                                               "description":  "PE file has an executable .text section and no other executable section",
                                               "match_data":  [
                                                                  "Section: .text IMAGE_SCN_CNT_CODE, IMAGE_SCN_MEM_EXECUTE, IMAGE_SCN_MEM_READ"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "509",
                                               "description":  "Reads software policies",
                                               "match_data":  [
                                                                  "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#registry_keys_opened",
                                                                "value":  "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "287",
                                               "description":  "Yara signature match",
                                               "match_data":  [
                                                                  "EldoS_RawDisk date = 2016-12-01, hash2 = 394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b, author = Florian Roth (with Binar.ly), description = EldoS Rawdisk Device Driver (Commercial ",
                                                                  "StoneDrill_ntssrvr32 date = 2017-03-07, hash1 = 394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b, author = Florian Roth, description = Detects malware from StoneDrill threat report, re"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "229",
                                               "description":  "Spawns processes",
                                               "match_data":  [
                                                                  "C:\\Windows\\SysWOW64\\cmd.exe cmd /c sc create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" \u003e\u003e C:\\servicereg.log 2\u003e\u00261",
                                                                  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                                                  "C:\\Windows\\SysWOW64\\sc.exe sc  create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" ",
                                                                  "C:\\Windows\\SysWOW64\\cmd.exe cmd /c sc start WvNwh \u003e\u003e C:\\servicestart.log 2\u003e\u00261",
                                                                  "C:\\Windows\\SysWOW64\\sc.exe sc  start WvNwh",
                                                                  "C:\\Users\\user\\Desktop\\file.exe C:\\Users\\user\\Desktop\\file.exe"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "317",
                                               "description":  "PE file contains an invalid checksum",
                                               "match_data":  [
                                                                  "real checksum: 0x33900 should be: 0x193def"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "406",
                                               "description":  "Contains modern PE file flags such as dynamic base (ASLR) or NX",
                                               "match_data":  [
                                                                  "DYNAMIC_BASE, NX_COMPAT, TERMINAL_SERVER_AWARE"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "187",
                                               "description":  "Tries to load missing DLLs",
                                               "match_data":  [
                                                                  "apphelp.dll",
                                                                  "version.dll",
                                                                  "netapi32.dll",
                                                                  "netutils.dll",
                                                                  "srvcli.dll",
                                                                  "wkscli.dll",
                                                                  "schedcli.dll"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "307",
                                               "description":  "May sleep (evasive loops) to hinder dynamic analysis",
                                               "match_data":  [
                                                                  "61 \u003e 30",
                                                                  "-61000s \u003e= -30000s",
                                                                  "35 \u003e 30",
                                                                  "-35000s \u003e= -30000s"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "-1243116986",
                                               "description":  "Sigma detected: New Service Creation Using Sc.EXE",
                                               "match_data":  [
                                                                  "Data: Command: sc create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" , CommandLine: sc create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" , CommandLine|base64offset|contains: , Image: C:\\Windo"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "95",
                                               "description":  "Creates mutexes",
                                               "match_data":  [
                                                                  "\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:6128:120:WilError_03",
                                                                  "\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:6000:120:WilError_03"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "-30932083",
                                               "description":  "Sigma detected: Suspicious New Service Creation",
                                               "match_data":  [
                                                                  "Data: Command: sc create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" , CommandLine: sc create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" , CommandLine|base64offset|contains: , Image: C:\\Windo"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "416",
                                               "description":  "PE file contains a valid data directory to section mapping",
                                               "match_data":  [
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_IMPORT is in: .rdata",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_RESOURCE is in: .rsrc",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_BASERELOC is in: .reloc",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG is in: .rdata",
                                                                  "Data directory: IMAGE_DIRECTORY_ENTRY_IAT is in: .rdata"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "7037",
                                               "description":  "Malicious sample detected (through community Yara rule)",
                                               "match_data":  [
                                                                  "EldoS Rawdisk Device Driver (Commercial raw disk access driver - used in Operation Shamoon 2.0) Author: Florian Roth (with Binar.ly)",
                                                                  "Detects malware from StoneDrill threat report Author: Florian Roth"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_HIGH"
                                           },
                                           {
                                               "id":  "871",
                                               "description":  "Sample execution stops while process was sleeping (likely an evasion)",
                                               "match_data":  [
                                                                  "Thread delayed"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "236",
                                               "description":  "Creates temporary files",
                                               "match_data":  [
                                                                  "c:\\windows\\temp\\key8854321.pub"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "7052",
                                               "description":  "Submitted sample is a known malware sample",
                                               "match_data":  [
                                                                  "MD5: 41f8cd9ac3fb6b1771177e5770537518 Family: Shamoon 3 Description: Shamoon 3, discovered by PaloAlto, shares a considerable amount of code with the Disttrack malware used in the Shamoon 2 attacks. I"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           },
                                           {
                                               "id":  "715",
                                               "description":  "Classification label",
                                               "match_data":  [
                                                                  "mal52.winEXE@9/3@0/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "381",
                                               "description":  "Disables application error messsages (SetErrorMode)",
                                               "match_data":  [
                                                                  "NOOPENFILEERRORBOX"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "626",
                                               "description":  "Sample tries to load a library which is not present or installed on the analysis machine, adding the library might reveal more behavior",
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "256",
                                               "description":  "Uses sc.exe to modify the status of services",
                                               "match_data":  [
                                                                  "C:\\Windows\\SysWOW64\\sc.exe sc  create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" "
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "1318",
                                               "description":  "Creates a process in suspended mode (likely to inject code)",
                                               "match_data":  [
                                                                  "C:\\Windows\\SysWOW64\\sc.exe sc  create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" ",
                                                                  "C:\\Windows\\SysWOW64\\sc.exe sc  start WvNwh"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "311543720",
                                               "description":  "Sigma detected: Publisher Attachment File Dropped In Suspicious Location",
                                               "match_data":  [
                                                                  "Data: EventID: 11, Image: C:\\Users\\user\\Desktop\\file.exe, ProcessId: 5224, TargetFilename: c:\\windows\\temp\\key8854321.pub"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "410",
                                               "description":  "PE file has a big raw section",
                                               "match_data":  [
                                                                  "Raw size of .rsrc is bigger than: 0x100000 \u003c 0x15ac00"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           }
                                       ],
                 "text_highlighted":  [
                                          "7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe"
                                      ],
                 "modules_loaded":  [
                                        "${SamplePath}\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe",
                                        "C:\\Windows\\System32\\ntdll.dll",
                                        "C:\\Windows\\SysWOW64\\ntdll.dll",
                                        "C:\\Windows\\System32\\wow64.dll",
                                        "C:\\Windows\\System32\\wow64win.dll",
                                        "C:\\Windows\\System32\\wow64cpu.dll",
                                        "C:\\Windows\\System32\\kernel32.dll",
                                        "C:\\Windows\\SysWOW64\\kernel32.dll",
                                        "C:\\Windows\\System32\\user32.dll",
                                        "C:\\Windows\\SysWOW64\\KernelBase.dll",
                                        "C:\\Windows\\SysWOW64\\version.dll",
                                        "C:\\Windows\\SysWOW64\\msvcrt.dll",
                                        "C:\\Windows\\SysWOW64\\netapi32.dll",
                                        "C:\\Windows\\SysWOW64\\netutils.dll",
                                        "C:\\Windows\\SysWOW64\\srvcli.dll",
                                        "C:\\Windows\\SysWOW64\\rpcrt4.dll",
                                        "C:\\Windows\\SysWOW64\\sspicli.dll",
                                        "C:\\Windows\\SysWOW64\\cryptbase.dll",
                                        "C:\\Windows\\SysWOW64\\sechost.dll",
                                        "C:\\Windows\\SysWOW64\\wkscli.dll",
                                        "C:\\Windows\\SysWOW64\\schedcli.dll",
                                        "C:\\Windows\\SysWOW64\\ws2_32.dll",
                                        "C:\\Windows\\SysWOW64\\nsi.dll",
                                        "C:\\Windows\\SysWOW64\\user32.dll",
                                        "C:\\Windows\\SysWOW64\\gdi32.dll",
                                        "C:\\Windows\\SysWOW64\\lpk.dll",
                                        "C:\\Windows\\SysWOW64\\usp10.dll",
                                        "C:\\Windows\\SysWOW64\\advapi32.dll",
                                        "C:\\Windows\\SysWOW64\\shell32.dll",
                                        "C:\\Windows\\SysWOW64\\shlwapi.dll",
                                        "C:\\Windows\\SysWOW64\\imm32.dll",
                                        "C:\\Windows\\SysWOW64\\msctf.dll",
                                        "C:\\Windows\\SysWOW64\\ole32.dll",
                                        "C:\\Windows\\winsxs\\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.24203_none_5c030043a0118fbf\\GdiPlus.dll",
                                        "C:\\Windows\\SysWOW64\\dbghelp.dll",
                                        "C:\\Windows\\SysWOW64\\psapi.dll",
                                        "C:\\Windows\\SysWOW64\\oleaut32.dll",
                                        "C:\\Windows\\SysWOW64\\setupapi.dll",
                                        "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                                        "C:\\Windows\\SysWOW64\\devobj.dll",
                                        "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                                        "C:\\Windows\\SysWOW64\\winnsi.dll",
                                        "C:\\Windows\\SysWOW64\\api-ms-win-core-synch-l1-2-0.DLL",
                                        "C:\\Windows\\SysWOW64\\logoncli.dll",
                                        "C:\\Windows\\SysWOW64\\samcli.dll",
                                        "C:\\Windows\\SysWOW64\\imagehlp.dll",
                                        "c:\\windows\\system32\\user32.dll",
                                        "c:\\windows\\system32\\imm32.dll",
                                        "c:\\windows\\system32\\shell32.dll",
                                        "c:\\windows\\system32\\ntdll.dll",
                                        "c:\\windows\\system32\\shlwapi.dll",
                                        "c:\\windows\\system32\\secur32.dll",
                                        "c:\\windows\\system32\\comctl32.dll",
                                        "c:\\windows\\system32\\advapi32.dll",
                                        "c:\\windows\\system32\\netapi32.dll",
                                        "c:\\windows\\system32\\msvcrt.dll",
                                        "c:\\windows\\system32\\ws2_32.dll",
                                        "c:\\windows\\system32\\gdi32.dll",
                                        "c:\\windows\\system32\\ws2help.dll",
                                        "c:\\windows\\system32\\version.dll",
                                        "c:\\windows\\system32\\kernel32.dll",
                                        "c:\\windows\\winsxs\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.2600.5512_x-ww_35d4ce83\\comctl32.dll",
                                        "c:\\windows\\system32\\rpcrt4.dll",
                                        "%SAMPLEPATH%\\.exe",
                                        "%SAMPLEPATH%\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe",
                                        "comctl32.dll",
                                        "imm32.dll",
                                        "rpcrt4.dll"
                                    ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "a83f:8110:99b:ffff:7d:d8d0:f8:ffff",
                                        "destination_port":  53,
                                        "transport_layer_protocol":  "UDP"
                                    },
                                    {
                                        "destination_ip":  "20.69.140.28",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.229.211.108",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.216.147.76",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.184.37",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.168.0.49",
                                        "destination_port":  137,
                                        "transport_layer_protocol":  "UDP"
                                    },
                                    {
                                        "destination_ip":  "20.99.186.246",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.6.103.183",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.216.81.152",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.185.48",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "memory_dumps":  [
                                      {
                                          "file_name":  "4044.dmp",
                                          "process":  "C:\\Users\\Bruno\\Desktop\\program.exe",
                                          "size":  "37789696",
                                          "base_address":  "4259840"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932266850.0000000000BE1000.00000020.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "122880",
                                          "base_address":  "12455936",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984304126.000000000018F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "1634304",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933404906.0000000001063000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "8192",
                                          "base_address":  "17182720",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1995875508.0000000000A9D000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "12288",
                                          "base_address":  "11128832",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984421408.0000000000418000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "28672",
                                          "base_address":  "4292608",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1995989640.0000000000B8F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "12120064",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932223153.0000000000BE0000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "12451840",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1996361943.0000000003118000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "28672",
                                          "base_address":  "51478528",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1995828780.0000000000A20000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "10616832",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984082966.000000000009D000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "12288",
                                          "base_address":  "643072",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932926530.0000000000E40000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "14942208",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984546276.000000000061E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "8192",
                                          "base_address":  "6414336",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984421408.0000000000410000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "24576",
                                          "base_address":  "4259840",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933404906.0000000001061000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "17174528",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933335296.000000000102D000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "16961536",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933892760.00000000016D0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "188416",
                                          "base_address":  "23920640",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933108889.0000000000F9D000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "16371712",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932486119.0000000000C0B000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "12627968",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1996211757.0000000000BFE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "8192",
                                          "base_address":  "12574720",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984657783.0000000000740000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "20480",
                                          "base_address":  "7602176",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932332926.0000000000BFF000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "28672",
                                          "base_address":  "12578816",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1996361943.0000000003110000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "24576",
                                          "base_address":  "51445760",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932979627.0000000000E50000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "16384",
                                          "base_address":  "15007744",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932421932.0000000000C06000.00000004.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "8192",
                                          "base_address":  "12607488",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932486119.0000000000C08000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "12615680",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932179309.0000000000BD0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "12386304",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933058752.0000000000F5F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "16117760",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000000.1994057959.0000000000BE0000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "12451840",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000006.00000000.1994314938.0000000000CE3000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "573440",
                                          "base_address":  "13512704",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932613139.0000000000C12000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "851968",
                                          "base_address":  "12656640",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000003.2600246942.00000000016D1000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "65536",
                                          "base_address":  "23924736",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000006.00000000.1994145200.0000000000BFF000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "28672",
                                          "base_address":  "12578816",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933404906.0000000001040000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "28672",
                                          "base_address":  "17039360",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932581160.0000000000C0E000.00000004.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "12640256",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000000.1994184582.0000000000C06000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "12607488",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933404906.000000000104D000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "77824",
                                          "base_address":  "17092608",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984015901.0000000000020000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "131072",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932115663.000000000078E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "8192",
                                          "base_address":  "7921664",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984185031.00000000000DE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "8192",
                                          "base_address":  "909312",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933838688.00000000016CD000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "23908352",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1996451754.00000000033C0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "20480",
                                          "base_address":  "54263808",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2931946805.00000000006A0000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "6946816",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000003.2600290407.0000000000E54000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "15024128",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1996267302.0000000000F0F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "15790080",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000003.2600390466.0000000000FF0000.00000004.00000800.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "135168",
                                          "base_address":  "16711680",
                                          "stage":  "MEM_STAGE_FREE"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1983940493.0000000000010000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "65536",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2934008024.00000000018CF000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "26013696",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1995797830.0000000000A10000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "10551296",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000000.1994090947.0000000000BE1000.00000020.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "122880",
                                          "base_address":  "12455936",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933162986.0000000000FA6000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "16384",
                                          "base_address":  "16408576",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000000.1994184582.0000000000C0B000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "16384",
                                          "base_address":  "12627968",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1996089064.0000000000BB0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "20480",
                                          "base_address":  "12255232",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933404906.0000000001049000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "17076224",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932613139.0000000000CE3000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "573440",
                                          "base_address":  "13512704",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984243053.000000000014E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "8192",
                                          "base_address":  "1368064",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000000.1994314938.0000000000C12000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "851968",
                                          "base_address":  "12656640",
                                          "stage":  "MEM_STAGE_NEW"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1995913112.0000000000ADD000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "12288",
                                          "base_address":  "11390976",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932152219.0000000000AFD000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "12288",
                                          "base_address":  "11522048",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932065787.000000000072C000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "16384",
                                          "base_address":  "7520256",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2932015101.00000000006B0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "7012352",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933162986.0000000000FA0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "16384",
                                          "base_address":  "16384000",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000005.00000002.1995951222.0000000000B4E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "8192",
                                          "base_address":  "11853824",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984365781.00000000001C0000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "20480",
                                          "base_address":  "1835008",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000002.00000002.1984608945.000000000065F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Windows\\SysWOW64\\sc.exe",
                                          "size":  "4096",
                                          "base_address":  "6680576",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933256004.0000000000FEE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "8192",
                                          "base_address":  "16703488",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "00000006.00000002.2933759337.000000000123F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\file.exe",
                                          "size":  "4096",
                                          "base_address":  "19132416",
                                          "stage":  "MEM_STAGE_EXIT"
                                      }
                                  ],
                 "files_opened":  [
                                      "C:\\Program Files\\Google\\Policies",
                                      "C:\\Program Files\\Google\\Temp\\GUMC927.tmp",
                                      "C:\\Program Files\\Google\\Temp\\GUMF047.tmp",
                                      "\\??\\PIPE\\wkssvc",
                                      "\\??\\pipe\\GoogleCrashServices\\S-1-5-18",
                                      "\\??\\{D5CD48D7-B0F7-4C10-89F8-4DF45C40E31E}",
                                      "C:\\Program Files\\Google\\Temp\\GUM2B7C.tmp",
                                      "C:\\Program Files\\Google\\Temp\\GUM46B.tmp",
                                      "C:\\WINDOWS\\system32\\winime32.dll",
                                      "C:\\WINDOWS\\system32\\ws2_32.dll",
                                      "C:\\WINDOWS\\system32\\ws2help.dll",
                                      "C:\\WINDOWS\\system32\\psapi.dll",
                                      "C:\\WINDOWS\\system32\\imm32.dll",
                                      "C:\\WINDOWS\\system32\\lpk.dll",
                                      "C:\\WINDOWS\\system32\\usp10.dll",
                                      "C:\\WINDOWS\\system32\\shell32.dll",
                                      "C:\\WINDOWS\\WinSxS\\x86_Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0.2600.5512_x-ww_35d4ce83\\comctl32.dll",
                                      "C:\\WINDOWS\\WindowsShell.Manifest",
                                      "C:\\WINDOWS\\system32\\comctl32.dll",
                                      "\\\\.\\pipe\\net\\NtControlPipe10",
                                      "C:\\Program Files (x86)\\AutoIt3\\",
                                      "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                                      "C:\\Users\\user\\Desktop\\file.exe",
                                      "C:\\Users\\user\\SystemResources\\file.exe.mun",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\SYSTEM32\\TextShaping.dll",
                                      "C:\\Windows\\SYSTEM32\\cmd.exe",
                                      "C:\\Windows\\SYSTEM32\\dwmapi.dll",
                                      "C:\\Windows\\SYSTEM32\\en-US\\cmd.exe.mui",
                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                      "C:\\Windows\\SysWOW64\\",
                                      "C:\\Windows\\SysWOW64\\ADVAPI32.dll",
                                      "C:\\Windows\\SysWOW64\\GDI32.dll",
                                      "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                                      "C:\\Windows\\SysWOW64\\NETAPI32.dll",
                                      "C:\\Windows\\SysWOW64\\NETUTILS.DLL",
                                      "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                                      "C:\\Windows\\SysWOW64\\SCHEDCLI.DLL",
                                      "C:\\Windows\\SysWOW64\\SHELL32.dll",
                                      "C:\\Windows\\SysWOW64\\SRVCLI.DLL",
                                      "C:\\Windows\\SysWOW64\\USER32.dll",
                                      "C:\\Windows\\SysWOW64\\VERSION.dll",
                                      "C:\\Windows\\SysWOW64\\WKSCLI.DLL",
                                      "C:\\Windows\\SysWOW64\\WS2_32.dll",
                                      "C:\\Windows\\SysWOW64\\apphelp.dll",
                                      "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                                      "C:\\Windows\\SysWOW64\\en-US\\sc.exe.mui",
                                      "C:\\Windows\\SysWOW64\\gdi32full.dll",
                                      "C:\\Windows\\SysWOW64\\msvcp_win.dll",
                                      "C:\\Windows\\SysWOW64\\msvcrt.dll",
                                      "C:\\Windows\\SysWOW64\\ntdll.dll",
                                      "C:\\Windows\\SysWOW64\\sechost.dll",
                                      "C:\\Windows\\SysWOW64\\ucrtbase.dll",
                                      "C:\\Windows\\SysWOW64\\win32u.dll",
                                      "C:\\Windows\\System32\\SystemResources\\cmd.exe.mui.mun",
                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                      "C:\\Windows\\SystemResources\\cmd.exe.mun",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.19041.1110_none_60b5254171f9507e",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.19041.1110_none_60b5254171f9507e\\comctl32.DLL",
                                      "C:\\Windows\\system32\\IMM32.DLL",
                                      "C:\\Windows\\system32\\conhost.exe",
                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                      "C:\\Windows\\system32\\uxtheme.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll.Config",
                                      "C:\\inf\\uv87m.pnf",
                                      "C:\\servicereg.log",
                                      "C:\\servicestart.log",
                                      "C:\\system32\\_mvscdsc.exe",
                                      "C:\\system32\\_s3wcap32.exe",
                                      "C:\\system32\\briaw00a.exe",
                                      "C:\\system32\\caiaw00a.exe",
                                      "C:\\system32\\caiaw00d.exe",
                                      "C:\\system32\\caiaw00f.exe",
                                      "C:\\system32\\cniaw001.exe",
                                      "C:\\system32\\hdvmp32.exe",
                                      "C:\\system32\\hpiaw001.exe",
                                      "C:\\system32\\kyiaw002.exe",
                                      "C:\\system32\\lxiaw004.exe",
                                      "C:\\system32\\lxiaw006.exe",
                                      "C:\\system32\\newtvsc.exe",
                                      "C:\\system32\\pdwmtphw.exe",
                                      "C:\\system32\\saiaw002.exe",
                                      "C:\\system32\\sdwprint.exe",
                                      "C:\\system32\\sdwscdrv.exe",
                                      "\\Device\\ConDrv\\Server",
                                      "\\Device\\ConDrv\\\\Input",
                                      "\\Device\\ConDrv\\\\Output",
                                      "\\Device\\ConDrv\\\\Reference"
                                  ],
                 "mutexes_created":  [
                                         "Global\\G{C4F406E5-F024-4e3f-89A7-D5AB7663C3CD}",
                                         "\\Sessions\\1\\BaseNamedObjects\\Local\\SessionImmersiveColorMutex"
                                     ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "4044",
                                            "name":  "\"C:\\Users\\\u003cUSER\u003e\\Desktop\\program.exe\""
                                        },
                                        {
                                            "process_id":  "1304",
                                            "name":  "\"${SamplePath}\\7b589d45825c096d42bdf341193d3fd8fd9a0bd612a6ebd7466c26a753304df9.exe\" "
                                        },
                                        {
                                            "process_id":  "1316",
                                            "name":  "C:\\DOCUME~1\\Miller\\LOCALS~1\\Temp\\oilrig.exe"
                                        },
                                        {
                                            "process_id":  "904",
                                            "name":  "C:\\DOCUME~1\\Miller\\LOCALS~1\\Temp\\oilrig.exe"
                                        },
                                        {
                                            "process_id":  "2816",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1152",
                                                                 "name":  "%SAMPLEPATH%\\.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "620",
                                            "name":  "C:\\Windows\\System32\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "4060",
                                                                 "name":  "C:\\Windows\\System32\\wuapihost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "124",
                                            "name":  "****.exe"
                                        },
                                        {
                                            "process_id":  "5992",
                                            "name":  "C:\\Windows\\SysWOW64\\cmd.exe cmd /c sc create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" \u003e\u003e C:\\servicereg.log 2\u003e\u00261",
                                            "children":  [
                                                             {
                                                                 "process_id":  "6000",
                                                                 "name":  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                                                 "files_opened":  [
                                                                                      "C:\\Windows\\SYSTEM32\\TextShaping.dll",
                                                                                      "C:\\Windows\\SYSTEM32\\cmd.exe",
                                                                                      "C:\\Windows\\SYSTEM32\\dwmapi.dll",
                                                                                      "C:\\Windows\\SYSTEM32\\en-US\\cmd.exe.mui",
                                                                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                                                                      "C:\\Windows\\System32\\SystemResources\\cmd.exe.mui.mun",
                                                                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                                                                      "C:\\Windows\\SystemResources\\cmd.exe.mun",
                                                                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.19041.1110_none_60b5254171f9507e",
                                                                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.19041.1110_none_60b5254171f9507e\\comctl32.DLL",
                                                                                      "C:\\Windows\\system32\\IMM32.DLL",
                                                                                      "C:\\Windows\\system32\\conhost.exe",
                                                                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                                                                      "C:\\Windows\\system32\\uxtheme.dll",
                                                                                      "C:\\Windows\\system32\\uxtheme.dll.Config"
                                                                                  ]
                                                             },
                                                             {
                                                                 "process_id":  "6036",
                                                                 "name":  "C:\\Windows\\SysWOW64\\sc.exe sc  create WvNwh binpath= \"C:\\Users\\user\\Desktop\\file.exe\" ",
                                                                 "files_opened":  [
                                                                                      "C:\\Windows\\SysWOW64\\en-US\\sc.exe.mui"
                                                                                  ],
                                                                 "files_written":  [
                                                                                       "C:\\servicereg.log",
                                                                                       "\\Device\\ConDrv\\\\Connect"
                                                                                   ]
                                                             }
                                                         ],
                                            "files_opened":  [
                                                                 "C:\\Program Files (x86)\\AutoIt3\\",
                                                                 "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                                                                 "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                                                 "C:\\Windows\\SysWOW64\\",
                                                                 "C:\\servicereg.log",
                                                                 "\\Device\\ConDrv\\Server",
                                                                 "\\Device\\ConDrv\\\\Input",
                                                                 "\\Device\\ConDrv\\\\Output",
                                                                 "\\Device\\ConDrv\\\\Reference"
                                                             ],
                                            "files_written":  [
                                                                  "C:\\servicereg.log",
                                                                  "\\Device\\ConDrv\\\\Connect"
                                                              ]
                                        },
                                        {
                                            "process_id":  "6120",
                                            "name":  "C:\\Windows\\SysWOW64\\cmd.exe cmd /c sc start WvNwh \u003e\u003e C:\\servicestart.log 2\u003e\u00261",
                                            "children":  [
                                                             {
                                                                 "process_id":  "6128",
                                                                 "name":  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
                                                             },
                                                             {
                                                                 "process_id":  "5184",
                                                                 "name":  "C:\\Windows\\SysWOW64\\sc.exe sc  start WvNwh",
                                                                 "files_written":  [
                                                                                       "C:\\servicestart.log",
                                                                                       "\\Device\\ConDrv\\\\Connect"
                                                                                   ]
                                                             }
                                                         ],
                                            "files_opened":  [
                                                                 "C:\\servicestart.log"
                                                             ],
                                            "files_written":  [
                                                                  "C:\\servicestart.log",
                                                                  "\\Device\\ConDrv\\\\Connect"
                                                              ]
                                        },
                                        {
                                            "process_id":  "5224",
                                            "name":  "C:\\Users\\user\\Desktop\\file.exe",
                                            "files_opened":  [
                                                                 "C:\\Users\\user\\Desktop\\file.exe",
                                                                 "C:\\Users\\user\\SystemResources\\file.exe.mun",
                                                                 "C:\\Windows\\AppPatch\\sysmain.sdb",
                                                                 "C:\\Windows\\SysWOW64\\ADVAPI32.dll",
                                                                 "C:\\Windows\\SysWOW64\\GDI32.dll",
                                                                 "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                                                                 "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                                                                 "C:\\Windows\\SysWOW64\\NETAPI32.dll",
                                                                 "C:\\Windows\\SysWOW64\\NETUTILS.DLL",
                                                                 "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                                                                 "C:\\Windows\\SysWOW64\\SCHEDCLI.DLL",
                                                                 "C:\\Windows\\SysWOW64\\SHELL32.dll",
                                                                 "C:\\Windows\\SysWOW64\\SRVCLI.DLL",
                                                                 "C:\\Windows\\SysWOW64\\USER32.dll",
                                                                 "C:\\Windows\\SysWOW64\\VERSION.dll",
                                                                 "C:\\Windows\\SysWOW64\\WKSCLI.DLL",
                                                                 "C:\\Windows\\SysWOW64\\WS2_32.dll",
                                                                 "C:\\Windows\\SysWOW64\\apphelp.dll",
                                                                 "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                                                                 "C:\\Windows\\SysWOW64\\gdi32full.dll",
                                                                 "C:\\Windows\\SysWOW64\\msvcp_win.dll",
                                                                 "C:\\Windows\\SysWOW64\\msvcrt.dll",
                                                                 "C:\\Windows\\SysWOW64\\ntdll.dll",
                                                                 "C:\\Windows\\SysWOW64\\sechost.dll",
                                                                 "C:\\Windows\\SysWOW64\\ucrtbase.dll",
                                                                 "C:\\Windows\\SysWOW64\\win32u.dll",
                                                                 "C:\\inf\\uv87m.pnf",
                                                                 "C:\\system32\\_mvscdsc.exe",
                                                                 "C:\\system32\\_s3wcap32.exe",
                                                                 "C:\\system32\\briaw00a.exe",
                                                                 "C:\\system32\\caiaw00a.exe",
                                                                 "C:\\system32\\caiaw00d.exe",
                                                                 "C:\\system32\\caiaw00f.exe",
                                                                 "C:\\system32\\cniaw001.exe",
                                                                 "C:\\system32\\hdvmp32.exe",
                                                                 "C:\\system32\\hpiaw001.exe",
                                                                 "C:\\system32\\kyiaw002.exe",
                                                                 "C:\\system32\\lxiaw004.exe",
                                                                 "C:\\system32\\lxiaw006.exe",
                                                                 "C:\\system32\\newtvsc.exe",
                                                                 "C:\\system32\\pdwmtphw.exe",
                                                                 "C:\\system32\\saiaw002.exe",
                                                                 "C:\\system32\\sdwprint.exe",
                                                                 "C:\\system32\\sdwscdrv.exe"
                                                             ],
                                            "files_written":  [
                                                                  "C:\\Windows\\Temp\\key8854321.pub",
                                                                  "c:\\windows\\temp\\key8854321.pub"
                                                              ]
                                        }
                                    ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "access PEB ldr_data",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "access PEB ldr_data"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link many functions at runtime",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link many functions at runtime"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encode data using XOR"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference Base64 string",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "reference Base64 string"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1222":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "set file attributes",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "set file attributes"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1027.005":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "contain obfuscated stackstrings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "contain obfuscated stackstrings"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1057":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get process heap flags",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get process heap flags"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate processes",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "enumerate processes"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Queries a list of all running processes",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "211"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1518":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate processes",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "enumerate processes"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get file size",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get file size"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get common file path",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get common file path"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get file version info",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get file version info"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1059":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "accept command line arguments",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "accept command line arguments"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1134.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "impersonate user",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "impersonate user"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1543.003":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "persist via Windows service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "persist via Windows service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "start service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "start service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "create service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "create service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "modify service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "modify service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Uses sc.exe to modify the status of services",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "256"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1569.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "persist via Windows service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "persist via Windows service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "create service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "create service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "modify service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "modify service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Uses sc.exe to modify the status of services",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "256"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1112":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "delete registry value",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "delete registry value"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1007":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query service status",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query service status"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1012":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query or enumerate registry value",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query or enumerate registry value"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get hostname",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get hostname"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "509"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1497.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "reference anti-VM strings targeting Xen",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "reference anti-VM strings targeting Xen"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                         }
                                                     ],
                                           "T1574.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Tries to load missing DLLs",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "187"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1497":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "May sleep (evasive loops) to hinder dynamic analysis",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "307"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
