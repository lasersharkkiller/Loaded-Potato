{
    "data":  {
                 "registry_keys_set":  [
                                           {
                                               "key":  "\u003cHKLM\u003e\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache\\Intranet\\\\{6A52BE73-EC8E-4F63-A268-7517A50DCB38}",
                                               "value":  "\\x0a\\x00\\x27\\x00\\x00\\x2c"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-3712457824-2419000099-45725732-1001\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\5.0\\CACHE\\COOKIES",
                                               "value":  "CachePrefix"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-3712457824-2419000099-45725732-1001\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\5.0\\CACHE\\HISTORY",
                                               "value":  "CachePrefix"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-3712457824-2419000099-45725732-1001\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\5.0\\CACHE\\CONTENT",
                                               "value":  "CachePrefix"
                                           }
                                       ],
                 "command_executions":  [
                                            "C:\\Users\\Johnson\\AppData\\Local\\Temp\\rundll32.exe 52b898adaaf2da71c5ad6b3dfd3ecf769918dbfb6b731.dll"
                                        ],
                 "processes_terminated":  [
                                              "%WINDIR%\\syswow64\\regsvr32.exe",
                                              "\u003cSYSTEM32\u003e\\regsvr32.exe"
                                          ],
                 "services_started":  [
                                          "ProtectedStorage",
                                          "VaultSvc"
                                      ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encode data using XOR"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get common file path",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get common file path"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1555.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "gather firefox profile information",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "gather firefox profile information"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get file size",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get file size"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1012",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query or enumerate registry value",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query or enumerate registry value"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query environment variable",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query environment variable"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "check if file exists",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "check if file exists"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate files on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "enumerate files on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "persist via Run registry key",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "persist via Run registry key"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1012",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query or enumerate registry key",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query or enumerate registry key"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1213",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference SQL statements",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference SQL statements"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using RC4 PRGA",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encrypt data using RC4 PRGA"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1555.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "gather chrome based browser login information",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "gather chrome based browser login information"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference Base64 string",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference Base64 string"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1497.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference anti-VM strings",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference anti-VM strings"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "files_opened":  [
                                      "%WINDIR%\\syswow64\\regsvr32.exe",
                                      "\u003cSYSTEM32\u003e\\ntdll.dll",
                                      "%WINDIR%\\syswow64\\ntdll.dll",
                                      "%APPDATA%\\roaming\\thunderbird\\profiles\\wjj9aet2.default\\prefs.js",
                                      "\u003cLS_APPDATA\u003e\\microsoft\\windows\\history\\history.ie5\\index.dat",
                                      "\u003cLS_APPDATA\u003e\\microsoft\\windows\\history\\history.ie5\\mshist012015112320151124\\index.dat",
                                      "\u003cLS_APPDATA\u003e\\microsoft\\windows\\history\\history.ie5\\mshist012016081820160819\\index.dat",
                                      "%APPDATA%\\roaming\\mozilla\\firefox\\profiles.ini",
                                      "%APPDATA%\\roaming\\mozilla\\firefox\\profiles\\gn7ryp3k.default\\secmod.db",
                                      "%APPDATA%\\roaming\\mozilla\\firefox\\profiles\\gn7ryp3k.default\\cert8.db",
                                      "%APPDATA%\\roaming\\mozilla\\firefox\\profiles\\gn7ryp3k.default\\key3.db",
                                      "\u003cLS_APPDATA\u003e\\google\\chrome\\user data\\default\\web data",
                                      "\u003cLS_APPDATA\u003e\\google\\chrome\\user data\\default\\web data-journal",
                                      "\u003cLS_APPDATA\u003e\\google\\chrome\\user data\\default\\login data",
                                      "\u003cLS_APPDATA\u003e\\google\\chrome\\user data\\default\\login data-journal",
                                      "\u003cSYSTEM32\u003e\\microsoft\\protect\\s-1-5-18\\user\\preferred",
                                      "%APPDATA%\\roaming\\microsoft\\protect\\s-1-5-21-1960123792-2022915161-3775307078-1001\\preferred",
                                      "\u003cDRIVERS\u003e\\etc\\hosts"
                                  ],
                 "files_dropped":  [
                                       {
                                           "path":  "%PROGRAMDATA%\\microsoft\\vault\\ac658cb4-9126-49bd-b877-31eedab3f204\\2f1a6504-0641-44cf-8bb5-3612d865f2e5.vsch",
                                           "sha256":  "e3a1b813779d3bfbfa2b0b862208b966eb4068e29c50877ac17383c6da9b68a4"
                                       },
                                       {
                                           "path":  "%PROGRAMDATA%\\microsoft\\vault\\ac658cb4-9126-49bd-b877-31eedab3f204\\3ccd5499-87a8-4b10-a215-608888dd3b55.vsch",
                                           "sha256":  "002bb5a917b093a16cd3ec97dc3aba782a4676d20b1887281e5d0eafa93bdd76"
                                       },
                                       {
                                           "path":  "%PROGRAMDATA%\\microsoft\\vault\\ac658cb4-9126-49bd-b877-31eedab3f204\\policy.vpol",
                                           "sha256":  "4802ac1b138f33b49ff40e21b59bcc152ac463df692a2a4086387826533a8b6b"
                                       },
                                       {
                                           "path":  "\u003cLS_APPDATA\u003e\\microsoft\\vault\\4bf4c442-9b8a-41a0-b380-dd4a704ddb28\\policy.vpol",
                                           "sha256":  "2f1f3d50baffc20701b821962aee4881c081bc3f0cd3429beca992d940427d79"
                                       },
                                       {
                                           "path":  "%APPDATA%\\roaming\\microsoft\\ttmp.log",
                                           "sha256":  "99272052095ddfa70ba86d574745f37bc7bdb53678c6c4727eec6d78fa98811e"
                                       }
                                   ],
                 "modules_loaded":  [
                                        "c:\\windows\\system32\\imm32.dll",
                                        "c:\\windows\\system32\\mpr.dll",
                                        "c:\\windows\\system32\\winmm.dll",
                                        "c:\\program files (x86)\\mozilla firefox\\nss3.dll",
                                        "c:\\windows\\syswow64\\normaliz.dll",
                                        "c:\\windows\\system32\\srvcli.dll",
                                        "c:\\program files (x86)\\mozilla firefox\\nssdbm3.dll",
                                        "c:\\windows\\system32\\msvcp110.dll",
                                        "c:\\windows\\syswow64\\ntdll.dll",
                                        "c:\\windows\\syswow64\\usp10.dll",
                                        "c:\\windows\\syswow64\\iertutil.dll",
                                        "c:\\windows\\system32\\rsaenh.dll",
                                        "c:\\windows\\syswow64\\ws2_32.dll",
                                        "c:\\windows\\system32\\wow64cpu.dll",
                                        "c:\\windows\\syswow64\\sechost.dll",
                                        "c:\\program files (x86)\\mozilla firefox\\msvcp100.dll",
                                        "c:\\windows\\syswow64\\userenv.dll",
                                        "c:\\windows\\syswow64\\psapi.dll",
                                        "c:\\windows\\syswow64\\gdi32.dll",
                                        "c:\\windows\\syswow64\\crypt32.dll",
                                        "c:\\program files (x86)\\mozilla firefox\\msvcr100.dll",
                                        "c:\\windows\\system32\\secur32.dll",
                                        "c:\\windows\\system32\\vaultcli.dll",
                                        "c:\\windows\\syswow64\\rpcrt4.dll",
                                        "c:\\windows\\system32\\wkscli.dll",
                                        "c:\\windows\\apppatch\\aclayers.dll",
                                        "c:\\windows\\system32\\wow64.dll",
                                        "c:\\windows\\syswow64\\oleaut32.dll",
                                        "c:\\windows\\syswow64\\api-ms-win-downlevel-ole32-l1-1-0.dll",
                                        "c:\\windows\\syswow64\\kernelbase.dll",
                                        "c:\\windows\\system32\\cryptsp.dll",
                                        "c:\\windows\\system32\\netapi32.dll",
                                        "c:\\windows\\syswow64\\shlwapi.dll",
                                        "c:\\windows\\syswow64\\wininet.dll",
                                        "c:\\windows\\syswow64\\user32.dll",
                                        "c:\\program files (x86)\\mozilla firefox\\softokn3.dll",
                                        "c:\\windows\\syswow64\\advapi32.dll",
                                        "c:\\windows\\syswow64\\msctf.dll",
                                        "c:\\windows\\system32\\wow64win.dll",
                                        "c:\\windows\\syswow64\\sspicli.dll",
                                        "c:\\windows\\system32\\winspool.drv",
                                        "c:\\windows\\syswow64\\api-ms-win-downlevel-normaliz-l1-1-0.dll",
                                        "c:\\windows\\syswow64\\kernel32.dll",
                                        "c:\\windows\\system32\\version.dll",
                                        "c:\\windows\\system32\\api-ms-win-downlevel-advapi32-l2-1-0.dll",
                                        "c:\\program files (x86)\\mozilla firefox\\freebl3.dll",
                                        "c:\\program files (x86)\\mozilla firefox\\mozglue.dll",
                                        "c:\\windows\\syswow64\\profapi.dll",
                                        "c:\\windows\\syswow64\\api-ms-win-downlevel-shlwapi-l1-1-0.dll",
                                        "c:\\windows\\system32\\ntdll.dll",
                                        "c:\\windows\\syswow64\\cryptbase.dll",
                                        "c:\\users\\johnson\\appdata\\local\\temp\\52b898adaaf2da71c5ad6b3dfd3ecf769918dbfb6b731.dll",
                                        "c:\\windows\\syswow64\\ole32.dll",
                                        "c:\\windows\\syswow64\\nsi.dll",
                                        "c:\\windows\\system32\\msvcr110.dll",
                                        "c:\\windows\\syswow64\\api-ms-win-downlevel-version-l1-1-0.dll",
                                        "c:\\windows\\syswow64\\msasn1.dll",
                                        "c:\\windows\\apppatch\\acwow64.dll",
                                        "c:\\windows\\system32\\wsock32.dll",
                                        "c:\\windows\\syswow64\\api-ms-win-downlevel-advapi32-l1-1-0.dll",
                                        "c:\\windows\\syswow64\\shell32.dll",
                                        "c:\\windows\\system32\\pstorec.dll",
                                        "c:\\windows\\syswow64\\lpk.dll",
                                        "c:\\windows\\system32\\samcli.dll",
                                        "c:\\windows\\system32\\netutils.dll",
                                        "c:\\windows\\syswow64\\api-ms-win-downlevel-user32-l1-1-0.dll",
                                        "c:\\windows\\system32\\atl.dll",
                                        "c:\\windows\\system32\\apphelp.dll",
                                        "c:\\windows\\syswow64\\msvcrt.dll"
                                    ],
                 "processes_created":  [
                                           "\u003cSYSTEM32\u003e\\regsvr32.exe",
                                           "%WINDIR%\\syswow64\\regsvr32.exe",
                                           "C:\\Users\\Johnson\\AppData\\Local\\Temp\\rundll32.exe"
                                       ],
                 "verdicts":  [
                                  "MALWARE",
                                  "TROJAN"
                              ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "calculate modulo 256 via x86 assembly",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file attributes",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create thread",
                                               "description":  "host-interaction/thread/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get common file path",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "copy file",
                                               "description":  "host-interaction/file-system/copy",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: LZCopy\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete file",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read .ini file",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read .ini file\n    namespace: host-interaction/file-system/read\n    authors:\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x401070\n      - E6234FB98F17201C232F4502015B47B3:0x701312FA\n  features:\n    - and:\n      - or:\n        - api: GetPrivateProfileInt\n        - api: GetPrivateProfileString\n        - api: GetPrivateProfileStruct\n        - api: GetPrivateProfileSection\n        - api: GetPrivateProfileSectionNames\n      - optional:\n        - string: /\\.ini/i\n        - api: GetFullPathName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set current directory",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set current directory\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n  features:\n    - or:\n      - api: System.IO.Directory::SetCurrentDirectory\n      - api: kernel32.SetCurrentDirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "gather firefox profile information",
                                               "description":  "collection/browser",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "still@teamt5.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: gather firefox profile information\n    namespace: collection/browser\n    authors:\n      - \"@_re_fox\"\n      - still@teamt5.org\n    scope: function\n    att\u0026ck:\n      - Credential Access::Credentials from Password Stores::Credentials from Web Browsers [T1555.003]\n    examples:\n      - 7204e3efc2434012e13ca939db0d0b02:0x4073c0\n      - 54390bda109aab7fc006b8b4ead5b6c2:0x1006e58b\n  features:\n    - and:\n      - 2 or more:\n        - string: /\\\\Mozilla\\\\Firefox\\\\profiles(\\.ini)?/i\n        - string: /\\\\(signons|cookies)\\.sqlite/i\n        - string: /SELECT\\s+[a-z,\\s]{5,}FROM moz_(logins|cookies)/i\n        - string: /FROM moz_(logins|cookies)/i\n        - substring: \"WHERE moz_cookies.host LIKE\"\n      - optional:\n        - or:\n          - string: \"encryptedUsername\"\n          - string: \"encryptedPassword\"\n          - string: \"usernameField\"\n          - string: \"formSubmitURL\"\n          - string: \"httpRealm\"\n          - string: \"passwordField\"\n          - string: \"timeCreated\"\n          - string: \"timeLastUsed\"\n          - string: \"timePasswordChanged\"\n          - string: \"timesUsed\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file size",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query or enumerate registry value",
                                               "description":  "host-interaction/registry",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate internet cache",
                                               "description":  "host-interaction/internet/cache",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate internet cache\n    namespace: host-interaction/internet/cache\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n  features:\n    - and:\n      - api: wininet.FindFirstUrlCacheEntry\n      - optional:\n        - api: wininet.FindNextUrlCacheEntry\n        - api: wininet.FindCloseUrlCache\n        - match: contain loop\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query environment variable",
                                               "description":  "host-interaction/environment-variable",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check if file exists",
                                               "description":  "host-interaction/file-system/exists",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Windows",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate files on Windows",
                                               "description":  "host-interaction/file-system/files/list",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate files on Windows\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    references:\n      - https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x4011E0\n      - Practical Malware Analysis Lab 20-02.exe_:0x401000\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x14000203C\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.FindFirstFile\n          - api: kernel32.FindFirstFileEx\n          - api: kernel32.FindFirstFileTransacted\n          - api: kernel32.FindFirstFileName\n          - api: kernel32.FindFirstFileNameTransacted\n        - or:\n          - api: kernel32.FindNextFile\n          - api: kernel32.FindNextFileName\n        - optional:\n          - api: kernel32.FindClose\n          - match: contain loop\n      - and:\n        - basic block:\n          - and:\n            - number: 1 = DIRECTORY_QUERY\n            - api: ntdll.NtOpenDirectoryObject\n        - api: ntdll.NtQueryDirectoryObject\n        - optional:\n          - api: RtlAllocateHeap\n          - match: contain loop\n          - characteristic: indirect call\n      - or:\n        - api: System.IO.DirectoryInfo::GetFiles\n        - api: System.IO.DirectoryInfo::EnumerateFiles\n        - api: System.IO.Directory::GetFiles\n        - api: System.IO.Directory::EnumerateFiles\n        - api: System.IO.Directory::EnumerateFileSystemEntries\n        - api: System.IO.DirectoryInfo::GetDirectories\n        - api: System.IO.DirectoryInfo::EnumerateDirectories\n        - api: System.IO.Directory::GetDirectories\n        - api: System.IO.Directory::EnumerateDirectories\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "persist via Run registry key",
                                               "description":  "persistence/registry/run",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: persist via Run registry key\n    namespace: persistence/registry/run\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]\n    mbc:\n      - Persistence::Registry Run Keys / Startup Folder [F0012]\n    examples:\n      - Practical Malware Analysis Lab 06-03.exe_:0x401130\n      - b87e9dd18a5533a09d3e48a7a1efbcf6:0x1400070E0\n      - 9ff8e68343cc29c1036650fc153e69f7:0x470624\n  features:\n    - and:\n      - or:\n        - match: set registry value\n        - number: 0x80000001 = HKEY_CURRENT_USER\n        - number: 0x80000002 = HKEY_LOCAL_MACHINE\n      - or:\n        - and:\n          - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion/i\n          - or:\n            - string: /Run/i\n            - string: /Explorer\\\\Shell Folders/i\n            - string: /User Shell Folders/i\n            - string: /RunServices/i\n            - string: /Policies\\\\Explorer\\\\Run/i\n        - string: /Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\load/i\n        - string: /System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\BootExecute/i\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query or enumerate registry key",
                                               "description":  "host-interaction/registry",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query or enumerate registry key\n    namespace: host-interaction/registry\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Key [C0036.005]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x404930\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402608\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegEnumKey\n        - api: advapi32.RegEnumKeyEx\n        - api: advapi32.RegQueryInfoKeyA\n        - api: ZwQueryKey\n        - api: ZwEnumerateKey\n        - api: NtQueryKey\n        - api: NtEnumerateKey\n        - api: RtlCheckRegistryKey\n        - api: SHEnumKeyEx\n        - api: SHQueryInfoKey\n        - api: SHRegEnumUSKey\n        - api: SHRegQueryInfoUSKey\n        - api: Microsoft.Win32.RegistryKey::GetSubKeyNames\n        - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenSubKey\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "parse credit card information",
                                               "description":  "collection/credit-card",
                                               "authors":  [
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: parse credit card information\n    namespace: collection/credit-card\n    authors:\n      - \"@_re_fox\"\n    scope: function\n    mbc:\n      - Data::Check String [C0019]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x402860\n  features:\n    - and:\n      - 3 or more:\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x5E = \u0027^\u0027 (Track 1 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3D = \u0027=\u0027 (Track 2 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x25 = \u0027%\u0027 (Track 1 start sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x42 = \u0027B\u0027 (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x44 = \u0027D\u0027 (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3F = \u0027?\u0027 (Track 1 \u0026 2 end sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3B = \u0027;\u0027 (Track 2 start sentinel)\n      - not:\n        - description: if a function also compares these non-hex characters it\u0027s most likely NOT parsing CC data\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6D = \u0027m\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6E = \u0027n\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6F = \u0027o\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x70 = \u0027p\u0027\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference SQL statements",
                                               "description":  "collection/database/sql",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference SQL statements\n    namespace: collection/database/sql\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Collection::Data from Information Repositories [T1213]\n    examples:\n      - 5F66B82558CA92E54E77F216EF4C066C:0x42B1DF\n  features:\n    - and:\n      - string: /SELECT.*FROM.*WHERE/\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using RC4 PRGA",
                                               "description":  "data-manipulation/encryption/rc4",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple or too complex (50 is picked by intuition)\n      - count(basic blocks): (4, 50)\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "gather chrome based browser login information",
                                               "description":  "collection/browser",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "still@teamt5.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: gather chrome based browser login information\n    namespace: collection/browser\n    authors:\n      - \"@_re_fox\"\n      - still@teamt5.org\n    scope: file\n    att\u0026ck:\n      - Credential Access::Credentials from Password Stores::Credentials from Web Browsers [T1555.003]\n    examples:\n      - 2fd45662e3d0ec0077ea2fa66b6378f0:0x6000039\n      - 54390bda109aab7fc006b8b4ead5b6c2:0x1006E8D3\n  features:\n    - and:\n      - or:\n        - string: /\\\\+(Edge|Chrome|Chromium|Brave\\-Browser|YandexBrowser|Kometa|Orbitum|Dragon|Torch|Amigo)\\\\+User Data\\\\+Default(\\\\+Network)?\\\\+(Cookies|Login Data)/i\n        - string: /\\\\Opera Software\\\\Opera Stable\\\\(Login Data|Cookies)/i\n      - or:\n        - string: /SELECT ((date_created|username_element|password_element|origin_url|signon_realm|action_url|username_value|password_value),?\\s?)+ FROM logins/i\n        - string: /SELECT ((creation_utc|encrypted_value),?\\s?)+ FROM cookies/i\n        - 2 or more:\n          - substring: \"date_created\"\n          - substring: \"encrypted_value\"\n          - substring: \"creation_utc\"\n          - substring: \"username_element\"\n          - substring: \"username_value\"\n          - substring: \"password_element\"\n          - substring: \"origin_url\"\n          - substring: \"signon_realm\"\n          - substring: \"action_url\"\n          - substring: \"password_value\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference Base64 string",
                                               "description":  "data-manipulation/encoding/base64",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference Base64 string\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Data::Encode Data::Base64 [C0026.001]\n      - Data::Check String [C0019]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5\n      - 074072B261FC27B65C72671F13510C05\n      - 5DB2D2BE20D59AA0BE6709A6850F1775\n  features:\n    - string: /ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against sqlite3",
                                               "description":  "linking/static/sqlite3",
                                               "authors":  [
                                                               "still@teamt5.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against sqlite3\n    namespace: linking/static/sqlite3\n    authors:\n      - still@teamt5.org\n    scope: file\n    examples:\n      - 253309d8b3675d3cc61d4bf23aa15d4b\n  features:\n    - or:\n      - 3 or more:\n        - string: \"database corruption\"\n        - string: \"SQLITE_OK\"\n        - string: \"SQLite format 3\"\n        - string: \"sqlite3_extension_init\"\n        - substring: \"cannot INSERT into generated column\"\n        - substring: \"UPSERT not implemented for virtual table\"\n        - substring: \"sqlite3_get_table()\"\n        - substring: \"qualified table names are not allowed on\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference anti-VM strings",
                                               "description":  "anti-analysis/anti-vm/vm-detection",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference anti-VM strings\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    att\u0026ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_\n  features:\n    - or:\n      - string: /HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i\n      - string: /HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i\n      - string: /A M I/i\n      - string: /Hyper-V/i\n      - string: /Kernel-VMDetection-Private/i\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L699\n      - string: /KVMKVMKVM/i\n        description: KVM\n      - string: /Microsoft Hv/i\n        description: Microsoft Hyper-V or Windows Virtual PC\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L8\n      - string: /avghookx.dll/i\n        description: AVG\n      - string: /avghooka.dll/i\n        description: AVG\n      - string: /snxhk.dll/i\n        description: Avast\n      - string: /pstorec.dll/i\n        description: SunBelt Sandbox\n      - string: /vmcheck.dll/i\n        description: Virtual PC\n      - string: /wpespy.dll/i\n        description: WPE Pro\n      - string: /cmdvrt64.dll/i\n        description: Comodo Container\n      - string: /cmdvrt32.dll/i\n        description: Comodo Container\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L46\n      - string: /sample.exe/i\n      - string: /bot.exe/i\n      - string: /sandbox.exe/i\n      - string: /malware.exe/i\n      - string: /test.exe/i\n      - string: /klavme.exe/i\n      - string: /myapp.exe/i\n      - string: /testapp.exe/i\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp"
                                                            }
                                                        ]
                                           }
                                       ],
                 "files_written":  [
                                       "%APPDATA%\\roaming\\microsoft\\ttmp.log",
                                       "%PROGRAMDATA%\\microsoft\\vault\\ac658cb4-9126-49bd-b877-31eedab3f204\\policy.vpol",
                                       "%PROGRAMDATA%\\microsoft\\vault\\ac658cb4-9126-49bd-b877-31eedab3f204\\3ccd5499-87a8-4b10-a215-608888dd3b55.vsch",
                                       "%PROGRAMDATA%\\microsoft\\vault\\ac658cb4-9126-49bd-b877-31eedab3f204\\2f1a6504-0641-44cf-8bb5-3612d865f2e5.vsch",
                                       "\u003cLS_APPDATA\u003e\\microsoft\\vault\\4bf4c442-9b8a-41a0-b380-dd4a704ddb28\\policy.vpol"
                                   ],
                 "registry_keys_opened":  [
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "\u003cHKLM\u003e\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Diagnostics",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\Error Message Instrument\\",
                                              "\u003cHKLM\u003e\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "\u003cHKLM\u003e\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Compatibility32",
                                              "\u003cHKLM\u003e\\Software\\Microsoft\\Windows NT\\CurrentVersion\\IME Compatibility",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\CMF\\Config",
                                              "\u003cHKLM\u003e\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Microsoft\\OLE",
                                              "\u003cHKLM\u003e\\Software\\Microsoft\\OLE\\Tracing",
                                              "\u003cHKLM\u003e\\system\\CurrentControlSet\\control\\NetworkProvider\\HwOrder",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\Session Manager\\AppCompatibility",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\en-US",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Diagnostics",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Compatibility32",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\IME Compatibility",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Wow6432Node\\Microsoft\\OLE",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\OLE\\Tracing",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Wow6432Node\\Microsoft\\OLEAUT",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows\\Windows Error Reporting\\WMR",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Setup",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion",
                                              "\u003cHKLM\u003e\\SYSTEM\\CurrentControlSet\\Services\\crypt32",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionInfo\\1",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionInfo\\1\\KnownFolders",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\KnownFolderSettings",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Rpc",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "\u003cHKLM\u003e\\Software\\Microsoft\\SQMClient\\Windows",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\SQMServiceList",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Internet Account Manager\\Accounts",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts",
                                              "\u003cHKCU\u003e\\Identities",
                                              "\u003cHKCU\u003e\\Identities\\{91255D00-95D9-49F5-8E84-7C027F5283B7}",
                                              "\u003cHKCU\u003e\\Identities\\{91255D00-95D9-49F5-8E84-7C027F5283B7}\\Software\\Microsoft\\Internet Account Manager\\Accounts",
                                              "\u003cHKCU\u003e\\Identities\\{91255D00-95D9-49F5-8E84-7C027F5283B7}\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging Subsystem\\Profiles",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Office\\15.0\\Outlook\\Profiles",
                                              "\u003cHKCU\u003e\\Software\\Microsoft\\Office\\16.0\\Outlook\\Profiles",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Mozilla\\Mozilla Thunderbird",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Mozilla\\Mozilla Thunderbird\\31.6.0 (ru)\\Main",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\Lsa",
                                              "\u003cHKLM\u003e\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Wow6432Node\\Mozilla",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Wow6432Node\\Mozilla\\Mozilla Firefox\\bin",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Wow6432Node\\Mozilla\\Mozilla Firefox 37.0.2\\bin",
                                              "\u003cHKLM\u003e\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Time Zones\\Pacific Standard Time\\Dynamic DST",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Control\\ComputerName",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache\\Intranet",
                                              "\u003cHKLM\u003e\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache\\Intranet\\",
                                              "\u003cHKLM\u003e\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters"
                                          ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "1232",
                                            "name":  "\u003cSYSTEM32\u003e\\regsvr32.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3044",
                                                                 "name":  "%WINDIR%\\syswow64\\regsvr32.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "412",
                                            "name":  "\u003cSYSTEM32\u003e\\services.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "280",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "552",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "620",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "668",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "772",
                                                                 "name":  "%CommonProgramFiles%\\microsoft shared\\officesoftwareprotectionplatform\\osppsvc.exe"
                                                             },
                                                             {
                                                                 "process_id":  "804",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "848",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "956",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1196",
                                                                 "name":  "\u003cSYSTEM32\u003e\\spoolsv.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1204",
                                                                 "name":  "\u003cSYSTEM32\u003e\\taskhost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1252",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1548",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1604",
                                                                 "name":  "%CommonProgramFiles(x86)%\\microsoft shared\\vs7debug\\mdm.exe"
                                                             },
                                                             {
                                                                 "process_id":  "2256",
                                                                 "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3044",
                                            "name":  "%WINDIR%\\syswow64\\regsvr32.exe"
                                        },
                                        {
                                            "process_id":  "428",
                                            "name":  "\u003cSYSTEM32\u003e\\lsass.exe"
                                        },
                                        {
                                            "process_id":  "280",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "552",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "620",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "668",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1352",
                                                                 "name":  "\u003cSYSTEM32\u003e\\audiodg.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "772",
                                            "name":  "%CommonProgramFiles%\\microsoft shared\\officesoftwareprotectionplatform\\osppsvc.exe"
                                        },
                                        {
                                            "process_id":  "804",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "616",
                                                                 "name":  "\u003cSYSTEM32\u003e\\dwm.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1132",
                                                                 "name":  "\u003cSYSTEM32\u003e\\wudfhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "848",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "956",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "1196",
                                            "name":  "\u003cSYSTEM32\u003e\\spoolsv.exe"
                                        },
                                        {
                                            "process_id":  "1204",
                                            "name":  "\u003cSYSTEM32\u003e\\taskhost.exe"
                                        },
                                        {
                                            "process_id":  "1252",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "1548",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "1604",
                                            "name":  "%CommonProgramFiles(x86)%\\microsoft shared\\vs7debug\\mdm.exe"
                                        },
                                        {
                                            "process_id":  "2256",
                                            "name":  "\u003cSYSTEM32\u003e\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "1352",
                                            "name":  "\u003cSYSTEM32\u003e\\audiodg.exe"
                                        },
                                        {
                                            "process_id":  "616",
                                            "name":  "\u003cSYSTEM32\u003e\\dwm.exe"
                                        },
                                        {
                                            "process_id":  "1132",
                                            "name":  "\u003cSYSTEM32\u003e\\wudfhost.exe"
                                        },
                                        {
                                            "process_id":  "2324",
                                            "name":  "C:\\Users\\Johnson\\AppData\\Local\\Temp\\rundll32.exe"
                                        },
                                        {
                                            "process_id":  "2600",
                                            "name":  "C:\\Users\\Johnson\\AppData\\Local\\Temp\\rundll32.exe"
                                        }
                                    ],
                 "attack_techniques":  {
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encode data using XOR"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using RC4 PRGA",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encrypt data using RC4 PRGA"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference Base64 string",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "reference Base64 string"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get common file path",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get common file path"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get file size",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get file size"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "check if file exists",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "check if file exists"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate files on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "enumerate files on Windows"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1555.003":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "gather firefox profile information",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "gather firefox profile information"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "gather chrome based browser login information",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "gather chrome based browser login information"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1012":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query or enumerate registry value",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query or enumerate registry value"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query or enumerate registry key",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query or enumerate registry key"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query environment variable",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query environment variable"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1547.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "persist via Run registry key",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "persist via Run registry key"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1213":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference SQL statements",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "reference SQL statements"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1497.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "reference anti-VM strings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "reference anti-VM strings"
                                                                              }
                                                                          ]
                                                             }
                                                         ]
                                       }
             }
}
