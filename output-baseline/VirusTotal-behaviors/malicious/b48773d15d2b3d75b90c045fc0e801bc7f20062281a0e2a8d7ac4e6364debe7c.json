{
    "data":  {
                 "registry_keys_deleted":  [
                                               "HKLM\\System\\CurrentControlSet\\Control\\Network\\NetCfgLockHolder",
                                               "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\CompatibilityAdapter\\Signatures\\Firefox Default Browser Agent 015D720F73A12532.job",
                                               "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\CompatibilityAdapter\\Signatures\\Firefox Default Browser Agent 015D720F73A12532.job.fp"
                                           ],
                 "files_attribute_changed":  [
                                                 "%APPDATA%\\vavcfuu"
                                             ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2884",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2608",
                                            "name":  "%SAMPLEPATH%",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2676",
                                                                 "name":  "%SAMPLEPATH%"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2928",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "1960",
                                            "name":  "C:\\wpiaw\\vkyaehf.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2916",
                                                                 "name":  "C:\\wpiaw\\vkyaehf.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "1100",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1884",
                                                                 "name":  "%WINDIR%\\system32\\cmd.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1960",
                                                                 "name":  "C:\\wpiaw\\vkyaehf.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "864",
                                            "name":  "%WINDIR%\\system32\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "412",
                                            "name":  "%WINDIR%\\system32\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "2916",
                                            "name":  "C:\\wpiaw\\vkyaehf.exe"
                                        },
                                        {
                                            "process_id":  "1884",
                                            "name":  "%WINDIR%\\system32\\cmd.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2224",
                                                                 "name":  "%WINDIR%\\system32\\ping.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1780",
                                                                 "name":  "%WINDIR%\\system32\\find.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1988",
                                                                 "name":  "%WINDIR%\\system32\\ipconfig.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3048",
                                            "name":  "%WINDIR%\\system32\\conhost.exe"
                                        },
                                        {
                                            "process_id":  "1540",
                                            "name":  "%WINDIR%\\system32\\audiodg.exe"
                                        },
                                        {
                                            "process_id":  "2784",
                                            "name":  "%WINDIR%\\system32\\svchost.exe",
                                            "time_offset":  21,
                                            "children":  [
                                                             {
                                                                 "process_id":  "2816",
                                                                 "name":  "%WINDIR%\\system32\\werfault.exe",
                                                                 "time_offset":  22
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2224",
                                            "name":  "%WINDIR%\\system32\\ping.exe"
                                        },
                                        {
                                            "process_id":  "1780",
                                            "name":  "%WINDIR%\\system32\\find.exe"
                                        },
                                        {
                                            "process_id":  "1988",
                                            "name":  "%WINDIR%\\system32\\ipconfig.exe"
                                        },
                                        {
                                            "process_id":  "2816",
                                            "name":  "%WINDIR%\\system32\\werfault.exe",
                                            "time_offset":  22
                                        }
                                    ],
                 "http_conversations":  [
                                            {
                                                "url":  "http://host-file-file0.com/",
                                                "request_method":  "POST",
                                                "request_headers":  {
                                                                        "Host":  "host-file-file0.com",
                                                                        "Content-Length":  "240",
                                                                        "Content-Type":  "application/x-www-form-urlencoded",
                                                                        "Accept":  "*/*",
                                                                        "Connection":  "Keep-Alive",
                                                                        "User-Agent":  "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64; x64; Trident/4.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)",
                                                                        "Referer":  "http://whwiroudar.com/"
                                                                    }
                                            },
                                            {
                                                "url":  "http://file-file-file1.com/",
                                                "request_method":  "POST",
                                                "request_headers":  {
                                                                        "Host":  "file-file-file1.com",
                                                                        "Content-Length":  "240",
                                                                        "Content-Type":  "application/x-www-form-urlencoded",
                                                                        "Accept":  "*/*",
                                                                        "Connection":  "Keep-Alive",
                                                                        "User-Agent":  "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64; x64; Trident/4.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)",
                                                                        "Referer":  "http://mqpvxhgn.org/"
                                                                    }
                                            }
                                        ],
                 "command_executions":  [
                                            "%SAMPLEPATH%"
                                        ],
                 "files_written":  [
                                       "%APPDATA%\\vavcfuu",
                                       "%WINDIR%\\system32\\tasks\\firefox default browser agent 015d720f73a12532"
                                   ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "194.169.175.127",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "dns.msftncsi.com",
                                         "resolved_ips":  [
                                                              "131.107.255.255"
                                                          ]
                                     },
                                     {
                                         "hostname":  "host-file-file0.com",
                                         "resolved_ips":  [
                                                              "194.169.175.127"
                                                          ]
                                     },
                                     {
                                         "hostname":  "file-file-file1.com",
                                         "resolved_ips":  [
                                                              "194.169.175.127"
                                                          ]
                                     }
                                 ],
                 "mutexes_created":  [
                                         "ShimCacheMutex"
                                     ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link many functions at runtime",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link many functions at runtime"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1059",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "accept command line arguments",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "accept command line arguments"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get common file path",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get common file path"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query environment variable",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query environment variable"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get disk information",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get disk information"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get hostname",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get hostname"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "files_opened":  [
                                      "%WINDIR%\\system32\\ntdll.dll",
                                      "%WINDIR%\\syswow64\\ntdll.dll",
                                      "C:\\WINDOWS\\system32\\winsock.dll",
                                      "C:\\b48773d15d2b3d75b90c045fc0e801bc7f20062281a0e2a8d7ac4e6364debe7c",
                                      "\\\\.\\PIPE\\lsarpc",
                                      "C:\\WINDOWS\\system32\\drwtsn32.exe",
                                      "C:\\WINDOWS\\system32\\netmsg.dll"
                                  ],
                 "verdict_labels":  [
                                        "SmokeLoader",
                                        "Zenpack"
                                    ],
                 "modules_loaded":  [
                                        "msimg32.dll",
                                        "kernel32.dll",
                                        "user32",
                                        "kernel32",
                                        "ntdll.dll",
                                        "advapi32.dll",
                                        "rpcrt4.dll",
                                        "shlwapi.dll",
                                        "version.dll",
                                        "shell32.dll"
                                    ],
                 "files_deleted":  [
                                       "C:\\wpiaw\\vkyaehf.exe"
                                   ],
                 "registry_keys_opened":  [
                                              "HKLM\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters",
                                              "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0009\\Linkage",
                                              "HKLM\\SYSTEM\\CURRENTCONTROLSET\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0009",
                                              "HKLM\\System\\CurrentControlSet\\Control\\Network\\{4D36E972-E325-11CE-BFC1-08002BE10318}",
                                              "HKLM\\System\\CurrentControlSet\\Control\\Network\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\{E464FC82-EE07-4BE9-9FA1-193D7005A861}\\Connection",
                                              "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Logon\\{466B7290-4A35-4615-8988-FC19C1131AD8}",
                                              "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{466B7290-4A35-4615-8988-FC19C1131AD8}",
                                              "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Firefox Default Browser Agent 015D720F73A12532",
                                              "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache",
                                              "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache\\Intranet",
                                              "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache\\Intranet\\"
                                          ],
                 "processes_created":  [
                                           "%WINDIR%\\system32\\cmd.exe",
                                           "%WINDIR%\\system32\\conhost.exe",
                                           "%WINDIR%\\system32\\audiodg.exe",
                                           "C:\\wpiaw\\vkyaehf.exe",
                                           "%WINDIR%\\system32\\svchost.exe",
                                           "C:\\b48773d15d2b3d75b90c045fc0e801bc7f20062281a0e2a8d7ac4e6364debe7c C:\\b48773d15d2b3d75b90c045fc0e801bc7f20062281a0e2a8d7ac4e6364debe7c\"\"",
                                           "C:\\WINDOWS\\system32\\drwtsn32 -p 1344 -e 200 -g"
                                       ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate thread",
                                               "description":  "host-interaction/thread/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate thread\n    namespace: host-interaction/thread/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Terminate Thread [C0039]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003286\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x407E90\n  features:\n    - or:\n      - api: kernel32.TerminateThread\n      - api: PsTerminateSystemThread\n      - api: System.Threading.Thread.Abort\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check mutex",
                                               "description":  "host-interaction/mutex",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Check Mutex [C0043]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - or:\n        - api: kernel32.OpenMutex\n        - match: create mutex\n        - api: System.Threading.Mutex::OpenExisting\n        - api: System.Threading.Mutex::TryOpenExisting\n      - optional:\n        - or:\n          - api: kernel32.GetLastError\n          - number: 2 = ERROR_FILE_NOT_FOUND\n          - number: 0xB7 = ERROR_ALREADY_EXISTS\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate RWX memory",
                                               "description":  "host-interaction/process/inject",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x40 = PAGE_EXECUTE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete file",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link many functions at runtime",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - os: linux\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete directory",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete directory\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete Directory [C0048]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x10009236\n      - AFB6EC3D721A5CB67863487B0E51A34C167F629CF701F8BC7A038C117B4DDA44:0x429AA0\n  features:\n    - or:\n      - api: RemoveDirectory\n      - api: RemoveDirectoryTransacted\n      - api: _rmdir\n      - api: _wrmdir\n      - api: System.IO.DirectoryInfo::Delete\n      - api: System.IO.Directory::Delete\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "accept command line arguments",
                                               "description":  "host-interaction/cli",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: accept command line arguments\n    namespace: host-interaction/cli\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Execution::Command and Scripting Interpreter [T1059]\n    mbc:\n      - Execution::Command and Scripting Interpreter [E1059]\n    examples:\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\n  features:\n    - or:\n      - api: GetCommandLine\n      - api: CommandLineToArgv\n      - api: System.Environment::GetCommandLineArgs\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get common file path",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read .ini file",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read .ini file\n    namespace: host-interaction/file-system/read\n    authors:\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x401070\n      - E6234FB98F17201C232F4502015B47B3:0x701312FA\n  features:\n    - and:\n      - or:\n        - api: GetPrivateProfileInt\n        - api: GetPrivateProfileString\n        - api: GetPrivateProfileStruct\n        - api: GetPrivateProfileSection\n        - api: GetPrivateProfileSectionNames\n      - optional:\n        - string: /\\.ini/i\n        - api: GetFullPathName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "manipulate console buffer",
                                               "description":  "host-interaction/console",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: manipulate console buffer\n    namespace: host-interaction/console\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Console [C0033]\n    references:\n      - https://stackoverflow.com/a/15770935/87207\n    examples:\n      - 3aa7ee4d67f562933bc998f352b1f319:0x705413A0\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.SetConsoleCursorPosition\n          - api: kernel32.ReadConsoleOutputCharacter\n          - api: kernel32.WriteConsoleOutputCharacter\n          - api: kernel32.WriteConsoleOutput\n          - api: kernel32.WriteConsoleInput\n        - optional:\n          - api: kernel32.GetStdHandle\n          - number: 0xfffffff5 = STD_OUTPUT_HANDLE\n      - api: System.Console::Write\n      - api: System.Console::WriteLine\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://stackoverflow.com/a/15770935/87207"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query environment variable",
                                               "description":  "host-interaction/environment-variable",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get disk information",
                                               "description":  "host-interaction/hardware/storage",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get hostname",
                                               "description":  "host-interaction/os/hostname",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "copy file",
                                               "description":  "host-interaction/file-system/copy",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "move file",
                                               "description":  "host-interaction/file-system/move",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create mailslot",
                                               "description":  "communication/mailslot",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create mailslot\n    namespace: communication/mailslot\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication [C0003]\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/ipc/mailslots\n    examples:\n      - af13e7583ed1b27c4ae219e344a37e2b:0x40151D\n  features:\n    - and:\n      - api: kernel32.CreateMailslot\n      - optional:\n        - api: kernel32.GetMailslotInfo\n        - api: kernel32.SetMailslotInfo\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://learn.microsoft.com/en-us/windows/win32/ipc/mailslots"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain a resource (.rsrc) section",
                                               "description":  "executable/pe/section/rsrc",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n"
                                           }
                                       ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP PING Windows",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:382",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP PING Windows\"; itype:8; content:\"abcdefghijklmnop\",depth 16; metadata:ruleset community; classtype:misc-activity; sid:382; rev:11; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Unusual PING detected",
                                        "rule_category":  "successful-recon-limited",
                                        "rule_id":  "1:29456",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_references":  [
                                                                "https://krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/",
                                                                "https://krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/"
                                                            ],
                                        "rule_raw":  "alert icmp $HOME_NET any -\u003e $EXTERNAL_NET any ( msg:\"PROTOCOL-ICMP Unusual PING detected\"; icode:0; itype:8; fragbits:!M; content:!\"ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI\",depth 32; content:!\"0123456789abcdefghijklmnopqrstuv\",depth 32; content:!\"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\",depth 36; content:!\"WANG2\"; content:!\"cacti-monitoring-system\",depth 65; content:!\"SolarWinds\",depth 72; metadata:policy max-detect-ips drop,ruleset community; reference:url,krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/; reference:url,krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/; classtype:successful-recon-limited; sid:29456; rev:3; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP PING",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:384",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP PING\"; icode:0; itype:8; metadata:ruleset community; classtype:misc-activity; sid:384; rev:8; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Echo Reply",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:408",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP Echo Reply\"; icode:0; itype:0; metadata:ruleset community; classtype:misc-activity; sid:408; rev:8; )"
                                    },
                                    {
                                        "rule_msg":  "ET MALWARE Suspected Smokeloader Activity (POST)",
                                        "rule_category":  "A Network Trojan was detected",
                                        "rule_id":  "1:2039103",
                                        "alert_severity":  "high",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "194.169.175.127",
                                                              "dest_port":  80,
                                                              "hostname":  "host-file-file0.com",
                                                              "url":  "http://host-file-file0.com/"
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://www.virustotal.com/gui/search/d58078226c4066f05926c70be7cf64a7"
                                                            ],
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET any (msg:\"ET MALWARE Suspected Smokeloader Activity (POST)\"; flow:established,to_server; urilen:\u003c10; http.method; content:\"POST\"; http.header_names; content:\"|0d 0a|Connection|0d 0a|\"; content:\"Content-Type|0d 0a|Accept|0d 0a|Referer|0d 0a|User-Agent|0d 0a|Content-Length|0d 0a|Host|0d 0a 0d 0a|\"; distance:0; fast_pattern; http.referer; pcre:\"/^http|3a 2f 2f|[a-z]{5,10}.(com|org|net|de)\\/$/\"; http.content_type; content:\"application/x-www-form-urlencoded\"; bsize:33; reference:md5,d58078226c4066f05926c70be7cf64a7; classtype:trojan-activity; sid:2039103; rev:2; metadata:attack_target Client_Endpoint, created_at 2022_10_06, deployment Perimeter, former_category MALWARE, performance_impact Low, signature_severity Major, updated_at 2022_10_28, reviewed_at 2023_09_01;)"
                                    },
                                    {
                                        "rule_msg":  "(eth) truncated ethernet header",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "116:424",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:116; sid:424; rev:2; msg:\"(eth) truncated ethernet header\"; metadata: policy max-detect-ips drop, rule-type decode; classtype:misc-activity;)"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP traceroute",
                                        "rule_category":  "attempted-recon",
                                        "rule_id":  "1:385",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP traceroute\"; itype:8; ttl:1; metadata:ruleset community; classtype:attempted-recon; sid:385; rev:8; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Destination Unreachable Network Unreachable",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:401",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP Destination Unreachable Network Unreachable\"; icode:0; itype:3; metadata:ruleset community; classtype:misc-activity; sid:401; rev:9; )"
                                    }
                                ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0009\\NetCfgInstanceId",
                                               "value":  "{E464FC82-EE07-4BE9-9FA1-193D7005A861}"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0009\\Linkage\\RootDevice",
                                               "value":  "{E464FC82-EE07-4BE9-9FA1-193D7005A861}"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0009\\Linkage\\UpperBind",
                                               "value":  "TCPIP6TUNNEL\\nTcpip6"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0009\\Linkage\\Export",
                                               "value":  "\\Device\\{E464FC82-EE07-4BE9-9FA1-193D7005A861}"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0007\\Linkage\\FilterList",
                                               "value":  "{A8B1B530-930D-4F5A-B04B-4C388594DD4B}-{B5F4D659-7DAA-4565-8E41-BE220ED60542}-0000\\n{A8B1B530-930D-4F5A-B04B-4C388594DD4B}-{B70D6460-3635-4D42-B866-B8AB1A24454C}-0000"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0008\\Linkage\\FilterList",
                                               "value":  "{2CAA64ED-BAA3-4473-B637-DEC65A14C8AA}-{B5F4D659-7DAA-4565-8E41-BE220ED60542}-0000"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0006\\Linkage\\FilterList",
                                               "value":  "{5BF54C7E-91DA-457D-80BF-333677D7E316}-{B5F4D659-7DAA-4565-8E41-BE220ED60542}-0000"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}\\0005\\Linkage\\FilterList",
                                               "value":  "{9A399D81-2EAD-4F23-BCDD-637FC13DCD51}-{B5F4D659-7DAA-4565-8E41-BE220ED60542}-0000"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Network\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\{E464FC82-EE07-4BE9-9FA1-193D7005A861}\\Connection\\Name",
                                               "value":  "isatap.{A8B1B530-930D-4F5A-B04B-4C388594DD4B}"
                                           },
                                           {
                                               "key":  "HKLM\\System\\CurrentControlSet\\Control\\Nsi\\{eb004a11-9b1a-11d4-9123-0050047759bc}\\10\\0000000400008300",
                                               "value":  "\\xae\\x01\\x84\\x04\\x5a\\x00\\x69\\x00\\x73\\x00\\x61\\x00\\x74\\x00\\x61\\x00\\x70\\x00\\x2e\\x00\\x7b\\x00\\x41\\x00\\x38\\x00\\x42\\x00\\x31\\x00\\x42\\x00\\x35\\x00\\x33\\x00\\x30\\x00\\x2d\\x00\\x39\\x00\\x33\\x00\\x30\\x00\\x44\\x00\\x2d\\x00\\x34\\x00\\x46\\x00\\x35\\x00\\x41\\x00\\x2d\\x00\\x42\\x00\\x30\\x00\\x34\\x00\\x42\\x00\\x2d\\x00\\x34\\x00\\x43\\x00\\x33\\x00\\x38\\x00\\x38\\x00\\x35\\x00\\x39\\x00\\x34..."
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{466B7290-4A35-4615-8988-FC19C1131AD8}\\Path",
                                               "value":  "\\Firefox Default Browser Agent 015D720F73A12532"
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{466B7290-4A35-4615-8988-FC19C1131AD8}\\Hash",
                                               "value":  "\\xcb\\xbf\\xbd\\xdd\\x21\\xa5\\xe5\\xd4\\x85\\x2b\\xb5\\xa8\\xe8\\x80\\x51\\x00\\x9c\\x37\\xca\\xa8\\xc1\\x34\\x0c\\xd0\\xc8\\xa5\\x9e\\x9a\\x82\\x57\\x8a\\x79"
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Firefox Default Browser Agent 015D720F73A12532\\Id",
                                               "value":  "{466B7290-4A35-4615-8988-FC19C1131AD8}"
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Firefox Default Browser Agent 015D720F73A12532\\Index",
                                               "value":  "0x00000002"
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{466B7290-4A35-4615-8988-FC19C1131AD8}\\Triggers",
                                               "value":  "\\x15\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x55\\x76\\x01\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x78\\x21\\x41\\x00\\x48\\x48\\x48\\x48\\xfc\\x58\\x01\\x52\\x48\\x48\\x48\\x48\\x00\\x48\\x48\\x48\\x48\\x48\\x48\\x48\\x00\\x48\\x48\\x48\\x48\\x48\\x48\\x48\\x01\\x00\\x00\\x00\\x48\\x48\\x48\\x48\\x1c\\x00\\x00\\x00\\x48..."
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{466B7290-4A35-4615-8988-FC19C1131AD8}\\DynamicInfo",
                                               "value":  "\\x03\\x00\\x00\\x00\\xf0\\x7f\\x76\\xe8\\x53\\xe8\\xd9\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00"
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Nla\\Cache\\Intranet\\{A8B1B530-930D-4F5A-B04B-4C388594DD4B}",
                                               "value":  "\\x0a\\x00\\x27\\x00\\x00\\x59"
                                           }
                                       ],
                 "processes_terminated":  [
                                              "wmiadap.exe /F /T /R",
                                              "%SAMPLEPATH%",
                                              "C:\\wpiaw\\vkyaehf.exe"
                                          ],
                 "files_dropped":  [
                                       {
                                           "path":  "%APPDATA%\\vavcfuu",
                                           "sha256":  "b48773d15d2b3d75b90c045fc0e801bc7f20062281a0e2a8d7ac4e6364debe7c",
                                           "type":  "PE_EXE"
                                       },
                                       {
                                           "path":  "%WINDIR%\\system32\\tasks\\firefox default browser agent 015d720f73a12532",
                                           "sha256":  "40bf54a0c5df79359640641a4711a8f1801418bd7a64c9a502e721a1fa5af961"
                                       }
                                   ],
                 "verdict_confidence":  50,
                 "processes_injected":  [
                                            "C:\\wpiaw\\vkyaehf.exe"
                                        ],
                 "tags":  [
                              "SELF_DELETE"
                          ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link many functions at runtime",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link many functions at runtime"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1059":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "accept command line arguments",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "accept command line arguments"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get common file path",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get common file path"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query environment variable",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query environment variable"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get disk information",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get disk information"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get hostname",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get hostname"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
