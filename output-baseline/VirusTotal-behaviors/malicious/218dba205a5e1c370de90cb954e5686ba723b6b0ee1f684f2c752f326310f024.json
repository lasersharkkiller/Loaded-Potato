{
    "data":  {
                 "processes_terminated":  [
                                              "%SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d.exe",
                                              "%USERPROFILE%\\AppData\\Roaming\\disk.exe",
                                              "C:\\Windows\\System32\\rundll32.exe",
                                              "C:\\Windows\\SysWOW64\\reg.exe",
                                              "C:\\Windows\\System32\\conhost.exe",
                                              "C:\\Windows\\System32\\wuapihost.exe"
                                          ],
                 "processes_injected":  [
                                            "\\\\?\\C:\\Windows\\system32\\wbem\\WMIADAP.EXE"
                                        ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "(eth) truncated ethernet header",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "116:424",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:116; sid:424; rev:2; msg:\"(eth) truncated ethernet header\"; metadata: policy max-detect-ips drop, rule-type decode; classtype:misc-activity;)"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Destination Unreachable Network Unreachable",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:401",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP Destination Unreachable Network Unreachable\"; icode:0; itype:3; metadata:ruleset community; classtype:misc-activity; sid:401; rev:9; )"
                                    },
                                    {
                                        "rule_msg":  "SERVER-OTHER Squid HTTP Vary response header denial of service attempt",
                                        "rule_category":  "denial-of-service",
                                        "rule_id":  "1:41379",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "src_ip":  "96.17.193.42",
                                                              "src_port":  80
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_references":  [
                                                                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=2016-2569",
                                                                "https://www.squid-cache.org/Advisories/SQUID-2016_2.txt"
                                                            ],
                                        "tags":  [
                                                     "cve-2016-2569"
                                                 ],
                                        "rule_raw":  "alert tcp $EXTERNAL_NET $HTTP_PORTS -\u003e $HOME_NET any ( msg:\"SERVER-OTHER Squid HTTP Vary response header denial of service attempt\"; flow:to_client,established; http_header; content:\"Vary|3A|\"; content:!\"|0D 0A|\",within 250; metadata:policy max-detect-ips drop; service:http; reference:cve,2016-2569; reference:url,www.squid-cache.org/Advisories/SQUID-2016_2.txt; classtype:denial-of-service; sid:41379; rev:1; )"
                                    },
                                    {
                                        "rule_msg":  "(http_inspect) HTTP Content-Length message body was truncated",
                                        "rule_category":  "unknown",
                                        "rule_id":  "119:260",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "src_ip":  "96.17.193.42",
                                                              "src_port":  80
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:119; sid:260; rev:1; msg:\"(http_inspect) HTTP Content-Length message body was truncated\"; metadata: rule-type preproc; classtype:unknown;)"
                                    }
                                ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d.exe",
                                           "%USERPROFILE%\\AppData\\Roaming\\disk.exe",
                                           "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmiintegrator.exe",
                                           "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmihostwin.exe",
                                           "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe",
                                           "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure.exe",
                                           "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure64.exe",
                                           "C:\\Windows\\System32\\rundll32.exe",
                                           "C:\\Windows\\SysWOW64\\reg.exe",
                                           "C:\\Windows\\System32\\wuapihost.exe"
                                       ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create process on Windows",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create thread",
                                               "description":  "host-interaction/thread/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "unmanaged call",
                                               "description":  "runtime : managed code calls unmanaged (native) code, often seen in .NET",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: unmanaged call\n    namespace: runtime\n    authors:\n      - michael.hunhoff@mandiant.com\n    description: managed code calls unmanaged (native) code, often seen in .NET\n    scopes:\n      static: function\n      dynamic: unsupported\n  features:\n    - or:\n      - characteristic: unmanaged call\n      - match: unmanaged call via dynamic PInvoke in .NET\n      - api: System.Runtime.InteropServices.Marshal::GetDelegateForFunctionPointer\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "manipulate unmanaged memory in .NET",
                                               "description":  "host-interaction/memory",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: manipulate unmanaged memory in .NET\n    namespace: host-interaction/memory\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires class features\n  features:\n    - or:\n      - class: System.Runtime.InteropServices.Marshal\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate unmanaged memory in .NET",
                                               "description":  "host-interaction/memory",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate unmanaged memory in .NET\n    namespace: host-interaction/memory\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.Runtime.InteropServices.Marshal::AllocHGlobal\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "find data using regex in .NET",
                                               "description":  "data-manipulation/regex",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: find data using regex in .NET\n    namespace: data-manipulation/regex\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.Text.RegularExpressions.Regex::Matches\n      - api: System.Text.RegularExpressions.Regex::Match\n      - api: System.Text.RegularExpressions.Regex::IsMatch\n      - api: System.Text.RegularExpressions.Regex::EnumerateMatches\n      - api: System.Text.RegularExpressions.Regex::Replace\n      - api: System.Text.RegularExpressions.Regex::Split\n      - api: System.Text.RegularExpressions.Regex::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create a process with modified I/O handles and window",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "matthew.williams@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create a process with modified I/O handles and window\n    namespace: host-interaction/process/create\n    authors:\n      - matthew.williams@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires property features\n    mbc:\n      - Process::Create Process [C0017]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4011C0\n  features:\n    - or:\n      - and:\n        - or:\n          - description: API functions that accept a pointer to a STARTUPINFO structure\n          - api: kernel32.CreateProcess\n          - api: kernel32.CreateProcessInternal\n          - api: advapi32.CreateProcessAsUser\n          - api: advapi32.CreateProcessWithLogon\n          - api: advapi32.CreateProcessWithToken\n        - number: 0x101 = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW\n          # STARTF_USESTDHANDLES indicates the hStdInput, hStdOutput, and hStdError members contain additional information\n          # STARTF_USESHOWWINDOW indicates the wShowWindow member contains additional information\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x44 = StartupInfo.cb (size)\n          - and:\n            - arch: amd64\n            - number: 0x68 = StartupInfo.cb (size)\n          # STARTUPINFOEX size values not currently supported by this rule.\n        - optional:\n          - api: kernel32.GetStartupInfo\n      - and:\n        - api: System.Diagnostics.Process::Start\n        - or:\n          - property/write: System.Diagnostics.ProcessStartInfo::UseShellExecute\n          - property/write: System.Diagnostics.ProcessStartInfo::Verb\n          - property/write: System.Diagnostics.ProcessStartInfo::WindowStyle\n          - property/write: System.Diagnostics.ProcessStartInfo::WorkingDirectory\n          - property/write: System.Diagnostics.ProcessStartInfo::FileName\n          - property/write: System.Diagnostics.ProcessStartInfo::Arguments\n          - property/write: System.Diagnostics.ProcessStartInfo::CreateNoWindow\n          - property/write: System.Diagnostics.ProcessStartInfo::RedirectStandardOutput\n          - property/write: System.Diagnostics.ProcessStartInfo::RedirectStandardInput\n          - property/read: System.Diagnostics.Process::StandardOutput\n          - property/read: System.Diagnostics.Process::StandardInput\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "compiled to the .NET platform",
                                               "description":  "runtime/dotnet",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: compiled to the .NET platform\n    namespace: runtime/dotnet\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - b9f5bd514485fb06da39beff051b9fdc\n  features:\n    - or:\n      - format: dotnet\n      - import: mscoree._CorExeMain\n      - import: mscoree._corexemain\n      - import: mscoree._CorDllMain\n      - import: mscoree._cordllmain\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "mixed mode",
                                               "description":  "runtime : file contains managed and unmanaged (native) code, often seen in .NET",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: mixed mode\n    namespace: runtime\n    authors:\n      - michael.hunhoff@mandiant.com\n    description: file contains managed and unmanaged (native) code, often seen in .NET\n    scopes:\n      static: file\n      dynamic: unsupported  # requires characteristic features\n  features:\n    - or:\n      - characteristic: mixed mode\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference startup folder",
                                               "description":  "persistence/startup-folder",
                                               "authors":  [
                                                               "matthew.williams@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference startup folder\n    namespace: persistence/startup-folder\n    authors:\n      - matthew.williams@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att\u0026ck:\n      - Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]\n  features:\n    - or:\n      - string: /Start Menu\\\\Programs\\\\Startup/i\n"
                                           }
                                       ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "142.251.211.227",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "142.250.69.195",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.185.48",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.229.211.108",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.184.37",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.216.147.76",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "142.250.179.99",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "99.86.91.74",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "96.17.207.133",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "96.17.193.42",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "96.17.207.150",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "96.17.193.45",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "99.86.91.61",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "99.86.91.22",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKEY_USERS\\%SID%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\KeybordDriver",
                                               "value":  "\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe\" winstart"
                                           }
                                       ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "www.google.com.br",
                                         "resolved_ips":  [
                                                              "142.251.211.227",
                                                              "142.250.179.99"
                                                          ]
                                     },
                                     {
                                         "hostname":  "f.i.uol.com.br",
                                         "resolved_ips":  [
                                                              "99.86.91.22",
                                                              "99.86.91.61",
                                                              "99.86.91.74",
                                                              "99.86.91.62"
                                                          ]
                                     },
                                     {
                                         "hostname":  "time.windows.com",
                                         "resolved_ips":  [
                                                              "51.145.123.29"
                                                          ]
                                     },
                                     {
                                         "hostname":  "cdn-catve.trrsf.com",
                                         "resolved_ips":  [
                                                              "96.17.207.133",
                                                              "96.17.207.150"
                                                          ]
                                     },
                                     {
                                         "hostname":  "statics.estadao.com.br",
                                         "resolved_ips":  [
                                                              "96.17.193.42",
                                                              "96.17.193.45"
                                                          ]
                                     }
                                 ],
                 "files_opened":  [
                                      "\u003cAnonymous Pipe\u003e"
                                  ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference startup folder",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference startup folder"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2812",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2252",
                                                                 "name":  "%SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d.exe",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3904",
                                                                                      "name":  "%USERPROFILE%\\AppData\\Roaming\\disk.exe",
                                                                                      "children":  [
                                                                                                       {
                                                                                                           "process_id":  "2796",
                                                                                                           "name":  "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmiintegrator.exe",
                                                                                                           "children":  [
                                                                                                                            "@{process_id=3764; name=%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmihostwin.exe; children=System.Object[]}"
                                                                                                                        ]
                                                                                                       }
                                                                                                   ]
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "620",
                                            "name":  "C:\\Windows\\System32\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3832",
                                                                 "name":  "C:\\Windows\\System32\\rundll32.exe"
                                                             },
                                                             {
                                                                 "process_id":  "3848",
                                                                 "name":  "C:\\Windows\\System32\\wuapihost.exe"
                                                             }
                                                         ]
                                        }
                                    ],
                 "command_executions":  [
                                            "\"%SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d.exe\" ",
                                            "\"%USERPROFILE%\\AppData\\Roaming\\disk.exe\" %SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d.exe",
                                            "\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmiintegrator.exe\" unk",
                                            "\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmihostwin.exe\" unk2",
                                            "\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe\" unk3",
                                            "\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure.exe\" execute",
                                            "\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure64.exe\" autorun",
                                            "C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\shell32.dll,SHCreateLocalServerRunDll {9aa46009-3ce0-458a-a354-715610a075e6} -Embedding",
                                            "\"C:\\Windows\\System32\\reg.exe\" add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"KeybordDriver\" /t REG_SZ /d \"\\\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe\\\" winstart\" /f",
                                            "C:\\Windows\\System32\\wuapihost.exe -Embedding"
                                        ],
                 "modules_loaded":  [
                                        "%SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d.exe",
                                        "%USERPROFILE%\\AppData\\Roaming\\disk.exe",
                                        "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmiintegrator.exe",
                                        "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmihostwin.exe",
                                        "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe",
                                        "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure.exe",
                                        "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure64.exe"
                                    ],
                 "files_dropped":  [
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\6s5d4f65ds4g65d47gfd684gfd_0023.sys"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\disk.exe"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Local\\Microsoft\\CLR_v2.0_32"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Local\\Microsoft\\CLR_v2.0_32\\UsageLogs"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Local\\Microsoft\\CLR_v2.0_32\\UsageLogs\\d9e1d4cf678096da71526ebef1d6002d.exe.log"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\Windows Objects"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmiintegrator.exe"
                                       },
                                       {
                                           "path":  "%SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmihostwin.exe"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure.exe"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmisecure64.exe"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Local\\Microsoft\\CLR_v2.0_32\\UsageLogs\\disk.exe.log"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Local\\Microsoft\\Windows\\INetCache\\IE\\P3H6T8JU\\googlelogo_color_272x92dp[1].png"
                                       },
                                       {
                                           "path":  "C:\\tmp"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER3033.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER3033.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER313C.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER313C.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER316C.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER316C.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4293.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4293.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4294.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4294.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER42B4.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER42B4.tmp.txt"
                                       },
                                       {
                                           "path":  "/s2016/portal/img/svg/logo-blue.svg",
                                           "sha256":  "4cdc2cd4ce3c3663bb6f55e8a246902f6b9e62f7f709cc8e22ebc25fdac73df0",
                                           "type":  "SVG",
                                           "download_url":  "http://statics.estadao.com.br/s2016/portal/img/svg/logo-blue.svg"
                                       }
                                   ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "Image":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "high",
                                                    "rule_id":  "53f67594c85a67cef198b525b556658fa4e46d1e49901472adbc8b7f0ba475a8",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Bad Opsec Defaults Sacrificial Processes With Improper Arguments",
                                                    "rule_description":  "Detects attackers using tooling with bad opsec defaults.\nE.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run.\nOne trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples.\n",
                                                    "rule_author":  "Oleg Kolesnikov @securonix invrep_de, oscd.community, Florian Roth (Nextron Systems), Christian Burkard (Nextron Systems)"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "Image":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "high",
                                                    "rule_id":  "87574dead19ceb246e10ccb4cb4fd5009c71c46de0d77965d2170bfafc2c3b14",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Rundll32 Execution Without CommandLine Parameters",
                                                    "rule_description":  "Detects suspicious start of rundll32.exe without any parameters as found in CobaltStrike beacon activity",
                                                    "rule_author":  "Florian Roth (Nextron Systems)"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "Image":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "2fd6d2b16365ba7157eee4934b406ac7d530b4ec62cc1b45c69ee4f07989f139",
                                                    "rule_source":  "SOC Prime Threat Detection Marketplace",
                                                    "rule_title":  "LOLBAS rundll32 without expected arguments (via cmdline)",
                                                    "rule_description":  "Detects use of rundll32 as a LOLBAS binary where rundll32 is passed unexpected arguments such as a .iso instead of .dll (i.e. rundll32.exe test.iso, evilexport).",
                                                    "rule_author":  "SOC Prime Team"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "EventID":  "13",
                                                                                             "Details":  "\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe\" winstart",
                                                                                             "EventType":  "SetValue",
                                                                                             "TargetObject":  "HKU\\%SID%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\KeybordDriver"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "8b5db9da5732dc549b0e8b56fe5933d7c95ed760f3ac20568ab95347ef8c5bcc",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "CurrentVersion Autorun Keys Modification",
                                                    "rule_description":  "Detects modification of autostart extensibility point (ASEP) in registry.",
                                                    "rule_author":  "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "\"C:\\Windows\\System32\\reg.exe\" add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"KeybordDriver\" /t REG_SZ /d \"\\\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe\\\" winstart\" /f",
                                                                                             "Image":  "C:\\Windows\\System32\\reg.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "aa87efb252a9cf7bb1fb0114336bd08c338bc9046dd498d187c209cd94ddbc6a",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Potential Persistence Attempt Via Run Keys Using Reg.EXE",
                                                    "rule_description":  "Detects suspicious command line reg.exe tool adding key to RUN key in Registry",
                                                    "rule_author":  "Florian Roth (Nextron Systems)"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "\"C:\\Windows\\System32\\reg.exe\" add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"KeybordDriver\" /t REG_SZ /d \"\\\"%USERPROFILE%\\AppData\\Roaming\\Windows Objects\\wmimic.exe\\\" winstart\" /f",
                                                                                             "Image":  "C:\\Windows\\System32\\reg.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "b5f76af9d8101930af8d4fee71f3a5395b47eff6bb88e581db02bf890242d79b",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Direct Autorun Keys Modification",
                                                    "rule_description":  "Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.",
                                                    "rule_author":  "Victor Sergeev, Daniil Yugoslavskiy, oscd.community"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "Image":  "C:\\Windows\\System32\\rundll32.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "e7856bac967038b016efab8e4f315a2f16ccd6ba62f20d73df0ad3826fe654a3",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Rundll32 Execution With Uncommon DLL Extension",
                                                    "rule_description":  "Detects the execution of rundll32 with a command line that doesn\u0027t contain a common extension",
                                                    "rule_author":  "Tim Shelton, Florian Roth (Nextron Systems), Yassine Oukessou"
                                                }
                                            ],
                 "http_conversations":  [
                                            {
                                                "url":  "http://f.i.uol.com.br/folha/furniture/5.4/images/sprite8.png",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)"
                                                                    }
                                            },
                                            {
                                                "url":  "http://cdn-catve.trrsf.com/novo/img/topo/logo_branca.png",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)"
                                                                    }
                                            },
                                            {
                                                "url":  "http://statics.estadao.com.br/s2016/portal/img/svg/logo-blue.svg",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)"
                                                                    }
                                            }
                                        ],
                 "files_deleted":  [
                                       "%SAMPLEPATH%\\d9e1d4cf678096da71526ebef1d6002d.exe",
                                       "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER3033.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER313C.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER316C.tmp.txt",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4293.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER4294.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER42B4.tmp.txt"
                                   ],
                 "mbc":  [
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create process on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0038",
                                 "objective":  "Process",
                                 "behavior":  "Create Thread",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create thread"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create a process with modified I/O handles and window"
                                              }
                                          ]
                             }
                         ],
                 "attack_techniques":  {
                                           "T1547.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "reference startup folder",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "reference startup folder"
                                                                              }
                                                                          ]
                                                             }
                                                         ]
                                       }
             }
}
