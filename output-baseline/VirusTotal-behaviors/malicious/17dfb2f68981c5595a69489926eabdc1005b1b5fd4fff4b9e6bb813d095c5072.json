{
    "data":  {
                 "processes_tree":  [
                                        {
                                            "process_id":  "1819",
                                            "name":  "sh -c /tmp/b2f68981c5595a69489926ea",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1820",
                                                                 "name":  "/tmp/b2f68981c5595a69489926ea",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "1821",
                                                                                      "name":  "fork()",
                                                                                      "children":  [
                                                                                                       {
                                                                                                           "process_id":  "1822",
                                                                                                           "name":  "fork()"
                                                                                                       }
                                                                                                   ]
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "105",
                                            "children":  [
                                                             {
                                                                 "process_id":  "109",
                                                                 "name":  "/usr/sbin/dropb",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "111",
                                                                                      "name":  "/usr/sbin/dropb",
                                                                                      "children":  [
                                                                                                       {
                                                                                                           "process_id":  "112",
                                                                                                           "name":  "/usr/sbin/dropb",
                                                                                                           "children":  [
                                                                                                                            "@{process_id=113; name=/usr/sbin/dropb}"
                                                                                                                        ]
                                                                                                       }
                                                                                                   ]
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "4371",
                                            "name":  "dash",
                                            "time_offset":  14674,
                                            "children":  [
                                                             {
                                                                 "process_id":  "4372",
                                                                 "name":  "8bb7ea763c38ef89d5274ef1c8bede94.",
                                                                 "time_offset":  14674
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "4372",
                                            "name":  "8bb7ea763c38ef89d5274ef1c8bede94.",
                                            "time_offset":  14674
                                        },
                                        {
                                            "process_id":  "3799",
                                            "name":  "/tmp/sample",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3800",
                                                                 "name":  "/tmp/sample n/a",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3801",
                                                                                      "name":  "/tmp/sample n/a",
                                                                                      "children":  [
                                                                                                       {
                                                                                                           "process_id":  "3803",
                                                                                                           "name":  "/tmp/sample n/a"
                                                                                                       },
                                                                                                       {
                                                                                                           "process_id":  "3848",
                                                                                                           "name":  "/tmp/sample n/a"
                                                                                                       }
                                                                                                   ]
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3880",
                                            "name":  "/bin/dpkg dpkg --print-architecture"
                                        }
                                    ],
                 "memory_pattern_urls":  [
                                             "http://141.98.6.169/bins.sh;"
                                         ],
                 "processes_created":  [
                                           "sh -c /tmp/b2f68981c5595a69489926ea",
                                           "/tmp/b2f68981c5595a69489926ea",
                                           "fork()",
                                           "/tmp/sample",
                                           "/tmp/sample n/a",
                                           "/bin/dpkg dpkg --print-architecture"
                                       ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Destination Unreachable Host Unreachable",
                                        "rule_id":  "1:399",
                                        "alert_severity":  "low",
                                        "alert_context":  {
                                                              "src_ip":  "45.137.207.99"
                                                          }
                                    },
                                    {
                                        "rule_msg":  "MALWARE-CNC Linux.Backdoor.Flooder inbound connection attempt - command",
                                        "rule_category":  "trojan-activity",
                                        "rule_id":  "1:32009",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "src_ip":  "141.98.6.169",
                                                              "src_port":  23
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_references":  [
                                                                "https://www.virustotal.com/en/file/73b0d95541c84965fa42c3e257bb349957b3be626dec9d55efcc6ebcba6fa489/analysis/"
                                                            ],
                                        "rule_raw":  "alert tcp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"MALWARE-CNC Linux.Backdoor.Flooder inbound connection attempt - command\"; flow:to_client,established; isdataat:!14; content:\"|21 2A 20|SCANNER ON\",fast_pattern,nocase; metadata:ruleset community; reference:url,www.virustotal.com/en/file/73b0d95541c84965fa42c3e257bb349957b3be626dec9d55efcc6ebcba6fa489/analysis/; classtype:trojan-activity; sid:32009; rev:3; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Destination Unreachable Network Unreachable",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:401",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP Destination Unreachable Network Unreachable\"; icode:0; itype:3; metadata:ruleset community; classtype:misc-activity; sid:401; rev:9; )"
                                    },
                                    {
                                        "rule_msg":  "(decode) loopback IP",
                                        "rule_category":  "bad-unknown",
                                        "rule_id":  "116:150",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:116; sid:150; rev:2; msg:\"(decode) loopback IP\"; metadata: policy max-detect-ips drop, rule-type decode; classtype:bad-unknown;)"
                                    },
                                    {
                                        "rule_msg":  "ET DROP Spamhaus DROP Listed Traffic Inbound group 19",
                                        "rule_category":  "Misc Attack",
                                        "rule_id":  "1:2400018",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "src_ip":  "169.246.180.197",
                                                              "src_port":  23
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://www.spamhaus.org/drop/drop.lasso"
                                                            ],
                                        "rule_raw":  "alert ip [169.136.224.0/19,169.239.48.0/22,169.239.152.0/22,169.245.0.0/16,169.246.0.0/15,169.248.0.0/14,170.67.0.0/16,170.83.232.0/22,170.113.0.0/16,170.179.0.0/16,170.244.240.0/22,170.247.220.0/22,171.26.0.0/16,175.103.64.0/18,176.113.115.0/24,176.126.192.0/23,176.126.194.0/24,176.223.116.0/23,176.223.118.0/24,177.234.136.0/21] any -\u003e $HOME_NET any (msg:\"ET DROP Spamhaus DROP Listed Traffic Inbound group 19\"; reference:url,www.spamhaus.org/drop/drop.lasso; threshold: type limit, track by_src, seconds 3600, count 1; classtype:misc-attack; flowbits:set,ET.Evil; flowbits:set,ET.DROPIP; sid:2400018; rev:3773; metadata:affected_product Any, attack_target Any, deployment Perimeter, tag Dshield, signature_severity Minor, created_at 2010_12_30, updated_at 2023_10_16;)"
                                    },
                                    {
                                        "rule_msg":  "ET DROP Spamhaus DROP Listed Traffic Inbound group 15",
                                        "rule_category":  "Misc Attack",
                                        "rule_id":  "1:2400014",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "src_ip":  "160.116.165.90",
                                                              "src_port":  23
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://www.spamhaus.org/drop/drop.lasso"
                                                            ],
                                        "rule_raw":  "alert ip [157.162.0.0/16,157.186.0.0/16,157.195.0.0/16,158.249.0.0/16,159.80.0.0/16,159.85.0.0/16,159.174.0.0/16,159.219.0.0/16,159.229.0.0/16,160.14.0.0/16,160.21.0.0/16,160.115.0.0/16,160.116.0.0/16,160.117.0.0/16,160.121.0.0/16,160.122.0.0/16,160.180.0.0/16,160.188.0.0/16,160.240.0.0/16,161.0.0.0/19] any -\u003e $HOME_NET any (msg:\"ET DROP Spamhaus DROP Listed Traffic Inbound group 15\"; reference:url,www.spamhaus.org/drop/drop.lasso; threshold: type limit, track by_src, seconds 3600, count 1; classtype:misc-attack; flowbits:set,ET.Evil; flowbits:set,ET.DROPIP; sid:2400014; rev:3773; metadata:affected_product Any, attack_target Any, deployment Perimeter, tag Dshield, signature_severity Minor, created_at 2010_12_30, updated_at 2023_10_16;)"
                                    }
                                ],
                 "mbc":  [
                             {
                                 "id":  "C0058",
                                 "objective":  "Data",
                                 "behavior":  "Modulo",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "calculate modulo 256 via x86 assembly"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0016",
                                 "objective":  "File System",
                                 "behavior":  "Create File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create process on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.010",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create UDP Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create UDP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.003",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create raw socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process via kill"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0052",
                                 "objective":  "File System",
                                 "behavior":  "Writes File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "write file on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.007",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Send Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "send data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "read file on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.012",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Get Socket Status",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get socket status"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0002.003",
                                 "objective":  "Communication",
                                 "behavior":  "HTTP Communication",
                                 "method":  "Send Request",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "send HTTP request"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0002"
                             },
                             {
                                 "id":  "C0005.001"
                             }
                         ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1016",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get socket status",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get socket status"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get system information on Linux",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get system information on Linux"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "signature_description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                 },
                                                 {
                                                     "id":  "T1046",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "Network portsweep"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "signature_description":  "get system information on Linux"
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "signature_description":  "The process originated ICMP traffic"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "signature_description":  "Created network traffic indicative of malicious activity"
                                                 },
                                                 {
                                                     "id":  "T1036",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Sample and/or dropped files symbols with suspicious names",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4005"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1018",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "Opens /proc/net/route. Can be used to find connected routers",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4037"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "calculate modulo 256 via x86 assembly",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create process on Linux",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create process on Linux\n    namespace: host-interaction/process/create\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x40236D\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: execve\n        - and:\n          - match: execute syscall\n          - arch: aarch64\n          - number: 0xdd = execve\n        - api: execl\n        - api: execlp\n        - api: execle\n        - api: execv\n        - api: execvp\n        - api: execvpe\n        - api: posix_spawn\n        - api: posix_spawnp\n        - api: popen\n        - api: fork\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create UDP socket",
                                               "description":  "communication/socket/udp/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create UDP socket\n    namespace: communication/socket/udp/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create UDP Socket [C0001.010]\n    examples:\n      - 203BD48BCC18434314AD60F4C8BC21E3D3422EB0624B22B827410F9BC63B4082:0x401240\n  features:\n    - or:\n      - and:\n        - count(number(2 = AF_INET/SOCK_DGRAM)): 2 or more\n        - or:\n          - api: socket\n          - api: ws2_32.socket\n          - api: ws2_32.#23 = socket\n          - api: ws2_32.WSASocket\n          - api: ws2_32.#82 = WSASocketA\n          - api: ws2_32.#83 = WSASocketW\n          - api: System.Net.Sockets.Socket::ctor\n      - api: System.Net.Sockets.UdpClient::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create raw socket",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "blas.kojusner@mandiant.com"
                                                           ],
                                               "rule_src":  "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: create raw socket\n    namespace: communication/socket\n    authors:\n      - blas.kojusner@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create Socket [C0001.003]\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/winsock/tcp-ip-raw-sockets-2\n      - https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-socket\n      - https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsasocketa\n    examples:\n      - 10EBCF8C20403457A08762200015B151:0x140001000\n  features:\n    - and:\n      - or:\n        - api: socket\n        - api: ws2_32.#23 = socket\n        - api: ws2_32.WSASocket\n        - api: ws2_32.#82 = WSASocketA\n        - api: ws2_32.#83 = WSASocketW\n      - or:\n        - number: 2 = AF_INET\n        - number: 23 = AF_INET6\n      - number: 3 = SOCK_RAW\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://learn.microsoft.com/en-us/windows/win32/winsock/tcp-ip-raw-sockets-2"
                                                            },
                                                            {
                                                                "ref":  "https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-socket"
                                                            },
                                                            {
                                                                "ref":  "https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsasocketa"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process via kill",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process via kill\n    namespace: host-interaction/process/terminate\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x402424\n  features:\n    - and:\n      - os: linux\n      - api: kill\n      - or:\n        - number: 1 = SIGHUP - controlling terminal closed\n        - number: 2 = SIGINT - interupt process stream, ctrl-C\n        - number: 3 = SIGQUIT - like ctrl-C but with a core dump\n        - number: 6 = SIGABRT\n        - number: 9 = SIGKILL - terminate immediately/hard kill\n        - number: 15 = SIGTERM - terminate whenever/soft kill\n        - number: 19 = SIGSTOP - Pause the process / free command line, ctrl-Z\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get current PID on Linux",
                                               "description":  "host-interaction/process",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get current PID on Linux\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: getpid\n        - api: getppid\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set thread name on Linux",
                                               "description":  "host-interaction/thread",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set thread name on Linux\n    namespace: host-interaction/thread\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: pthread_setname_np\n        - and:\n          - api: prctl\n          - number: 0xF = PR_SET_NAME\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Linux",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Linux\n    namespace: host-interaction/file-system/write\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x401E14\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: fputc\n        - api: fputs\n        - api: putc\n        - api: write\n        - api: fputwc\n        - api: putwc\n        - api: fputws\n        - api: write\n        - api: fwrite\n        - api: putwchar\n        - api: dprintf\n        - api: vdprintf\n        - api: fprintf\n        - api: vfprintf\n      - optional:\n        - match: create or open file\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "send data on socket",
                                               "description":  "communication/socket/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: send\n      - api: ws2_32.send\n      - api: ws2_32.#19 = send\n      - api: ws2_32.sendto\n      - api: ws2_32.#20 = sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.#76 = WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: ws2_32.#78 = WSASendTo\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Linux",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Linux\n    namespace: host-interaction/file-system/read\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x4059AD\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - optional:\n        - match: create or open file\n      - or:\n        - api: fgetc\n        - api: fgets\n        - api: getc\n        - api: getchar\n        - api: read\n        - api: getline\n        - api: getdelim\n        - api: fgetwc\n        - api: getwc\n        - api: fscanf\n        - api: vfscanf\n        - api: fread\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get socket status",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get socket status\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    mbc:\n      - Communication::Socket Communication::Get Socket Status [C0001.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.select\n      - api: ws2_32.#18 = select\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "send HTTP request",
                                               "description":  "communication/http/client",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: send HTTP request\n    namespace: communication/http/client\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::HTTP Communication::Send Request [C0002.003]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x100026E0\n  features:\n    - or:\n      - api: System.Net.WebRequest::GetResponse\n      - api: System.Net.WebRequest::GetResponseAsync\n      - and:\n        - or:\n          - api: wininet.HttpOpenRequest\n          - api: wininet.InternetConnect\n        - or:\n          - api: wininet.HttpSendRequest\n          - api: wininet.HttpSendRequestEx\n      - and:\n        - api: winhttp.WinHttpSendRequest\n        - api: winhttp.WinHttpWriteData\n        - optional:\n          - or:\n            - api: winhttp.WinHttpOpenRequest\n            - api: winhttp.WinHttpConnect\n      - and:\n        - match: send data on socket\n        - string: /HTTP/i\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "map or unmap memory on Linux",
                                               "description":  "host-interaction/memory",
                                               "authors":  [
                                                               "mehunhoff@google.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: map or unmap memory on Linux\n    namespace: host-interaction/memory\n    authors:\n      - mehunhoff@google.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: mmap\n        - api: munmap\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get system information on Linux",
                                               "description":  "host-interaction/os/info",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get system information on Linux\n    namespace: host-interaction/os/info\n    authors:\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n  features:\n    - and:\n      - os: linux\n      - or:\n        - api: sysconf\n        - and:\n          - api: system\n          - string: \"lshw\"\n        - api: sysinfo\n"
                                           },
                                           {
                                               "id":  "stealth_network",
                                               "name":  "stealth_network",
                                               "description":  "Network activity detected but not expressed in monitor API logs",
                                               "match_data":  [
                                                                  "{\"ip\": \"141.98.6.169\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "reads_files",
                                               "name":  "reads_files",
                                               "description":  "Reads files from disk",
                                               "match_data":  [
                                                                  "{\"ReadFile\": \"/lib/x86_64-linux-gnu/libc.so.6\"}",
                                                                  "{\"ReadFile\": \"/proc/net/route\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "drops_files",
                                               "name":  "drops_files",
                                               "description":  "Drops files onto disk",
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "writes_files",
                                               "name":  "writes_files",
                                               "description":  "Writes to files on disk",
                                               "match_data":  [
                                                                  "{\"WriteFile\": \"STDOUT\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "7037",
                                               "description":  "Malicious sample detected (through community Yara rule)",
                                               "match_data":  [
                                                                  "Linux_Trojan_Gafgyt_6321b565 Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_c573932b Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_5bf62ce4 Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_750fe002 Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_6122acdf Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_71e487ea Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_7167d08f Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_20f5e74f Author: unknown",
                                                                  "Linux_Trojan_Gafgyt_fb14e81f Author: unknown",
                                                                  "Linux_Trojan_Mirai_389ee3e9 Author: unknown"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_HIGH"
                                           },
                                           {
                                               "id":  "4037",
                                               "description":  "Opens /proc/net/* files useful for finding connected devices and routers",
                                               "match_data":  [
                                                                  "/proc/net/route"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "287",
                                               "description":  "Yara signature match",
                                               "match_data":  [
                                                                  "Linux_Trojan_Gafgyt_6321b565 reference_sample = cd48addd392e7912ab15a5464c710055f696990fab564f29f13121e7a5e93730, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, ",
                                                                  "Linux_Trojan_Gafgyt_c573932b reference_sample = 4c6aeaa6f6a0c40a3f4116a2e19e669188a8b1678a8930350889da1bab531c68, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, ",
                                                                  "Linux_Trojan_Gafgyt_5bf62ce4 reference_sample = 4c6aeaa6f6a0c40a3f4116a2e19e669188a8b1678a8930350889da1bab531c68, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, ",
                                                                  "Linux_Trojan_Gafgyt_750fe002 reference_sample = 4c6aeaa6f6a0c40a3f4116a2e19e669188a8b1678a8930350889da1bab531c68, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, ",
                                                                  "Linux_Trojan_Gafgyt_6122acdf os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, license = Elastic License v2, threat_name = Linux.Trojan.Gafgyt, fingerprint = 283275",
                                                                  "Linux_Trojan_Gafgyt_71e487ea reference_sample = b8d044f2de21d20c7e4b43a2baf5d8cdb97fba95c3b99816848c0f214515295b, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, ",
                                                                  "Linux_Trojan_Gafgyt_7167d08f reference_sample = 4c6aeaa6f6a0c40a3f4116a2e19e669188a8b1678a8930350889da1bab531c68, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, ",
                                                                  "Linux_Trojan_Gafgyt_20f5e74f reference_sample = 9084b00f9bb71524987dc000fb2bc6f38e722e2be2832589ca4bb1671e852f5b, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory, ",
                                                                  "Linux_Trojan_Gafgyt_fb14e81f severity = 100, os = linux, arch_context = x86, creation_date = 2022-01-05, scan_context = file, memory, reference = 0fd07e6068a721774716eb4940e2c19faef02d5bdacf3b018bf599",
                                                                  "Linux_Trojan_Mirai_389ee3e9 reference_sample = 5217f2a46cb93946e04ab00e385ad0fe0a2844b6ea04ef75ee9187aac3f3d52f, os = linux, severity  = x86, creation_date = 2022-01-05, scan_context = file, memory, l"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4004",
                                               "description":  "Sample and/or dropped files contains symbols with file path information",
                                               "match_data":  [
                                                                  "libc/sysdeps/linux/i386/crt1.S",
                                                                  "libc/sysdeps/linux/i386/crti.S",
                                                                  "libc/sysdeps/linux/i386/crtn.S",
                                                                  "libc/sysdeps/linux/i386/mmap.S",
                                                                  "libc/sysdeps/linux/i386/vfork.S"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4005",
                                               "description":  "Sample and/or dropped files contains symbols with suspicious names",
                                               "match_data":  [
                                                                  "passwords",
                                                                  "usernames"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "715",
                                               "description":  "Classification label",
                                               "match_data":  [
                                                                  "mal52.spre.lin@0/0@0/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "238",
                                               "description":  "URLs found in memory or binary data",
                                               "match_data":  [
                                                                  "http://141.98.6.169/bins.sh;"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           }
                                       ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "141.98.6.169",
                                        "destination_port":  23
                                    },
                                    {
                                        "destination_ip":  "71.183.176.131",
                                        "destination_port":  23
                                    },
                                    {
                                        "destination_ip":  "141.98.6.169",
                                        "destination_port":  23,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "command_executions":  [
                                            "sh -c /tmp/8bb7ea763c38ef89d5274ef1c8bede94.",
                                            "dpkg --print-architecture"
                                        ],
                 "files_opened":  [
                                      "/proc/net/route",
                                      "/etc/dpkg/dpkg.cfg",
                                      "/etc/dpkg/dpkg.cfg.d",
                                      "/etc/dpkg/dpkg.cfg.d/pkg-config-hook-config",
                                      "/etc/locale.alias",
                                      "/proc/3799/net/route",
                                      "/proc/filesystems",
                                      "/usr/lib/locale/C.UTF-8/LC_CTYPE",
                                      "/usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache",
                                      "/usr/share/locale/locale.alias"
                                  ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "tags":  [
                              "TELNET_COMMUNICATION",
                              "SERVICE_SCAN",
                              "SETS_PROCESS_NAME"
                          ],
                 "memory_pattern_domains":  [
                                                "141.98.6.169"
                                            ],
                 "text_highlighted":  [
                                          "BUILD DONGS",
                                          "buf: BUILD DONGS",
                                          "",
                                          "buf: PROBING",
                                          "buf: PONG"
                                      ],
                 "attack_techniques":  {
                                           "T1016":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get socket status",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get socket status"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get system information on Linux",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get system information on Linux"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "get system information on Linux"
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Created network traffic indicative of malicious activity"
                                                         }
                                                     ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                         }
                                                     ],
                                           "T1046":  [
                                                         {
                                                             "severity":  "LOW",
                                                             "description":  "Network portsweep"
                                                         }
                                                     ],
                                           "T1095":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process originated ICMP traffic"
                                                         }
                                                     ],
                                           "T1036":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Sample and/or dropped files symbols with suspicious names",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "4005"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1018":  [
                                                         {
                                                             "severity":  "LOW",
                                                             "description":  "Opens /proc/net/route. Can be used to find connected routers",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "4037"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
