{
    "data":  {
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using AES",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "0"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "3"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference AES constants",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "7"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "signature_matches":  [
                                           {
                                               "id":  "0",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using AES",
                                               "description":  "data-manipulation/encryption/aes",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "Ivan Kwiatkowski (@JusticeRage)"
                                                           ],
                                               "rule_src":  "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: encrypt data using AES\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - william.ballenthin@mandiant.com\n      - Ivan Kwiatkowski (@JusticeRage)\n    scopes:\n      static: function\n      dynamic: unsupported  # requires bytes features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]\n      - Cryptography::Encrypt Data::AES [C0027.001]\n    references:\n      - https://github.com/JusticeRage/Manalyze/blob/8e77642c911d5d82b5f43b198667ab8c77a88763/bin/yara_rules/findcrypt.yara#L351\n      - https://github.com/creaktive/tsh/blob/53b822b9a07d8cc65f1f31c915cf834a2944e833/aes.c\n  features:\n    - or:\n      - bytes: 63 7c 77 7b f2 6b 6f c5 30 01 67 2b fe d7 ab 76 = AES_SBOX_ENC\n      - bytes: 63 00 00 00 00 00 00 00 7c 00 00 00 00 00 00 00 77 00 00 00 00 00 00 00 7b 00 00 00 00 00 00 00 f2 00 00 00 00 00 00 00 6b 00 00 00 00 00 00 00 6f 00 00 00 00 00 00 00 c5 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 67 00 00 00 00 00 00 00 2b 00 00 00 00 00 00 00 fe 00 00 00 00 00 00 00 d7 00 00 00 00 00 00 00 ab 00 00 00 00 00 00 00 76 = AES_SBOX_ENC\n      - bytes: 52 09 6a d5 30 36 a5 38 bf 40 a3 9e 81 f3 d7 fb = AES_SBOX_DEC\n      - bytes: 52 00 00 00 00 00 00 00 09 00 00 00 00 00 00 00 6a 00 00 00 00 00 00 00 d5 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 36 00 00 00 00 00 00 00 a5 00 00 00 00 00 00 00 38 00 00 00 00 00 00 00 bf 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a3 00 00 00 00 00 00 00 9e 00 00 00 00 00 00 00 81 00 00 00 00 00 00 00 f3 00 00 00 00 00 00 00 d7 00 00 00 00 00 00 00 fb = AES_SBOX_DEC\n      - bytes: a5 63 63 c6 84 7c 7c f8 99 77 77 ee 8d 7b 7b f6 = AES_T0_ENC\n      - bytes: a5 63 63 c6 00 00 00 00 84 7c 7c f8 00 00 00 00 99 77 77 ee 00 00 00 00 8d 7b 7b f6 = AES_T0_ENC\n      - bytes: 63 63 c6 a5 7c 7c f8 84 77 77 ee 99 7b 7b f6 8d = AES_T1_ENC\n      - bytes: 63 63 c6 a5 00 00 00 00 7c 7c f8 84 00 00 00 00 77 77 ee 99 00 00 00 00 7b 7b f6 8d = AES_T1_ENC\n      - bytes: 63 c6 a5 63 7c f8 84 7c 77 ee 99 77 7b f6 8d 7b = AES_T2_ENC\n      - bytes: 63 c6 a5 63 00 00 00 00 7c f8 84 7c 00 00 00 00 77 ee 99 77 00 00 00 00 7b f6 8d 7b = AES_T2_ENC\n      - bytes: c6 a5 63 63 f8 84 7c 7c ee 99 77 77 f6 8d 7b 7b = AES_T3_ENC\n      - bytes: c6 a5 63 63 00 00 00 00 f8 84 7c 7c 00 00 00 00 ee 99 77 77 00 00 00 00 f6 8d 7b 7b = AES_T3_ENC\n      - bytes: 63 63 63 63 7c 7c 7c 7c 77 77 77 77 7b 7b 7b 7b = AES_T4_ENC\n      - bytes: 50 a7 f4 51 53 65 41 7e c3 a4 17 1a 96 5e 27 3a = AES_T0_DEC\n      - bytes: 50 a7 f4 51 00 00 00 00 53 65 41 7e 00 00 00 00 c3 a4 17 1a 00 00 00 00 96 5e 27 3a = AES_T0_DEC\n      - bytes: a7 f4 51 50 65 41 7e 53 a4 17 1a c3 5e 27 3a 96 = AES_T1_DEC\n      - bytes: a7 f4 51 50 00 00 00 00 65 41 7e 53 00 00 00 00 a4 17 1a c3 00 00 00 00 5e 27 3a 96 = AES_T1_DEC\n      - bytes: f4 51 50 a7 41 7e 53 65 17 1a c3 a4 27 3a 96 5e = AES_T2_DEC\n      - bytes: f4 51 50 a7 00 00 00 00 41 7e 53 65 00 00 00 00 17 1a c3 a4 00 00 00 00 27 3a 96 5e = AES_T2_DEC\n      - bytes: 51 50 a7 f4 7e 53 65 41 1a c3 a4 17 3a 96 5e 27 = AES_T3_DEC\n      - bytes: 51 50 a7 f4 00 00 00 00 7e 53 65 41 00 00 00 00 1a c3 a4 17 00 00 00 00 3a 96 5e 27 = AES_T3_DEC\n      - bytes: 52 52 52 52 09 09 09 09 6a 6a 6a 6a d5 d5 d5 d5 = AES_T4_DEC\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/JusticeRage/Manalyze/blob/8e77642c911d5d82b5f43b198667ab8c77a88763/bin/yara_rules/findcrypt.yara#L351"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/creaktive/tsh/blob/53b822b9a07d8cc65f1f31c915cf834a2944e833/aes.c"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "2",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate PE sections",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "@Ana06",
                                                               "@mr-tz"
                                                           ],
                                               "match_data":  [
                                                                  "mnemonic: movzx",
                                                                  "mnemonic: mov"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n      - \"@mr-tz\"\n    scopes:\n      static: function\n      dynamic: unsupported  # requires offset, operand[1].offset, characteristic, mnemonic, basicblock features\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      # there should be some complexity to functions like this\n      - count(basic blocks): 3 or more\n      - optional:\n        - offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n      - instruction:\n        - or:\n          - mnemonic: mov\n          - mnemonic: movzx\n        - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - instruction:\n              - or:\n                - mnemonic: add\n                - mnemonic: mov\n                - mnemonic: movzx\n              - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - operand[1].offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header-\u003ee_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - 2 or more:\n        - operand[1].offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n        - operand[1].offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n        - operand[1].offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n        # there\u0027s also offset 0x8 = IMAGE_SECTION_HEADER.Misc.PhysicalAddress, but it\u0027s likely too common\n      - not:\n        # non-zeroing XOR was observed in FPs\n        - characteristic: nzxor\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://0x00sec.org/t/reflective-dll-injection/3080"
                                                            },
                                                            {
                                                                "ref":  "https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "3",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "tight loop",
                                                                  "nzxor"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "id":  "4",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "inspect section memory permissions",
                                               "description":  "load-code/pe : translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants",
                                               "authors":  [
                                                               "@Ana06"
                                                           ],
                                               "match_data":  [
                                                                  "PAGE_EXECUTE_READ",
                                                                  "IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE",
                                                                  "PAGE_EXECUTE"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: inspect section memory permissions\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    description: \"translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants\"\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - Discovery::Code Discovery::Inspect Section Memory Permissions [B0046.002]\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401480\n  features:\n    - and:\n      - os: windows\n      - 3 or more:\n        - and:\n          - number: 0x40000000 = IMAGE_SCN_MEM_READ\n          - number: 0x2 = PAGE_READONLY\n        - and:\n          - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x10 = PAGE_EXECUTE\n        - and:\n          - or:\n            - number: 0x60000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x20 = PAGE_EXECUTE_READ\n        - and:\n          - or:\n            - number: 0xC0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n          - number: 0x4 = PAGE_READWRITE\n        - and:\n          - or:\n            - number: 0xE0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n      - optional:\n        - number: 0x1 = PAGE_NOACCESS\n"
                                           },
                                           {
                                               "id":  "5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "hash data using djb2",
                                               "description":  "data-manipulation/hashing/djb2",
                                               "authors":  [
                                                               "awillia2@cisco.com",
                                                               "still@teamt5.org"
                                                           ],
                                               "match_data":  [
                                                                  "mnemonic: imul",
                                                                  "mnemonic: mov"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: hash data using djb2\n    namespace: data-manipulation/hashing/djb2\n    authors:\n      - awillia2@cisco.com\n      - still@teamt5.org\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Non-Cryptographic Hash::djb2 [C0030.006]\n    references:\n      - https://twitter.com/r3c0nst/status/1392405576131436546\n      - http://www.cse.yorku.ca/~oz/hash.html\n    examples:\n      - 6be0ae5cb7c3155f70d608fc7670d2d9:0x41DD19\n  features:\n    - and:\n      - instruction:\n        - description: hash = 5381\n        - mnemonic: mov\n        - number: 5381\n      - or:\n        - instruction:\n          - description: hash \u003c\u003c 5\n          - mnemonic: shl\n          - number: 5\n        - instruction:\n          - description: hash * 33\n          - or:\n            - mnemonic: mul\n            - mnemonic: imul\n          - number: 33\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://twitter.com/r3c0nst/status/1392405576131436546"
                                                            },
                                                            {
                                                                "ref":  "http://www.cse.yorku.ca/~oz/hash.html"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "6",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "match_data":  [
                                                                  "mnemonic: movzx",
                                                                  "loop"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "id":  "7",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference AES constants",
                                               "description":  "data-manipulation/encryption/aes",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference AES constants\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires bytes features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n  features:\n    - or:\n      - bytes: 50 a7 f4 51 53 65 41 7e = d-0\n      - bytes: 63 7c 77 7b f2 6b 6f c5 = s-box\n      - bytes: 52 09 6a d5 30 36 a5 38 = inv-s-box\n"
                                           }
                                       ],
                 "mbc":  [
                             {
                                 "id":  "E1027.m05",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encryption-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "0"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0027.001",
                                 "objective":  "Cryptography",
                                 "behavior":  "Encrypt Data",
                                 "method":  "AES",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "0"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0046.001",
                                 "objective":  "Discovery",
                                 "behavior":  "Code Discovery",
                                 "method":  "Enumerate PE Sections",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "2"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0046.002",
                                 "objective":  "Discovery",
                                 "behavior":  "Code Discovery",
                                 "method":  "Inspect Section Memory Permissions",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "4"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0030.006",
                                 "objective":  "Data",
                                 "behavior":  "Non-Cryptographic Hash",
                                 "method":  "djb2",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "5"
                                              }
                                          ]
                             }
                         ],
                 "attack_techniques":  {
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using AES",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "0"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "3"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference AES constants",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "7"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
