{
    "data":  {
                 "files_opened":  [
                                      "C:\\Users\\user\\Desktop\\server.exe",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\SYSTEM32\\ntmarta.dll",
                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                      "C:\\Windows\\SYSTEM32\\wintypes.dll",
                                      "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
                                      "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                                      "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                                      "C:\\Windows\\SysWOW64\\SspiCli.dll",
                                      "C:\\Windows\\SysWOW64\\WS2_32.dll",
                                      "C:\\Windows\\SysWOW64\\apphelp.dll",
                                      "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                                      "C:\\Windows\\SysWOW64\\ntdll.dll",
                                      "C:\\Windows\\SysWOW64\\sechost.dll",
                                      "C:\\Windows\\System32\\CoreMessaging.dll",
                                      "C:\\Windows\\System32\\CoreUIComponents.dll",
                                      "C:\\Windows\\System32\\TextInputFramework.dll",
                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
                                      "C:\\Windows\\system32\\IMM32.DLL",
                                      "C:\\Windows\\system32\\conhost.exe",
                                      "C:\\Windows\\system32\\dwmapi.dll",
                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                      "C:\\Windows\\system32\\rpcss.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll.Config"
                                  ],
                 "tags":  [
                              "CHECKS_USER_INPUT",
                              "IDLE"
                          ],
                 "verdict_confidence":  98,
                 "files_dropped":  [
                                       {
                                           "sha256":  "9dcd5ce0fb86c0ac54a4c1e8ba0b2e5e31754374e409acaa8e35df4f563f90d3"
                                       },
                                       {
                                           "path":  "\\Device\\ConDrv",
                                           "sha256":  "f861fb836e7137eff76fcdfa3d116d56e159f2cf14fc335d4907da0911cf2ef8",
                                           "type":  "TEXT",
                                           "process_name":  "C:\\Users\\user\\Desktop\\server.exe",
                                           "process_id":  "7548"
                                       }
                                   ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1071",
                                                     "signature_description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                 },
                                                 {
                                                     "id":  "T1070.006",
                                                     "signature_description":  "Adversaries may modify file time attributes to hide new or changes to existing files."
                                                 },
                                                 {
                                                     "id":  "T1070",
                                                     "signature_description":  "Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses."
                                                 },
                                                 {
                                                     "id":  "T1574.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to load missing DLLs",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "187"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1056",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates a DirectInput object (often for capturing keystrokes)",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "311"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "509"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "processes_created":  [
                                           "\"C:\\Users\\\u003cUSER\u003e\\Desktop\\server.exe\"",
                                           "%SAMPLEPATH%\\server.exe",
                                           "\"C:\\Users\\user\\Desktop\\server.exe\"",
                                           "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
                                       ],
                 "registry_keys_opened":  [
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableMetaFiles",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableUmpdBufferSizeCheck",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DllNXOptions",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager"
                                          ],
                 "processes_injected":  [
                                            "\\\\?\\C:\\Windows\\system32\\wbem\\WMIADAP.EXE"
                                        ],
                 "verdicts":  [
                                  "UNKNOWN_VERDICT",
                                  "CLEAN"
                              ],
                 "processes_terminated":  [
                                              "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                              "%CONHOST% \"1216938998-128559963-1626429127-1593967193-7846282212205416411524329346609417029",
                                              "%SAMPLEPATH%",
                                              "wmiadap.exe /F /T /R",
                                              "%SAMPLEPATH%\\server.exe",
                                              "C:\\Windows\\System32\\conhost.exe",
                                              "C:\\Users\\user\\Desktop\\server.exe"
                                          ],
                 "memory_dumps":  [
                                      {
                                          "file_name":  "3680.dmp",
                                          "process":  "C:\\Users\\Bruno\\Desktop\\server.exe",
                                          "size":  "35790848",
                                          "base_address":  "65536"
                                      },
                                      {
                                          "file_name":  "00000001.00000000.1128397429.0000000000400000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4194304",
                                          "stage":  "MEM_STAGE_NEW",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129435346.0000000000400000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4194304",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000000.1128414583.0000000000406000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4218880",
                                          "stage":  "MEM_STAGE_NEW",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129516098.0000000000470000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "24576",
                                          "base_address":  "4653056",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129616178.000000000090F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "9498624",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129491450.0000000000409000.00000004.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4231168",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129575936.000000000061A000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "49152",
                                          "base_address":  "6397952",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "refs":  [
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "311"
                                                       }
                                                   ],
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000000.1128427215.0000000000407000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4222976",
                                          "stage":  "MEM_STAGE_NEW",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129416111.000000000019C000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "16384",
                                          "base_address":  "1687552",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129442119.0000000000401000.00000020.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "20480",
                                          "base_address":  "4198400",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129379754.000000000009D000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "12288",
                                          "base_address":  "643072",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129477990.0000000000407000.00000004.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4222976",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000000.1128427215.0000000000409000.00000008.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4231168",
                                          "stage":  "MEM_STAGE_NEW",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129343734.0000000000010000.00000004.00000020.00040000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "65536",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129357696.0000000000020000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "131072",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129649456.0000000000A0F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "10547200",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129682824.0000000000B30000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "12288",
                                          "base_address":  "11730944",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000000.1128403257.0000000000401000.00000020.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "20480",
                                          "base_address":  "4198400",
                                          "stage":  "MEM_STAGE_NEW",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129457868.0000000000406000.00000002.00000001.01000000.00000003.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "4218880",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129524157.000000000058E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "8192",
                                          "base_address":  "5824512",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129575936.0000000000610000.00000004.00000020.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "32768",
                                          "base_address":  "6356992",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129428060.00000000001FE000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "8192",
                                          "base_address":  "2088960",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129498767.000000000044E000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "8192",
                                          "base_address":  "4513792",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      },
                                      {
                                          "file_name":  "00000001.00000002.1129595905.000000000080F000.00000004.00000010.00020000.00000000.sdmp",
                                          "process":  "C:\\Users\\user\\Desktop\\server.exe",
                                          "size":  "4096",
                                          "base_address":  "8450048",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "process_id":  "7548"
                                      }
                                  ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2168",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                                        },
                                        {
                                            "process_id":  "2596",
                                            "name":  "%CONHOST% \"1216938998-128559963-1626429127-1593967193-7846282212205416411524329346609417029"
                                        },
                                        {
                                            "process_id":  "2528",
                                            "name":  "%SAMPLEPATH%"
                                        },
                                        {
                                            "process_id":  "2748",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2788",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "3680",
                                            "name":  "\"C:\\Users\\\u003cUSER\u003e\\Desktop\\server.exe\""
                                        },
                                        {
                                            "process_id":  "2484",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3988",
                                                                 "name":  "%SAMPLEPATH%\\server.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "7548",
                                            "name":  "\"C:\\Users\\user\\Desktop\\server.exe\"",
                                            "children":  [
                                                             {
                                                                 "process_id":  "7592",
                                                                 "name":  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1",
                                                                 "files_opened":  [
                                                                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                                                                      "C:\\Windows\\SYSTEM32\\ntmarta.dll",
                                                                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                                                                      "C:\\Windows\\SYSTEM32\\wintypes.dll",
                                                                                      "C:\\Windows\\System32\\CoreMessaging.dll",
                                                                                      "C:\\Windows\\System32\\CoreUIComponents.dll",
                                                                                      "C:\\Windows\\System32\\TextInputFramework.dll",
                                                                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                                                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
                                                                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
                                                                                      "C:\\Windows\\system32\\IMM32.DLL",
                                                                                      "C:\\Windows\\system32\\conhost.exe",
                                                                                      "C:\\Windows\\system32\\dwmapi.dll",
                                                                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                                                                      "C:\\Windows\\system32\\rpcss.dll",
                                                                                      "C:\\Windows\\system32\\uxtheme.dll",
                                                                                      "C:\\Windows\\system32\\uxtheme.dll.Config"
                                                                                  ]
                                                             }
                                                         ],
                                            "files_opened":  [
                                                                 "C:\\Users\\user\\Desktop\\server.exe",
                                                                 "C:\\Windows\\AppPatch\\sysmain.sdb",
                                                                 "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
                                                                 "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                                                                 "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                                                                 "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                                                                 "C:\\Windows\\SysWOW64\\SspiCli.dll",
                                                                 "C:\\Windows\\SysWOW64\\WS2_32.dll",
                                                                 "C:\\Windows\\SysWOW64\\apphelp.dll",
                                                                 "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                                                                 "C:\\Windows\\SysWOW64\\ntdll.dll",
                                                                 "C:\\Windows\\SysWOW64\\sechost.dll"
                                                             ],
                                            "files_written":  [
                                                                  "\\Device\\ConDrv",
                                                                  "\\Device\\ConDrv\\\\Connect"
                                                              ]
                                        }
                                    ],
                 "command_executions":  [
                                            "%SAMPLEPATH%",
                                            "\"%SAMPLEPATH%\\server.exe\" ",
                                            " "
                                        ],
                 "files_deleted":  [
                                       "C:\\Windows\\System32\\wbem\\Performance\\WmiApRpl.h",
                                       "C:\\Windows\\System32\\wbem\\Performance\\WmiApRpl.ini"
                                   ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create UDP socket",
                                               "description":  "communication/socket/udp/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create UDP socket\n    namespace: communication/socket/udp/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create UDP Socket [C0001.010]\n    examples:\n      - 203BD48BCC18434314AD60F4C8BC21E3D3422EB0624B22B827410F9BC63B4082:0x401240\n  features:\n    - or:\n      - and:\n        - count(number(2 = AF_INET/SOCK_DGRAM)): 2 or more\n        - or:\n          - api: socket\n          - api: ws2_32.socket\n          - api: ws2_32.#23 = socket\n          - api: ws2_32.WSASocket\n          - api: ws2_32.#82 = WSASocketA\n          - api: ws2_32.#83 = WSASocketW\n          - api: System.Net.Sockets.Socket::ctor\n      - api: System.Net.Sockets.UdpClient::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate or change RWX memory",
                                               "description":  "host-interaction/process/inject",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate or change RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x40 = PAGE_EXECUTE_READWRITE\n        # lea     r9d, [rcx+40h]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x40 = PAGE_EXECUTE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "initialize Winsock library",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - or:\n      - api: ws2_32.WSAStartup\n      - api: ws2_32.#115 = WSAStartup\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data on socket",
                                               "description":  "communication/socket/receive",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: recv\n      - api: ws2_32.recv\n      - api: ws2_32.#16 = recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.#17 = recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.#71 = WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.#72 = WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.#73 = WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recvmsg\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data",
                                               "description":  "communication : all known techniques for receiving data from a potential C2 server",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n"
                                           },
                                           {
                                               "id":  "stealth_network",
                                               "name":  "stealth_network",
                                               "description":  "Network activity detected but not expressed in monitor API logs",
                                               "match_data":  [
                                                                  "{\"ip\": \"13.95.31.18\"}",
                                                                  "{\"ip\": \"199.232.210.172\"}",
                                                                  "{\"ip\": \"40.83.240.146\"}",
                                                                  "{\"ip\": \"52.152.180.155\"}",
                                                                  "{\"ip\": \"4.245.163.56\"}",
                                                                  "{\"ip\": \"40.126.28.14\"}",
                                                                  "{\"ip\": \"52.183.220.149\"}",
                                                                  "{\"ip\": \"23.36.220.65\"}",
                                                                  "{\"ip\": \"23.204.150.28\"}",
                                                                  "{\"ip\": \"23.55.178.178\"}",
                                                                  "{\"ip\": \"204.79.197.203\"}",
                                                                  "{\"domain\": \"wpad.hostonly\"}",
                                                                  "{\"domain\": \"settings-win.data.microsoft.com\"}",
                                                                  "{\"domain\": \"settings-prod-cin-1.centralindia.cloudapp.azure.com\"}",
                                                                  "{\"domain\": \"slscr.update.microsoft.com\"}",
                                                                  "{\"domain\": \"glb.sls.prod.dcat.dsp.trafficmanager.net\"}",
                                                                  "{\"domain\": \"s-part-0010.t-0009.t-msedge.net\"}",
                                                                  "{\"domain\": \"_ldap._tcp.dc._msdcs.WORKGROUP.hostonly\"}",
                                                                  "{\"domain\": \"dns.msftncsi.com\"}",
                                                                  "{\"domain\": \"ctldl.windowsupdate.com\"}",
                                                                  "{\"domain\": \"ocsp.digicert.com\"}",
                                                                  "{\"domain\": \"cdn.onenote.net\"}",
                                                                  "{\"domain\": \"login.live.com\"}",
                                                                  "{\"domain\": \"fe2cr.update.microsoft.com\"}",
                                                                  "{\"domain\": \"download.windowsupdate.com\"}",
                                                                  "{\"domain\": \"fe3cr.delivery.mp.microsoft.com\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "network_http",
                                               "name":  "network_http",
                                               "description":  "Performs some HTTP requests",
                                               "match_data":  [
                                                                  "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBQ50otx%2Fh0Ztl%2Bz8SiPI7wEWVxDlQQUTiJUIBiV5uNu5g%2F6%2BrkS7QYXjzkCEApDqVCbATUviZV57HIIulA%3D\"}",
                                                                  "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBSAUQYBMq2awn1Rh6Doh%2FsBYgFV7gQUA95QNVbRTLtm8KPiGxvDl7I90VUCEAJ0LqoXyo4hxxe7H%2Fz9DKA%3D\"}",
                                                                  "{\"url\": \"http://download.windowsupdate.com/d/msdownload/update/others/2015/05/17930914_a3b333eff1f0428f5a2c87724c542504821cdbd8.cab\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "procmem_yara",
                                               "name":  "procmem_yara",
                                               "description":  "Yara detections observed in process dumps, payloads or dropped files",
                                               "match_data":  [
                                                                  "{\"Hit\": \"PID 3680 triggered the Yara rule \u0027shellcode_get_eip\u0027 with data \u0027[\u0027{ E8 00 00 00 00 58 }\u0027]\u0027\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           },
                                           {
                                               "id":  "static_pe_anomaly",
                                               "name":  "static_pe_anomaly",
                                               "description":  "Anomalous binary characteristics",
                                               "match_data":  [
                                                                  "{\"anomaly\": \"Entrypoint of binary is located outside of any mapped sections\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           },
                                           {
                                               "id":  "187",
                                               "description":  "Tries to load missing DLLs",
                                               "match_data":  [
                                                                  "apphelp.dll"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "311",
                                               "description":  "Creates a DirectInput object (often for capturing keystrokes)",
                                               "match_data":  [
                                                                  "      \u003cHOOK MODULE=\"DDRAW.DLL\" FUNCTION=\"DirectDrawCreateEx\"/\u003e"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#memory_dumps",
                                                                "value":  "server.exe, 00000001.00000002.1129575936.000000000061A000.00000004.00000020.00020000.00000000.sdmp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "9028",
                                               "description":  "Uses 32bit PE files",
                                               "match_data":  [
                                                                  "RELOCS_STRIPPED, EXECUTABLE_IMAGE, LINE_NUMS_STRIPPED, LOCAL_SYMS_STRIPPED, 32BIT_MACHINE"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "430",
                                               "description":  "PE / OLE file has an invalid certificate",
                                               "match_data":  [
                                                                  "invalid certificate"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "95",
                                               "description":  "Creates mutexes",
                                               "match_data":  [
                                                                  "\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:7592:120:WilError_01"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "415",
                                               "description":  "PE file has an executable .text section and no other executable section",
                                               "match_data":  [
                                                                  "Section: .text IMAGE_SCN_CNT_CODE, IMAGE_SCN_MEM_EXECUTE, IMAGE_SCN_MEM_READ"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "509",
                                               "description":  "Reads software policies",
                                               "match_data":  [
                                                                  "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#registry_keys_opened",
                                                                "value":  "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "149",
                                               "description":  "Program does not show much activity (idle)",
                                               "match_data":  [
                                                                  "no activity detected"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "715",
                                               "description":  "Classification label",
                                               "match_data":  [
                                                                  "clean2.winEXE@2/1@0/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "626",
                                               "description":  "Sample tries to load a library which is not present or installed on the analysis machine, adding the library might reveal more behavior",
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "229",
                                               "description":  "Spawns processes",
                                               "match_data":  [
                                                                  "C:\\Users\\user\\Desktop\\server.exe \"C:\\Users\\user\\Desktop\\server.exe\"",
                                                                  "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "238",
                                               "description":  "URLs found in memory or binary data",
                                               "match_data":  [
                                                                  "http://crl.globalsign.com/ca/gstsacasha384g4.crl0",
                                                                  "http://crl.globalsign.com/codesigningrootr45.crl0U",
                                                                  "http://crl.globalsign.com/gsgccr45evcodesignca2020.crl0",
                                                                  "http://crl.globalsign.com/root-r3.crl0G",
                                                                  "http://crl.globalsign.com/root-r6.crl0G",
                                                                  "http://crl.globalsign.com/root.crl0G",
                                                                  "http://ocsp.globalsign.com/ca/gstsacasha384g40C",
                                                                  "http://ocsp.globalsign.com/codesigningrootr450F",
                                                                  "http://ocsp.globalsign.com/gsgccr45evcodesignca20200U",
                                                                  "http://ocsp.globalsign.com/rootr103",
                                                                  "http://ocsp.globalsign.com/rootr30;",
                                                                  "http://ocsp2.globalsign.com/rootr306",
                                                                  "http://ocsp2.globalsign.com/rootr606",
                                                                  "http://secure.globalsign.com/cacert/codesigningrootr45.crt0A",
                                                                  "http://secure.globalsign.com/cacert/gsgccr45evcodesignca2020.crt0?",
                                                                  "http://secure.globalsign.com/cacert/gstsacasha384g4.crt0",
                                                                  "http://secure.globalsign.com/cacert/root-r3.crt06",
                                                                  "https://www.globalsign.com/repository/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           }
                                       ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "www.microsoft.com",
                                         "resolved_ips":  [
                                                              "23.216.81.152"
                                                          ]
                                     }
                                 ],
                 "mbc":  [
                             {
                                 "id":  "C0001.010",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create UDP Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create UDP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate or change RWX memory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.009",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Initialize Winsock Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "initialize Winsock library"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.006",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0030.002",
                                 "objective":  "Command and Control",
                                 "behavior":  "C2 Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0002"
                             },
                             {
                                 "id":  "OB0006"
                             },
                             {
                                 "id":  "F0005"
                             },
                             {
                                 "id":  "F0005.004"
                             },
                             {
                                 "id":  "C0005.001"
                             }
                         ],
                 "files_written":  [
                                       "\\Device\\ConDrv",
                                       "\\Device\\ConDrv\\\\Connect"
                                   ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "192.168.0.12",
                                        "destination_port":  137,
                                        "transport_layer_protocol":  "UDP"
                                    },
                                    {
                                        "destination_ip":  "20.99.133.109",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.216.81.152",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "attack_techniques":  {
                                           "T1071":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                         }
                                                     ],
                                           "T1070.006":  [
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "Adversaries may modify file time attributes to hide new or changes to existing files."
                                                             }
                                                         ],
                                           "T1070":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses."
                                                         }
                                                     ],
                                           "T1574.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Tries to load missing DLLs",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "187"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1056":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates a DirectInput object (often for capturing keystrokes)",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "311"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "509"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
