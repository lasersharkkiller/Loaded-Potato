{
    "data":  {
                 "verdict_confidence":  56,
                 "processes_tree":  [
                                        {
                                            "process_id":  "6272",
                                            "name":  "\"C:\\Users\\\u003cUSER\u003e\\Desktop\\ss.exe\""
                                        }
                                    ],
                 "files_written":  [
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\CabB622.tmp",
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\TarB633.tmp"
                                   ],
                 "memory_dumps":  [
                                      {
                                          "file_name":  "6272.dmp",
                                          "process":  "C:\\Users\\Bruno\\Desktop\\ss.exe",
                                          "size":  "61415424",
                                          "base_address":  "2147352576"
                                      }
                                  ],
                 "modules_loaded":  [
                                        "ADVAPI32.DLL",
                                        "NETAPI32.DLL",
                                        "SspiCli.dll",
                                        "dhcpcsvc.DLL",
                                        "IPHLPAPI.DLL",
                                        "SHLWAPI.dll",
                                        "ADVAPI32.dll",
                                        "winhttp.dll",
                                        "WS2_32.dll",
                                        "kernel32.dll",
                                        "cryptsp.dll",
                                        "credssp.dll",
                                        "RPCRT4.dll",
                                        "C:\\Windows\\system32\\mswsock.dll",
                                        "C:\\Windows\\System32\\wshtcpip.dll",
                                        "API-MS-WIN-Service-Management-L1-1-0.dll",
                                        "API-MS-WIN-Service-Management-L2-1-0.dll",
                                        "CRYPTBASE.dll",
                                        "API-MS-WIN-Service-winsvc-L1-1-0.dll",
                                        "dhcpcsvc6.DLL",
                                        "ntdll.dll",
                                        "ole32.dll",
                                        "NSI.dll",
                                        "CFGMGR32.dll",
                                        "OLEAUT32.dll",
                                        "DNSAPI.dll",
                                        "C:\\Windows\\system32\\schannel.DLL",
                                        "secur32.dll",
                                        "ncrypt.dll",
                                        "C:\\Windows\\system32\\bcryptprimitives.dll",
                                        "USER32.dll",
                                        "CRYPT32.dll",
                                        "USERENV.dll",
                                        "API-MS-Win-Security-SDDL-L1-1-0.dll",
                                        "GPAPI.dll",
                                        "C:\\Windows\\system32\\rsaenh.dll",
                                        "C:\\Windows\\system32\\cryptnet.dll",
                                        "cryptnet.dll",
                                        "SensApi.dll",
                                        "C:\\Windows\\System32\\wship6.dll",
                                        "profapi.dll",
                                        "rasadhlp.dll",
                                        "C:\\Windows\\System32\\fwpuclnt.dll",
                                        "API-MS-Win-Core-LocalRegistry-L1-1-0.dll",
                                        "setupapi.dll",
                                        "Cabinet.dll",
                                        "DEVRTL.dll",
                                        "API-MS-Win-Security-LSALookup-L1-1-0.dll"
                                    ],
                 "ja3_digests":  [
                                     "72a589da586844d7f0818ce684948eea",
                                     "3fb606854ebf048da79310759b037bca"
                                 ],
                 "files_opened":  [
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\ncrypt.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\profapi.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\Cabinet.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\DPAPI.DLL",
                                      "C:\\Windows\\system32\\SSPICLI.DLL",
                                      "C:\\Windows\\system32\\WINHTTP.DLL",
                                      "C:\\Windows\\system32\\webio.dll",
                                      "C:\\Windows\\system32\\NETAPI32.DLL",
                                      "C:\\Windows\\system32\\netutils.dll",
                                      "C:\\Windows\\system32\\srvcli.dll",
                                      "C:\\Windows\\system32\\wkscli.dll",
                                      "C:\\Windows\\system32\\SAMCLI.DLL",
                                      "C:\\Windows\\system32\\dhcpcsvc.DLL",
                                      "\\DEVICE\\NETBT_TCPIP_{3C840B95-8252-4CDA-8A4C-5BA57747369D}",
                                      "C:\\Windows\\system32\\en-US\\KERNELBASE.dll.mui",
                                      "C:\\Windows\\system32\\cryptsp.dll",
                                      "C:\\Windows\\system32\\credssp.dll",
                                      "C:\\Windows\\system32\\mswsock.dll",
                                      "C:\\Windows\\System32\\wshtcpip.dll",
                                      "C:\\Windows\\system32\\dhcpcsvc6.DLL",
                                      "\\DEVICE\\NETBT_TCPIP_{846EE342-7039-11DE-9D20-806E6F6E6963}",
                                      "\\DEVICE\\NETBT_TCPIP_{3DFCAD32-1CDE-44FB-A9E1-D91126365830}",
                                      "C:\\Windows\\system32\\rpcss.dll",
                                      "\\Device\\Afd\\Endpoint",
                                      "C:\\Windows\\system32\\schannel.DLL",
                                      "C:\\Windows\\system32\\secur32.dll",
                                      "C:\\Windows\\system32\\ncrypt.dll",
                                      "C:\\Windows\\system32\\bcryptprimitives.dll",
                                      "C:\\Windows\\system32\\p2pcollab.dll",
                                      "C:\\Windows\\system32\\qagentrt.dll",
                                      "C:\\Windows\\system32\\dnsapi.dll",
                                      "C:\\Windows\\System32\\fveui.dll",
                                      "C:\\Windows\\System32\\wuaueng.dll",
                                      "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My\\Certificates\\",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My\\CRLs\\",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My\\CTLs\\",
                                      "C:\\Windows\\system32\\GPAPI.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My",
                                      "C:\\Windows\\system32\\CRYPTSP.dll",
                                      "C:\\Windows\\system32\\rsaenh.dll",
                                      "C:\\Windows\\system32\\cryptnet.dll",
                                      "C:\\Windows\\system32\\SensApi.dll",
                                      "C:\\Windows\\System32\\wship6.dll",
                                      "C:\\Windows\\system32\\en-US\\WINHTTP.DLL.mui",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\LocalLow",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\MetaData\\77EC63BDA74BD0D0E0426DC8F8008506",
                                      "C:\\Windows\\system32\\rasadhlp.dll",
                                      "\\Device\\RasAcd",
                                      "C:\\Windows\\system32\\drivers\\etc\\hosts",
                                      "C:\\Windows\\System32\\fwpuclnt.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\MetaData",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content\\77EC63BDA74BD0D0E0426DC8F8008506",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\CabB622.tmp",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\TarB633.tmp",
                                      "C:\\Windows\\system32\\Cabinet.dll",
                                      "CabB622.tmp",
                                      "C:\\Windows\\system32\\DEVRTL.dll",
                                      "C:\\Windows\\INF"
                                  ],
                 "processes_created":  [
                                           "\"C:\\Users\\\u003cUSER\u003e\\Desktop\\ss.exe\""
                                       ],
                 "mbc":  [
                             {
                                 "id":  "B0046.001",
                                 "objective":  "Discovery",
                                 "behavior":  "Code Discovery",
                                 "method":  "Enumerate PE Sections",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "0"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1027.m05",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encryption-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0027.001",
                                 "objective":  "Cryptography",
                                 "behavior":  "Encrypt Data",
                                 "method":  "AES",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0046.002",
                                 "objective":  "Discovery",
                                 "behavior":  "Code Discovery",
                                 "method":  "Inspect Section Memory Permissions",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "5"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0030.006",
                                 "objective":  "Data",
                                 "behavior":  "Non-Cryptographic Hash",
                                 "method":  "djb2",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "6"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0002"
                             }
                         ],
                 "verdict_labels":  [
                                        "Havoc"
                                    ],
                 "files_deleted":  [
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\CabB622.tmp",
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\TarB633.tmp"
                                   ],
                 "signature_matches":  [
                                           {
                                               "id":  "0",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate PE sections",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "@Ana06",
                                                               "@mr-tz"
                                                           ],
                                               "match_data":  [
                                                                  "mnemonic: mov",
                                                                  "mnemonic: movzx"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n      - \"@mr-tz\"\n    scopes:\n      static: function\n      dynamic: unsupported  # requires offset, operand[1].offset, characteristic, mnemonic, basicblock features\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      # there should be some complexity to functions like this\n      - count(basic blocks): 3 or more\n      - optional:\n        - offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n      - instruction:\n        - or:\n          - mnemonic: mov\n          - mnemonic: movzx\n        - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - instruction:\n              - or:\n                - mnemonic: add\n                - mnemonic: mov\n                - mnemonic: movzx\n              - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - operand[1].offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header-\u003ee_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - 2 or more:\n        - operand[1].offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n        - operand[1].offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n        - operand[1].offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n        # there\u0027s also offset 0x8 = IMAGE_SECTION_HEADER.Misc.PhysicalAddress, but it\u0027s likely too common\n      - not:\n        # non-zeroing XOR was observed in FPs\n        - characteristic: nzxor\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://0x00sec.org/t/reflective-dll-injection/3080"
                                                            },
                                                            {
                                                                "ref":  "https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "1",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using AES",
                                               "description":  "data-manipulation/encryption/aes",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "Ivan Kwiatkowski (@JusticeRage)"
                                                           ],
                                               "rule_src":  "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: encrypt data using AES\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - william.ballenthin@mandiant.com\n      - Ivan Kwiatkowski (@JusticeRage)\n    scopes:\n      static: function\n      dynamic: unsupported  # requires bytes features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]\n      - Cryptography::Encrypt Data::AES [C0027.001]\n    references:\n      - https://github.com/JusticeRage/Manalyze/blob/8e77642c911d5d82b5f43b198667ab8c77a88763/bin/yara_rules/findcrypt.yara#L351\n      - https://github.com/creaktive/tsh/blob/53b822b9a07d8cc65f1f31c915cf834a2944e833/aes.c\n  features:\n    - or:\n      - bytes: 63 7c 77 7b f2 6b 6f c5 30 01 67 2b fe d7 ab 76 = AES_SBOX_ENC\n      - bytes: 63 00 00 00 00 00 00 00 7c 00 00 00 00 00 00 00 77 00 00 00 00 00 00 00 7b 00 00 00 00 00 00 00 f2 00 00 00 00 00 00 00 6b 00 00 00 00 00 00 00 6f 00 00 00 00 00 00 00 c5 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 67 00 00 00 00 00 00 00 2b 00 00 00 00 00 00 00 fe 00 00 00 00 00 00 00 d7 00 00 00 00 00 00 00 ab 00 00 00 00 00 00 00 76 = AES_SBOX_ENC\n      - bytes: 52 09 6a d5 30 36 a5 38 bf 40 a3 9e 81 f3 d7 fb = AES_SBOX_DEC\n      - bytes: 52 00 00 00 00 00 00 00 09 00 00 00 00 00 00 00 6a 00 00 00 00 00 00 00 d5 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 36 00 00 00 00 00 00 00 a5 00 00 00 00 00 00 00 38 00 00 00 00 00 00 00 bf 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a3 00 00 00 00 00 00 00 9e 00 00 00 00 00 00 00 81 00 00 00 00 00 00 00 f3 00 00 00 00 00 00 00 d7 00 00 00 00 00 00 00 fb = AES_SBOX_DEC\n      - bytes: a5 63 63 c6 84 7c 7c f8 99 77 77 ee 8d 7b 7b f6 = AES_T0_ENC\n      - bytes: a5 63 63 c6 00 00 00 00 84 7c 7c f8 00 00 00 00 99 77 77 ee 00 00 00 00 8d 7b 7b f6 = AES_T0_ENC\n      - bytes: 63 63 c6 a5 7c 7c f8 84 77 77 ee 99 7b 7b f6 8d = AES_T1_ENC\n      - bytes: 63 63 c6 a5 00 00 00 00 7c 7c f8 84 00 00 00 00 77 77 ee 99 00 00 00 00 7b 7b f6 8d = AES_T1_ENC\n      - bytes: 63 c6 a5 63 7c f8 84 7c 77 ee 99 77 7b f6 8d 7b = AES_T2_ENC\n      - bytes: 63 c6 a5 63 00 00 00 00 7c f8 84 7c 00 00 00 00 77 ee 99 77 00 00 00 00 7b f6 8d 7b = AES_T2_ENC\n      - bytes: c6 a5 63 63 f8 84 7c 7c ee 99 77 77 f6 8d 7b 7b = AES_T3_ENC\n      - bytes: c6 a5 63 63 00 00 00 00 f8 84 7c 7c 00 00 00 00 ee 99 77 77 00 00 00 00 f6 8d 7b 7b = AES_T3_ENC\n      - bytes: 63 63 63 63 7c 7c 7c 7c 77 77 77 77 7b 7b 7b 7b = AES_T4_ENC\n      - bytes: 50 a7 f4 51 53 65 41 7e c3 a4 17 1a 96 5e 27 3a = AES_T0_DEC\n      - bytes: 50 a7 f4 51 00 00 00 00 53 65 41 7e 00 00 00 00 c3 a4 17 1a 00 00 00 00 96 5e 27 3a = AES_T0_DEC\n      - bytes: a7 f4 51 50 65 41 7e 53 a4 17 1a c3 5e 27 3a 96 = AES_T1_DEC\n      - bytes: a7 f4 51 50 00 00 00 00 65 41 7e 53 00 00 00 00 a4 17 1a c3 00 00 00 00 5e 27 3a 96 = AES_T1_DEC\n      - bytes: f4 51 50 a7 41 7e 53 65 17 1a c3 a4 27 3a 96 5e = AES_T2_DEC\n      - bytes: f4 51 50 a7 00 00 00 00 41 7e 53 65 00 00 00 00 17 1a c3 a4 00 00 00 00 27 3a 96 5e = AES_T2_DEC\n      - bytes: 51 50 a7 f4 7e 53 65 41 1a c3 a4 17 3a 96 5e 27 = AES_T3_DEC\n      - bytes: 51 50 a7 f4 00 00 00 00 7e 53 65 41 00 00 00 00 1a c3 a4 17 00 00 00 00 3a 96 5e 27 = AES_T3_DEC\n      - bytes: 52 52 52 52 09 09 09 09 6a 6a 6a 6a d5 d5 d5 d5 = AES_T4_DEC\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/JusticeRage/Manalyze/blob/8e77642c911d5d82b5f43b198667ab8c77a88763/bin/yara_rules/findcrypt.yara#L351"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/creaktive/tsh/blob/53b822b9a07d8cc65f1f31c915cf834a2944e833/aes.c"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "2",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "match_data":  [
                                                                  "mnemonic: movzx",
                                                                  "loop"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "id":  "3",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "nzxor",
                                                                  "tight loop"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "id":  "4",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference AES constants",
                                               "description":  "data-manipulation/encryption/aes",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference AES constants\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires bytes features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n  features:\n    - or:\n      - bytes: 50 a7 f4 51 53 65 41 7e = d-0\n      - bytes: 63 7c 77 7b f2 6b 6f c5 = s-box\n      - bytes: 52 09 6a d5 30 36 a5 38 = inv-s-box\n"
                                           },
                                           {
                                               "id":  "5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "inspect section memory permissions",
                                               "description":  "load-code/pe : translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants",
                                               "authors":  [
                                                               "@Ana06"
                                                           ],
                                               "match_data":  [
                                                                  "IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE",
                                                                  "PAGE_EXECUTE_READ",
                                                                  "IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: inspect section memory permissions\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    description: \"translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants\"\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - Discovery::Code Discovery::Inspect Section Memory Permissions [B0046.002]\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401480\n  features:\n    - and:\n      - os: windows\n      - 3 or more:\n        - and:\n          - number: 0x40000000 = IMAGE_SCN_MEM_READ\n          - number: 0x2 = PAGE_READONLY\n        - and:\n          - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x10 = PAGE_EXECUTE\n        - and:\n          - or:\n            - number: 0x60000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x20 = PAGE_EXECUTE_READ\n        - and:\n          - or:\n            - number: 0xC0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n          - number: 0x4 = PAGE_READWRITE\n        - and:\n          - or:\n            - number: 0xE0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n      - optional:\n        - number: 0x1 = PAGE_NOACCESS\n"
                                           },
                                           {
                                               "id":  "6",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "hash data using djb2",
                                               "description":  "data-manipulation/hashing/djb2",
                                               "authors":  [
                                                               "awillia2@cisco.com",
                                                               "still@teamt5.org"
                                                           ],
                                               "match_data":  [
                                                                  "mnemonic: mov",
                                                                  "mnemonic: imul"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: hash data using djb2\n    namespace: data-manipulation/hashing/djb2\n    authors:\n      - awillia2@cisco.com\n      - still@teamt5.org\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Non-Cryptographic Hash::djb2 [C0030.006]\n    references:\n      - https://twitter.com/r3c0nst/status/1392405576131436546\n      - http://www.cse.yorku.ca/~oz/hash.html\n    examples:\n      - 6be0ae5cb7c3155f70d608fc7670d2d9:0x41DD19\n  features:\n    - and:\n      - instruction:\n        - description: hash = 5381\n        - mnemonic: mov\n        - number: 5381\n      - or:\n        - instruction:\n          - description: hash \u003c\u003c 5\n          - mnemonic: shl\n          - number: 5\n        - instruction:\n          - description: hash * 33\n          - or:\n            - mnemonic: mul\n            - mnemonic: imul\n          - number: 33\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://twitter.com/r3c0nst/status/1392405576131436546"
                                                            },
                                                            {
                                                                "ref":  "http://www.cse.yorku.ca/~oz/hash.html"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "queries_user_name",
                                               "name":  "queries_user_name",
                                               "description":  "Queries the username",
                                               "match_data":  [
                                                                  "Process ss.exe"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "dead_connect",
                                               "name":  "dead_connect",
                                               "description":  "Attempts to connect to a dead IP:Port",
                                               "match_data":  [
                                                                  "Process ss.exe",
                                                                  "132.145.75.68:5970 (unknown)",
                                                                  "92.223.96.6:80 (unknown)"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "http_request",
                                               "name":  "http_request",
                                               "description":  "Performs HTTP requests potentially not found in PCAP.",
                                               "match_data":  [
                                                                  "Process ss.exe",
                                                                  "/"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "network_cnc_https_generic",
                                               "name":  "network_cnc_https_generic",
                                               "description":  "Establishes an encrypted HTTPS connection",
                                               "match_data":  [
                                                                  "POST / HTTP/1.1\r\nCache-Control: no-cache\r\nConnection: Keep-Alive\r\nPragma: no-cache\r\nContent-Type: */*\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36\r\nContent-Length: 259\r\nHost: 132.145.75.68:5970\r\n\r\n",
                                                                  "Process ss.exe",
                                                                  "POST / HTTP/1.1\r\nCache-Control: no-cache\r\nConnection: Keep-Alive\r\nPragma: no-cache\r\nContent-Type: */*\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36\r\nContent-Length: 20\r\nHost: 132.145.75.68:5970\r\n\r\n",
                                                                  "POST / HTTP/1.1\r\nCache-Control: no-cache\r\nConnection: Keep-Alive\r\nPragma: no-cache\r\nContent-Type: */*\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36\r\nContent-Length: 20\r\nHost: 132.145.75.68:5970\r\n\r\n"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "415",
                                               "description":  "PE file has an executable .text section and no other executable section",
                                               "match_data":  [
                                                                  "Section: .text IMAGE_SCN_CNT_CODE, IMAGE_SCN_MEM_EXECUTE, IMAGE_SCN_MEM_READ"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "420",
                                               "description":  "PE file does not import any functions",
                                               "match_data":  [
                                                                  "No import functions for PE file found"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "715",
                                               "description":  "Classification label",
                                               "match_data":  [
                                                                  "mal56.troj.winEXE@0/0@0/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "102606",
                                               "description":  "Yara detected Havoc",
                                               "match_data":  [
                                                                  "ss.exe, type: SAMPLE"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_HIGH"
                                           },
                                           {
                                               "id":  "419",
                                               "description":  "PE file has a high image base, often used for DLLs",
                                               "match_data":  [
                                                                  "Image base 0x140000000 \u003e 0x60000000"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "406",
                                               "description":  "Contains modern PE file flags such as dynamic base (ASLR) or NX",
                                               "match_data":  [
                                                                  "HIGH_ENTROPY_VA, DYNAMIC_BASE, NX_COMPAT, NO_SEH"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           }
                                       ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "ET ATTACK_RESPONSE Havoc/Sliver Framework TLS Certificate Observed",
                                        "rule_category":  "A Network Trojan was detected",
                                        "rule_id":  "1:2037675",
                                        "alert_severity":  "high",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "src_ip":  "132.145.75.68",
                                                              "src_port":  5970,
                                                              "ja3":  [
                                                                          "72a589da586844d7f0818ce684948eea"
                                                                      ],
                                                              "ja3s":  [
                                                                           "326de7c6719a77bb7ef65f6cac962193"
                                                                       ]
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://github.com/BishopFox/sliver/blob/97d3da75b6e24defb3a2a97443a15a632b3a8448/server/certs/subject.go"
                                                            ],
                                        "rule_raw":  "alert tls $EXTERNAL_NET any -\u003e $HOME_NET any (msg:\"ET ATTACK_RESPONSE Havoc/Sliver Framework TLS Certificate Observed\"; flow:established,to_client; tls.certs; content:\"|31 0b 30 09 06 03 55 04 06 13 02|US|31 11 30 0f 06 03 55 04 08 13 08|Illinois|31 13 30 11 06 03 55 04 07 13 0a|Naperville|31 09 30 07 06 03 55 04 09 13 00 31 0d 30 0b 06 03 55 04 11 13 04|\"; fast_pattern; pcre:\"/^\\d{4}[01]/R\"; content:\"|06 03 55 04 0a 13|\"; distance:3; within:6; content:\"ACME\"; nocase; distance:1; within:4; pcre:\"/^(?:\\s(?:co(?:rp)?|l(?:lc|td)|inc))?[01]/Ri\"; content:\"|06 03 55 04 03|\"; distance:3; within:5; content:!\"|2a 86 48 86 f7 0d 01 09 01|\"; reference:url,github.com/BishopFox/sliver/blob/97d3da75b6e24defb3a2a97443a15a632b3a8448/server/certs/subject.go; classtype:trojan-activity; sid:2037675; rev:2; metadata:affected_product Any, attack_target Client_and_Server, created_at 2022_07_07, deployment Perimeter, malware_family Sliver, malware_family Havoc, performance_impact Low, confidence High, signature_severity Major, updated_at 2024_01_03;)"
                                    },
                                    {
                                        "rule_msg":  "ET ATTACK_RESPONSE Havoc/Sliver Framework TLS Certificate Observed",
                                        "rule_category":  "A Network Trojan was detected",
                                        "rule_id":  "1:2037675",
                                        "alert_severity":  "high",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "src_ip":  "132.145.75.68",
                                                              "src_port":  5970,
                                                              "ja3":  [
                                                                          "3fb606854ebf048da79310759b037bca"
                                                                      ],
                                                              "ja3s":  [
                                                                           "bb8ffe549d81183544fcdb59cdf5267b"
                                                                       ]
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://github.com/BishopFox/sliver/blob/97d3da75b6e24defb3a2a97443a15a632b3a8448/server/certs/subject.go"
                                                            ],
                                        "rule_raw":  "alert tls $EXTERNAL_NET any -\u003e $HOME_NET any (msg:\"ET ATTACK_RESPONSE Havoc/Sliver Framework TLS Certificate Observed\"; flow:established,to_client; tls.certs; content:\"|31 0b 30 09 06 03 55 04 06 13 02|US|31 11 30 0f 06 03 55 04 08 13 08|Illinois|31 13 30 11 06 03 55 04 07 13 0a|Naperville|31 09 30 07 06 03 55 04 09 13 00 31 0d 30 0b 06 03 55 04 11 13 04|\"; fast_pattern; pcre:\"/^\\d{4}[01]/R\"; content:\"|06 03 55 04 0a 13|\"; distance:3; within:6; content:\"ACME\"; nocase; distance:1; within:4; pcre:\"/^(?:\\s(?:co(?:rp)?|l(?:lc|td)|inc))?[01]/Ri\"; content:\"|06 03 55 04 03|\"; distance:3; within:5; content:!\"|2a 86 48 86 f7 0d 01 09 01|\"; reference:url,github.com/BishopFox/sliver/blob/97d3da75b6e24defb3a2a97443a15a632b3a8448/server/certs/subject.go; classtype:trojan-activity; sid:2037675; rev:2; metadata:affected_product Any, attack_target Client_and_Server, created_at 2022_07_07, deployment Perimeter, malware_family Sliver, malware_family Havoc, performance_impact Low, confidence High, signature_severity Major, updated_at 2024_01_03;)"
                                    }
                                ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "132.145.75.68",
                                        "destination_port":  5970,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "calls_highlighted":  [
                                           "SystemFunction032",
                                           "AddMandatoryAce",
                                           "NetLocalGroupEnum",
                                           "NetGroupEnum",
                                           "NetUserEnum",
                                           "NetWkstaUserEnum",
                                           "NetSessionEnum",
                                           "NetShareEnum",
                                           "NetApiBufferFree",
                                           "GetTickCount",
                                           "Sleep",
                                           "GetAdaptersAddresses"
                                       ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using AES",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "1"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "3"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference AES constants",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "registry_keys_opened":  [
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakECDSAThirdPartyFlags",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\Default\\WeakSHA1AllFlags",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\System32\\fveui.dll,-844",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\WeakSHA1ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakDSAAllFlags",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\Default\\WeakMD5AllSha256Allow",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\system32\\dnsapi.dll,-103",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.10.3.37!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\crypt32\\DiagMatchAnyMask",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\Default\\WeakSHA1AllSha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakMD5ThirdPartyFlags",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\System32\\ci.dll,-101",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakMD5ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\WeakSHA1AllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxUrlRetrievalByteCount",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.10.3.37!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakMD5AllSha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakMD5ThirdPartyAfterTime",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\WeakMD5AllSha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MinRsaPubKeyBitLength",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.10.3.37!7",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\WeakMD5AllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakRSAThirdPartyFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.67.1.1!7",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.67.1.1!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakSHA1AllSha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.92.1.1!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakDSAAllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.67.1.1!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxAIAUrlCountInCert",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\crypt32\\DiagLevel",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakMD5ThirdPartyFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakSHA1ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\CryptnetPreFetchTriggerPeriodSeconds",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.92.1.1!7",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\system32\\NgcRecovery.dll,-100",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakMD5AllFlags",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\WeakSHA1AllSha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.76.6.1!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakRSAAllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxAIAUrlRetrievalCertCount",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.10.3.42!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\EnableStrictChecksFlags",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SecurityProviders\\SCHANNEL\\UserContextListCount",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\DisableCANameConstraints",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.67.1.2!7",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\System32\\fveui.dll,-843",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.10.3.42!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxAIAUrlRetrievalByteCount",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakMD5AllSha256Allow",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.80.1!7",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.67.1.2!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.80.1!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.92.1.1!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakDSAThirdPartyFlags",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\System32\\wuaueng.dll,-400",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakSHA1ThirdPartyFlags",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.80.1!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakRSAAllFlags",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SecurityProviders\\SCHANNEL\\UserContextLockCount",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxIssuerDepth",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxAIAUrlRetrievalCountPerChain",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\Default\\WeakSHA1ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\StringCacheSettings\\StringCacheGeneration",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\Default",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakSHA1ThirdPartyAfterTime",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakRSAThirdPartyFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakMD5AllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakECDSAThirdPartyFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakSHA1AllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakMD5ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakSHA1ThirdPartyFlags",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\System32\\ci.dll,-100",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\ChainCacheResyncFiletime",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\Default\\WeakMD5AllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxPathCountPerChain",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\DisableMandatoryBasicConstraints",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.76.6.1!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakSHA1AllFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakSHA1AllSha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\Default\\WeakMD5ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\CI\\Config\\WeakMD5ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.64.1.1!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakSHA1ThirdPartySha256Allow",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\WeakRsaPubKeyTime",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\MaxVerifySignatureCountPerChain",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\Default\\WeakDSAThirdPartyFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\EnableWeakSignatureFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CertDllCreateCertificateChainEngine\\Config\\DisableUnsupportedCriticalExtensions",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.67.1.2!7\\Name",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.76.6.1!7",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.64.1.1!7",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.64.1.1!7",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\MuiCache\\7a\\52C64B7E\\@%SystemRoot%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe,-124",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.3.6.1.4.1.311.10.3.42!7",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel",
                                              "System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel\\UserContextLockCount",
                                              "System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel\\UserContextListCount",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}"
                                          ],
                 "verdicts":  [
                                  "MALWARE",
                                  "TROJAN"
                              ],
                 "tls":  [
                             {
                                 "subject":  {
                                                 "ST":  "Illinois",
                                                 "L":  "Naperville",
                                                 "CN":  "0.0.0.0",
                                                 "O":  "acme co",
                                                 "C":  "US"
                                             },
                                 "issuer":  {
                                                "ST":  "Illinois",
                                                "L":  "Naperville",
                                                "CN":  "0.0.0.0",
                                                "O":  "acme co",
                                                "C":  "US"
                                            },
                                 "serial_number":  "31cb8c743e376f076513891365b239e9",
                                 "thumbprint":  "f36961a6c512fdd2bef7b209c7a4c8409ab2b650",
                                 "version":  "TLS 1.2",
                                 "ja3":  "72a589da586844d7f0818ce684948eea",
                                 "ja3s":  "326de7c6719a77bb7ef65f6cac962193",
                                 "ip_traffic":  [
                                                    {
                                                        "destination_ip":  "132.145.75.68",
                                                        "destination_port":  5970,
                                                        "transport_layer_protocol":  "TCP"
                                                    }
                                                ],
                                 "ja4":  "t12i190700_d83cc789557e_7af1ed941c26"
                             },
                             {
                                 "subject":  {
                                                 "ST":  "Illinois",
                                                 "L":  "Naperville",
                                                 "CN":  "0.0.0.0",
                                                 "O":  "acme co",
                                                 "C":  "US"
                                             },
                                 "issuer":  {
                                                "ST":  "Illinois",
                                                "L":  "Naperville",
                                                "CN":  "0.0.0.0",
                                                "O":  "acme co",
                                                "C":  "US"
                                            },
                                 "serial_number":  "31cb8c743e376f076513891365b239e9",
                                 "thumbprint":  "f36961a6c512fdd2bef7b209c7a4c8409ab2b650",
                                 "version":  "TLSv1",
                                 "ja3":  "3fb606854ebf048da79310759b037bca",
                                 "ja3s":  "bb8ffe549d81183544fcdb59cdf5267b",
                                 "ip_traffic":  [
                                                    {
                                                        "destination_ip":  "132.145.75.68",
                                                        "destination_port":  5970,
                                                        "transport_layer_protocol":  "TCP"
                                                    }
                                                ],
                                 "ja4":  "t10i120400_d94e65cdb899_559829c2a830"
                             }
                         ],
                 "http_conversations":  [
                                            {
                                                "url":  "https://132.145.75.68:5970/",
                                                "request_method":  "POST",
                                                "request_headers":  {
                                                                        "User-Agent":  "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Type":  "*/*"
                                                                     },
                                                "response_status_code":  200
                                            },
                                            {
                                                "url":  "132.145.75.68/",
                                                "request_method":  "POST"
                                            }
                                        ],
                 "services_opened":  [
                                         "dnsCache"
                                     ],
                 "attack_techniques":  {
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using AES",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "1"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "3"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "reference AES constants",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "4"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
