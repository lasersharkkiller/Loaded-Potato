{
    "data":  {
                 "command_executions":  [
                                            "%SAMPLEPATH%",
                                            "\"%windir%\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"%windir%\\SysWOW64\\svchost.exe\" enable=yes\u003enul",
                                            "\"%ComSpec%\" /C move /Y \"%TEMP%\\ukkhtfvt.exe\" %windir%\\SysWOW64\\uilrrcrq\\",
                                            "\"%ComSpec%\" /C mkdir %windir%\\SysWOW64\\uilrrcrq\\",
                                            "\"%windir%\\System32\\sc.exe\" create uilrrcrq binPath= \"%windir%\\SysWOW64\\uilrrcrq\\ukkhtfvt.exe /d\\\"%SAMPLEPATH%\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                            "\"%windir%\\System32\\sc.exe\" start uilrrcrq",
                                            "\"%windir%\\System32\\sc.exe\" description uilrrcrq \"wifi internet conection\"",
                                            "\"%SAMPLEPATH%\\kwebhuay.exe\" ",
                                            "\"C:\\Windows\\System32\\cmd.exe\" /C mkdir C:\\Windows\\SysWOW64\\zgsqyqr\\",
                                            "\"C:\\Windows\\System32\\cmd.exe\" /C move /Y \"%USERPROFILE%\\AppData\\Local\\Temp\\pnxyawzf.exe\" C:\\Windows\\SysWOW64\\zgsqyqr\\",
                                            "\"C:\\Windows\\System32\\sc.exe\" create zgsqyqr binPath= \"C:\\Windows\\SysWOW64\\zgsqyqr\\pnxyawzf.exe /d\\\"%SAMPLEPATH%\\kwebhuay.exe\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                            "\"C:\\Windows\\System32\\sc.exe\" description zgsqyqr \"wifi internet conection\"",
                                            "\"C:\\Windows\\System32\\sc.exe\" start zgsqyqr",
                                            "C:\\Windows\\SysWOW64\\zgsqyqr\\pnxyawzf.exe /d\"%SAMPLEPATH%\\kwebhuay.exe\"",
                                            "\"C:\\Windows\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"C:\\Windows\\SysWOW64\\svchost.exe\" enable=yes\u003enul",
                                            "svchost.exe",
                                            "cmd /C mkdir C:\\Windows\\SysWOW64\\evgjoukr\\",
                                            "cmd /C move /Y \"C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\qoyzbxag.exe\" C:\\Windows\\SysWOW64\\evgjoukr\\",
                                            "sc create evgjoukr binPath= \"C:\\Windows\\SysWOW64\\evgjoukr\\qoyzbxag.exe /d\\\"C:\\Users\\\u003cUSER\u003e\\Downloads\\kwebhuay.exe\\\"\" type= own start= auto DisplayName= \"wifi support\""
                                        ],
                 "registry_keys_opened":  [
                                              "HKEY_CURRENT_USER\\Software",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\SessionMerging",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_INITIALIZE_URLACTION_SHELLEXECUTE_TO_ALLOW_KB936610",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_PROTOCOL_LOCKDOWN",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SpecialFoldersCacheSize",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\EUPP Protected - It is a violation of Windows Policy to modify. See aka.ms/browserpolicy",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SpecialFoldersCacheSize",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_ZONES_CHECK_ZONEMAP_POLICY_KB941001",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Internet Explorer\\Main",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\EnablePunycode",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\EUPP Protected - It is a violation of Windows Policy to modify. See aka.ms/browserpolicy\\FirstRunComplete",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FrameTabWindow",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\EnablePunycode",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\TabProcGrowth",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup\\SystemSetupInProgress",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\1",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\2",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\3",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\4",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_ALLOW_REVERSE_SOLIDUS_IN_USERINFO_KB932562",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_IGNORE_POLICIES_ZONEMAP_IF_ESC_ENABLED_KB918915",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\KindMap",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_LOCALMACHINE_LOCKDOWN",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\CreateUriCacheSize",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FrameMerging",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_ZONES_DEFAULT_DRIVE_INTRANET_KB941000",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Security\\DisableSecuritySettingsCheck",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Internet Explorer",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Security",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Internet Explorer\\Main\\FeatureControl",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\AdminTabProcs",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\CreateUriCacheSize"
                                          ],
                 "verdict_confidence":  70,
                 "processes_terminated":  [
                                              "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                              "%CONHOST% \"894579687639933341183001330917295076009015057372024694219265275000514337798",
                                              "%CONHOST% \"-194845104-813038714203507352010543067449368811917216729001008576284-88337168",
                                              "%CONHOST% \"-828544789-209723651-2935655009328080516306746841364337933-1622962943-1326761479",
                                              "%CONHOST% \"-4026864841927029975-1024620082-11513033161885984883-57594916115665552611985869107",
                                              "%CONHOST% \"-176869090313219884051855012201201847304919124207611920385919560204319-2118202609",
                                              "%CONHOST% \"-10287856771574562896-611902116-1413231108-1989229438-19418383412094270439-495117321",
                                              "wmiadap.exe /F /T /R",
                                              "%windir%\\SysWOW64\\uilrrcrq\\ukkhtfvt.exe /d\"%SAMPLEPATH%\"",
                                              "%SAMPLEPATH%",
                                              "\"%windir%\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"%windir%\\SysWOW64\\svchost.exe\" enable=yes\u003enul",
                                              "\"%ComSpec%\" /C move /Y \"%TEMP%\\ukkhtfvt.exe\" %windir%\\SysWOW64\\uilrrcrq\\",
                                              "\"%ComSpec%\" /C mkdir %windir%\\SysWOW64\\uilrrcrq\\",
                                              "\"%windir%\\System32\\sc.exe\" create uilrrcrq binPath= \"%windir%\\SysWOW64\\uilrrcrq\\ukkhtfvt.exe /d\\\"%SAMPLEPATH%\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                              "\"%windir%\\System32\\sc.exe\" start uilrrcrq",
                                              "\"%windir%\\System32\\sc.exe\" description uilrrcrq \"wifi internet conection\"",
                                              "C:\\Windows\\SysWOW64\\cmd.exe",
                                              "C:\\Windows\\System32\\conhost.exe",
                                              "C:\\Windows\\SysWOW64\\sc.exe",
                                              "%SAMPLEPATH%\\kwebhuay.exe",
                                              "C:\\Windows\\SysWOW64\\zgsqyqr\\pnxyawzf.exe",
                                              "C:\\Windows\\SysWOW64\\netsh.exe",
                                              "C:\\Windows\\System32\\cmd.exe /C mkdir C:\\Windows\\SysWOW64\\evgjoukr\\",
                                              "C:\\Windows\\System32\\cmd.exe /C move /Y C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\qoyzbxag.exe C:\\Windows\\SysWOW64\\evgjoukr\\",
                                              "C:\\Windows\\System32\\sc.exe create evgjoukr binPath= C:\\Windows\\SysWOW64\\evgjoukr\\qoyzbxag.exe /d\\C:\\Users\\\u003cUSER\u003e\\Downloads\\kwebhuay.exe\\ type= own start= auto DisplayName= wifi support"
                                          ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "23.216.147.64",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.229.211.108",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "193.106.174.220",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "62.122.184.58",
                                        "destination_port":  484,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "239.255.255.250",
                                        "destination_port":  1900,
                                        "transport_layer_protocol":  "UDP"
                                    },
                                    {
                                        "destination_ip":  "176.113.115.84",
                                        "destination_port":  420,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.113.115.135",
                                        "destination_port":  420,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.113.115.136",
                                        "destination_port":  420,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "176.113.115.85",
                                        "destination_port":  420,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "62.122.184.92",
                                        "destination_port":  420,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.143.201.238",
                                        "destination_port":  420,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "80.66.75.4",
                                        "destination_port":  420,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "142.250.217.100",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "34.120.241.214",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "93.186.225.205",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "37.1.217.172",
                                        "destination_port":  25000,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "52.96.113.130",
                                        "destination_port":  587,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "34.117.59.81",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.186.246",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file attributes",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate RWX memory",
                                               "description":  "host-interaction/process/inject",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x40 = PAGE_EXECUTE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain obfuscated stackstrings",
                                               "description":  "anti-analysis/obfuscation/string/stackstring",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "move file",
                                               "description":  "host-interaction/file-system/move",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link many functions at runtime",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - os: linux\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete directory",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete directory\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete Directory [C0048]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x10009236\n      - AFB6EC3D721A5CB67863487B0E51A34C167F629CF701F8BC7A038C117B4DDA44:0x429AA0\n  features:\n    - or:\n      - api: RemoveDirectory\n      - api: RemoveDirectoryTransacted\n      - api: _rmdir\n      - api: _wrmdir\n      - api: System.IO.DirectoryInfo::Delete\n      - api: System.IO.Directory::Delete\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "accept command line arguments",
                                               "description":  "host-interaction/cli",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: accept command line arguments\n    namespace: host-interaction/cli\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Execution::Command and Scripting Interpreter [T1059]\n    mbc:\n      - Execution::Command and Scripting Interpreter [E1059]\n    examples:\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\n  features:\n    - or:\n      - api: GetCommandLine\n      - api: CommandLineToArgv\n      - api: System.Environment::GetCommandLineArgs\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get common file path",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Windows",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "manipulate console buffer",
                                               "description":  "host-interaction/console",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: manipulate console buffer\n    namespace: host-interaction/console\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Console [C0033]\n    references:\n      - https://stackoverflow.com/a/15770935/87207\n    examples:\n      - 3aa7ee4d67f562933bc998f352b1f319:0x705413A0\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.SetConsoleCursorPosition\n          - api: kernel32.ReadConsoleOutputCharacter\n          - api: kernel32.WriteConsoleOutputCharacter\n          - api: kernel32.WriteConsoleOutput\n          - api: kernel32.WriteConsoleInput\n        - optional:\n          - api: kernel32.GetStdHandle\n          - number: 0xfffffff5 = STD_OUTPUT_HANDLE\n      - api: System.Console::Write\n      - api: System.Console::WriteLine\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://stackoverflow.com/a/15770935/87207"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get disk information",
                                               "description":  "host-interaction/hardware/storage",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query environment variable",
                                               "description":  "host-interaction/environment-variable",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get hostname",
                                               "description":  "host-interaction/os/hostname",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete file",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get geographical location",
                                               "description":  "collection",
                                               "authors":  [
                                                               "moritz.raabe",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get geographical location\n    namespace: collection\n    authors:\n      - moritz.raabe\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Discovery::System Location Discovery [T1614]\n    examples:\n      - 9879D201DC5ACA863F357184CD1F170E:0x10001A99\n  features:\n    - or:\n      - api: GetLocaleInfo\n      - api: GetLocaleInfoEx\n      - api: kernel32.GetUserGeoID\n      - api: kernel32.GetGeoInfo\n      # strings part of requests or parsed from response\n      # \"geo\" and \"zip\" are too short\n      # \"region\" results in FPs mostly related to memory\n      - string: /geolocation/i\n      - string: /geo-location/i\n      - string: /^city/i\n      - string: /region_code/i\n      - string: /region_name/i\n      - string: /^country/i\n      - string: /country_code/i\n      - string: /countrycode/i\n      - string: /country_name/i\n      - string: /continent_code/i\n      - string: /continent_name/i\n      - string: /^latitude/i\n      - string: /^longitude/i\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read .ini file",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read .ini file\n    namespace: host-interaction/file-system/read\n    authors:\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x401070\n      - E6234FB98F17201C232F4502015B47B3:0x701312FA\n  features:\n    - and:\n      - or:\n        - api: GetPrivateProfileInt\n        - api: GetPrivateProfileString\n        - api: GetPrivateProfileStruct\n        - api: GetPrivateProfileSection\n        - api: GetPrivateProfileSectionNames\n      - optional:\n        - string: /\\.ini/i\n        - api: GetFullPathName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "copy file",
                                               "description":  "host-interaction/file-system/copy",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create mailslot",
                                               "description":  "communication/mailslot",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create mailslot\n    namespace: communication/mailslot\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication [C0003]\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/ipc/mailslots\n    examples:\n      - af13e7583ed1b27c4ae219e344a37e2b:0x40151D\n  features:\n    - and:\n      - api: kernel32.CreateMailslot\n      - optional:\n        - api: kernel32.GetMailslotInfo\n        - api: kernel32.SetMailslotInfo\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://learn.microsoft.com/en-us/windows/win32/ipc/mailslots"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain a resource (.rsrc) section",
                                               "description":  "executable/pe/section/rsrc",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n"
                                           }
                                       ],
                 "files_dropped":  [
                                       {
                                           "path":  "%windir%\\SysWOW64\\uilrrcrq\\ukkhtfvt.exe",
                                           "sha256":  "8455ed77f50f60d3fdc27380a66f3ad1eb4816613239dfc09446e981d485dee4"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Local\\Temp\\pnxyawzf.exe"
                                       },
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\zgsqyqr"
                                       },
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile"
                                       },
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile:.repos"
                                       },
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile:.repos",
                                           "sha256":  "c91f22102c811bc22d20dcb3258749ab023d592aed5db3bdee5ab5295ab44d5c"
                                       },
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile:.repos",
                                           "sha256":  "5f4f619c6ab3bc4f30dc616abb49e94968d4008c5d59921433358171759d9ffb"
                                       },
                                       {
                                           "path":  "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\qoyzbxag.exe",
                                           "sha256":  "96b3145c8fbe66df18b7cefa453d0e112c3516c050bfed1de70f151b25000961"
                                       }
                                   ],
                 "tags":  [
                              "CHECKS_DISK_SPACE"
                          ],
                 "files_deleted":  [
                                       "%SAMPLEPATH%\\kwebhuay.exe",
                                       "C:\\Windows\\SysWOW64\\config\\systemprofile:.repos"
                                   ],
                 "calls_highlighted":  [
                                           "GetTickCount",
                                           "GetDiskFreeSpaceA"
                                       ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027.005",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "contain obfuscated stackstrings",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "contain obfuscated stackstrings"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link many functions at runtime",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link many functions at runtime"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1059",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "accept command line arguments",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "accept command line arguments"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get common file path",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get common file path"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get disk information",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get disk information"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query environment variable",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query environment variable"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get hostname",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get hostname"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1614",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get geographical location",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get geographical location"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "files_opened":  [
                                      "\\xeqowop",
                                      "C:\\Windows\\system32\\msimg32.dll",
                                      "C:\\Windows\\system32\\dbghelp.dll",
                                      "pipe\\izknsyov",
                                      "C:\\Users\\\u003cUSER\u003e\\Downloads\\kwebhuay.exe",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\qoyzbxag.exe",
                                      "C:\\Users\\\u003cUSER\u003e\\Downloads",
                                      "C:\\Windows\\system32\\PROPSYS.dll",
                                      "C:\\Windows\\syswow64\\SHELL32.dll",
                                      "C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.24483_none_2b200f664577e14b",
                                      "C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.24483_none_2b200f664577e14b\\comctl32.dll",
                                      "C:\\Windows\\WindowsShell.Manifest",
                                      "C:\\Windows\\system32\\apphelp.dll",
                                      "C:\\Windows\\SysWOW64\\ieframe.dll",
                                      "\\SystemRoot\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\SysWOW64\\",
                                      "C:\\Windows\\",
                                      "C:\\Windows\\SysWOW64\\api-ms-win-downlevel-shell32-l1-1-0.dll",
                                      "C:\\Windows\\system32\\version.DLL",
                                      "C:\\Users\\\u003cUSER\u003e\\Downloads\\",
                                      "C:\\Windows\\system32\\",
                                      "C:\\Windows",
                                      "C:\\Windows\\System32",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\Windows\\Caches",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\Windows\\Caches\\cversions.1.db",
                                      "C:\\Windows\\system32\\ntmarta.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\Windows\\Caches\\{AFBF9F1A-8EE8-4C77-AF34-C647E37CA0D9}.1.ver0x0000000000000017.db",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\desktop.ini",
                                      "STORAGE#Volume#{61d44178-60b0-11ee-a358-806e6f6e6963}#0000000000100000#{53f5630d-b6bf-11d0-94f2-00a0c91efb8b}",
                                      "STORAGE#Volume#{61d44178-60b0-11ee-a358-806e6f6e6963}#0000000006500000#{53f5630d-b6bf-11d0-94f2-00a0c91efb8b}",
                                      "C:\\Windows\\SysWOW64\\propsys.dll",
                                      "C:\\Windows\\system32\\propsys.dll",
                                      "C:\\Windows\\SysWOW64\\urlmon.dll",
                                      "C:\\Windows\\system32\\Secur32.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Windows\\Cookies",
                                      "C:\\Windows\\System32\\",
                                      "C:\\Windows\\System32\\cmd.exe",
                                      "C:\\Windows\\System32\\cmd.exe:Zone.Identifier",
                                      "C:\\Users\\",
                                      "C:\\Users\\\u003cUSER\u003e\\",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp",
                                      "C:\\Windows\\SysWOW64\\evgjoukr",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\",
                                      "C:\\Windows\\System32\\sc.exe",
                                      "C:\\Windows\\System32\\sc.exe:Zone.Identifier"
                                  ],
                 "files_written":  [
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\qoyzbxag.exe",
                                       "C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Application Experience\\Microsoft Compatibility Appraiser"
                                   ],
                 "verdict_labels":  [
                                        "Tofsee",
                                        "Zenpack"
                                    ],
                 "modules_loaded":  [
                                        "C:\\Windows\\System32\\drivers\\http.sys",
                                        "SHELL32.dll",
                                        "ole32.dll",
                                        "ADVAPI32.dll",
                                        "propsys.dll",
                                        "C:\\Windows\\SysWOW64\\ieframe.dll",
                                        "comctl32.dll",
                                        "API-MS-Win-Core-LocalRegistry-L1-1-0.dll",
                                        "api-ms-win-downlevel-advapi32-l1-1-0.dll",
                                        "Secur32.dll",
                                        "API-MS-WIN-DOWNLEVEL-SHLWAPI-L1-1-0.DLL",
                                        "OLEAUT32.dll"
                                    ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "jotunheim.name",
                                         "resolved_ips":  [
                                                              "80.66.75.77"
                                                          ]
                                     },
                                     {
                                         "hostname":  "vanaheim.cn",
                                         "resolved_ips":  [
                                                              "193.106.174.220"
                                                          ]
                                     },
                                     {
                                         "hostname":  "www.google.com",
                                         "resolved_ips":  [
                                                              "142.250.217.100"
                                                          ]
                                     },
                                     {
                                         "hostname":  "www.evernote.com",
                                         "resolved_ips":  [
                                                              "34.120.241.214"
                                                          ]
                                     },
                                     {
                                         "hostname":  "api.vk.com",
                                         "resolved_ips":  [
                                                              "93.186.225.205",
                                                              "87.240.137.206",
                                                              "87.240.137.207",
                                                              "87.240.129.140",
                                                              "87.240.190.70",
                                                              "87.240.137.208",
                                                              "87.240.137.130",
                                                              "87.240.139.193",
                                                              "87.240.190.75"
                                                          ]
                                     },
                                     {
                                         "hostname":  "work.a-poster.info",
                                         "resolved_ips":  [
                                                              "37.1.217.172"
                                                          ]
                                     },
                                     {
                                         "hostname":  "smtp.office365.com",
                                         "resolved_ips":  [
                                                              "52.96.113.130",
                                                              "52.96.91.34",
                                                              "52.96.164.114",
                                                              "52.96.113.178"
                                                          ]
                                     }
                                 ],
                 "memory_pattern_domains":  [
                                                "jotunheim.name",
                                                "vanaheim.cn"
                                            ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2184",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                                        },
                                        {
                                            "process_id":  "2680",
                                            "name":  "%CONHOST% \"894579687639933341183001330917295076009015057372024694219265275000514337798"
                                        },
                                        {
                                            "process_id":  "2648",
                                            "name":  "%CONHOST% \"-194845104-813038714203507352010543067449368811917216729001008576284-88337168"
                                        },
                                        {
                                            "process_id":  "2736",
                                            "name":  "%CONHOST% \"-828544789-209723651-2935655009328080516306746841364337933-1622962943-1326761479"
                                        },
                                        {
                                            "process_id":  "2708",
                                            "name":  "%CONHOST% \"-4026864841927029975-1024620082-11513033161885984883-57594916115665552611985869107"
                                        },
                                        {
                                            "process_id":  "2776",
                                            "name":  "%CONHOST% \"-176869090313219884051855012201201847304919124207611920385919560204319-2118202609"
                                        },
                                        {
                                            "process_id":  "2804",
                                            "name":  "%CONHOST% \"-10287856771574562896-611902116-1413231108-1989229438-19418383412094270439-495117321"
                                        },
                                        {
                                            "process_id":  "3052",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2036",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2820",
                                            "name":  "%windir%\\SysWOW64\\uilrrcrq\\ukkhtfvt.exe /d\"%SAMPLEPATH%\"",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2852",
                                                                 "name":  "svchost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2560",
                                            "name":  "%SAMPLEPATH%",
                                            "time_offset":  2,
                                            "children":  [
                                                             {
                                                                 "process_id":  "2796",
                                                                 "name":  "\"%windir%\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"%windir%\\SysWOW64\\svchost.exe\" enable=yes\u003enul",
                                                                 "time_offset":  6
                                                             },
                                                             {
                                                                 "process_id":  "2672",
                                                                 "name":  "\"%ComSpec%\" /C move /Y \"%TEMP%\\ukkhtfvt.exe\" %windir%\\SysWOW64\\uilrrcrq\\",
                                                                 "time_offset":  4
                                                             },
                                                             {
                                                                 "process_id":  "2640",
                                                                 "name":  "\"%ComSpec%\" /C mkdir %windir%\\SysWOW64\\uilrrcrq\\",
                                                                 "time_offset":  3
                                                             },
                                                             {
                                                                 "process_id":  "2700",
                                                                 "name":  "\"%windir%\\System32\\sc.exe\" create uilrrcrq binPath= \"%windir%\\SysWOW64\\uilrrcrq\\ukkhtfvt.exe /d\\\"%SAMPLEPATH%\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                                                 "time_offset":  4
                                                             },
                                                             {
                                                                 "process_id":  "2768",
                                                                 "name":  "\"%windir%\\System32\\sc.exe\" start uilrrcrq",
                                                                 "time_offset":  6
                                                             },
                                                             {
                                                                 "process_id":  "2728",
                                                                 "name":  "\"%windir%\\System32\\sc.exe\" description uilrrcrq \"wifi internet conection\"",
                                                                 "time_offset":  5
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2900",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2436",
                                                                 "name":  "%SAMPLEPATH%\\kwebhuay.exe",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "1424",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\cmd.exe"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "2476",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\cmd.exe"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "3824",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\sc.exe"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "3708",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\sc.exe"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "4052",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\sc.exe"
                                                                                  },
                                                                                  {
                                                                                      "process_id":  "3792",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\netsh.exe"
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "540",
                                            "name":  "-",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3916",
                                                                 "name":  "C:\\Windows\\SysWOW64\\zgsqyqr\\pnxyawzf.exe",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3020",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\svchost.exe"
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2304",
                                            "name":  "kwebhuay.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1924",
                                                                 "name":  "C:\\Windows\\System32\\sc.exe create evgjoukr binPath= C:\\Windows\\SysWOW64\\evgjoukr\\qoyzbxag.exe /d\\C:\\Users\\\u003cUSER\u003e\\Downloads\\kwebhuay.exe\\ type= own start= auto DisplayName= wifi support",
                                                                 "time_offset":  14
                                                             },
                                                             {
                                                                 "process_id":  "2280",
                                                                 "name":  "C:\\Windows\\System32\\cmd.exe /C move /Y C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\qoyzbxag.exe C:\\Windows\\SysWOW64\\evgjoukr\\",
                                                                 "time_offset":  12
                                                             },
                                                             {
                                                                 "process_id":  "1620",
                                                                 "name":  "C:\\Windows\\System32\\cmd.exe /C mkdir C:\\Windows\\SysWOW64\\evgjoukr\\",
                                                                 "time_offset":  10
                                                             }
                                                         ]
                                        }
                                    ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\kwebhuay.exe",
                                           "C:\\Windows\\SysWOW64\\cmd.exe",
                                           "C:\\Windows\\SysWOW64\\sc.exe",
                                           "C:\\Windows\\SysWOW64\\zgsqyqr\\pnxyawzf.exe",
                                           "C:\\Windows\\SysWOW64\\netsh.exe",
                                           "C:\\Windows\\SysWOW64\\svchost.exe",
                                           "C:\\Windows\\System32\\cmd.exe /C mkdir C:\\Windows\\SysWOW64\\evgjoukr\\",
                                           "C:\\Windows\\System32\\cmd.exe /C move /Y C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Temp\\qoyzbxag.exe C:\\Windows\\SysWOW64\\evgjoukr\\",
                                           "C:\\Windows\\System32\\sc.exe create evgjoukr binPath= C:\\Windows\\SysWOW64\\evgjoukr\\qoyzbxag.exe /d\\C:\\Users\\\u003cUSER\u003e\\Downloads\\kwebhuay.exe\\ type= own start= auto DisplayName= wifi support"
                                       ],
                 "verdicts":  [
                                  "TROJAN",
                                  "MALWARE"
                              ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\%windir%\\SysWOW64\\uilrrcrq"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\services\\uilrrcrq\\ImagePath"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\zgsqyqr\\Start",
                                               "value":  "DWORD (0x00000002)"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\zgsqyqr\\ImagePath",
                                               "value":  "C:\\Windows\\SysWOW64\\zgsqyqr\\pnxyawzf.exe"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\services\\evgjoukr\\Start",
                                               "value":  "DWORD (0x00000002)"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\services\\evgjoukr\\ImagePath",
                                               "value":  "C:\\Windows\\SysWOW64\\evgjoukr\\qoyzbxag.exe /d\"C:\\Users\\\u003cUSER\u003e\\Downloads\\kwebhuay.exe\""
                                           },
                                           {
                                               "key":  "\\REGISTRY\\A\\{1DE8EE43-4365-FA69-B507-41BEAD4E716C}\\Root\\InventoryApplication\\0000021f1df94e2c7570a94e39009b97cde300000000\\Publisher",
                                               "value":  "Microsoft Corporation"
                                           },
                                           {
                                               "key":  "\\REGISTRY\\A\\{1DE8EE43-4365-FA69-B507-41BEAD4E716C}\\Root\\InventoryApplication\\0000c34c48b48a14753d8877e705591744db00000000\\Publisher",
                                               "value":  "Microsoft Corporation"
                                           },
                                           {
                                               "key":  "\\REGISTRY\\A\\{1DE8EE43-4365-FA69-B507-41BEAD4E716C}\\Root\\InventoryDevicePnp\\acpi/genuineintel_-_intel64_family_6_model_79_-____________intel(r)_xeon(r)_cpu_@_2.20ghz/_0\\DriverVerVersion",
                                               "value":  "6.1.7601.24520"
                                           },
                                           {
                                               "key":  "\\REGISTRY\\A\\{1DE8EE43-4365-FA69-B507-41BEAD4E716C}\\Root\\InventoryDevicePnp\\acpi/pnp0303/4\u00262c352a27\u00260\\DriverVerVersion",
                                               "value":  "6.1.7601.17514"
                                           },
                                           {
                                               "key":  "HKEY_USERS\\S-1-5-21-4270068108-2931534202-3907561125-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.exe\\OpenWithProgids\\exefile",
                                               "value":  "Binary Data"
                                           },
                                           {
                                               "key":  "\\REGISTRY\\A\\{1DE8EE43-4365-FA69-B507-41BEAD4E716C}\\Root\\InventoryDevicePnp\\acpi/genuineintel_-_intel64_family_6_model_79_-____________intel(r)_xeon(r)_cpu_@_2.20ghz/_1\\DriverVerVersion",
                                               "value":  "6.1.7601.24520"
                                           }
                                       ],
                 "memory_pattern_urls":  [
                                             "tcp://jotunheim.name:443",
                                             "tcp://vanaheim.cn:443"
                                         ],
                 "attack_techniques":  {
                                           "T1027.005":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "contain obfuscated stackstrings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "contain obfuscated stackstrings"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link many functions at runtime",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link many functions at runtime"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1059":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "accept command line arguments",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "accept command line arguments"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get common file path",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get common file path"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get disk information",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get disk information"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query environment variable",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query environment variable"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get hostname",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get hostname"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1614":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get geographical location",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get geographical location"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
