{
    "data":  {
                 "processes_tree":  [
                                        {
                                            "process_id":  "102",
                                            "name":  "sh",
                                            "children":  [
                                                             {
                                                                 "process_id":  "103",
                                                                 "name":  "crontab"
                                                             },
                                                             {
                                                                 "process_id":  "104",
                                                                 "name":  "grep"
                                                             },
                                                             {
                                                                 "process_id":  "105",
                                                                 "name":  "grep"
                                                             },
                                                             {
                                                                 "process_id":  "106",
                                                                 "name":  "grep"
                                                             }
                                                         ]
                                        }
                                    ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "191.98.172.42",
                                        "destination_port":  8080
                                    }
                                ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "INDICATOR-COMPROMISE IRC nick change on non-standard port",
                                        "rule_category":  "trojan-activity",
                                        "rule_id":  "1:38933",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "191.98.172.42",
                                                              "dest_port":  8080
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e $EXTERNAL_NET !6666:7000 ( msg:\"INDICATOR-COMPROMISE IRC nick change on non-standard port\"; flow:to_server,established; isdataat:!99; content:\"NICK \",depth 5; metadata:policy max-detect-ips drop; service:irc; classtype:trojan-activity; sid:38933; rev:3; )"
                                    },
                                    {
                                        "rule_msg":  "INDICATOR-COMPROMISE IRC channel join on non-standard port",
                                        "rule_category":  "trojan-activity",
                                        "rule_id":  "1:20092",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "191.98.172.42",
                                                              "dest_port":  8080
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e $EXTERNAL_NET !6666:7000 ( msg:\"INDICATOR-COMPROMISE IRC channel join on non-standard port\"; flow:to_server,established; isdataat:!139; content:\"JOIN #\",depth 6; metadata:policy max-detect-ips drop; service:irc; classtype:trojan-activity; sid:20092; rev:10; )"
                                    },
                                    {
                                        "rule_msg":  "ET POLICY IRC Channel JOIN on non-standard port",
                                        "rule_category":  "A client was using an unusual port",
                                        "rule_id":  "1:2000348",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "191.98.172.42",
                                                              "dest_port":  8080
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://www.rfc-editor.org/rfc/rfc1459#section-4.2.1"
                                                            ],
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e $EXTERNAL_NET ![25,587,6666:7000,8076] (msg:\"ET POLICY IRC Channel JOIN on non-standard port\"; flow:established,to_server; dsize:\u003c64; content:\"JOIN \"; nocase; depth:5; pcre:\"/\u0026|#|\\+|!/R\"; reference:url,www.rfc-editor.org/rfc/rfc1459#section-4.2.1; classtype:unusual-client-port-connection; sid:2000348; rev:18; metadata:attack_target Client_and_Server, created_at 2010_07_30, deployment Perimeter, performance_impact Moderate, confidence Medium, signature_severity Informational, updated_at 2023_05_09, reviewed_at 2024_09_16; target:src_ip;)"
                                    }
                                ],
                 "command_executions":  [
                                            "/usr/bin/crontab, [crontab, /var/run/.x00740882966]",
                                            "/bin/uname, [/bin/uname, -n]",
                                            "/bin/touch, [touch, -acmr, /bin/ls, /etc/inittab]",
                                            "/usr/bin/crontab, [crontab, -l]",
                                            "/bin/grep, [grep, -v, no cron]",
                                            "/bin/rm, [rm, -rf, /var/run/.x00740882966]",
                                            "/usr/bin/killall, [killall, -9, httpd]",
                                            "/bin/rm, [rm, -rf, /etc/inittab2]",
                                            "/bin/cat, [cat, /var/run/httpd.pid]",
                                            "/usr/bin/killall, [killall, -9, minihttpd]",
                                            "/bin/grep, [grep, -v, lesshts/run.sh]",
                                            "/usr/bin/killall, [killall, -9, telnetd]",
                                            "/usr/bin/killall, [killall, -9, dropbear]",
                                            "/bin/cat, [cat, /etc/inittab2]",
                                            "/bin/cat, [cat, /etc/inittab]",
                                            "/bin/cat, [cat, /var/run/thttpd.pid]",
                                            "/bin/grep, [grep, -v, /root/analyzed_bin]",
                                            "/usr/bin/killall, [killall, -9, mini_httpd]",
                                            "/usr/bin/killall, [killall, -9, utelnetd]",
                                            "/usr/bin/killall, [killall, -9, sshd]",
                                            "/bin/touch, [touch, -acmr, /bin/ls, /root/analyzed_bin]",
                                            "/usr/bin/killall, [killall, -9, lighttpd]"
                                        ],
                 "tags":  [
                              "OBFUSCATED",
                              "EXECUTES_DROPPED_FILE"
                          ],
                 "files_written":  [
                                       "/etc/inittab2",
                                       "/dev/null",
                                       "/var/run/.x00740882966",
                                       "/etc/inittab"
                                   ],
                 "files_opened":  [
                                      "/proc/117/cmdline",
                                      "/proc/144/cmdline",
                                      "/root/analyzed_bin",
                                      "/proc/6/cmdline",
                                      "/proc/94/stat",
                                      "/proc/129/cmdline",
                                      "/proc/4/cmdline",
                                      "/bin/sh",
                                      "/proc/11/cmdline",
                                      "/var/run/httpd.pid",
                                      "/proc/14/stat",
                                      "/proc/7/cmdline",
                                      "/proc/131/stat",
                                      "/proc/17/stat",
                                      "/proc/122/stat",
                                      "/var/run/thttpd.pid",
                                      "/proc/10/cmdline",
                                      "/proc/117/stat",
                                      "/proc/3/stat",
                                      "/proc/146/stat",
                                      "/proc/20/cmdline",
                                      "/proc/15/stat",
                                      "/lib/libresolv.so.2",
                                      "/proc/95/stat",
                                      "/proc/96/stat",
                                      "/bin/busybox",
                                      "/proc/147/stat",
                                      "/proc/11/stat",
                                      "/proc/92/stat",
                                      "/proc/100/cmdline",
                                      "/proc/150/stat",
                                      "/proc/89/stat",
                                      "/etc/inittab2",
                                      "/proc/128/stat",
                                      "/proc/84/cmdline",
                                      "/proc/95/cmdline",
                                      "/proc/148/stat",
                                      "/proc/96/cmdline",
                                      "/proc/140/stat",
                                      "/proc/136/stat",
                                      "/lib/mips/libresolv.so.2",
                                      "/proc/17/cmdline",
                                      "/proc/18/stat",
                                      "/proc/10/stat",
                                      "/etc/ld.so.cache",
                                      "/proc/2/stat",
                                      "/proc/8/stat",
                                      "/usr/bin/compile_time",
                                      "/proc/45/cmdline",
                                      "/proc/132/stat",
                                      "/proc/122/cmdline",
                                      "/proc/129/stat",
                                      "/proc/20/stat",
                                      "/bin/crontab",
                                      "/proc/133/stat",
                                      "/proc/14/cmdline",
                                      "/proc/self/exe",
                                      "/lib/tls/libresolv.so.2",
                                      "/proc/29/cmdline",
                                      "/proc/2/cmdline",
                                      "/proc/16/stat",
                                      "/proc/8/cmdline",
                                      "/proc/136/cmdline",
                                      "/proc/145/stat",
                                      "/dev/null",
                                      "/proc/127/stat",
                                      "/proc/91/cmdline",
                                      "/proc/146/cmdline",
                                      "/proc/142/stat",
                                      "/proc",
                                      "/proc/48/cmdline",
                                      "/bin/uname",
                                      "/proc/48/stat",
                                      "/proc/89/cmdline",
                                      "/etc/rc.local",
                                      "/proc/7/stat",
                                      "/proc/4/stat",
                                      "/proc/138/stat",
                                      "/proc/13/cmdline",
                                      "/proc/12/cmdline",
                                      "/proc/144/stat",
                                      "/proc/3/cmdline",
                                      "/proc/29/stat",
                                      "/proc/19/stat",
                                      "/proc/45/stat",
                                      "/lib/tls/mips/libresolv.so.2",
                                      "/proc/9/cmdline",
                                      "/usr/bin/crontab",
                                      "/proc/9/stat",
                                      "/etc/nsswitch.conf",
                                      "/lib/libnss_files.so.2",
                                      "/proc/127/cmdline",
                                      "/proc/92/cmdline",
                                      "/proc/148/cmdline",
                                      "/proc/137/stat",
                                      "/proc/5/stat",
                                      "/proc/1/stat",
                                      "/proc/94/cmdline",
                                      "/tmp/toexec",
                                      "/proc/1/cmdline",
                                      "/proc/18/cmdline",
                                      "/etc/rc.conf",
                                      "/proc/100/stat",
                                      "/proc/16/cmdline",
                                      "/proc/91/stat",
                                      "/proc/19/cmdline",
                                      "/proc/142/cmdline",
                                      "/proc/12/stat",
                                      "/proc/28/stat",
                                      "/proc/131/cmdline",
                                      "/proc/28/cmdline",
                                      "/proc/13/stat",
                                      "/proc/version",
                                      "/var/run/.x00740882966",
                                      "/etc/inittab",
                                      "/proc/150/cmdline",
                                      "/etc/passwd",
                                      "/proc/5/cmdline",
                                      "/lib/libc.so.6",
                                      "/etc/issue",
                                      "/proc/27/cmdline",
                                      "/proc/15/cmdline",
                                      "/proc/84/stat",
                                      "/proc/6/stat",
                                      "/proc/27/stat"
                                  ],
                 "files_deleted":  [
                                       "/etc/inittab2",
                                       "0x7fd8cf48",
                                       "/var/run/.x00740882966",
                                       "0x7ff2d7b8"
                                   ],
                 "sigma_analysis_results":  [
                                                {
                                                    "rule_level":  "medium",
                                                    "rule_id":  "0cbddc72cfb3b9426508057fbe3e7b0ed88990983f04ad15f9685e585ce7ae66",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Communication To Uncommon Destination Ports",
                                                    "rule_description":  "Detects programs that connect to uncommon destination ports",
                                                    "rule_author":  "Florian Roth (Nextron Systems)",
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "DestinationIp":  "191.98.172.42",
                                                                                             "DestinationPort":  "8080",
                                                                                             "Initiated":  "true"
                                                                                         }
                                                                          }
                                                                      ]
                                                }
                                            ]
             }
}
