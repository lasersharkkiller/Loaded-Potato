{
    "data":  {
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get common file path",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get common file path"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate files in .NET",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "enumerate files in .NET"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "signature_description":  "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture."
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "signature_description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                 },
                                                 {
                                                     "id":  "T1106",
                                                     "signature_description":  "Adversaries may interact with the native OS application programming interface (API) to execute behaviors."
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates a process in suspended mode (likely to inject code)"
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Spawns processes"
                                                 },
                                                 {
                                                     "id":  "T1036",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates files inside the user directory"
                                                 },
                                                 {
                                                     "id":  "T1218.011",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Runs a DLL by calling functions"
                                                 },
                                                 {
                                                     "id":  "T1562.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates guard pages, often used to prevent reverse engineering and debugging"
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Contains long sleeps (\u003e= 3 min)"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Queries the volume information (name, serial number etc) of a device"
                                                 },
                                                 {
                                                     "id":  "T1056",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates a DirectInput object (often for capturing keystrokes)"
                                                 }
                                             ],
                 "verdict_confidence":  2,
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "ProcessHostingdotNETCode",
                                                                                             "CreationUtcTime":  "1665595851",
                                                                                             "UtcTime":  "1665595851",
                                                                                             "EventID":  "11",
                                                                                             "ProcessGuid":  "{C784477D-F9C4-6346-9006-000000001F00}",
                                                                                             "ProcessId":  "780",
                                                                                             "Image":  "C:\\Windows\\SysWOW64\\rundll32.exe",
                                                                                             "TargetFilename":  "C:\\Users\\george\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs\\rundll32.exe.log"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "high",
                                                    "rule_id":  "a0cf7d21374ebc3567492775f48033b67b0a81b95521f405e5be52f2950f9d18",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Suspicious CLR Logs Creation",
                                                    "rule_description":  "Detects suspicious .NET assembly executions. Could detect using Cobalt Strike\u0027s command execute-assembly.",
                                                    "rule_author":  "omkar72, oscd.community, Wojciech Lesicki"
                                                }
                                            ],
                 "files_written":  [
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs\\rundll32.exe.log",
                                       "C:\\Users\\user\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs\\rundll32.exe.log",
                                       "\\Device\\ConDrv\\\\Connect"
                                   ],
                 "files_dropped":  [
                                       {
                                           "path":  "rundll32.exe.log",
                                           "sha256":  "d8988d672d6915b46946b28c06ad8066c50041f6152a91d37ffa5cf129cc146b",
                                           "type":  "TEXT",
                                           "process_name":  "\"C:\\Windows\\System32\\rundll32.exe\" \"C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll\",#1",
                                           "process_id":  "3920"
                                       },
                                       {
                                           "path":  "C:\\Users\\user\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs\\rundll32.exe.log",
                                           "sha256":  "d8988d672d6915b46946b28c06ad8066c50041f6152a91d37ffa5cf129cc146b",
                                           "type":  "TEXT"
                                       }
                                   ],
                 "verdicts":  [
                                  "UNKNOWN_VERDICT",
                                  "CLEAN"
                              ],
                 "files_opened":  [
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.manifest",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.123.Manifest",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.124.Manifest",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.2.Manifest",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll.config",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs\\rundll32.exe.log",
                                      "C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.INI",
                                      "C:\\ProgramData\\",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\CLR_v4.0_32",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs",
                                      "C:\\Program Files (x86)\\",
                                      "C:\\Program Files (x86)\\Common Files\\",
                                      "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                                      "C:\\Users\\user\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs\\rundll32.exe.log",
                                      "C:\\Users\\user\\Desktop\\library.dll",
                                      "C:\\Users\\user\\Desktop\\library.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll.2.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll.config",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v1.0.3705\\clr.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v1.0.3705\\mscorwks.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v1.1.4322\\clr.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v1.1.4322\\mscorwks.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\clr.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\mscorwks.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Config\\machine.config",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\clr.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\clrjit.dll",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\config\\machine.config",
                                      "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\mscoreei.dll",
                                      "C:\\Windows\\SysWOW64\\",
                                      "C:\\Windows\\SysWOW64\\ADVAPI32.dll",
                                      "C:\\Windows\\SysWOW64\\AcLayers.DLL",
                                      "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
                                      "C:\\Windows\\SysWOW64\\FLTLIB.DLL",
                                      "C:\\Windows\\SysWOW64\\GDI32.dll",
                                      "C:\\Windows\\SysWOW64\\IMM32.DLL",
                                      "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                                      "C:\\Windows\\SysWOW64\\MPR.dll",
                                      "C:\\Windows\\SysWOW64\\MSCTF.dll",
                                      "C:\\Windows\\SysWOW64\\OLEAUT32.dll",
                                      "C:\\Windows\\SysWOW64\\PROPSYS.dll",
                                      "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                                      "C:\\Windows\\SysWOW64\\SETUPAPI.dll",
                                      "C:\\Windows\\SysWOW64\\SHELL32.dll",
                                      "C:\\Windows\\SysWOW64\\SHLWAPI.dll",
                                      "C:\\Windows\\SysWOW64\\SspiCli.dll",
                                      "C:\\Windows\\SysWOW64\\USER32.dll",
                                      "C:\\Windows\\SysWOW64\\VCRUNTIME140_CLR0400.dll",
                                      "C:\\Windows\\SysWOW64\\VERSION.dll",
                                      "C:\\Windows\\SysWOW64\\WINSPOOL.DRV",
                                      "C:\\Windows\\SysWOW64\\advapi32.dll",
                                      "C:\\Windows\\SysWOW64\\apphelp.dll",
                                      "C:\\Windows\\SysWOW64\\bcrypt.dll",
                                      "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                                      "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                                      "C:\\Windows\\SysWOW64\\combase.dll",
                                      "C:\\Windows\\SysWOW64\\dwmapi.dll",
                                      "C:\\Windows\\SysWOW64\\en-US\\rundll32.exe.mui",
                                      "C:\\Windows\\SysWOW64\\gdi32full.dll",
                                      "C:\\Windows\\SysWOW64\\imagehlp.dll",
                                      "C:\\Windows\\SysWOW64\\kernel.appcore.dll",
                                      "C:\\Windows\\SysWOW64\\loaddll32.exe",
                                      "C:\\Windows\\SysWOW64\\mscoree.dll",
                                      "C:\\Windows\\SysWOW64\\msvcp_win.dll",
                                      "C:\\Windows\\SysWOW64\\msvcrt.dll",
                                      "C:\\Windows\\SysWOW64\\ntdll.dll",
                                      "C:\\Windows\\SysWOW64\\ole32.dll",
                                      "C:\\Windows\\SysWOW64\\powrprof.dll",
                                      "C:\\Windows\\SysWOW64\\profapi.dll",
                                      "C:\\Windows\\SysWOW64\\psapi.dll",
                                      "C:\\Windows\\SysWOW64\\rundll32.exe",
                                      "C:\\Windows\\SysWOW64\\rundll32.exe.config",
                                      "C:\\Windows\\SysWOW64\\sechost.dll",
                                      "C:\\Windows\\SysWOW64\\sfc.dll",
                                      "C:\\Windows\\SysWOW64\\sfc_os.DLL",
                                      "C:\\Windows\\SysWOW64\\shcore.dll",
                                      "C:\\Windows\\SysWOW64\\shlwapi.dll",
                                      "C:\\Windows\\SysWOW64\\ucrtbase.dll",
                                      "C:\\Windows\\SysWOW64\\ucrtbase_clr0400.dll",
                                      "C:\\Windows\\SysWOW64\\uxtheme.dll",
                                      "C:\\Windows\\SysWOW64\\win32u.dll",
                                      "C:\\Windows\\SysWOW64\\windows.storage.dll",
                                      "C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\mscorlib\\",
                                      "C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\mscorlib\\75b341f10c9579cbe1059d18f6f3b27b\\mscorlib.ni.dll",
                                      "C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\mscorlib\\75b341f10c9579cbe1059d18f6f3b27b\\mscorlib.ni.dll.aux",
                                      "C:\\Windows\\assembly\\pubpol66.dat",
                                      "\\Device\\KsecDD",
                                      "C:\\Users\\user\\Desktop\\attachment.dll",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.2.Manifest",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.config",
                                      "C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\mscorlib\\92d30f3dd1d092e15dd783b14354d8ea\\mscorlib.ni.dll",
                                      "C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\mscorlib\\92d30f3dd1d092e15dd783b14354d8ea\\mscorlib.ni.dll.aux",
                                      "C:\\Users\\user\\Desktop\\init.dll",
                                      "C:\\Users\\user\\Desktop\\init.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\init.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\init.dll.2.Manifest",
                                      "C:\\Users\\user\\Desktop\\init.dll.config",
                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                      "C:\\Windows\\System32\\en-US\\user32.dll.mui",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
                                      "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
                                      "C:\\Windows\\system32\\IMM32.DLL",
                                      "C:\\Windows\\system32\\conhost.exe",
                                      "C:\\Windows\\system32\\dwmapi.dll",
                                      "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
                                      "C:\\Windows\\system32\\loaddll32.exe",
                                      "C:\\Windows\\system32\\uxtheme.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll.Config",
                                      "\\Device\\ConDrv\\Server",
                                      "\\Device\\ConDrv\\\\Reference"
                                  ],
                 "registry_keys_opened":  [
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\Paths",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\NGen\\Policy\\v4.0\\OptimizeUsedBinaries",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\.NETFramework",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\.NETFramework\\NGen\\Policy\\v4.0",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\StrongName",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DevOverrideEnable",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\FeatureSIMD",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Installer\\Assemblies\\C:|Windows|SysWOW64|rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\LevelObjects",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Paths",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\Managed\\S-1-5-21-4005801669-2598574594-602355426-1001\\Installer\\Assemblies\\Global",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\safer\\codeidentifiers\\DefaultLevel",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\\Full",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Hashes",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\Managed\\S-1-5-21-4005801669-2598574594-602355426-1001\\Installer\\Assemblies\\C:|Windows|SysWOW64|rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\UrlZones",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\Hashes",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\Paths",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableMetaFiles",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\UrlZones",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Installer\\Assemblies\\Global",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\Paths",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\Paths",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\Paths",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\safer\\codeidentifiers\\SaferFlags",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\\Full\\Release",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableUmpdBufferSizeCheck",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\safer\\codeidentifiers\\Levels",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\.NETFramework",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Hashes",
                                              "Policy\\Standards",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\DisableConfigCache",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\Hashes",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Paths",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\Paths",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Paths",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\AppContext",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\UrlZones",
                                              "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\AppsUseLightTheme",
                                              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Paths",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Fusion",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionInfo\\1",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionInfo\\1\\KnownFolders",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Installer\\Assemblies\\C:|Windows|SysWOW64|rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Installer\\Assemblies\\Global",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\Policy\\Servicing",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DllNXOptions",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\cmd.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\loaddll32.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\Managed\\S-1-5-21-1015118539-3749460369-599379286-1001\\Installer\\Assemblies\\C:|Windows|SysWOW64|rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\Managed\\S-1-5-21-1015118539-3749460369-599379286-1001\\Installer\\Assemblies\\Global",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\AppContext",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\Policy\\Standards",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\policy\\standards\\v4.0.30319",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\policy\\v4.0",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Fusion",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\NET Framework Setup\\NDP\\v4\\Full",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLE",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLEAUT",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{62AB5D82-FDC1-4DC3-A9DD-070D1D495D97}",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{62AB5D82-FDC1-4DC3-A9DD-070D1D495D97}\\PropertyBag",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\\PropertyBag",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{905E63B6-C1BF-494E-B29C-65B732D3D21A}",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{905e63b6-c1bf-494e-b29c-65b732d3d21a}\\PropertyBag",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{F1B32785-6FBA-4FCF-9D55-7B8E7F157091}",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{F1B32785-6FBA-4FCF-9D55-7B8E7F157091}\\PropertyBag",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{F7F1ED05-9F6D-47A2-AAAE-29D317C6F066}",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{F7F1ED05-9F6D-47A2-AAAE-29D317C6F066}\\PropertyBag",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Policies\\Microsoft\\WindowsStore",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Fusion",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Fusion\\PublisherPolicy\\Default",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\.NETFramework",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\.NETFramework\\NGen\\Policy\\v4.0",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\.NETFramework\\Policy\\",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\OLE\\Tracing",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\StrongName",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\KnownFolderSettings",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Display",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Paths",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\Paths",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\131072\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Paths",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\Paths",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\4096\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\Hashes",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\Paths",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\65536\\UrlZones",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\LevelObjects",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Ids",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup",
                                              "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\HwOrder",
                                              "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\ProviderOrder",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties"
                                          ],
                 "mbc":  [
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get common file path"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "enumerate files in .NET"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0047",
                                 "objective":  "File System",
                                 "behavior":  "Delete File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delete file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0002"
                             },
                             {
                                 "id":  "C0005.001"
                             },
                             {
                                 "id":  "OB0001"
                             },
                             {
                                 "id":  "B0001"
                             },
                             {
                                 "id":  "B0001.009"
                             },
                             {
                                 "id":  "B0002"
                             },
                             {
                                 "id":  "B0002.008"
                             },
                             {
                                 "id":  "OC0002"
                             },
                             {
                                 "id":  "C0008"
                             }
                         ],
                 "processes_terminated":  [
                                              "wmiadap.exe /F /T /R"
                                          ],
                 "processes_created":  [
                                           "\"C:\\Windows\\System32\\rundll32.exe\" \"C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll\",#1"
                                       ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2560",
                                            "name":  "%CONHOST% \"-4841167346715954324149682517949437476528372391927874141-89251758746188614"
                                        },
                                        {
                                            "process_id":  "2784",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2828",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2492",
                                            "name":  "%SANDBOX_DLL_LOADER_AMD64% %SAMPLEPATH% 483"
                                        },
                                        {
                                            "process_id":  "3920",
                                            "name":  "\"C:\\Windows\\System32\\rundll32.exe\" \"C:\\Users\\\u003cUSER\u003e\\Desktop\\readme.dll\",#1",
                                            "files_written":  [
                                                                  "C:\\Users\\Bruno\\AppData\\Local\\Microsoft\\CLR_v4.0_32\\UsageLogs\\rundll32.exe.log"
                                                              ]
                                        },
                                        {
                                            "process_id":  "5428",
                                            "name":  "C:\\Windows\\System32\\loaddll32.exe loaddll32.exe \"C:\\Users\\user\\Desktop\\library.dll\"",
                                            "children":  [
                                                             {
                                                                 "process_id":  "5244",
                                                                 "name":  "C:\\Windows\\SysWOW64\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\library.dll\",#1",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "4064",
                                                                                      "name":  "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\library.dll\",#1"
                                                                                  }
                                                                              ]
                                                             },
                                                             {
                                                                 "process_id":  "780",
                                                                 "name":  "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\library.dll,voicednws_St1_4"
                                                             },
                                                             {
                                                                 "process_id":  "8072",
                                                                 "name":  "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe \"C:\\Users\\user\\Desktop\\library.dll\",voicednws_St1_4"
                                                             }
                                                         ]
                                        }
                                    ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get common file path",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "manipulate unmanaged memory in .NET",
                                               "description":  "host-interaction/memory",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: manipulate unmanaged memory in .NET\n    namespace: host-interaction/memory\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires class features\n  features:\n    - or:\n      - class: System.Runtime.InteropServices.Marshal\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate files in .NET",
                                               "description":  "host-interaction/file-system/files/list",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate files in .NET\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    references:\n      - https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b\n  features:\n    - or:\n      - api: System.IO.DirectoryInfo::GetFiles\n      - api: System.IO.DirectoryInfo::EnumerateFiles\n      - api: System.IO.Directory::GetFiles\n      - api: System.IO.Directory::EnumerateFiles\n      - api: System.IO.Directory::EnumerateFileSystemEntries\n      - api: System.IO.DirectoryInfo::GetDirectories\n      - api: System.IO.DirectoryInfo::EnumerateDirectories\n      - api: System.IO.Directory::GetDirectories\n      - api: System.IO.Directory::EnumerateDirectories\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete file",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      # static\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n      # dynamic\n      - call:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "compiled to the .NET platform",
                                               "description":  "runtime/dotnet",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: compiled to the .NET platform\n    namespace: runtime/dotnet\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - b9f5bd514485fb06da39beff051b9fdc\n  features:\n    - or:\n      - format: dotnet\n      - import: mscoree._CorExeMain\n      - import: mscoree._corexemain\n      - import: mscoree._CorDllMain\n      - import: mscoree._cordllmain\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "mixed mode",
                                               "description":  "runtime : file contains managed and unmanaged (native) code, often seen in .NET",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: mixed mode\n    namespace: runtime\n    authors:\n      - michael.hunhoff@mandiant.com\n    description: file contains managed and unmanaged (native) code, often seen in .NET\n    scopes:\n      static: file\n      dynamic: unsupported  # requires characteristic features\n  features:\n    - or:\n      - characteristic: mixed mode\n"
                                           },
                                           {
                                               "id":  "stealth_network",
                                               "name":  "stealth_network",
                                               "description":  "Network activity detected but not expressed in monitor API logs",
                                               "match_data":  [
                                                                  "{\"ip\": \"13.85.23.206\"}",
                                                                  "{\"ip\": \"40.127.169.103\"}",
                                                                  "{\"ip\": \"40.83.247.108\"}",
                                                                  "{\"ip\": \"192.229.211.108\"}",
                                                                  "{\"ip\": \"204.79.197.203\"}",
                                                                  "{\"ip\": \"23.197.244.30\"}",
                                                                  "{\"ip\": \"20.190.190.195\"}",
                                                                  "{\"ip\": \"72.21.81.240\"}",
                                                                  "{\"ip\": \"20.72.205.209\"}",
                                                                  "{\"ip\": \"23.216.147.78\"}",
                                                                  "{\"domain\": \"settings-win.data.microsoft.com\"}",
                                                                  "{\"domain\": \"settings-prod-sea-1.southeastasia.cloudapp.azure.com\"}",
                                                                  "{\"domain\": \"slscr.update.microsoft.com\"}",
                                                                  "{\"domain\": \"glb.sls.prod.dcat.dsp.trafficmanager.net\"}",
                                                                  "{\"domain\": \"_ldap._tcp.dc._msdcs.WORKGROUP.hostonly\"}",
                                                                  "{\"domain\": \"www.msftconnecttest.com\"}",
                                                                  "{\"domain\": \"wpad.hostonly\"}",
                                                                  "{\"domain\": \"ctldl.windowsupdate.com\"}",
                                                                  "{\"domain\": \"login.live.com\"}",
                                                                  "{\"domain\": \"cdn.onenote.net\"}",
                                                                  "{\"domain\": \"api.msn.com\"}",
                                                                  "{\"domain\": \"ocsp.digicert.com\"}",
                                                                  "{\"domain\": \"fe3cr.delivery.mp.microsoft.com\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "antivm_checks_available_memory",
                                               "name":  "antivm_checks_available_memory",
                                               "description":  "Checks available memory",
                                               "match_data":  [
                                                                  "{\"type\": \"call\", \"pid\": 3920, \"cid\": 426}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "antidebug_setunhandledexceptionfilter",
                                               "name":  "antidebug_setunhandledexceptionfilter",
                                               "description":  "SetUnhandledExceptionFilter detected (possible anti-debug)",
                                               "match_data":  [
                                                                  "{\"type\": \"call\", \"pid\": 3920, \"cid\": 397}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "antidebug_guardpages",
                                               "name":  "antidebug_guardpages",
                                               "description":  "Guard pages use detected - possible anti-debugging.",
                                               "match_data":  [
                                                                  "{\"type\": \"call\", \"pid\": 3920, \"cid\": 271}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "network_http",
                                               "name":  "network_http",
                                               "description":  "Performs some HTTP requests",
                                               "match_data":  [
                                                                  "{\"url\": \"http://www.msftconnecttest.com/connecttest.txt\"}",
                                                                  "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBQ50otx%2Fh0Ztl%2Bz8SiPI7wEWVxDlQQUTiJUIBiV5uNu5g%2F6%2BrkS7QYXjzkCEA77flR%2B3w%2FxBpruV2lte6A%3D\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "injection_rwx",
                                               "name":  "injection_rwx",
                                               "description":  "Creates RWX memory",
                                               "match_data":  [
                                                                  "{\"type\": \"call\", \"pid\": 3920, \"cid\": 265}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "procmem_yara",
                                               "name":  "procmem_yara",
                                               "description":  "Yara detections observed in process dumps, payloads or dropped files",
                                               "match_data":  [
                                                                  "{\"Hit\": \"PID 3920 trigged the Yara rule \u0027shellcode_get_eip\u0027 with data \u0027[\u0027{ E8 00 00 00 00 58 }\u0027]\u0027\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           }
                                       ],
                 "tags":  [
                              "DETECT_DEBUG_ENVIRONMENT",
                              "LONG_SLEEPS",
                              "CHECKS_USER_INPUT"
                          ],
                 "memory_dumps":  [
                                      {
                                          "file_name":  "3920.dmp",
                                          "process":  "C:\\Windows\\SysWOW64\\rundll32.exe",
                                          "size":  "49782784",
                                          "base_address":  "6881280"
                                      }
                                  ],
                 "attack_techniques":  {
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get common file path",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get common file path"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate files in .NET",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "enumerate files in .NET"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture."
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Queries the volume information (name, serial number etc) of a device"
                                                         }
                                                     ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                         }
                                                     ],
                                           "T1106":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may interact with the native OS application programming interface (API) to execute behaviors."
                                                         }
                                                     ],
                                           "T1055":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates a process in suspended mode (likely to inject code)"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Spawns processes"
                                                         }
                                                     ],
                                           "T1036":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates files inside the user directory"
                                                         }
                                                     ],
                                           "T1218.011":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Runs a DLL by calling functions"
                                                             }
                                                         ],
                                           "T1562.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Creates guard pages, often used to prevent reverse engineering and debugging"
                                                             }
                                                         ],
                                           "T1497":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Contains long sleeps (\u003e= 3 min)"
                                                         }
                                                     ],
                                           "T1056":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates a DirectInput object (often for capturing keystrokes)"
                                                         }
                                                     ]
                                       }
             }
}
