{
    "data":  {
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKU\\S-1-5-21-1229272821-1563985344-1801674531-1003\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\SHELL FOLDERS",
                                               "value":  "Cache"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-1229272821-1563985344-1801674531-1003\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\SHELL FOLDERS",
                                               "value":  "History"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-1229272821-1563985344-1801674531-1003\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\SHELL FOLDERS",
                                               "value":  "Cookies"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-18\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\SHELL FOLDERS",
                                               "value":  "History"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-18\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\SHELL FOLDERS",
                                               "value":  "Cache"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-18\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\SHELL FOLDERS",
                                               "value":  "Cookies"
                                           }
                                       ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "452",
                                            "name":  "C:\\DOCUME~1\\Miller\\LOCALS~1\\Temp\\rundll32.exe"
                                        },
                                        {
                                            "process_id":  "1068",
                                            "name":  "C:\\WINDOWS\\mssecsvc.exe"
                                        },
                                        {
                                            "process_id":  "992",
                                            "name":  "C:\\WINDOWS\\mssecsvc.exe"
                                        },
                                        {
                                            "process_id":  "2472",
                                            "name":  "C:\\WINDOWS\\mssecsvc.exe"
                                        },
                                        {
                                            "process_id":  "1768",
                                            "name":  "13f43b565119f43f7155f96cafa8b05d.exe",
                                            "time_offset":  25165
                                        }
                                    ],
                 "signature_matches":  [
                                           {
                                               "id":  "1",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Windows",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: CreateFile",
                                                                  "create or open file",
                                                                  "FILE_WRITE_DATA"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                                           },
                                           {
                                               "id":  "2",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain an embedded PE file",
                                               "description":  "executable/subfile/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n"
                                           },
                                           {
                                               "id":  "3",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against ZLIB",
                                               "description":  "linking/static/zlib",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "regex: /inflate .* Copyright/"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against ZLIB\n    namespace: linking/static/zlib\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Data::Compression Library [C0060]\n    examples:\n      - 6cc148363200798a12091b97a17181a1\n  features:\n    - or:\n      - string: /deflate .* Copyright/\n      - string: /inflate .* Copyright/\n"
                                           },
                                           {
                                               "id":  "4",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create process on Windows",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: CreateProcess"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n"
                                           },
                                           {
                                               "id":  "5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "extract resource via kernel32 functions",
                                               "description":  "executable/resource",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: LockResource",
                                                                  "api: SizeofResource",
                                                                  "api: LoadResource"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n"
                                           }
                                       ],
                 "command_executions":  [
                                            "C:\\DOCUME~1\\Miller\\LOCALS~1\\Temp\\rundll32.exe 62186bebffffcfafb1c70a8ff03fa3ca49cba14556378.dll",
                                            "C:\\WINDOWS\\mssecsvc.exe",
                                            "C:\\WINDOWS\\mssecsvc.exe -m security"
                                        ],
                 "mutexes_opened":  [
                                        "ShimCacheMutex",
                                        "Local\\c:!documents and settings!miller!cookies!",
                                        "Local\\WininetConnectionMutex",
                                        "Local\\_!MSFTHISTORY!_",
                                        "Local\\WininetStartupMutex",
                                        "Local\\c:!documents and settings!miller!local settings!history!history.ie5!",
                                        "Local\\WininetProxyRegistryMutex",
                                        "Local\\c:!documents and settings!miller!local settings!temporary internet files!content.ie5!",
                                        "Local\\c:!documents and settings!localservice!cookies!",
                                        "Local\\c:!documents and settings!localservice!local settings!history!history.ie5!",
                                        "Local\\c:!documents and settings!localservice!local settings!temporary internet files!content.ie5!"
                                    ],
                 "verdicts":  [
                                  "MALWARE",
                                  "TROJAN"
                              ],
                 "services_started":  [
                                          "mssecsvc2.0"
                                      ],
                 "files_attribute_changed":  [
                                                 "C:\\Documents and Settings\\Miller\\Local Settings\\Temporary Internet Files\\Content.IE5",
                                                 "C:\\Documents and Settings\\Miller\\Local Settings\\Temporary Internet Files\\Content.IE5\\index.dat",
                                                 "C:\\Documents and Settings\\Miller\\Cookies\\index.dat",
                                                 "C:\\Documents and Settings\\Miller\\Local Settings\\History\\History.IE5\\index.dat",
                                                 "C:\\Documents and Settings\\Miller\\Local Settings\\History\\History.IE5",
                                                 "C:\\Documents and Settings\\Miller\\Cookies",
                                                 "C:\\Documents and Settings\\Miller\\Local Settings\\History",
                                                 "C:\\Documents and Settings\\Miller\\Local Settings\\Temporary Internet Files",
                                                 "C:\\Documents and Settings\\LocalService\\Cookies\\index.dat",
                                                 "C:\\Documents and Settings\\LocalService\\Local Settings\\History\\History.IE5\\index.dat",
                                                 "C:\\Documents and Settings\\LocalService\\Local Settings\\History\\History.IE5",
                                                 "C:\\Documents and Settings\\LocalService\\Local Settings\\Temporary Internet Files",
                                                 "C:\\Documents and Settings\\LocalService\\Local Settings\\Temporary Internet Files\\Content.IE5\\index.dat",
                                                 "C:\\Documents and Settings\\LocalService\\Cookies",
                                                 "C:\\Documents and Settings\\LocalService\\Local Settings\\Temporary Internet Files\\Content.IE5",
                                                 "C:\\Documents and Settings\\LocalService\\Local Settings\\History"
                                             ],
                 "processes_created":  [
                                           "C:\\DOCUME~1\\Miller\\LOCALS~1\\Temp\\rundll32.exe",
                                           "C:\\WINDOWS\\mssecsvc.exe"
                                       ],
                 "files_opened":  [
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\8d668bfad92ffde75aaaaf2d649bb93a.exe.dll",
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\8d668bfad92ffde75aaaaf2d649bb93a.exe.dll.manifest"
                                  ],
                 "modules_loaded":  [
                                        "c:\\windows\\system32\\apphelp.dll",
                                        "c:\\windows\\system32\\user32.dll",
                                        "c:\\windows\\system32\\imm32.dll",
                                        "c:\\windows\\system32\\shell32.dll",
                                        "c:\\windows\\system32\\ntdll.dll",
                                        "c:\\windows\\system32\\psapi.dll",
                                        "c:\\windows\\system32\\kernel32.dll",
                                        "c:\\windows\\system32\\secur32.dll",
                                        "c:\\windows\\system32\\shlwapi.dll",
                                        "c:\\windows\\system32\\comctl32.dll",
                                        "c:\\windows\\system32\\advapi32.dll",
                                        "c:\\windows\\system32\\netapi32.dll",
                                        "c:\\windows\\system32\\mpr.dll",
                                        "c:\\windows\\system32\\msvcrt.dll",
                                        "c:\\windows\\system32\\ws2_32.dll",
                                        "c:\\windows\\system32\\gdi32.dll",
                                        "c:\\windows\\system32\\ws2help.dll",
                                        "c:\\windows\\system32\\ole32.dll",
                                        "c:\\windows\\winsxs\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.2600.5512_x-ww_35d4ce83\\comctl32.dll",
                                        "c:\\documents and settings\\miller\\local settings\\temp\\62186bebffffcfafb1c70a8ff03fa3ca49cba14556378.dll",
                                        "c:\\windows\\system32\\rpcrt4.dll",
                                        "c:\\windows\\system32\\wininet.dll",
                                        "c:\\windows\\system32\\urlmon.dll",
                                        "c:\\windows\\system32\\normaliz.dll",
                                        "c:\\windows\\system32\\oleaut32.dll",
                                        "c:\\windows\\system32\\msvcp60.dll",
                                        "c:\\windows\\system32\\iphlpapi.dll",
                                        "c:\\windows\\system32\\iertutil.dll",
                                        "c:\\windows\\system32\\rsaenh.dll",
                                        "c:\\windows\\system32\\wshtcpip.dll",
                                        "c:\\windows\\system32\\hnetcfg.dll",
                                        "c:\\windows\\system32\\mswsock.dll",
                                        "rpcrt4",
                                        "SspiCli",
                                        "CRYPTBASE",
                                        "kernel32",
                                        "MSCTF",
                                        "CLBCatQ",
                                        "ADVAPI32",
                                        "OLEAUT32",
                                        "8d668bfad92ffde75aaaaf2d649bb93a.exe",
                                        "ole32"
                                    ],
                 "services_created":  [
                                          "mssecsvc2.0"
                                      ],
                 "mbc":  [
                             {
                                 "id":  "C0052",
                                 "objective":  "File System",
                                 "behavior":  "Writes File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0023",
                                 "objective":  "Execution",
                                 "behavior":  "Install Additional Program",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "2"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0060",
                                 "objective":  "Data",
                                 "behavior":  "Compression Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "4"
                                              }
                                          ]
                             }
                         ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1059",
                                                     "signature_description":  "Apparent Internal Usage of CMD.EXE"
                                                 }
                                             ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "51.44.90.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.100.182.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "attack_techniques":  {
                                           "T1059":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Apparent Internal Usage of CMD.EXE"
                                                         }
                                                     ]
                                       }
             }
}
