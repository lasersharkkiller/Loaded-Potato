{
    "data":  {
                 "memory_pattern_urls":  [
                                             "tcp://jotunheim.name:443",
                                             "tcp://vanaheim.cn:443"
                                         ],
                 "memory_pattern_domains":  [
                                                "jotunheim.name",
                                                "vanaheim.cn"
                                            ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1620",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "execute shellcode via Windows callback function",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "execute shellcode via Windows callback function"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get hostname",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get hostname"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get common file path",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get common file path"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link many functions at runtime",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link many functions at runtime"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "processes_terminated":  [
                                              "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                              "%CONHOST% \"50472252509410330-328179561255008592176251340-322057414-1953456883-1592826699",
                                              "%CONHOST% \"-15490084191864770001481900692125563231013828779918766094911389930620981705062",
                                              "%CONHOST% \"140713479-703082411751554854439765221-275460560-2049711714-11265012861768725949",
                                              "%CONHOST% \"195970304-1568581119195349782027988316014739068871157002092-821461499-1630978502",
                                              "%CONHOST% \"619943339-574015672-1477487057-207134493819714597841815605789-1002573193346598069",
                                              "%CONHOST% \"161377112816356265121214608053-11603636612135407342-1880511736-1314752520431150812",
                                              "%windir%\\SysWOW64\\bpsyyjyx\\zcvggpqq.exe /d\"%SAMPLEPATH%\"",
                                              "wmiadap.exe /F /T /R",
                                              "%SAMPLEPATH%",
                                              "\"%ComSpec%\" /C mkdir %windir%\\SysWOW64\\bpsyyjyx\\",
                                              "\"%windir%\\System32\\sc.exe\" create bpsyyjyx binPath= \"%windir%\\SysWOW64\\bpsyyjyx\\zcvggpqq.exe /d\\\"%SAMPLEPATH%\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                              "\"%windir%\\System32\\sc.exe\" start bpsyyjyx",
                                              "\"%ComSpec%\" /C move /Y \"%TEMP%\\zcvggpqq.exe\" %windir%\\SysWOW64\\bpsyyjyx\\",
                                              "\"%windir%\\System32\\sc.exe\" description bpsyyjyx \"wifi internet conection\"",
                                              "\"%windir%\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"%windir%\\SysWOW64\\svchost.exe\" enable=yes\u003enul"
                                          ],
                 "files_dropped":  [
                                       {
                                           "path":  "%windir%\\SysWOW64\\bpsyyjyx\\zcvggpqq.exe",
                                           "sha256":  "19c37f8800dfc00d62f97590720a4fd742423f075c4fef6e47d44d2b93372496"
                                       }
                                   ],
                 "verdicts":  [
                                  "TROJAN",
                                  "MALWARE"
                              ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate or change RWX memory",
                                               "description":  "host-interaction/process/inject",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate or change RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x40 = PAGE_EXECUTE_READWRITE\n        # lea     r9d, [rcx+40h]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x40 = PAGE_EXECUTE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check mutex",
                                               "description":  "host-interaction/mutex",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Check Mutex [C0043]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - or:\n        - api: kernel32.OpenMutex\n        - match: create mutex\n        - api: System.Threading.Mutex::OpenExisting\n        - api: System.Threading.Mutex::TryOpenExisting\n      - optional:\n        - or:\n          - api: kernel32.GetLastError\n          - number: 2 = ERROR_FILE_NOT_FOUND\n          - number: 0xB7 = ERROR_ALREADY_EXISTS\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "execute shellcode via Windows callback function",
                                               "description":  "load-code/shellcode : Detect usage of various WinAPI functions that accept callback functions as parameters in order to execute arbitrary shellcode",
                                               "authors":  [
                                                               "ervin.ocampo@mandiant.com",
                                                               "jakub.jozwiak@mandiant.com",
                                                               "still@teamt5.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: execute shellcode via Windows callback function\n    namespace: load-code/shellcode\n    authors:\n      - ervin.ocampo@mandiant.com\n      - jakub.jozwiak@mandiant.com\n      - still@teamt5.org\n    description: Detect usage of various WinAPI functions that accept callback functions as parameters in order to execute arbitrary shellcode\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Defense Evasion::Reflective Code Loading [T1620]\n    mbc:\n      - Defense Evasion::Hijack Execution Flow::Abuse Windows Function Calls [F0015.006]\n    references:\n      - https://github.com/ChaitanyaHaritash/Callback_Shellcode_Injection\n      - https://www.trendmicro.com/en_us/research/22/k/earth-preta-spear-phishing-governments-worldwide.html\n      - http://ropgadget.com/posts/abusing_win_functions.html\n      - https://github.com/aahmad097/AlternativeShellcodeExec/\n      - https://osandamalith.com/2021/04/01/executing-shellcode-via-callbacks/\n    examples:\n      - 10cd7afd580ee9c222b0a87ff241d306:0x10008BE0\n      - 268d61837aa248c1d49a973612a129ce:0x1000CEC0\n      - 4a2992b4c7a1573bf7c74065e3bf5b0d:0x1000D050\n      - 43db867967c71bd3aaba9a9a3084e7fa:0x140001000\n  features:\n    - and:\n      - match: allocate or change RWX memory\n      - or:\n        - api: AddPropSheetPageProc\n        - api: CallWindowProc\n        - api: CertEnumSystemStore\n        - api: CertEnumSystemStoreLocation\n        - api: CreateTimerQueueTimer\n        - api: CryptEnumOIDInfo\n        - and:\n          - api: DPA_Create\n          - api: DPA_SetPtr\n          - api: DPA_EnumCallback\n        - and:\n          - api: DSA_Create\n          - api: DSA_InsertItem\n          - api: DSA_EnumCallback\n        - api: DrawState\n        - api: EnumCalendarInfo\n        - api: EnumCalendarInfoEx\n        - api: EnumChildWindows\n        - api: EnumDateFormats\n        - api: EnumDesktops\n        - api: EnumDesktopWindows\n        - api: EnumDirTree\n        - api: EnumDisplayMonitors\n        - api: EnumFontFamilies\n        - api: EnumFontFamiliesEx\n        - api: EnumFonts\n        - api: EnumLanguageGroupLocales\n        - and:\n          - or:\n            - api: GetDC\n            - api: GetDCEx\n          - api: EnumObjects\n        - api: EnumProps\n        - api: EnumPropsEx\n        - api: EnumPwrSchemes\n        - api: EnumResourceTypes\n        - api: EnumSystemCodePages\n        - api: EnumSystemGeoID\n        - api: EnumSystemGeoNames\n        - api: EnumSystemLanguageGroups\n        - api: EnumSystemLocales\n        - api: EnumThreadWindows\n        - api: EnumTimeFormats\n        - api: EnumUILanguages\n        - api: EnumWindows\n        - api: EnumWindowStations\n        - api: EnumerateLoadedModules\n        - api: GrayString\n        - api: ImmEnumInputContext\n        - api: LineDDA\n        - and:\n          - api: SymInitialize\n          - or:\n            - api: SymEnumProcesses\n            - api: SymRegisterCallback\n        - api: VerifierEnumerateResource\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/ChaitanyaHaritash/Callback_Shellcode_Injection"
                                                            },
                                                            {
                                                                "ref":  "https://www.trendmicro.com/en_us/research/22/k/earth-preta-spear-phishing-governments-worldwide.html"
                                                            },
                                                            {
                                                                "ref":  "http://ropgadget.com/posts/abusing_win_functions.html"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/aahmad097/AlternativeShellcodeExec/"
                                                            },
                                                            {
                                                                "ref":  "https://osandamalith.com/2021/04/01/executing-shellcode-via-callbacks/"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Windows",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set current directory",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set current directory\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.IO.Directory::SetCurrentDirectory\n      - api: kernel32.SetCurrentDirectory\n      - api: chdir\n      - api: fchdir\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get hostname",
                                               "description":  "host-interaction/os/hostname",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "copy file",
                                               "description":  "host-interaction/file-system/copy",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: LZCopy\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create mutex",
                                               "description":  "host-interaction/mutex",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: System.Threading.Mutex::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get common file path",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "execute shellcode via indirect call",
                                               "description":  "load-code/shellcode",
                                               "authors":  [
                                                               "ronnie.salomonsen@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: execute shellcode via indirect call\n    namespace: load-code/shellcode\n    authors:\n      - ronnie.salomonsen@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    mbc:\n      - Memory::Allocate Memory [C0007]\n  features:\n    - and:\n      - match: allocate or change RWX memory\n      - or:\n        - characteristic: indirect call\n        - characteristic: cross section flow\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link many functions at runtime",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against CPP standard library",
                                               "description":  "linking/static",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against CPP standard library\n    namespace: linking/static\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: file\n      dynamic: file\n    references:\n      - https://en.wikipedia.org/wiki/P._J._Plauger\n      - https://www.dinkumware.com/\n    examples:\n      - 03b236b23b1ec37c663527c1f53af3fe\n  features:\n    - or:\n      - string: \"Copyright (c) by P.J. Plauger, licensed by Dinkumware, Ltd. ALL RIGHTS RESERVED.\"\n      - string: \"Copyright (c) 1992-2004 by P.J. Plauger, licensed by Dinkumware, Ltd. ALL RIGHTS RESERVED.\"\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://en.wikipedia.org/wiki/P._J._Plauger"
                                                            },
                                                            {
                                                                "ref":  "https://www.dinkumware.com/"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contains PDB path",
                                               "description":  "executable/pe/pdb",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n"
                                           }
                                       ],
                 "verdict_labels":  [
                                        "Tofsee",
                                        "Zenpack"
                                    ],
                 "mbc":  [
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "allocate or change RWX memory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0043",
                                 "objective":  "Process",
                                 "behavior":  "Check Mutex",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "check mutex"
                                              }
                                          ]
                             },
                             {
                                 "id":  "F0015.006",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Hijack Execution Flow",
                                 "method":  "Abuse Windows Function Calls",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "execute shellcode via Windows callback function"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "read file on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1082",
                                 "objective":  "Discovery",
                                 "behavior":  "System Information Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get hostname"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0045",
                                 "objective":  "File System",
                                 "behavior":  "Copy File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "copy file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0042",
                                 "objective":  "Process",
                                 "behavior":  "Create Mutex",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create mutex"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get common file path"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0007",
                                 "objective":  "Memory",
                                 "behavior":  "Allocate Memory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "execute shellcode via indirect call"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             }
                         ],
                 "command_executions":  [
                                            "%SAMPLEPATH%",
                                            "\"%ComSpec%\" /C mkdir %windir%\\SysWOW64\\bpsyyjyx\\",
                                            "\"%windir%\\System32\\sc.exe\" create bpsyyjyx binPath= \"%windir%\\SysWOW64\\bpsyyjyx\\zcvggpqq.exe /d\\\"%SAMPLEPATH%\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                            "\"%ComSpec%\" /C move /Y \"%TEMP%\\zcvggpqq.exe\" %windir%\\SysWOW64\\bpsyyjyx\\",
                                            "\"%windir%\\System32\\sc.exe\" description bpsyyjyx \"wifi internet conection\"",
                                            "\"%windir%\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"%windir%\\SysWOW64\\svchost.exe\" enable=yes\u003enul"
                                        ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2176",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                                        },
                                        {
                                            "process_id":  "2880",
                                            "name":  "%CONHOST% \"50472252509410330-328179561255008592176251340-322057414-1953456883-1592826699"
                                        },
                                        {
                                            "process_id":  "2904",
                                            "name":  "%CONHOST% \"-15490084191864770001481900692125563231013828779918766094911389930620981705062"
                                        },
                                        {
                                            "process_id":  "2788",
                                            "name":  "%CONHOST% \"140713479-703082411751554854439765221-275460560-2049711714-11265012861768725949"
                                        },
                                        {
                                            "process_id":  "2816",
                                            "name":  "%CONHOST% \"195970304-1568581119195349782027988316014739068871157002092-821461499-1630978502"
                                        },
                                        {
                                            "process_id":  "2940",
                                            "name":  "%CONHOST% \"619943339-574015672-1477487057-207134493819714597841815605789-1002573193346598069"
                                        },
                                        {
                                            "process_id":  "2848",
                                            "name":  "%CONHOST% \"161377112816356265121214608053-11603636612135407342-1880511736-1314752520431150812"
                                        },
                                        {
                                            "process_id":  "2968",
                                            "name":  "%windir%\\SysWOW64\\bpsyyjyx\\zcvggpqq.exe /d\"%SAMPLEPATH%\""
                                        },
                                        {
                                            "process_id":  "3020",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "3064",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2592",
                                            "name":  "%SAMPLEPATH%",
                                            "time_offset":  4,
                                            "children":  [
                                                             {
                                                                 "process_id":  "2780",
                                                                 "name":  "\"%ComSpec%\" /C mkdir %windir%\\SysWOW64\\bpsyyjyx\\",
                                                                 "time_offset":  107
                                                             },
                                                             {
                                                                 "process_id":  "2840",
                                                                 "name":  "\"%windir%\\System32\\sc.exe\" create bpsyyjyx binPath= \"%windir%\\SysWOW64\\bpsyyjyx\\zcvggpqq.exe /d\\\"%SAMPLEPATH%\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                                                 "time_offset":  117
                                                             },
                                                             {
                                                                 "process_id":  "2896",
                                                                 "name":  "\"%windir%\\System32\\sc.exe\" start bpsyyjyx"
                                                             },
                                                             {
                                                                 "process_id":  "2808",
                                                                 "name":  "\"%ComSpec%\" /C move /Y \"%TEMP%\\zcvggpqq.exe\" %windir%\\SysWOW64\\bpsyyjyx\\",
                                                                 "time_offset":  114
                                                             },
                                                             {
                                                                 "process_id":  "2868",
                                                                 "name":  "\"%windir%\\System32\\sc.exe\" description bpsyyjyx \"wifi internet conection\"",
                                                                 "time_offset":  119
                                                             },
                                                             {
                                                                 "process_id":  "2932",
                                                                 "name":  "\"%windir%\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"%windir%\\SysWOW64\\svchost.exe\" enable=yes\u003enul",
                                                                 "time_offset":  123
                                                             }
                                                         ]
                                        }
                                    ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "\"%windir%\\System32\\netsh.exe\" advfirewall firewall add rule name=\"Host-process for services of Windows\" dir=in action=allow program=\"%windir%\\SysWOW64\\svchost.exe\" enable=yes\u003enul",
                                                                                             "Image":  "%windir%\\System32\\netsh.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "7b1f3cd9ca9b55feb5fdd5c8e1821348f2d78745282b41055af44f88df612112",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "New Firewall Rule Added Via Netsh.EXE",
                                                    "rule_description":  "Detects the addition of a new rule to the Windows firewall via netsh",
                                                    "rule_author":  "Markus Neis, Sander Wiebing"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "\"%windir%\\System32\\sc.exe\" create bpsyyjyx binPath= \"%windir%\\SysWOW64\\bpsyyjyx\\zcvggpqq.exe /d\\\"%SAMPLEPATH%\\\"\" type= own start= auto DisplayName= \"wifi support\"",
                                                                                             "Image":  "%windir%\\System32\\sc.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "low",
                                                    "rule_id":  "9821e08a6d71e81d42d38e95e4265f2df05a9e00e70a874249d812f403a8c789",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "New Service Creation Using Sc.EXE",
                                                    "rule_description":  "Detects the creation of a new service using the \"sc.exe\" utility.",
                                                    "rule_author":  "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community"
                                                }
                                            ],
                 "verdict_confidence":  70,
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link many functions at runtime",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link many functions at runtime"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1620":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "execute shellcode via Windows callback function",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "execute shellcode via Windows callback function"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get hostname",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get hostname"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get common file path",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get common file path"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
