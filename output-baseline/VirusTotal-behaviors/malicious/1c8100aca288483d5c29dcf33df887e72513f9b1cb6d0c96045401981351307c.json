{
    "data":  {
                 "verdicts":  [
                                  "UNKNOWN_VERDICT",
                                  "CLEAN",
                                  "MALWARE"
                              ],
                 "processes_terminated":  [
                                              "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                              "wmiadap.exe /F /T /R",
                                              "C:\\windows\\system32\\rundll32.exe"
                                          ],
                 "verdict_confidence":  1,
                 "files_opened":  [
                                      "C:\\Users\\user\\Desktop\\attachment.dll",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\attachment.dll.2.Manifest",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\SysWOW64\\AcLayers.DLL",
                                      "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
                                      "C:\\Windows\\SysWOW64\\CoreMessaging.dll",
                                      "C:\\Windows\\SysWOW64\\CoreUIComponents.dll",
                                      "C:\\Windows\\SysWOW64\\FLTLIB.DLL",
                                      "C:\\Windows\\SysWOW64\\GDI32.dll",
                                      "C:\\Windows\\SysWOW64\\IMM32.DLL",
                                      "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                                      "C:\\Windows\\SysWOW64\\MPR.dll",
                                      "C:\\Windows\\SysWOW64\\MSCTF.dll",
                                      "C:\\Windows\\SysWOW64\\OLEAUT32.dll",
                                      "C:\\Windows\\SysWOW64\\PROPSYS.dll",
                                      "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                                      "C:\\Windows\\SysWOW64\\SETUPAPI.dll",
                                      "C:\\Windows\\SysWOW64\\SHELL32.dll",
                                      "C:\\Windows\\SysWOW64\\SspiCli.dll",
                                      "C:\\Windows\\SysWOW64\\TextInputFramework.dll",
                                      "C:\\Windows\\SysWOW64\\USER32.dll",
                                      "C:\\Windows\\SysWOW64\\WINSPOOL.DRV",
                                      "C:\\Windows\\SysWOW64\\advapi32.dll",
                                      "C:\\Windows\\SysWOW64\\apphelp.dll",
                                      "C:\\Windows\\SysWOW64\\bcrypt.dll",
                                      "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                                      "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                                      "C:\\Windows\\SysWOW64\\combase.dll",
                                      "C:\\Windows\\SysWOW64\\dwmapi.dll",
                                      "C:\\Windows\\SysWOW64\\en-US\\KERNELBASE.dll.mui",
                                      "C:\\Windows\\SysWOW64\\en-US\\USER32.dll.mui",
                                      "C:\\Windows\\SysWOW64\\en-US\\rundll32.exe.mui",
                                      "C:\\Windows\\SysWOW64\\gdi32full.dll",
                                      "C:\\Windows\\SysWOW64\\imagehlp.dll",
                                      "C:\\Windows\\SysWOW64\\kernel.appcore.dll",
                                      "C:\\Windows\\SysWOW64\\loaddll32.exe",
                                      "C:\\Windows\\SysWOW64\\msvcp_win.dll",
                                      "C:\\Windows\\SysWOW64\\msvcrt.dll",
                                      "C:\\Windows\\SysWOW64\\ntdll.dll",
                                      "C:\\Windows\\SysWOW64\\ntmarta.dll",
                                      "C:\\Windows\\SysWOW64\\ole32.dll",
                                      "C:\\Windows\\SysWOW64\\powrprof.dll",
                                      "C:\\Windows\\SysWOW64\\profapi.dll",
                                      "C:\\Windows\\SysWOW64\\rundll32.exe",
                                      "C:\\Windows\\SysWOW64\\sechost.dll",
                                      "C:\\Windows\\SysWOW64\\sfc.dll",
                                      "C:\\Windows\\SysWOW64\\sfc_os.DLL",
                                      "C:\\Windows\\SysWOW64\\shcore.dll",
                                      "C:\\Windows\\SysWOW64\\shlwapi.dll",
                                      "C:\\Windows\\SysWOW64\\ucrtbase.dll",
                                      "C:\\Windows\\SysWOW64\\uxtheme.dll",
                                      "C:\\Windows\\SysWOW64\\win32u.dll",
                                      "C:\\Windows\\SysWOW64\\windows.storage.dll",
                                      "C:\\Windows\\SysWOW64\\wintypes.dll",
                                      "\\Device\\KsecDD",
                                      "C:\\Users\\user\\Desktop\\init.dll",
                                      "C:\\Users\\user\\Desktop\\init.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\init.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\init.dll.2.Manifest",
                                      "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                                      "C:\\Windows\\SysWOW64\\",
                                      "C:\\Users\\user\\Desktop\\readme.dll",
                                      "C:\\Users\\user\\Desktop\\readme.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\readme.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\readme.dll.2.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll",
                                      "C:\\Users\\user\\Desktop\\library.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll.124.Manifest",
                                      "C:\\Users\\user\\Desktop\\library.dll.2.Manifest"
                                  ],
                 "tags":  [
                              "RUNTIME_MODULES",
                              "IDLE",
                              "DETECT_DEBUG_ENVIRONMENT"
                          ],
                 "command_executions":  [
                                            "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\1c8100aca288483d5c29dcf33df887e72513f9b1cb6d0c96045401981351307c.dll ",
                                            "\\??\\C:\\Windows\\system32\\conhost.exe",
                                            "C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding",
                                            "\"D:\\loadll.exe\" C:\\Windows\\Temp\\sample\\pcreposix-0.dll 1"
                                        ],
                 "files_written":  [
                                       "C:\\ProgramData\\Microsoft\\RAC\\PublishedData\\RacWmiDatabase.sdf",
                                       "\\Device\\ConDrv\\\\Connect"
                                   ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "parse PE header",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "parse PE header"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129"
                                                 },
                                                 {
                                                     "id":  "T1218.011"
                                                 },
                                                 {
                                                     "id":  "T1574.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to load missing DLLs"
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Spawns processes"
                                                 },
                                                 {
                                                     "id":  "T1218.011",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Runs a DLL by calling functions"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies"
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates a process in suspended mode (likely to inject code)"
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Checks if the current process is being debugged"
                                                 },
                                                 {
                                                     "id":  "T1518.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Checks if the current process is being debugged"
                                                 }
                                             ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USERASSIST\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\COUNT/{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\\rkcybere.rkr",
                                               "value":  "00 00 00 00 09 00 00 00 65 00 00 00 5C 73 1A 00 ...(72)"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USERASSIST\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\COUNT/HRZR_PGYFRFFVBA",
                                               "value":  "00 00 00 00 A1 00 00 00 9A 01 00 00 BE 48 84 00 ...(1612)"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USERASSIST\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\COUNT/Zvpebfbsg.Jvaqbjf.Furyy.EhaQvnybt",
                                               "value":  "00 00 00 00 00 00 00 00 02 00 00 00 D6 ED 01 00 ...(72)"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USERASSIST\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\COUNT/Q:\\ybnqyy.rkr",
                                               "value":  "00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 ...(72)"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\RUNMRU/b",
                                               "value":  "D:\\loadll.exe C:\\Windows\\Temp\\sample\\pcreposix-0.dll 1\\1"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\RUNMRU/MRUList",
                                               "value":  "ba"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\MUICACHE\\20\\AAF68885/LanguageList",
                                               "value":  "zh-CN\nzh-Hans\nzh\nen-US\nen"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\ALLFOLDERS\\SHELL/WFlags",
                                               "value":  "0x00000000(0)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\ALLFOLDERS\\SHELL/ShowCmd",
                                               "value":  "0x00000001(1)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\ALLFOLDERS\\SHELL/HotKey",
                                               "value":  "0x00000000(0)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGMRU/NodeSlots",
                                               "value":  "02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 ...(81)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGMRU/MRUListEx",
                                               "value":  "01 00 00 00 02 00 00 00 00 00 00 00 05 00 00 00 ...(32)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/FFlags",
                                               "value":  "0x41200001(1092616193)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/Rev",
                                               "value":  "0x00000000(0)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/Vid",
                                               "value":  "{65F125E5-7BE1-4810-BA9D-D271C8432CE3}"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USERASSIST\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\COUNT/Q:\\flap.rkr",
                                               "value":  "00 00 00 00 00 00 00 00 00 00 00 00 05 07 00 00 ...(72)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/LogicalViewMode",
                                               "value":  "0x00000002(2)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/Mode",
                                               "value":  "0x00000006(6)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/IconSize",
                                               "value":  "0x00000030(48)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/ColInfo",
                                               "value":  "00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ...(136)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/Sort",
                                               "value":  "00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ...(44)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/GroupView",
                                               "value":  "0x00000000(0)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/GroupByKey:FMTID",
                                               "value":  "{00000000-0000-0000-0000-000000000000}"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/GroupByKey:PID",
                                               "value":  "0x00000000(0)"
                                           },
                                           {
                                               "key":  "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/GroupByDirection",
                                               "value":  "0x00000001(1)"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\MODULES\\GLOBALSETTINGS\\PROPERTREEMODULEINNER/ProperTreeModuleInner",
                                               "value":  "94 00 00 00 90 00 00 00 31 53 50 53 05 D5 CD D5 ...(152)"
                                           },
                                           {
                                               "key":  "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\MODULES\\NAVPANE/ExpandedState",
                                               "value":  "06 00 00 00 16 00 14 00 1F 80 80 A6 3C 32 4D C2 ...(638)"
                                           }
                                       ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2160",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                                        },
                                        {
                                            "process_id":  "2576",
                                            "name":  "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483"
                                        },
                                        {
                                            "process_id":  "2800",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2844",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "352",
                                            "name":  "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\1c8100aca288483d5c29dcf33df887e72513f9b1cb6d0c96045401981351307c.dll "
                                        },
                                        {
                                            "process_id":  "1744",
                                            "name":  "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\1c8100aca288483d5c29dcf33df887e72513f9b1cb6d0c96045401981351307c.dll "
                                        },
                                        {
                                            "process_id":  "3232",
                                            "name":  "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\1c8100aca288483d5c29dcf33df887e72513f9b1cb6d0c96045401981351307c.dll "
                                        },
                                        {
                                            "process_id":  "344",
                                            "name":  "C:\\Windows\\System32\\csrss.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1620",
                                                                 "name":  "C:\\Windows\\System32\\conhost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "872",
                                                                 "name":  "C:\\Windows\\System32\\conhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "556",
                                            "name":  "C:\\Windows\\System32\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "976",
                                                                 "name":  "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "1340",
                                            "name":  "C:\\Windows\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "880",
                                                                 "name":  "D:\\loadll.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "6344",
                                            "name":  "C:\\Windows\\System32\\loaddll32.exe loaddll32.exe \u0027C:\\Users\\user\\Desktop\\attachment.dll\u0027",
                                            "children":  [
                                                             {
                                                                 "process_id":  "5420",
                                                                 "name":  "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\attachment.dll,regcomp"
                                                             },
                                                             {
                                                                 "process_id":  "4804",
                                                                 "name":  "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\attachment.dll,regerror"
                                                             },
                                                             {
                                                                 "process_id":  "6008",
                                                                 "name":  "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\attachment.dll,regexec"
                                                             },
                                                             {
                                                                 "process_id":  "4156",
                                                                 "name":  "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\attachment.dll,regfree"
                                                             }
                                                         ]
                                        }
                                    ],
                 "windows_hidden":  [
                                        "C:\\windows\\system32\\rundll32.exe"
                                    ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delay execution",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@ramen0x3f"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "parse PE header",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate PE sections",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "@Ana06",
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n      - \"@mr-tz\"\n    scopes:\n      static: function\n      dynamic: unsupported  # requires offset, operand[1].offset, characteristic, mnemonic, basicblock features\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      # there should be some complexity to functions like this\n      - count(basic blocks): 3 or more\n      - optional:\n        - offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n      - instruction:\n        - or:\n          - mnemonic: mov\n          - mnemonic: movzx\n        - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - instruction:\n              - or:\n                - mnemonic: add\n                - mnemonic: mov\n                - mnemonic: movzx\n              - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - operand[1].offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header-\u003ee_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - 2 or more:\n        - operand[1].offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n        - operand[1].offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n        - operand[1].offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n        # there\u0027s also offset 0x8 = IMAGE_SECTION_HEADER.Misc.PhysicalAddress, but it\u0027s likely too common\n      - not:\n        # non-zeroing XOR was observed in FPs\n        - characteristic: nzxor\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://0x00sec.org/t/reflective-dll-injection/3080"
                                                            },
                                                            {
                                                                "ref":  "https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"
                                                            }
                                                        ]
                                           }
                                       ],
                 "modules_loaded":  [
                                        "C:\\Windows\\System32\\ntdll.dll",
                                        "C:\\Windows\\SysWOW64\\ntdll.dll",
                                        "C:\\Windows\\System32\\wow64.dll",
                                        "C:\\Windows\\System32\\wow64win.dll",
                                        "C:\\Windows\\System32\\wow64cpu.dll",
                                        "C:\\Windows\\System32\\kernel32.dll",
                                        "C:\\Windows\\SysWOW64\\kernel32.dll",
                                        "C:\\Windows\\System32\\user32.dll",
                                        "C:\\Windows\\SysWOW64\\KernelBase.dll",
                                        "C:\\Windows\\SysWOW64\\shell32.dll",
                                        "C:\\Windows\\SysWOW64\\msvcrt.dll",
                                        "C:\\Windows\\SysWOW64\\shlwapi.dll",
                                        "C:\\Windows\\SysWOW64\\gdi32.dll",
                                        "C:\\Windows\\SysWOW64\\user32.dll",
                                        "C:\\Windows\\SysWOW64\\advapi32.dll",
                                        "C:\\Windows\\SysWOW64\\sechost.dll",
                                        "C:\\Windows\\SysWOW64\\rpcrt4.dll",
                                        "C:\\Windows\\SysWOW64\\sspicli.dll",
                                        "C:\\Windows\\SysWOW64\\cryptbase.dll",
                                        "C:\\Windows\\SysWOW64\\lpk.dll",
                                        "C:\\Windows\\SysWOW64\\usp10.dll",
                                        "C:\\Windows\\SysWOW64\\ole32.dll",
                                        "C:\\Windows\\SysWOW64\\imagehlp.dll",
                                        "C:\\Windows\\SysWOW64\\imm32.dll",
                                        "C:\\Windows\\SysWOW64\\msctf.dll",
                                        "C:\\Windows\\winsxs\\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.24203_none_5c030043a0118fbf\\GdiPlus.dll",
                                        "C:\\Windows\\SysWOW64\\dbghelp.dll",
                                        "C:\\Windows\\SysWOW64\\ws2_32.dll",
                                        "C:\\Windows\\SysWOW64\\nsi.dll",
                                        "C:\\Windows\\SysWOW64\\psapi.dll",
                                        "C:\\Windows\\SysWOW64\\oleaut32.dll",
                                        "C:\\Windows\\SysWOW64\\setupapi.dll",
                                        "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                                        "C:\\Windows\\SysWOW64\\devobj.dll",
                                        "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                                        "C:\\Windows\\SysWOW64\\winnsi.dll",
                                        "C:\\Windows\\SysWOW64\\api-ms-win-core-synch-l1-2-0.DLL",
                                        "C:\\Windows\\SysWOW64\\version.dll",
                                        "${SamplePath}\\1c8100aca288483d5c29dcf33df887e72513f9b1cb6d0c96045401981351307c.dll"
                                    ],
                 "files_dropped":  [
                                       {
                                           "sha256":  "1a970a269b7ba9bf54ffe59f2ebbe2865402d1827cf589ea44b025bc82b4e8af"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\OfficeSoftwareProtectionPlatform\\Cache\\cache.dat",
                                           "sha256":  "3978a5b918167c0692569ac04ac9ffd50e4cb3f611a7d8315f907b95c6e76ef0"
                                       }
                                   ],
                 "processes_created":  [
                                           "C:\\windows\\system32\\rundll32.exe",
                                           "C:\\Windows\\System32\\conhost.exe",
                                           "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
                                           "D:\\loadll.exe"
                                       ],
                 "registry_keys_opened":  [
                                              "\\Registry\\Machine\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\CTF\\DirectSwitchHotkeys",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\FontLink\\SystemLink",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DllNXOptions",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\LanguagePack\\DataStore_V1.0",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\LanguagePack\\SurrogateFallback",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\LanguagePack\\SurrogateFallback\\Segoe UI",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\CTF\\",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\CTF\\Compatibility\\rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLE",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLEAUT",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\OOBE",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Policies\\Microsoft\\WindowsStore",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\OEM",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Input",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\OLE\\Tracing",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Display",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Ids",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup",
                                              "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\HwOrder",
                                              "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\ProviderOrder",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\cmd.exe"
                                          ],
                 "mbc":  [
                             {
                                 "id":  "B0003.003",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Dynamic Analysis Evasion",
                                 "method":  "Delayed Execution",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delay execution"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0046.001",
                                 "objective":  "Discovery",
                                 "behavior":  "Code Discovery",
                                 "method":  "Enumerate PE Sections",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "enumerate PE sections"
                                              }
                                          ]
                             }
                         ],
                 "registry_keys_deleted":  [
                                               "HKCU\\Software\\Classes\\LOCAL SETTINGS\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELL\\BAGS\\11\\SHELL\\{C4D98F09-6124-4FE0-9942-826416082DA9}/GroupCollapseState"
                                           ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "parse PE header",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "parse PE header"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN"
                                                         }
                                                     ],
                                           "T1218.011":  [
                                                             {
                                                                 "severity":  "UNKNOWN"
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Runs a DLL by calling functions"
                                                             }
                                                         ],
                                           "T1574.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Tries to load missing DLLs"
                                                             }
                                                         ],
                                           "T1055":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Spawns processes"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates a process in suspended mode (likely to inject code)"
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies"
                                                         }
                                                     ],
                                           "T1497":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Checks if the current process is being debugged"
                                                         }
                                                     ],
                                           "T1518.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Checks if the current process is being debugged"
                                                             }
                                                         ]
                                       }
             }
}
