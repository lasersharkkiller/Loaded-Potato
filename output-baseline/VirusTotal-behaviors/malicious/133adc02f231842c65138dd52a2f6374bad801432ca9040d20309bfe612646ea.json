{
    "data":  {
                 "services_created":  [
                                          "mssecsvc2.0"
                                      ],
                 "files_written":  [
                                       "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\History\\History.IE5",
                                       "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files\\Content.IE5",
                                       "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Roaming\\Microsoft\\Windows\\Cookies",
                                       "C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Windows\\History\\History.IE5",
                                       "C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files\\Content.IE5",
                                       "C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Cookies",
                                       "C:\\Windows\\tasksche.exe",
                                       "C:\\WINDOWS\\tasksche.exe",
                                       "C:\\Program Files\\Google\\Temp\\GUMD4EC.tmp"
                                   ],
                 "memory_pattern_urls":  [
                                             "http://cwwnhwhlz52maqm7.onion",
                                             "http://gx7ekbenv2riucmf.onion",
                                             "http://57g7spgrzlojinas.onion",
                                             "http://xxlvbrloxvriy2c5.onion",
                                             "http://76jdd2ir2embyv47.onion"
                                         ],
                 "verdict_labels":  [
                                        "WannaCry",
                                        "SMBScan"
                                    ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe",
                                           "C:\\Windows\\tasksche.exe",
                                           "C:\\Windows\\System32\\wuapihost.exe",
                                           "C:\\WINDOWS\\tasksche.exe /i"
                                       ],
                 "processes_terminated":  [
                                              "wmiadap.exe /F /T /R",
                                              "%SAMPLEPATH%",
                                              "C:\\Windows\\tasksche.exe",
                                              "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe",
                                              "C:\\Windows\\System32\\wuapihost.exe"
                                          ],
                 "files_opened":  [
                                      "\\??\\Nsi",
                                      "\\DEVICE\\NETBT_TCPIP_{CA8FCF09-3454-4A77-8B0B-C56C1488303C}",
                                      "\\DEVICE\\NETBT_TCPIP_{D5CD48D7-B0F7-4C10-89F8-4DF45C40E31E}",
                                      "\\DEVICE\\NETBT_TCPIP_{DCF5E7D8-4DB5-460B-B10A-62818BEB69E8}",
                                      "\\DEVICE\\NETBT_TCPIP_{E29AC6C2-7037-11DE-816D-806E6F6E6963}",
                                      "\\Device\\Afd\\AsyncConnectHlp",
                                      "\\Device\\Afd\\Endpoint",
                                      "C:\\WINDOWS\\tasksche.exe",
                                      "\\SystemRoot\\AppPatch\\sysmain.sdb",
                                      "C:\\",
                                      "C:\\Program Files\\Google\\Temp\\GUMD4EC.tmp",
                                      "\\??\\PIPE\\wkssvc"
                                  ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027.005",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "contain obfuscated stackstrings",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "contain obfuscated stackstrings"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1016",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get socket status",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get socket status"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get number of processors",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get number of processors"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get file size",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get file size"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "create service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "create service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "create service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "create service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "start service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "start service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "persist via Windows service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "persist via Windows service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "persist via Windows service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "persist via Windows service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.003",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "modify service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "modify service"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1569.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "modify service",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "modify service"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "memory_pattern_domains":  [
                                                "cwwnhwhlz52maqm7.onion",
                                                "gx7ekbenv2riucmf.onion",
                                                "57g7spgrzlojinas.onion",
                                                "xxlvbrloxvriy2c5.onion",
                                                "76jdd2ir2embyv47.onion"
                                            ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "213.225.126.194",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.93.38.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "36.11.170.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.140.164.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "123.251.31.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.117.119.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.43.45.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.11.180.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.93.38.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "213.225.126.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "150.111.75.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.43.45.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "35.37.57.124",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "68.142.137.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "213.225.126.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "15.101.173.57",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "19.225.10.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.11.180.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "194.116.206.169",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "19.225.10.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "194.116.206.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.43.45.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "209.117.0.11",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "15.101.173.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "101.36.97.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "194.116.206.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "209.117.0.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "66.34.51.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "98.143.47.115",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.97.167.43",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "11.103.231.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.44.54.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.154.80.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "8.86.38.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "25.109.234.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "13.198.181.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "101.36.97.203",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.235.188.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "15.101.173.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "11.103.231.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "25.109.234.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.11.180.114",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "11.103.231.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "213.225.126.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "25.109.234.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "8.86.38.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "11.103.231.24",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.55.40.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "19.225.10.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "98.143.47.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.218.131.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.43.45.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "104.11.47.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "19.225.10.148",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "66.34.51.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "68.142.137.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "19.225.10.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "184.177.92.56",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.117.119.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.38.177.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "13.198.181.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "184.177.92.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "184.177.92.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "209.117.0.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "150.111.75.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.43.45.210",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.117.119.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "209.117.0.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "104.11.47.174",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.44.54.163",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.235.188.110",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.11.180.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.140.164.172",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "123.251.31.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "8.86.38.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "15.101.173.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.38.177.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "194.116.206.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.140.164.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.97.167.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.218.131.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.93.38.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "35.37.57.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.218.131.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "11.103.231.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "101.36.97.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.55.40.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "101.36.97.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.55.40.134",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "36.11.170.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "13.198.181.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.38.177.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "98.143.47.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "66.34.51.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.44.54.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "15.101.173.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "123.251.31.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "184.177.92.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "68.142.137.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.38.177.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "8.86.38.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "194.116.206.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.159.153.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.93.38.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.44.54.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "209.117.0.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "104.11.47.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "25.109.234.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.218.131.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.159.153.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "36.11.170.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.11.180.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "150.111.75.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "25.109.234.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "213.225.126.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.159.153.18",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "211.11.180.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "8.86.38.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "8.86.38.145",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "98.143.47.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.218.131.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "19.225.10.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "150.111.75.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "184.177.92.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.140.164.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "68.142.137.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "123.251.31.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "209.117.0.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "98.143.47.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "194.116.206.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "15.101.173.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.235.188.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "68.142.137.67",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.218.131.254",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.159.153.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "101.36.97.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.44.54.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.97.167.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "13.198.181.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.117.119.168",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.38.177.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "98.143.47.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "123.251.31.38",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.117.119.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "104.11.47.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.55.40.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "101.36.97.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "120.117.119.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.235.188.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.38.177.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.154.80.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "68.142.137.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "150.111.75.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.235.188.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "35.37.57.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.93.38.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "35.37.57.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "35.37.57.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "60.93.38.77",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "213.225.126.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.55.40.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "104.11.47.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.159.153.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "68.142.137.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "184.177.92.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "150.111.75.224",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "66.34.51.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "35.37.57.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "209.117.0.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "104.11.47.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "13.198.181.20",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "73.43.45.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "123.251.31.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.154.80.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "36.11.170.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "194.116.206.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "123.251.31.6",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "126.235.188.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.97.167.1",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.97.167.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "42.140.164.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "45.38.177.192",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "66.34.51.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.44.54.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.154.80.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "183.55.40.3",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "13.198.181.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "189.154.80.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "11.103.231.5",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "46.159.153.2",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "182.97.167.4",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.133.109",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.229.211.108",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "0.48.144.16",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "10.117.112.220",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "100.55.179.214",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "100.70.105.203",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "102.11.32.68",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "105.251.197.56",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "105.71.253.5",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "108.46.50.28",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "108.74.248.192",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "109.234.84.95",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "11.179.137.30",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "110.2.13.138",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "112.130.26.248",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "112.197.236.133",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "112.225.48.75",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "113.167.54.249",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "113.220.82.61",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "117.226.227.17",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "118.183.170.118",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "118.94.211.140",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "119.120.210.2",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "119.202.66.79",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "12.95.86.153",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "120.231.13.49",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "121.3.74.24",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "121.42.62.80",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "125.203.190.146",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "125.220.69.233",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "125.42.215.232",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "128.249.40.45",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "128.78.157.228",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "130.168.45.100",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "132.191.84.186",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "132.67.239.132",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "133.92.95.253",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "134.102.173.154",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "136.231.241.181",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "137.214.120.30",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "137.4.202.138",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "138.166.213.179",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "138.208.16.1",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "14.49.249.211",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "140.44.107.67",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "141.225.205.223",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "141.35.3.30",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "143.24.14.139",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "143.69.181.211",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "144.236.247.250",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "147.52.64.34",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "15.65.77.183",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "15.87.39.153",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "150.179.178.76",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "150.206.127.198",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "151.59.108.225",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "152.121.211.199",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "152.136.54.225",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "154.241.251.171",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "154.43.5.91",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "154.67.171.161",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "155.111.161.36",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "156.138.231.135",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "156.2.115.177",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "158.215.227.236",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "158.62.49.133",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "159.84.66.171",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "161.121.91.84",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "162.123.148.227",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "163.122.30.207",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "163.218.134.187",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "164.9.43.194",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "165.161.138.107",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "167.53.31.120",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "168.83.132.164",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "17.3.43.248",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "171.212.25.56",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "172.83.70.209",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "173.82.88.146",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "175.194.14.77",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "177.204.197.163",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "178.197.126.125",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "178.21.65.50",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "178.250.254.174",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "178.89.146.73",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "179.113.97.83",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "179.93.14.87",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "18.177.124.38",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "180.53.126.87",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "181.111.22.167",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "181.180.197.35",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "181.211.99.149",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "183.224.188.109",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "183.229.73.197",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "183.79.202.39",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "184.254.105.224",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "185.9.33.126",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "186.188.208.15",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "186.28.248.76",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "188.21.156.235",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "189.102.80.65",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "189.160.246.10",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "189.168.25.101",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "19.254.183.26",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "190.236.229.214",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "190.47.125.220",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "191.149.177.47",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "191.155.179.35",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "191.229.71.72",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.159.89.162",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.100",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.101",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.102",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.103",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.104",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.105",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.106",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.107",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.108",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.109",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.10",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.110",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.111",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.112",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.113",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.114",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.115",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.116",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.117",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.118",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.119",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.11",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.120",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.121",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.122",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.123",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.124",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.125",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.126",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.127",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.128",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.129",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.12",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.130",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.131",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.132",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.133",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.134",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.135",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.136",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.137",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.138",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.139",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.13",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.140",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.141",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.142",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.143",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.144",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.145",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.146",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.147",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.148",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.149",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.14",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.150",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.151",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.152",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.153",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.154",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.155",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.156",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.157",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.158",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.159",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.15",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.160",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.161",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.162",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.163",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.164",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.165",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.166",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.167",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.168",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.169",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.16",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.170",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.171",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.172",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.173",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.174",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.175",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.176",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.177",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.178",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.179",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.17",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.180",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.181",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.182",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.183",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.184",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.185",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.186",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.187",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.188",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.189",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.18",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.190",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.191",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.192",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.193",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.194",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.195",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.196",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.197",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.198",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.199",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.19",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.1",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.200",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.201",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.202",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.203",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.204",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.205",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.206",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.207",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.208",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.209",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.20",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.210",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.211",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.212",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.213",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.214",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.215",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.216",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.217",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.218",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.219",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.21",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.220",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.221",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.222",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.223",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.224",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.225",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.226",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.227",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.228",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.229",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.22",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.230",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.231",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.232",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.233",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.234",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.235",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.236",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.237",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.238",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.239",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.23",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.240",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.241",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.242",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.243",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.244",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.245",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.246",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.247",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.248",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.249",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.24",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.250",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.251",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.252",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.253",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.254",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.25",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.26",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.27",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.28",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.29",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.2",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.30",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.31",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.32",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.33",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.34",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.35",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.36",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.37",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.38",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.39",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.3",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.40",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.41",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.42",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "192.168.122.43",
                                        "destination_port":  445
                                    },
                                    {
                                        "destination_ip":  "145.134.159.71",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "178.185.101.204",
                                        "destination_port":  445,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "command_executions":  [
                                            "%SAMPLEPATH%",
                                            "\"%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe\" ",
                                            "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe -m security",
                                            "C:\\WINDOWS\\tasksche.exe /i",
                                            "C:\\Windows\\System32\\wuapihost.exe -Embedding",
                                            "\"C:\\Program Files\\MicrosoftBAF\\CFWorker.exe\" ",
                                            "c:\\analyse\\1712260425.4383225_32f30493-b403-4d32-930d-f8f1673ac594 -m security",
                                            " ",
                                            "\"C:\\Program Files\\Google\\Update\\GoogleUpdate.exe\" /svc"
                                        ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\mssecsvc2.0\\Start",
                                               "value":  "DWORD (0x00000002)"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\mssecsvc2.0\\ImagePath",
                                               "value":  "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe -m security"
                                           }
                                       ],
                 "mbc":  [
                             {
                                 "id":  "C0058",
                                 "objective":  "Data",
                                 "behavior":  "Modulo",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "calculate modulo 256 via x86 assembly"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0003.003",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Dynamic Analysis Evasion",
                                 "method":  "Delayed Execution",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delay execution"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.010",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create UDP Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create UDP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.020",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Argument Obfuscation",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.017",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Stack Strings",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.011",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create TCP Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create TCP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0038",
                                 "objective":  "Process",
                                 "behavior":  "Create Thread",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create thread"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0039",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Thread",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate thread"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0001.019",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Debugger Detection",
                                 "method":  "Process Environment Block",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "PEB access"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0016",
                                 "objective":  "File System",
                                 "behavior":  "Create File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.006",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.007",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Send Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "send data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0030.001",
                                 "objective":  "Command and Control",
                                 "behavior":  "C2 Communication",
                                 "method":  "Send Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "send data"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0030.002",
                                 "objective":  "Command and Control",
                                 "behavior":  "C2 Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0001.033",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Debugger Detection",
                                 "method":  "Timing/Delay Check QueryPerformanceCounter",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "check for time delay via QueryPerformanceCounter"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0046.002",
                                 "objective":  "Discovery",
                                 "behavior":  "Code Discovery",
                                 "method":  "Inspect Section Memory Permissions",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "inspect section memory permissions"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.012",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Get Socket Status",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get socket status"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.001",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Set Socket Config",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "set socket configuration"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.004",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Connect Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "connect TCP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.008",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "TCP Client",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "act as TCP client"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0021.003",
                                 "objective":  "Cryptography",
                                 "behavior":  "Generate Pseudo-random Sequence",
                                 "method":  "Use API",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "generate random numbers via WinAPI"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get file size"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "read file on Windows"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.009",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Initialize Winsock Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "initialize Winsock library"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0063",
                                 "objective":  "File System",
                                 "behavior":  "Move File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "move file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "terminate process"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0002.012",
                                 "objective":  "Communication",
                                 "behavior":  "HTTP Communication",
                                 "method":  "Create Request",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create HTTP request"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0002.004",
                                 "objective":  "Communication",
                                 "behavior":  "HTTP Communication",
                                 "method":  "Open URL",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "connect to URL"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0023",
                                 "objective":  "Execution",
                                 "behavior":  "Install Additional Program",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain an embedded PE file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0025.007",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Conditional Execution",
                                 "method":  "Runs as Service",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "run as service"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0060",
                                 "objective":  "Data",
                                 "behavior":  "Compression Library",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "linked against ZLIB"
                                              }
                                          ]
                             }
                         ],
                 "files_copied":  [
                                      {
                                          "source":  "C:\\WINDOWS\\tasksche.exe",
                                          "destination":  "C:\\WINDOWS\\qeriuwjhrf"
                                      }
                                  ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "time.windows.com",
                                         "resolved_ips":  [
                                                              "51.145.123.29"
                                                          ]
                                     }
                                 ],
                 "verdict_confidence":  60,
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "(eth) truncated ethernet header",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "116:424",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:116; sid:424; rev:2; msg:\"(eth) truncated ethernet header\"; metadata: policy max-detect-ips drop, rule-type decode; classtype:misc-activity;)"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Destination Unreachable Network Unreachable",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:401",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP Destination Unreachable Network Unreachable\"; icode:0; itype:3; metadata:ruleset community; classtype:misc-activity; sid:401; rev:9; )"
                                    },
                                    {
                                        "rule_msg":  "(port_scan) TCP filtered portsweep",
                                        "rule_category":  "attempted-recon",
                                        "rule_id":  "122:7",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "178.185.101.204",
                                                              "dest_port":  445
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:122; sid:7; rev:2; msg:\"(port_scan) TCP filtered portsweep\"; metadata: rule-type preproc; classtype:attempted-recon;)"
                                    },
                                    {
                                        "rule_msg":  "(ipv4) IPv4 packet to \u0027current net\u0027 dest address",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "116:409",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:116; sid:409; rev:2; msg:\"(ipv4) IPv4 packet to \u0027current net\u0027 dest address\"; metadata: rule-type decode; classtype:misc-activity;)"
                                    },
                                    {
                                        "rule_msg":  "ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection",
                                        "rule_category":  "Misc activity",
                                        "rule_id":  "1:2001569",
                                        "alert_severity":  "low",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "145.134.159.71",
                                                              "dest_port":  445
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_raw":  "alert tcp $HOME_NET any -\u003e any 445 (msg:\"ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection\"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 70 , seconds 60; classtype:misc-activity; sid:2001569; rev:15; metadata:created_at 2010_07_30, former_category SCAN, updated_at 2019_07_26;)"
                                    }
                                ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2700",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "676",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2532",
                                            "name":  "%SAMPLEPATH%"
                                        },
                                        {
                                            "process_id":  "2624",
                                            "name":  "%SAMPLEPATH% -m security"
                                        },
                                        {
                                            "process_id":  "2684",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1316",
                                                                 "name":  "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "4068",
                                                                                      "name":  "C:\\Windows\\tasksche.exe"
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "536",
                                            "name":  "C:\\Windows\\System32\\services.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2040",
                                                                 "name":  "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "616",
                                            "name":  "C:\\Windows\\System32\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2240",
                                                                 "name":  "C:\\Windows\\System32\\wuapihost.exe"
                                                             }
                                                         ]
                                        }
                                    ],
                 "files_deleted":  [
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER48F.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER490.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER54B.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER54A.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER58C.tmp.txt",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER58B.tmp.txt",
                                       "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat",
                                       "C:\\CommonFramework\\instdata.dat",
                                       "C:\\Program Files\\Google\\Temp\\GUMD4EC.tmp"
                                   ],
                 "modules_loaded":  [
                                        "%SAMPLEPATH%\\_home_petik_shadowserver_malware_2024-04-04_3a6889e0fd7c9a9bac4dd67b91b0e05a_wannacry.exe",
                                        "secur32.dll",
                                        "shell32.dll",
                                        "wsock32",
                                        "ws2_32",
                                        "rpcrt4.dll",
                                        "advapi32.dll"
                                    ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "files_dropped":  [
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\INetCache"
                                       },
                                       {
                                           "path":  "C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\INetCache\\counters2.dat"
                                       },
                                       {
                                           "path":  "C:\\Windows\\tasksche.exe"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER48F.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER48F.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER490.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER490.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER54A.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER54A.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER54B.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER54B.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER58B.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER58C.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER58B.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER58C.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                       },
                                       {
                                           "path":  "tasksche.exe",
                                           "sha256":  "6c18edabe4864c9c0da047c7fddc15c09f69b2a99b520c613b3e096d98f80c1e"
                                       }
                                   ],
                 "mutexes_created":  [
                                         "Global\\Common Framework RepairService Mutex",
                                         "Local\\WininetProxyRegistryMutex",
                                         "Local\\WininetStartupMutex",
                                         "Local\\_!MSFTHISTORY!_",
                                         "Local\\c:!windows!system32!config!systemprofile!appdata!local!microsoft!windows!history!history.ie5!",
                                         "Local\\c:!windows!system32!config!systemprofile!appdata!local!microsoft!windows!temporary internet files!content.ie5!",
                                         "Local\\c:!windows!system32!config!systemprofile!appdata!roaming!microsoft!windows!cookies!",
                                         "Local\\c:!users!administrator!appdata!local!microsoft!windows!history!history.ie5!",
                                         "Local\\c:!users!administrator!appdata!local!microsoft!windows!temporary internet files!content.ie5!",
                                         "Local\\c:!users!administrator!appdata!roaming!microsoft!windows!cookies!",
                                         "ShimCacheMutex"
                                     ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "calculate modulo 256 via x86 assembly",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delay execution",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@ramen0x3f"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create UDP socket",
                                               "description":  "communication/socket/udp/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create UDP socket\n    namespace: communication/socket/udp/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create UDP Socket [C0001.010]\n    examples:\n      - 203BD48BCC18434314AD60F4C8BC21E3D3422EB0624B22B827410F9BC63B4082:0x401240\n  features:\n    - or:\n      - and:\n        - count(number(2 = AF_INET/SOCK_DGRAM)): 2 or more\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n          - api: System.Net.Sockets.Socket::ctor\n      - api: System.Net.Sockets.UdpClient::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain obfuscated stackstrings",
                                               "description":  "anti-analysis/obfuscation/string/stackstring",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create TCP socket",
                                               "description":  "communication/socket/tcp",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - and:\n        - number: 6 = IPPROTO_TCP\n        - number: 1 = SOCK_STREAM\n        - number: 2 = AF_INET\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n          - api: System.Net.Sockets.Socket::ctor\n      - property/read: System.Net.Sockets.TcpClient::Client\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create thread",
                                               "description":  "host-interaction/thread/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate thread",
                                               "description":  "host-interaction/thread/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate thread\n    namespace: host-interaction/thread/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Terminate Thread [C0039]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003286\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x407E90\n  features:\n    - or:\n      - api: kernel32.TerminateThread\n      - api: PsTerminateSystemThread\n      - api: System.Threading.Thread.Abort\n      - api: pthread_terminate\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "PEB access",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data on socket",
                                               "description":  "communication/socket/receive",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recv\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n      - api: recvmsg\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "send data on socket",
                                               "description":  "communication/socket/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.send\n      - api: ws2_32.sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: send\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "send data",
                                               "description":  "communication : all known techniques for sending data to a potential C2 server",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: send data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n    description: all known techniques for sending data to a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Send Data [B0030.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n          - match: send data to Internet\n      - and:\n        - os: linux\n        - or: # Require network bound socket.\n          - match: create TCP socket\n          - match: create UDP socket\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data",
                                               "description":  "communication : all known techniques for receiving data from a potential C2 server",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check for time delay via QueryPerformanceCounter",
                                               "description":  "anti-analysis/anti-debugging/debugger-detection",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check for time delay via QueryPerformanceCounter\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4011e0\n  features:\n    - and:\n      - count(api(kernel32.QueryPerformanceCounter)): 2 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "inspect section memory permissions",
                                               "description":  "load-code/pe : translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants",
                                               "authors":  [
                                                               "@Ana06"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: inspect section memory permissions\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    description: \"translate section memory permissions (specified in the \u0027Characteristics\u0027 field of the image section header) into page protection constants\"\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Discovery::Code Discovery::Inspect Section Memory Permissions [B0046.002]\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401480\n  features:\n    - and:\n      - os: windows\n      - 3 or more:\n        - and:\n          - number: 0x40000000 = IMAGE_SCN_MEM_READ\n          - number: 0x2 = PAGE_READONLY\n        - and:\n          - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x10 = PAGE_EXECUTE\n        - and:\n          - or:\n            - number: 0x60000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x20 = PAGE_EXECUTE_READ\n        - and:\n          - or:\n            - number: 0xC0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n          - number: 0x4 = PAGE_READWRITE\n        - and:\n          - or:\n            - number: 0xE0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n      - optional:\n        - number: 0x1 = PAGE_NOACCESS\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get socket status",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get socket status\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    mbc:\n      - Communication::Socket Communication::Get Socket Status [C0001.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - and:\n      - api: ws2_32.select\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set socket configuration",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set socket configuration\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Set Socket Config [C0001.001]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.setsockopt\n      - api: ws2_32.ioctlsocket\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "connect TCP socket",
                                               "description":  "communication/socket/tcp",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: connect TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::Socket Communication::Connect Socket [C0001.004]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - match: create TCP socket\n      - or:\n        - api: connect\n        - api: ws2_32.connect\n        - api: ws2_32.WSAConnect\n        - api: ConnectEx\n        - or:\n          - and:\n            # static\n            - basic block:\n              # candidate for GUID: WSAID_CONNECTEX/25a207b9-ddf3-4660-8ee9-76e58c74063e\n              - and:\n                - number: 0x25A207B9\n                - number: 0x4660DDF3\n                - number: 0xE576E98E\n                - number: 0x3E06748C\n            - basic block:\n              - and:\n                - api: WSAIoctl\n                - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n            - basic block:\n              - and:\n                - api: setsockopt\n                - number: 0xFFFF = SOL_SOCKET\n                - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n            # socket must be bound to ConnectEx\n            # https://gist.github.com/joeyadams/4158972\n            - api: bind\n          - and:\n            # dynamic\n            - call:\n              - and:\n                - api: WSAIoctl\n                - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n            - call:\n              - and:\n                - api: setsockopt\n                - number: 0xFFFF = SOL_SOCKET\n                - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n            # socket must be bound to ConnectEx\n            # https://gist.github.com/joeyadams/4158972\n            - api: bind\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "act as TCP client",
                                               "description":  "communication/tcp/client",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: act as TCP client\n    namespace: communication/tcp/client\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::Socket Communication::TCP Client [C0001.008]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - match: connect TCP socket\n      - api: System.Net.Sockets.TcpClient::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "generate random numbers via WinAPI",
                                               "description":  "data-manipulation/prng",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "johnk3r"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: generate random numbers via WinAPI\n    namespace: data-manipulation/prng\n    authors:\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Cryptography::Generate Pseudo-random Sequence::Use API [C0021.003]\n    examples:\n      - ba947eb07d8c823949316a97364d060f:0x1400031E0\n      - 3ca359f5085bb96a7950d4735b089ffe:0x403A80\n      - e59ffeaf7acb0c326e452fa30bb71a36:0x40403E\n      - 1195d0d18be9362fb8dd9e1738404c9d:0x404E90\n  features:\n    - and:\n      - or:\n        - api: BCryptGenRandom\n        - api: CryptGenRandom\n      - optional:\n        - api: BCryptOpenAlgorithmProvider\n        - api: BCryptCloseAlgorithmProvider\n        - api: CryptAquireContext\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get number of processors",
                                               "description":  "host-interaction/hardware/cpu",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get number of processors\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires property features\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361\n    examples:\n      - al-khaser_x86.exe_:0x432CB0\n  features:\n    - or:\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x64 = PEB-\u003eNumberOfProcessors\n          - and:\n            - arch: amd64\n            - number: 0xB8 = PEB-\u003eNumberOfProcessors\n      - property/read: System.Environment::ProcessorCount\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file size",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Windows",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "initialize Winsock library",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - and:\n      - api: ws2_32.WSAStartup\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get service handle",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create service",
                                               "description":  "host-interaction/service/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create service\n    namespace: host-interaction/service/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - and:\n      - api: advapi32.CreateService\n      - optional:\n        - api: advapi32.OpenSCManager\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "start service",
                                               "description":  "host-interaction/service/start",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: start service\n    namespace: host-interaction/service/start\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x401FA0\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - api: advapi32.StartService\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "persist via Windows service",
                                               "description":  "persistence/service",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: persist via Windows service\n    namespace: persistence/service\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - 9f012d7e3ae8f62370278e372691eb73b878fe2280b6083e1be637b278021855:0x40113A\n  features:\n    - or:\n      - and:\n        - or:\n          - basic block:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n          - call:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n        - optional:\n          - or:\n            - api: advapi32.OpenService\n            - api: advapi32.StartService\n      - and:\n        - match: host-interaction/process/create\n        - or:\n          - and:\n            - string: /^sc(|\\.exe)$/i\n            - string: /create /i\n          - string: /^sc(|\\.exe) create/i\n          - string: /New-Service /i\n      - and:\n        - match: \"set registry value\"\n        - string: /System\\\\(CurrentControlSet|ControlSet001)\\\\Services/i\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "move file",
                                               "description":  "host-interaction/file-system/move",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 1 = FO_MOVE\n          - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "extract resource via kernel32 functions",
                                               "description":  "executable/resource",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "modify service",
                                               "description":  "host-interaction/service/modify",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: modify service\n    namespace: host-interaction/service/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - 7D16EFD0078F22C17A4BD78B0F0CC468:0x401000\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - or:\n        - api: advapi32.ChangeServiceConfig\n        - api: advapi32.ChangeServiceConfig2\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create HTTP request",
                                               "description":  "communication/http/client",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create HTTP request\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::HTTP Communication::Create Request [C0002.012]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - or:\n        - api: wininet.InternetOpen\n        - api: System.Net.WebRequest::Create\n        - api: System.Net.WebRequest::CreateDefault\n        - api: System.Net.WebRequest::CreateHttp\n      - optional:\n        - api: wininet.InternetCloseHandle\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "connect to URL",
                                               "description":  "communication/http/client",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: connect to URL\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::HTTP Communication::Open URL [C0002.004]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - optional:\n        - match: create HTTP request\n      - api: wininet.InternetOpenUrl\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain an embedded PE file",
                                               "description":  "executable/subfile/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "run as service",
                                               "description":  "host-interaction/service",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: run as service\n    namespace: host-interaction/service\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Anti-Behavioral Analysis::Conditional Execution::Runs as Service [B0025.007]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_\n  features:\n    - or:\n      - export: ServiceMain\n      - function:\n        - or:\n          - api: RegisterServiceCtrlHandler\n          - api: RegisterServiceCtrlHandlerEx\n          - api: StartServiceCtrlDispatcher\n          - api: System.ServiceProcess.ServiceBase::Run\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "linked against ZLIB",
                                               "description":  "linking/static/zlib",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: linked against ZLIB\n    namespace: linking/static/zlib\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Data::Compression Library [C0060]\n    examples:\n      - 6cc148363200798a12091b97a17181a1\n  features:\n    - or:\n      - string: /deflate .* Copyright/\n      - string: /inflate .* Copyright/\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contains PDB path",
                                               "description":  "executable/pe/pdb",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n"
                                           }
                                       ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "C:\\WINDOWS\\tasksche.exe /i",
                                                                                             "Image":  "C:\\WINDOWS\\tasksche.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "C:\\Windows\\tasksche.exe",
                                                                                             "Image":  "C:\\Windows\\tasksche.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "critical",
                                                    "rule_id":  "b8a9a3d755cac11238eb37aa06d27255714356075872c2e2e140acfb3e8ab8b0",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "WannaCry Ransomware Activity",
                                                    "rule_description":  "Detects WannaCry ransomware activity",
                                                    "rule_author":  "Florian Roth (Nextron Systems), Tom U. @c_APT_ure (collection), oscd.community, Jonhnathan Ribeiro"
                                                }
                                            ],
                 "attack_techniques":  {
                                           "T1027.005":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "contain obfuscated stackstrings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "contain obfuscated stackstrings"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1016":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get socket status",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get socket status"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get number of processors",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get number of processors"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get file size",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get file size"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1543.003":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "create service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "create service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "start service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "start service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "persist via Windows service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "persist via Windows service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "modify service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "modify service"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1569.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "create service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "create service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "persist via Windows service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "persist via Windows service"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "modify service",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "modify service"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
