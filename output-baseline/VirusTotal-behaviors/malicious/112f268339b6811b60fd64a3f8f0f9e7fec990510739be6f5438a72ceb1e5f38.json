{
    "data":  {
                 "mbc":  [
                             {
                                 "id":  "B0001.019",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Debugger Detection",
                                 "method":  "Process Environment Block",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "PEB access"
                                              }
                                          ]
                             }
                         ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "128.199.31.87",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "sciiultaelinoza.com",
                                         "resolved_ips":  [
                                                              "128.199.31.87"
                                                          ]
                                     }
                                 ],
                 "registry_keys_opened":  [
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\OLE",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\OLEAUT",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\cmd.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WinHttp",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient\\DnsPolicyConfig",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Lsa\\SspiCache\\credssp.dll",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Dnscache\\InterfaceSpecificParameters\\{D98ADCA8-3705-4093-B6B0-210B85CA195B}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{3882a85b-858a-11eb-b9e1-806e6f6e6963}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{d98adca8-3705-4093-b6b0-210b85ca195b}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\307BDA19",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\307BDA19-2D829E51",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\307BDA19-3AB86DD1",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\00000014",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000001",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000002",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000003",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000004",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000005",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64\\000000000006",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\00000007",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000001",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000002",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000003",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000004",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000005",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000006",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000007",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000008",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000009",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000010",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000011",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000012",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64\\000000000013",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Winsock\\Setup Migration\\Providers\\Tcpip",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Winsock\\Setup Migration\\Providers\\Tcpip6",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Dnscache\\InterfaceSpecificParameters",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Dnscache\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Dnscache\\Parameters\\dnscache",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Interfaces\\{3882A85B-858A-11EB-B9E1-806E6F6E6963}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Interfaces\\{D98ADCA8-3705-4093-B6B0-210B85CA195B}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{3882A85B-858A-11EB-B9E1-806E6F6E6963}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{D98ADCA8-3705-4093-B6B0-210B85CA195B}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WinHttpAutoProxySvc\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Setup Migration\\Providers",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\OLE\\Tracing",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\PeerDist\\Service",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\windows\\CurrentVersion\\Internet Settings\\Connections",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\PeerDist\\Service",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\System\\DNSClient",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\DnsClient",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Display",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Error Message Instrument\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Hvsi",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\SspiCache",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Ids",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SQMServiceList",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders\\SaslProfiles",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\StateSeparation\\RedirectionMap\\Keys",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\DNS",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters\\DnsPolicyConfig",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{3882A85B-858A-11EB-B9E1-806E6F6E6963}",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{D98ADCA8-3705-4093-B6B0-210B85CA195B}",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\WinSock2\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Winsock2\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\afunix\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup"
                                          ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_HIGH",
                                                     "signature_description":  "System process connects to network (likely due to code injection)"
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Spawns processes"
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates a process in suspended mode (likely to inject code)"
                                                 },
                                                 {
                                                     "id":  "T1218.011",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Runs a DLL by calling functions"
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "May sleep (evasive loops) to hinder dynamic analysis"
                                                 },
                                                 {
                                                     "id":  "T1518.001",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "Tries to detect virtualization through RDTSC time measurements"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "Tries to detect virtualization through RDTSC time measurements"
                                                 },
                                                 {
                                                     "id":  "T1018",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads the hosts file"
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Downloads files from webservers via HTTP"
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Performs DNS lookups"
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Downloads files from webservers via HTTP"
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "C2 URLs / IPs found in malware configuration"
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Performs DNS lookups"
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Downloads files from webservers via HTTP"
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Some HTTP requests failed (404). It is likely the sample will exhibit less behavior"
                                                 }
                                             ],
                 "http_conversations":  [
                                            {
                                                "url":  "http://sciiultaelinoza.com/",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "Host":  "sciiultaelinoza.com"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "162",
                                                                         "Content-Type":  "text/html"
                                                                     },
                                                "response_status_code":  403,
                                                "response_body_filetype":  "HTML"
                                            }
                                        ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "PEB access",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get OS version",
                                               "authors":  [
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n      - api: GetProductInfo\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - or:\n              - offset: 0xA4 = PEB-\u003eOSMajorVersion\n              - offset: 0xA8 = PEB-\u003eOSMinorVersion\n              - offset: 0xAC = PEB-\u003eOSBuildNumber\n          - and:\n            - arch: amd64\n            - or:\n              - offset: 0x118 = PEB-\u003eOSMajorVersion\n              - offset: 0x11C = PEB-\u003eOSMinorVersion\n              - offset: 0x120 = PEB-\u003eOSBuildNumber\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           }
                                       ],
                 "verdict_confidence":  72,
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "MALWARE-CNC Win.Trojan.IcedId outbound connection",
                                        "rule_category":  "trojan-activity",
                                        "rule_id":  "1:300262",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "dest_ip":  "128.199.31.87",
                                                              "dest_port":  80
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_references":  [
                                                                "https://www.virustotal.com/gui/file/baeb13eea3a71cfaba9d20ef373dcea69cf31f2ec21f45b83f29f699330cb3e3/detection"
                                                            ],
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET $HTTP_PORTS ( msg:\"MALWARE-CNC Win.Trojan.IcedId outbound connection\"; flow:to_server,established; http_cookie; content:\"__gads=\",depth 7; content:\"|3B| _gat=\",distance 0; content:\"|3B| _ga=\",distance 0; content:\"|3B| _u=\",distance 0; content:\"|3B| __io=\",distance 0,fast_pattern; content:\"|3B| _gid=\",distance 0; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/gui/file/baeb13eea3a71cfaba9d20ef373dcea69cf31f2ec21f45b83f29f699330cb3e3/detection; classtype:trojan-activity; gid:1; sid:300262; rev:1; )"
                                    },
                                    {
                                        "rule_msg":  "ET MALWARE Win32/IcedID Request Cookie",
                                        "rule_category":  "A Network Trojan was detected",
                                        "rule_id":  "1:2032086",
                                        "alert_severity":  "high",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "128.199.31.87",
                                                              "dest_port":  80,
                                                              "hostname":  "sciiultaelinoza.com",
                                                              "url":  "http://sciiultaelinoza.com/"
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://sysopfb.github.io/malware",
                                                                "https://www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html"
                                                            ],
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET any (msg:\"ET MALWARE Win32/IcedID Request Cookie\"; flow:established,to_server; http.method; content:\"GET\"; http.cookie; content:\"_gads=\"; depth:7; content:\"_gat=\"; distance:0; content:\"_ga=\"; distance:0; content:\"_u=\"; distance:0; content:\"_io=\"; distance:0; content:\"_gid=\"; distance:0; reference:url,sysopfb.github.io/malware,/icedid/2020/04/28/IcedIDs-updated-photoloader.html; reference:url,www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html; classtype:trojan-activity; sid:2032086; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_17, deployment Perimeter, former_category MALWARE, signature_severity Major, updated_at 2021_03_17;)"
                                    }
                                ],
                 "files_opened":  [
                                      "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                                      "C:\\Users\\user\\Desktop\\init.dll",
                                      "C:\\Users\\user\\Desktop\\init.dll.123.Manifest",
                                      "C:\\Users\\user\\Desktop\\init.dll.124.Manifest",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\SYSTEM32\\CRYPTBASE.dll",
                                      "C:\\Windows\\SYSTEM32\\DNSAPI.dll",
                                      "C:\\Windows\\SYSTEM32\\IPHLPAPI.DLL",
                                      "C:\\Windows\\SYSTEM32\\WINHTTP.dll",
                                      "C:\\Windows\\SYSTEM32\\WINNSI.DLL",
                                      "C:\\Windows\\SYSTEM32\\apphelp.dll",
                                      "C:\\Windows\\SYSTEM32\\bcrypt.dll",
                                      "C:\\Windows\\SYSTEM32\\dhcpcsvc.DLL",
                                      "C:\\Windows\\SYSTEM32\\dhcpcsvc6.DLL",
                                      "C:\\Windows\\SYSTEM32\\en-US\\rundll32.exe.mui",
                                      "C:\\Windows\\SYSTEM32\\en-US\\winnlsres.dll.mui",
                                      "C:\\Windows\\SYSTEM32\\loaddll64.exe",
                                      "C:\\Windows\\SYSTEM32\\ntdll.dll",
                                      "C:\\Windows\\SYSTEM32\\ole32.dll",
                                      "C:\\Windows\\SYSTEM32\\webio.dll",
                                      "C:\\Windows\\SYSTEM32\\winnlsres.dll",
                                      "C:\\Windows\\System32\\KERNEL32.DLL",
                                      "C:\\Windows\\System32\\KERNELBASE.dll",
                                      "C:\\Windows\\System32\\SspiCli.dll",
                                      "C:\\Windows\\System32\\drivers\\etc\\hosts",
                                      "C:\\Windows\\System32\\en-US\\wshqos.dll.mui",
                                      "C:\\Windows\\System32\\fwpuclnt.dll",
                                      "C:\\Windows\\System32\\rasadhlp.dll",
                                      "C:\\Windows\\System32\\wshqos.dll",
                                      "C:\\Windows\\system32\\",
                                      "C:\\Windows\\system32\\IMM32.DLL",
                                      "C:\\Windows\\system32\\IPHLPAPI.DLL",
                                      "C:\\Windows\\system32\\OnDemandConnRouteHelper.dll",
                                      "C:\\Windows\\system32\\WINHTTP.dll",
                                      "C:\\Windows\\system32\\bcrypt.dll",
                                      "C:\\Windows\\system32\\drivers\\etc\\hosts",
                                      "C:\\Windows\\system32\\dwmapi.dll",
                                      "C:\\Windows\\system32\\en-US\\mswsock.dll.mui",
                                      "C:\\Windows\\system32\\en-US\\rundll32.exe.mui",
                                      "C:\\Windows\\system32\\en-US\\winnlsres.dll.mui",
                                      "C:\\Windows\\system32\\mswsock.dll",
                                      "C:\\Windows\\system32\\uxtheme.dll",
                                      "C:\\Windows\\system32\\webio.dll",
                                      "C:\\Windows\\system32\\winnlsres.dll",
                                      "Nsi",
                                      "\\DEVICE\\NETBT_TCPIP_{3882A85B-858A-11EB-B9E1-806E6F6E6963}",
                                      "\\DEVICE\\NETBT_TCPIP_{D98ADCA8-3705-4093-B6B0-210B85CA195B}",
                                      "\\Device\\Afd\\Endpoint",
                                      "\\Device\\KsecDD",
                                      "\\Device\\RasAcd"
                                  ],
                 "tags":  [
                              "DETECT_DEBUG_ENVIRONMENT",
                              "LONG_SLEEPS"
                          ],
                 "verdict_labels":  [
                                        "IcedID"
                                    ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2752",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2796",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2452",
                                            "name":  "%SANDBOX_DLL_LOADER_AMD64% %SAMPLEPATH% %WORKDIR% 483"
                                        },
                                        {
                                            "process_id":  "4576",
                                            "name":  "C:\\Windows\\System32\\loaddll64.exe loaddll64.exe \"C:\\Users\\user\\Desktop\\init.dll\"",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3732",
                                                                 "name":  "C:\\Windows\\System32\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\init.dll\",#1",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3124",
                                                                                      "name":  "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\init.dll\",#1"
                                                                                  }
                                                                              ]
                                                             },
                                                             {
                                                                 "process_id":  "3356",
                                                                 "name":  "C:\\Windows\\System32\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\init.dll,hjaskdnajsdsas"
                                                             },
                                                             {
                                                                 "process_id":  "3744",
                                                                 "name":  "C:\\Windows\\System32\\rundll32.exe rundll32.exe \"C:\\Users\\user\\Desktop\\init.dll\",hjaskdnajsdsas"
                                                             }
                                                         ]
                                        }
                                    ],
                 "files_written":  [
                                       "\\Device\\ConDrv\\\\Connect"
                                   ],
                 "verdicts":  [
                                  "UNKNOWN_VERDICT",
                                  "MALWARE",
                                  "TROJAN",
                                  "EVADER"
                              ],
                 "memory_pattern_urls":  [
                                             "sciiultaelinoza.com"
                                         ],
                 "text_decoded":  [
                                      "{\"Campaign ID\": 3822462527, \"C2 url\": \"sciiultaelinoza.com\"}"
                                  ],
                 "processes_terminated":  [
                                              "wmiadap.exe /F /T /R"
                                          ],
                 "attack_techniques":  {
                                           "T1055":  [
                                                         {
                                                             "severity":  "HIGH",
                                                             "description":  "System process connects to network (likely due to code injection)"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Spawns processes"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates a process in suspended mode (likely to inject code)"
                                                         }
                                                     ],
                                           "T1218.011":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Runs a DLL by calling functions"
                                                             }
                                                         ],
                                           "T1497":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "May sleep (evasive loops) to hinder dynamic analysis"
                                                         }
                                                     ],
                                           "T1518.001":  [
                                                             {
                                                                 "severity":  "LOW",
                                                                 "description":  "Tries to detect virtualization through RDTSC time measurements"
                                                             }
                                                         ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies"
                                                         },
                                                         {
                                                             "severity":  "LOW",
                                                             "description":  "Tries to detect virtualization through RDTSC time measurements"
                                                         }
                                                     ],
                                           "T1018":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads the hosts file"
                                                         }
                                                     ],
                                           "T1095":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Downloads files from webservers via HTTP"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Performs DNS lookups"
                                                         }
                                                     ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Downloads files from webservers via HTTP"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                         },
                                                         {
                                                             "severity":  "LOW",
                                                             "description":  "C2 URLs / IPs found in malware configuration"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Performs DNS lookups"
                                                         }
                                                     ],
                                           "T1105":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Downloads files from webservers via HTTP"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Some HTTP requests failed (404). It is likely the sample will exhibit less behavior"
                                                         }
                                                     ]
                                       }
             }
}
