{
    "data":  {
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "(eth) truncated ethernet header",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "116:424",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert ( gid:116; sid:424; rev:2; msg:\"(eth) truncated ethernet header\"; metadata: policy max-detect-ips drop, rule-type decode; classtype:misc-activity;)"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Unusual PING detected",
                                        "rule_category":  "successful-recon-limited",
                                        "rule_id":  "1:29456",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_references":  [
                                                                "https://krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/",
                                                                "https://krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/"
                                                            ],
                                        "rule_raw":  "alert icmp $HOME_NET any -\u003e $EXTERNAL_NET any ( msg:\"PROTOCOL-ICMP Unusual PING detected\"; icode:0; itype:8; fragbits:!M; content:!\"ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI\",depth 32; content:!\"0123456789abcdefghijklmnopqrstuv\",depth 32; content:!\"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\",depth 36; content:!\"WANG2\"; content:!\"cacti-monitoring-system\",depth 65; content:!\"SolarWinds\",depth 72; metadata:policy max-detect-ips drop,ruleset community; reference:url,krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/; reference:url,krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/; classtype:successful-recon-limited; sid:29456; rev:3; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP traceroute",
                                        "rule_category":  "attempted-recon",
                                        "rule_id":  "1:385",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP traceroute\"; itype:8; ttl:1; metadata:ruleset community; classtype:attempted-recon; sid:385; rev:8; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP PING",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:384",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP PING\"; icode:0; itype:8; metadata:ruleset community; classtype:misc-activity; sid:384; rev:8; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Echo Reply",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:408",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP Echo Reply\"; icode:0; itype:0; metadata:ruleset community; classtype:misc-activity; sid:408; rev:8; )"
                                    },
                                    {
                                        "rule_msg":  "PROTOCOL-ICMP Destination Unreachable Network Unreachable",
                                        "rule_category":  "misc-activity",
                                        "rule_id":  "1:401",
                                        "alert_severity":  "low",
                                        "rule_source":  "Snort registered user ruleset",
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert icmp $EXTERNAL_NET any -\u003e $HOME_NET any ( msg:\"PROTOCOL-ICMP Destination Unreachable Network Unreachable\"; icode:0; itype:3; metadata:ruleset community; classtype:misc-activity; sid:401; rev:9; )"
                                    }
                                ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "parse PE header"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query environment variable"
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using RC4 KSA"
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows"
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference startup folder"
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "parse PE header",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "parse PE header"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "link function at runtime on Windows"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "query environment variable",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "query environment variable"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using RC4 KSA",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encrypt data using RC4 KSA"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference startup folder",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "reference startup folder"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "The process attempted to dynamically load a malicious function"
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "signature_description":  "The process tried to load dynamically one or more functions."
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "signature_description":  "The process tried to collect informations about the system reading some known registry keys"
                                                 },
                                                 {
                                                     "id":  "T1012",
                                                     "signature_description":  "The process tried to collect informations about the system reading some known registry keys"
                                                 },
                                                 {
                                                     "id":  "T1050",
                                                     "signature_description":  "The process has tried to set its autorun on the system startup"
                                                 },
                                                 {
                                                     "id":  "T1112",
                                                     "signature_description":  "The process has tried to set its autorun on the system startup"
                                                 },
                                                 {
                                                     "id":  "T1060",
                                                     "signature_description":  "The process has tried to set its autorun on the system startup"
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates a start menu entry (Start Menu\\\\Programs\\\\Startup)"
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates an autostart registry key"
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Stores files to the Windows startup directory"
                                                 },
                                                 {
                                                     "id":  "T1547.001",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "Drops PE files to the startup folder (C:\\\\Documents and Settings\\\\All Users\\\\Start Menu\\\\Programs\\\\Startup)"
                                                 },
                                                 {
                                                     "id":  "T1055",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Spawns processes"
                                                 },
                                                 {
                                                     "id":  "T1036",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates files inside the user directory"
                                                 },
                                                 {
                                                     "id":  "T1497",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "May sleep (evasive loops) to hinder dynamic analysis"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Queries the cryptographic machine GUID"
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Reads software policies"
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Posts data to webserver"
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Posts data to webserver"
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Some HTTP requests failed (404). It is likely the sample will exhibit less behavior"
                                                 }
                                             ],
                 "registry_keys_opened":  [
                                              "HKLM\\SOFTWARE\\Microsoft\\Cryptography",
                                              "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                                              "HKEY_CURRENT_USER\\Software\\Microsoft\\windows\\CurrentVersion\\Internet Settings\\Connections",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole",
                                              "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sihost.exe.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\software.exe",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLE",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLEAUT",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WinHttp",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Policies\\Microsoft\\WindowsStore",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Lsa\\SspiCache\\credssp.dll",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{3882a85b-858a-11eb-b9e1-806e6f6e6963}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\136875EC",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\34FF3DD3",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\37CAA466",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\00000014",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries\\000000000001",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries\\000000000002",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries\\000000000003",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries\\000000000004",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries\\000000000005",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries\\000000000006",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\00000007",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000001",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000002",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000003",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000004",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000005",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000006",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000007",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000008",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000009",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000010",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000011",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000012",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries\\000000000013",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Winsock\\Setup Migration\\Providers\\Tcpip",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Winsock\\Setup Migration\\Providers\\Tcpip6",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Dnscache\\Parameters\\dnscache",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Interfaces\\{3882A85B-858A-11EB-B9E1-806E6F6E6963}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{3882A85B-858A-11EB-B9E1-806E6F6E6963}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{92904508-F335-4574-A127-534547B20089}",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WinHttpAutoProxySvc\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Setup Migration\\Providers",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\PeerDist\\Service",
                                              "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
                                              "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\PeerDist\\Service",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\OLE\\Tracing",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\windows\\CurrentVersion\\Internet Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows NT\\Rpc",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Display",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                                              "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\System",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Hvsi",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\SspiCache",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Ids",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SQMServiceList",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders\\SaslProfiles",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Terminal Server",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\WinSock2\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Winsock2\\Parameters",
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\afunix\\Parameters\\Winsock",
                                              "HKEY_LOCAL_MACHINE\\System\\Setup",
                                              "\\REGISTRY\\USER",
                                              "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\executable.exe",
                                              "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\WinSock2\\Parameters\\AppId_Catalog\\14685EAE"
                                          ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "calculate modulo 256 via x86 assembly",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delay execution",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@ramen0x3f"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "allocate RW memory",
                                               "authors":  [
                                                               "0x534a@mailbox.org"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: allocate RW memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x4 = PAGE_READWRITE\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "parse PE header",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Windows",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "validate payment card number using luhn algorithm with no lookup table",
                                               "authors":  [
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: validate payment card number using luhn algorithm with no lookup table\n    authors:\n      - \"@_re_fox\"\n    lib: true\n    scope: function\n    mbc:\n      - Data::Checksum::Luhn [C0032.002]\n    examples:\n      - 6fcc13563aad936c7d0f3165351cb453:0x4026C0\n  features:\n    - and:\n      - characteristic: loop\n        description: Iterate over CC digits\n      - or:\n        - basic block:\n          - and:\n            # 6fcc13563aad936c7d0f3165351cb453:402842\n            - or:\n              - instruction:\n                - mnemonic: shl\n                - number: 0x1\n              - instruction:\n                - mnemonic: imul\n                - number: 0x2\n              - mnemonic: add = add al, al\n            - instruction:\n              - mnemonic: cmp\n              - number: 0x9\n            - description: Digital Root check number*2 \u003c 0x9\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x9\n            - description: Compare number to 0x9 for Digital Root\n          - basic block:\n            - or:\n              - instruction:\n                - mnemonic: imul\n                - number: 0x2\n              - instruction:\n                - mnemonic: shl\n                - number: 0x1\n              - mnemonic: add = add al, al\n              - description: 2*Number for Digital Root\n      - or:\n        - instruction:\n          # 6fcc13563aad936c7d0f3165351cb453:0x402820\n          - mnemonic: sub\n          - number: 0x30\n          - description: Conversion of chr to int (SUB 0x30)\n        - instruction:\n          - offset: -0x30\n          - mnemonic: lea\n          - description: Conversion of chr to int (LEA REG,[REG+ -0x30])\n      - basic block:\n        - or:\n          - and:\n            # 6fcc13563aad936c7d0f3165351cb453:0x402857\n            - or:\n              - mnemonic: div\n              - and:\n                - mnemonic: idiv\n                - mnemonic: cdq\n            - number: 0xa\n            - optional:\n              - mnemonic: neg\n            - description: Final section returning checkum % 10\n          - and:\n            - mnemonic: shr\n            - mnemonic: imul\n            - number: 0x66666667\n            - number: 0x1f\n            - number: 0x2\n            - optional:\n              - mnemonic: neg\n            - description: Compiler optimized returning checkum % 10\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "validate payment card number using luhn algorithm",
                                               "description":  "data-manipulation/checksum/luhn",
                                               "authors":  [
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: validate payment card number using luhn algorithm\n    namespace: data-manipulation/checksum/luhn\n    authors:\n      - \"@_re_fox\"\n    scope: function\n    mbc:\n      - Data::Checksum::Luhn [C0032.002]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x401920\n      - 6fcc13563aad936c7d0f3165351cb453:0x4026C0\n  features:\n    - or:\n      - match: validate payment card number using luhn algorithm with no lookup table\n      - match: validate payment card number using luhn algorithm with lookup table\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "query environment variable",
                                               "description":  "host-interaction/environment-variable",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@_re_fox"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "hash data with CRC32",
                                               "description":  "data-manipulation/checksum/crc32",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: hash data with CRC32\n    namespace: data-manipulation/checksum/crc32\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Data::Checksum::CRC32 [C0032.001]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403CBD\n      - 7D28CB106CB54876B2A5C111724A07CD:0x402350  # RtlComputeCrc32\n      - 7EFF498DE13CC734262F87E6B3EF38AB:0x100084A6\n  features:\n    - or:\n      - and:\n        - number: 1 = bits in a byte\n        - instruction:\n          - description: is bit set?\n          - or:\n            - mnemonic: and\n            - mnemonic: test\n          - operand[1].number: 1\n        - instruction:\n          - mnemonic: shr\n          - number: 1\n        - characteristic: nzxor\n        - operand[1].number: 0xEDB88320\n      - and:\n        - number: 0x8320\n        - number: 0xEDB8\n        - characteristic: nzxor\n      - api: RtlComputeCrc32\n      - bytes: 00 00 00 00 96 30 07 77 2C 61 0E EE BA 51 09 99 19 C4 6D 07 8F F4 6A 70 35 A5 63 E9 A3 95 64 9E = crc32_tab\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get thread local storage value",
                                               "description":  "host-interaction/process",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get thread local storage value\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n  features:\n    - and:\n      - api: kernel32.TlsGetValue\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using RC4 KSA",
                                               "description":  "data-manipulation/encryption/rc4",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using RC4 KSA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Encryption Key::RC4 KSA [C0028.002]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403D40\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404950\n      - 2B8BEC5BCB1777EAA155D832F7AFC797:0x405C42\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x40646E\n  features:\n    - or:\n      - and:\n        - basic block:\n          - and:\n            - description: initialize S\n            # misses if regular loop is used,\n            # however we cannot model that a loop contains a certain number\n            - characteristic: tight loop\n            - or:\n              - number: 0xFF\n              - number: 0x100\n        - or:\n          - description: modulo 256\n          - match: calculate modulo 256 via x86 assembly\n          - basic block:\n            - and:\n              - description: modulo via zero-extended mov from 8-bit register\n              - count(mnemonic(movzx)): 2 or more\n              # avoid false positives; filter out unexpected instructions\n              - not:\n                - or:\n                  - mnemonic: shl\n                  - mnemonic: rol\n                  - characteristic: nzxor\n        - or:\n          - description: modulo key length\n          - mnemonic: div\n          - mnemonic: idiv\n      - and:\n        - description: write DWORDs instead of bytes\n        - or:\n          - number: 0x03020100\n          - number: 0xFFFEFDFC\n        - instruction:\n          - or:\n            - mnemonic: add\n            - mnemonic: sub\n          - number: 0x04040404\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain a thread local storage (.tls) section",
                                               "description":  "executable/pe/section/tls",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain a thread local storage (.tls) section\n    namespace: executable/pe/section/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    examples:\n      - Practical Malware Analysis Lab 16-02.exe_\n  features:\n    - section: .tls\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain a resource (.rsrc) section",
                                               "description":  "executable/pe/section/rsrc",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "compiled with Nim",
                                               "description":  "compiler/nim",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: compiled with Nim\n    namespace: compiler/nim\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    examples:\n      - 580c37831fe98a254eb6c61c692c70d8.exe_\n  features:\n    - or:\n      - substring: \"NimMain\"\n      - substring: \"NimMainModule\"\n      - substring: \"NimMainInner\"\n      - substring: \"io.nim\"\n      - substring: \"fatal.nim\"\n      - substring: \"system.nim\"\n      - substring: \"alloc.nim\"\n      - substring: \"osalloc.nim\"\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference startup folder",
                                               "description":  "persistence/startup-folder",
                                               "authors":  [
                                                               "matthew.williams@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference startup folder\n    namespace: persistence/startup-folder\n    authors:\n      - matthew.williams@mandiant.com\n    scope: file\n    att\u0026ck:\n      - Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]\n  features:\n    - or:\n      - string: /Start Menu\\\\Programs\\\\Startup/i\n"
                                           }
                                       ],
                 "files_opened":  [
                                      "C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                      "C:\\Users\\Administrator\\AppData\\Roaming\\sihost.exe.exe",
                                      "C:\\Windows\\system32\\winhttp.DLL",
                                      "C:\\Windows\\system32\\webio.dll",
                                      "C:\\Users\\\u003cUSER\u003e\\Downloads\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\sihost.exe.exe",
                                      "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                      "C:\\Windows\\syswow64\\en-US\\KERNELBASE.dll.mui",
                                      "C:\\Windows\\system32\\cryptsp.dll",
                                      "C:\\Windows\\system32\\credssp.dll",
                                      "\\Sessions\\1\\BaseNamedObjects",
                                      "C:\\Windows\\system32",
                                      "C:\\Users\\user\\AppData\\Local\\Temp\\8533f79f09cedb723ac3a77df1712f50.exe",
                                      "C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe",
                                      "C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                      "C:\\Users\\user\\AppData\\Roaming\\",
                                      "C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\",
                                      "C:\\Users\\user\\Desktop\\software.exe",
                                      "C:\\Users\\user\\Desktop\\software.exe:Zone.Identifier",
                                      "C:\\Users\\user\\Desktop\\software.exe\\:Zone.Identifier:$DATA",
                                      "C:\\Windows\\AppPatch\\sysmain.sdb",
                                      "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                                      "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
                                      "C:\\Windows\\SysWOW64\\FLTLIB.DLL",
                                      "C:\\Windows\\SysWOW64\\GDI32.dll",
                                      "C:\\Windows\\SysWOW64\\IMM32.DLL",
                                      "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                                      "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                                      "C:\\Windows\\SysWOW64\\NSI.dll",
                                      "C:\\Windows\\SysWOW64\\OnDemandConnRouteHelper.dll",
                                      "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                                      "C:\\Windows\\SysWOW64\\SspiCli.dll",
                                      "C:\\Windows\\SysWOW64\\USER32.dll",
                                      "C:\\Windows\\SysWOW64\\USERENV.dll",
                                      "C:\\Windows\\SysWOW64\\WINNSI.DLL",
                                      "C:\\Windows\\SysWOW64\\Ws2_32.dll",
                                      "C:\\Windows\\SysWOW64\\advapi32.dll",
                                      "C:\\Windows\\SysWOW64\\amsi.DLL",
                                      "C:\\Windows\\SysWOW64\\apphelp.dll",
                                      "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                                      "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                                      "C:\\Windows\\SysWOW64\\combase.dll",
                                      "C:\\Windows\\SysWOW64\\cryptsp.dll",
                                      "C:\\Windows\\SysWOW64\\dhcpcsvc.DLL",
                                      "C:\\Windows\\SysWOW64\\dhcpcsvc6.DLL",
                                      "C:\\Windows\\SysWOW64\\en-US\\KERNELBASE.dll.mui",
                                      "C:\\Windows\\SysWOW64\\en-US\\mswsock.dll.mui",
                                      "C:\\Windows\\SysWOW64\\en-US\\winnlsres.dll.mui",
                                      "C:\\Windows\\SysWOW64\\en-US\\wshqos.dll.mui",
                                      "C:\\Windows\\SysWOW64\\gdi32full.dll",
                                      "C:\\Windows\\SysWOW64\\kernel.appcore.dll",
                                      "C:\\Windows\\SysWOW64\\msvcp_win.dll",
                                      "C:\\Windows\\SysWOW64\\msvcrt.dll",
                                      "C:\\Windows\\SysWOW64\\mswsock.dll",
                                      "C:\\Windows\\SysWOW64\\ntdll.dll",
                                      "C:\\Windows\\SysWOW64\\ntmarta.dll",
                                      "C:\\Windows\\SysWOW64\\ole32.DLL",
                                      "C:\\Windows\\SysWOW64\\oleaut32.DLL",
                                      "C:\\Windows\\SysWOW64\\oleaut32.dll",
                                      "C:\\Windows\\SysWOW64\\powrprof.dll",
                                      "C:\\Windows\\SysWOW64\\profapi.dll",
                                      "C:\\Windows\\SysWOW64\\sechost.dll",
                                      "C:\\Windows\\SysWOW64\\shcore.dll",
                                      "C:\\Windows\\SysWOW64\\shell32.DLL",
                                      "C:\\Windows\\SysWOW64\\shlwapi.dll",
                                      "C:\\Windows\\SysWOW64\\ucrtbase.dll",
                                      "C:\\Windows\\SysWOW64\\webio.dll",
                                      "C:\\Windows\\SysWOW64\\win32u.dll",
                                      "C:\\Windows\\SysWOW64\\windows.storage.dll",
                                      "C:\\Windows\\SysWOW64\\winhttp.DLL",
                                      "C:\\Windows\\SysWOW64\\winnlsres.dll",
                                      "C:\\Windows\\SysWOW64\\wshqos.dll",
                                      "Nsi",
                                      "\\DEVICE\\NETBT_TCPIP_{3882A85B-858A-11EB-B9E1-806E6F6E6963}",
                                      "\\DEVICE\\NETBT_TCPIP_{92904508-F335-4574-A127-534547B20089}",
                                      "\\Device\\Afd\\Endpoint",
                                      "C:\\Users\\user\\Desktop\\executable.exe",
                                      "C:\\Users\\user\\Desktop\\executable.exe:Zone.Identifier",
                                      "C:\\Users\\user\\Desktop\\executable.exe\\:Zone.Identifier:$DATA"
                                  ],
                 "calls_highlighted":  [
                                           "Sleep",
                                           "GetTickCount",
                                           "kernel32.CreatePipe",
                                           "kernel32.SetFileAttributesW",
                                           "winhttp.WinHttpConnect",
                                           "winhttp.WinHttpSendRequest",
                                           "advapi32.RegOpenKeyExW"
                                       ],
                 "modules_loaded":  [
                                        "%SAMPLEPATH%\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe",
                                        "ws2_32.dll",
                                        "kernel32",
                                        "winhttp",
                                        "ole32",
                                        "oleaut32",
                                        "user32",
                                        "shell32",
                                        "advapi32.dll",
                                        "SHLWAPI.dll",
                                        "ADVAPI32.dll",
                                        "WS2_32.dll",
                                        "SspiCli.dll",
                                        "RPCRT4.dll",
                                        "ADVAPI32",
                                        "User32",
                                        "credssp",
                                        "cryptsp",
                                        "Advapi32",
                                        "ntdll",
                                        "amsi",
                                        "WS2_32",
                                        "RPCRT4",
                                        "rpcrt4",
                                        "Ws2_32",
                                        "SspiCli",
                                        "SHLWAPI"
                                    ],
                 "processes_injected":  [
                                            "%SAMPLEPATH%\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe",
                                            "\\\\?\\C:\\Windows\\system32\\wbem\\WMIADAP.EXE"
                                        ],
                 "files_copied":  [
                                      {
                                          "source":  "C:\\analyse\\1665912868.1027877_62b07306-9e83-4a90-bd8a-1acf097518e8",
                                          "destination":  "C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe"
                                      },
                                      {
                                          "source":  "C:\\analyse\\1665912868.1027877_62b07306-9e83-4a90-bd8a-1acf097518e8",
                                          "destination":  "C:\\Users\\Administrator\\AppData\\Roaming\\sihost.exe.exe"
                                      },
                                      {
                                          "source":  "C:\\Users\\\u003cUSER\u003e\\Downloads\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe",
                                          "destination":  "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\sihost.exe.exe"
                                      },
                                      {
                                          "source":  "C:\\Users\\\u003cUSER\u003e\\Downloads\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe",
                                          "destination":  "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe"
                                      }
                                  ],
                 "files_written":  [
                                       "C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                       "C:\\Users\\Administrator\\AppData\\Roaming\\sihost.exe.exe",
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\sihost.exe.exe",
                                       "C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                       "\\Sessions\\1\\BaseNamedObjects",
                                       "C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe",
                                       "C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                       "C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe:Zone.Identifier",
                                       "C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe\\:Zone.Identifier:$DATA",
                                       "C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe:Zone.Identifier",
                                       "C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe\\:Zone.Identifier:$DATA"
                                   ],
                 "verdicts":  [
                                  "UNKNOWN_VERDICT",
                                  "MALWARE"
                              ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "20.99.184.37",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.216.147.76",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.168.0.27",
                                        "destination_port":  137,
                                        "transport_layer_protocol":  "UDP"
                                    },
                                    {
                                        "destination_ip":  "45.155.165.151",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "23.216.147.64",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "20.99.133.109",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "192.229.211.108",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "files_deleted":  [
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER22F4.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2305.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER23C0.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER23BF.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2401.tmp.txt",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2400.tmp.txt",
                                       "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF760.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF82B.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF84B.tmp.txt",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER16EE.tmp.WERInternalMetadata.xml",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER16FF.tmp.csv",
                                       "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1710.tmp.txt"
                                   ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe",
                                           "C:\\Windows\\System32\\wuapihost.exe",
                                           "29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21-2022-11-10-07-02-12.exe",
                                           "DeviceDisplayObjectProvider.exe -Embedding",
                                           "sihost.exe.exe",
                                           "Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                           "DiagTrackRunner.exe /UploadEtlFilesOnly",
                                           "sc.exe start w32time task_started"
                                       ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\3C0000000004AE\\661"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\_IndexName_"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\LruList\\0000000000002B69\\ObjectLru"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\LruList\\0000000000002B69\\ObjectId"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\Indexes\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\3C0000000004AE"
                                           },
                                           {
                                               "key":  "HKLM\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"%APPDATA%\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\LruList\\CurrentLru"
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"%APPDATA%\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\_CurrentObjectId_"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\_FileId_"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\_ObjectLru_"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\_Usn_"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\_ObjectId_"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\AeFileID"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\_UsnJournalId_"
                                           },
                                           {
                                               "key":  "\\\\REGISTRY\\A\\{047d2853-30d1-11ec-a263-167c9a143b3e}\\DefaultObjectStore\\ObjectTable\\661\\AeProgramID"
                                           },
                                           {
                                               "key":  "HKU\\%SID%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"%USERPROFILE%\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"%USERPROFILE%\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"%USERPROFILE%\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKEY_USERS\\%SID%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"%USERPROFILE%\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\Administrator\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\Administrator\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\Administrator\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-556235188-3083858380-1854236872-500\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\Administrator\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-4270068108-2931534202-3907561125-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\\u003cUSER\u003e\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKU\\S-1-5-21-4270068108-2931534202-3907561125-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.exe\\OpenWithProgids\\exefile",
                                               "value":  "Binary Data"
                                           },
                                           {
                                               "key":  "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe\""
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe",
                                               "value":  "\"C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe\""
                                           }
                                       ],
                 "files_dropped":  [
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\sihost.exe.exe"
                                       },
                                       {
                                           "path":  "%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER22F4.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER22F4.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2305.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2305.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER23BF.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER23C0.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER23BF.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER23C0.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2400.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2400.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2401.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER2401.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF760.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF760.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF82B.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF82B.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF84B.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WERF84B.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER16EE.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER16EE.tmp.WERInternalMetadata.xml"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER16FF.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER16FF.tmp.csv"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1710.tmp"
                                       },
                                       {
                                           "path":  "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1710.tmp.txt"
                                       },
                                       {
                                           "path":  "C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe",
                                           "sha256":  "29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21",
                                           "type":  "PE_EXE"
                                       },
                                       {
                                           "path":  "C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe:Zone.Identifier",
                                           "sha256":  "255a65d30841ab4082bd9d0eea79d49c5ee88f56136157d8d6156aef11c12309",
                                           "type":  "TEXT"
                                       },
                                       {
                                           "path":  "C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe",
                                           "sha256":  "29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21",
                                           "type":  "PE_EXE"
                                       },
                                       {
                                           "path":  "C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe:Zone.Identifier",
                                           "sha256":  "255a65d30841ab4082bd9d0eea79d49c5ee88f56136157d8d6156aef11c12309",
                                           "type":  "TEXT"
                                       }
                                   ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "T1060,RunKey",
                                                                                             "UtcTime":  "1665890913",
                                                                                             "Details":  "\"C:\\Users\\george\\AppData\\Roaming\\sihost.exe.exe\"",
                                                                                             "ProcessGuid":  "{C784477D-7A5D-634B-DF0A-000000004700}",
                                                                                             "EventID":  "13",
                                                                                             "ProcessId":  "7008",
                                                                                             "Image":  "C:\\Users\\george\\Desktop\\software.exe",
                                                                                             "EventType":  "SetValue",
                                                                                             "TargetObject":  "HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\sihost.exe"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "medium",
                                                    "rule_id":  "18842e32896dd83b8aca4d5e1ac78c1f66b1d252479c0023cdd02f108c42c8cd",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Wow6432Node CurrentVersion Autorun Keys Modification",
                                                    "rule_description":  "Detects modification of autostart extensibility point (ASEP) in registry.",
                                                    "rule_author":  "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "EXE",
                                                                                             "CreationUtcTime":  "1665890912",
                                                                                             "UtcTime":  "1665890912",
                                                                                             "EventID":  "11",
                                                                                             "ProcessGuid":  "{C784477D-7A5D-634B-DF0A-000000004700}",
                                                                                             "ProcessId":  "7008",
                                                                                             "Image":  "C:\\Users\\george\\Desktop\\software.exe",
                                                                                             "TargetFilename":  "C:\\Users\\george\\AppData\\Roaming\\sihost.exe.exe"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "RuleName":  "T1023",
                                                                                             "CreationUtcTime":  "1665890912",
                                                                                             "UtcTime":  "1665890912",
                                                                                             "EventID":  "11",
                                                                                             "ProcessGuid":  "{C784477D-7A5D-634B-DF0A-000000004700}",
                                                                                             "ProcessId":  "7008",
                                                                                             "Image":  "C:\\Users\\george\\Desktop\\software.exe",
                                                                                             "TargetFilename":  "C:\\Users\\george\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "low",
                                                    "rule_id":  "b5386a23355681c43cfbd2f2ccfe4b16ed45324d0d7b5583487a9f302ee1e427",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Creation of an Executable by an Executable",
                                                    "rule_description":  "Detects the creation of an executable by another executable",
                                                    "rule_author":  "frack113"
                                                }
                                            ],
                 "processes_terminated":  [
                                              "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                              "wmiadap.exe /F /T /R",
                                              "explorer.exe \"%APPDATA%\\sihost.exe.exe\"",
                                              "%windir%\\explorer.exe /factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b} -Embedding",
                                              "C:\\Windows\\System32\\wuapihost.exe"
                                          ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2228",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                                        },
                                        {
                                            "process_id":  "2088",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "2656",
                                            "name":  "%SAMPLEPATH%"
                                        },
                                        {
                                            "process_id":  "1540",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2844",
                                            "name":  "\"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe\""
                                        },
                                        {
                                            "process_id":  "2832",
                                            "name":  "explorer.exe \"%APPDATA%\\sihost.exe.exe\""
                                        },
                                        {
                                            "process_id":  "2872",
                                            "name":  "%windir%\\explorer.exe /factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b} -Embedding",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2908",
                                                                 "name":  "\"%APPDATA%\\sihost.exe.exe\" "
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2908",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3680",
                                                                 "name":  "%SAMPLEPATH%\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "620",
                                            "name":  "C:\\Windows\\System32\\svchost.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3184",
                                                                 "name":  "C:\\Windows\\System32\\wuapihost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2292"
                                        },
                                        {
                                            "process_id":  "3024",
                                            "time_offset":  9
                                        },
                                        {
                                            "process_id":  "1248",
                                            "time_offset":  9
                                        },
                                        {
                                            "process_id":  "1152",
                                            "time_offset":  99
                                        },
                                        {
                                            "process_id":  "2780",
                                            "time_offset":  99
                                        },
                                        {
                                            "process_id":  "2708",
                                            "time_offset":  107
                                        },
                                        {
                                            "process_id":  "2588",
                                            "name":  "4641c28221cbb14fc1a7730ac1112691.exe",
                                            "time_offset":  5738
                                        },
                                        {
                                            "process_id":  "7008",
                                            "name":  "\"C:\\Users\\user\\Desktop\\software.exe\" "
                                        },
                                        {
                                            "process_id":  "5588",
                                            "name":  "\"C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe\" "
                                        },
                                        {
                                            "process_id":  "7016",
                                            "name":  "\"C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe\" "
                                        },
                                        {
                                            "process_id":  "3092",
                                            "name":  "\"C:\\Users\\user\\AppData\\Roaming\\sihost.exe.exe\" "
                                        },
                                        {
                                            "process_id":  "4124",
                                            "name":  "\"C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\sihost.exe.exe\" "
                                        }
                                    ],
                 "command_executions":  [
                                            "\"%SAMPLEPATH%\\29c7d7d36a0c8acec88ff7aa34adc0f9240270a85e330fd2336408e1f0d52c21.exe\" ",
                                            "C:\\Windows\\System32\\wuapihost.exe -Embedding",
                                            " "
                                        ],
                 "tags":  [
                              "DIRECT_CPU_CLOCK_ACCESS",
                              "LONG_SLEEPS",
                              "RUNTIME_MODULES",
                              "PERSISTENCE",
                              "DETECT_DEBUG_ENVIRONMENT"
                          ],
                 "attack_techniques":  {
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "parse PE header",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "parse PE header"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "link function at runtime on Windows"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process attempted to dynamically load a malicious function"
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process tried to load dynamically one or more functions."
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "query environment variable",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "query environment variable"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process tried to collect informations about the system reading some known registry keys"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Queries the cryptographic machine GUID"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Reads software policies"
                                                         }
                                                     ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using RC4 KSA",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encrypt data using RC4 KSA"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1547.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "reference startup folder",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "reference startup folder"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Creates a start menu entry (Start Menu\\\\Programs\\\\Startup)"
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Creates an autostart registry key"
                                                             },
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Stores files to the Windows startup directory"
                                                             },
                                                             {
                                                                 "severity":  "LOW",
                                                                 "description":  "Drops PE files to the startup folder (C:\\\\Documents and Settings\\\\All Users\\\\Start Menu\\\\Programs\\\\Startup)"
                                                             }
                                                         ],
                                           "T1012":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process tried to collect informations about the system reading some known registry keys"
                                                         }
                                                     ],
                                           "T1050":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process has tried to set its autorun on the system startup"
                                                         }
                                                     ],
                                           "T1112":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process has tried to set its autorun on the system startup"
                                                         }
                                                     ],
                                           "T1060":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "The process has tried to set its autorun on the system startup"
                                                         }
                                                     ],
                                           "T1055":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Spawns processes"
                                                         }
                                                     ],
                                           "T1036":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Creates files inside the user directory"
                                                         }
                                                     ],
                                           "T1497":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "May sleep (evasive loops) to hinder dynamic analysis"
                                                         }
                                                     ],
                                           "T1095":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Posts data to webserver"
                                                         }
                                                     ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Posts data to webserver"
                                                         }
                                                     ],
                                           "T1105":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing http route (HTTP/1.1 404 Not Found / 503 Service Unavailable)"
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Some HTTP requests failed (404). It is likely the sample will exhibit less behavior"
                                                         }
                                                     ]
                                       }
             }
}
