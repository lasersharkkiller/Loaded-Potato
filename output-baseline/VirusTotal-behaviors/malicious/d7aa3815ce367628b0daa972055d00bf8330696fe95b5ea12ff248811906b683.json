{
    "data":  {
                 "mitre_attack_techniques":  [
                                                 {
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "contain obfuscated stackstrings"
                                                                  }
                                                              ],
                                                     "signature_description":  "contain obfuscated stackstrings",
                                                     "id":  "T1027.005",
                                                     "severity":  "IMPACT_SEVERITY_INFO"
                                                 }
                                             ],
                 "signature_matches":  [
                                           {
                                               "description":  "anti-analysis/obfuscation/string/stackstring",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n",
                                               "name":  "contain obfuscated stackstrings",
                                               "format":  "SIG_FORMAT_CAPA"
                                           },
                                           {
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                                               "name":  "contain loop",
                                               "format":  "SIG_FORMAT_CAPA"
                                           },
                                           {
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                                               "name":  "resolve function by parsing PE exports",
                                               "format":  "SIG_FORMAT_CAPA"
                                           },
                                           {
                                               "description":  "data-manipulation/hashing/md5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp"
                                                            }
                                                        ],
                                               "rule_src":  "rule:\n  meta:\n    name: hash data with MD5\n    namespace: data-manipulation/hashing/md5\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Cryptography::Cryptographic Hash::MD5 [C0029.001]\n    references:\n      - https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x100108ED\n  features:\n    - or:\n      - and:\n        - description: magic initialization constants from MD4 and MD5\n        - number: 0x67452301 = A, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0xefcdab89 = B, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x98badcfe = C, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x10325476 = D, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - not:\n          - number: 0xc3d2e1f0 = likely SHA1 but also used in RIPEMD-160 and RIPEMD-320\n        - optional:\n          - description: specific compilation from https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp\n          - and:\n            - offset: -0x28955B88\n            - offset: -0x173848AA\n      - basic block:\n        - and:\n          - number: 0x8003 = CALG_MD5\n          - api: advapi32.CryptCreateHash\n      - and:\n        - format: dotnet\n        - or:\n          - api: System.Security.Cryptography.MD5::Create\n          - api: System.Security.Cryptography.MD5CryptoServiceProvider::ctor\n        - optional:\n          - api: System.Security.Cryptography.HashAlgorithm::ComputeHash\n",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "name":  "hash data with MD5"
                                           },
                                           {
                                               "description":  "data-manipulation/compression : detects decompression function of library aPLib",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://ibsensoftware.com/files/aPLib-1.1.1.zip"
                                                            }
                                                        ],
                                               "rule_src":  "rule:\n  meta:\n    name: decompress data using aPLib\n    namespace: data-manipulation/compression\n    authors:\n      - \"@r3c0nst (Frank Boldewin)\"\n      - moritz.raabe@mandiant.com\n      - cdong49@gatech.edu\n    description: detects decompression function of library aPLib\n    scope: function\n    mbc:\n      - Data::Decompress Data::aPLib [C0025.003]\n    references:\n      - https://ibsensoftware.com/files/aPLib-1.1.1.zip\n    examples:\n      - DAA13AE302FE8B618DDBF590537443EF:0x419F50\n      - B43FCA5283BFC7022553EFF663683834:0x424\n      - 757139E76FAE876AE50DD2C3AC11D5D8:0x413074\n  features:\n    - and:\n      - description: aP_depack\n      - match: contain loop\n      - instruction:\n        - description: line 138, if (offs \u003e= 32000)\n        - mnemonic: cmp\n        - number: 32000\n      - instruction:\n        - description: line 144, if (offs \u003c 128)\n        - mnemonic: cmp\n        - or:\n          - number: 127\n          - number: 128\n      - instruction:\n        - description: line 133, offs \u003c\u003c= 8;\n        - mnemonic: shl\n        - number: 8\n      - instruction:\n        - description: line 96, offs \u003e\u003e= 1;\n        - mnemonic: shr\n        - number: 1\n      - optional:\n        - count(characteristic(calls from)): 2 or more\n          description: calls aP_getbit and aP_getgamma\n",
                                               "authors":  [
                                                               "@r3c0nst (Frank Boldewin)",
                                                               "moritz.raabe@mandiant.com",
                                                               "cdong49@gatech.edu"
                                                           ],
                                               "name":  "decompress data using aPLib"
                                           },
                                           {
                                               "description":  "executable/pe/section/tls",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain a thread local storage (.tls) section\n    namespace: executable/pe/section/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    examples:\n      - Practical Malware Analysis Lab 16-02.exe_\n  features:\n    - section: .tls\n",
                                               "name":  "contain a thread local storage (.tls) section",
                                               "format":  "SIG_FORMAT_CAPA"
                                           },
                                           {
                                               "description":  "executable/pe/section/rsrc",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n",
                                               "name":  "contain a resource (.rsrc) section",
                                               "format":  "SIG_FORMAT_CAPA"
                                           },
                                           {
                                               "description":  "executable/subfile/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n",
                                               "name":  "contain an embedded PE file",
                                               "format":  "SIG_FORMAT_CAPA"
                                           },
                                           {
                                               "description":  "compiler/delphi",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "@mr-tz"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: compiled with Borland Delphi\n    namespace: compiler/delphi\n    authors:\n      - william.ballenthin@mandiant.com\n      - \"@mr-tz\"\n    scope: file\n    examples:\n      - 4BDD67FF852C221112337FECD0681EAC\n  features:\n    - or:\n      - string: \"Borland C++ - Copyright 2002 Borland Corporation\"\n      - string: \"Sysutils::Exception\"\n      - string: \"TForm1\"\n      - import: \"BORLNDMM.DLL\"\n      - substring: \"SOFTWARE\\\\Borland\\\\Delphi\\\\RTL\"\n      - substring: \"Embarcadero Delphi for Win32 compiler\"\n",
                                               "name":  "compiled with Borland Delphi",
                                               "format":  "SIG_FORMAT_CAPA"
                                           }
                                       ],
                 "attack_techniques":  {
                                           "T1027.005":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "contain obfuscated stackstrings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "contain obfuscated stackstrings"
                                                                              }
                                                                          ]
                                                             }
                                                         ]
                                       }
             }
}
