{
    "data":  {
                 "tags":  [
                              "OBFUSCATED"
                          ],
                 "processes_terminated":  [
                                              "%SAMPLEPATH%\\6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421.exe"
                                          ],
                 "processes_injected":  [
                                            "%SAMPLEPATH%\\6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421.exe"
                                        ],
                 "files_dropped":  [
                                       {
                                           "sha256":  "7858c18da27fb386eed2191d1c70fc085ad6f91c23bf13d6dc93f8e03d674258"
                                       }
                                   ],
                 "processes_created":  [
                                           "%SAMPLEPATH%\\6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421.exe"
                                       ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "packed with VMProtect",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "packed with VMProtect"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "signature_description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "signature_description":  "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit."
                                                 },
                                                 {
                                                     "id":  "T1027.002",
                                                     "signature_description":  "Adversaries may perform software packing or virtual machine software protection to conceal their code."
                                                 }
                                             ],
                 "command_executions":  [
                                            "\"%SAMPLEPATH%\\6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421.exe\" "
                                        ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "packed with VMProtect",
                                               "description":  "anti-analysis/packer/vmprotect",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: packed with VMProtect\n    namespace: anti-analysis/packer/vmprotect\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]\n    mbc:\n      - Anti-Static Analysis::Software Packing::VMProtect [F0001.010]\n    references:\n      - https://www.pcworld.com/article/2824572/leaked-programming-manual-may-help-criminals-develop-more-atm-malware.html\n      - https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/\n    examples:\n      - 971e599e6e707349eccea2fd4c8e5f67\n  features:\n    - or:\n      - string: \"A debugger has been found running in your system.\"\n      - string: \"Please, unload it from memory and restart your program.\"\n      - string: \"File corrupted!. This program has been manipulated and maybe\"\n      - string: \"it\u0027s infected by a Virus or cracked. This file won\u0027t work anymore.\"\n      - section: .vmp0\n      - section: .vmp1\n      - section: .vmp2\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://www.pcworld.com/article/2824572/leaked-programming-manual-may-help-criminals-develop-more-atm-malware.html"
                                                            },
                                                            {
                                                                "ref":  "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "(internal) packer file limitation",
                                               "description":  "internal/limitation/static : This sample appears to be packed.\n\nPacked samples have often been obfuscated to hide their logic.\ncapa cannot handle obfuscation well using static analysis. This means the results may be misleading or incomplete.\nIf possible, you should try to unpack this input file before analyzing it with capa.\nAlternatively, run the sample in a supported sandbox and invoke capa against the report to obtain dynamic analysis results.\n",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: (internal) packer file limitation\n    namespace: internal/limitation/static\n    authors:\n      - william.ballenthin@mandiant.com\n    description: |\n      This sample appears to be packed.\n\n      Packed samples have often been obfuscated to hide their logic.\n      capa cannot handle obfuscation well using static analysis. This means the results may be misleading or incomplete.\n      If possible, you should try to unpack this input file before analyzing it with capa.\n      Alternatively, run the sample in a supported sandbox and invoke capa against the report to obtain dynamic analysis results.\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - CD2CBA9E6313E8DF2C1273593E649682\n  features:\n    - or:\n      - match: anti-analysis/packer\n"
                                           },
                                           {
                                               "id":  "network_http",
                                               "name":  "network_http",
                                               "description":  "Performs some HTTP requests",
                                               "match_data":  [
                                                                  "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBQ50otx%2Fh0Ztl%2Bz8SiPI7wEWVxDlQQUTiJUIBiV5uNu5g%2F6%2BrkS7QYXjzkCEApDqVCbATUviZV57HIIulA%3D\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "packer_unknown_pe_section_name",
                                               "name":  "packer_unknown_pe_section_name",
                                               "description":  "The binary contains an unknown PE section name indicative of packing",
                                               "match_data":  [
                                                                  "{\"unknown section\": {\"name\": \"INIT\", \"raw_address\": \"0x0000e800\", \"virtual_address\": \"0x0002a000\", \"virtual_size\": \"0x00000858\", \"size_of_data\": \"0x00000a00\", \"characteristics\": \"IMAGE_SCN_CNT_CODE|IM",
                                                                  "{\"unknown section\": {\"name\": \".vmp0\", \"raw_address\": \"0x0000f200\", \"virtual_address\": \"0x0002b000\", \"virtual_size\": \"0x002200f8\", \"size_of_data\": \"0x00220200\", \"characteristics\": \"IMAGE_SCN_CNT_CODE|I"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "packer_entropy",
                                               "name":  "packer_entropy",
                                               "description":  "The binary likely contains encrypted or compressed data",
                                               "match_data":  [
                                                                  "{\"section\": {\"name\": \".vmp0\", \"raw_address\": \"0x0000f200\", \"virtual_address\": \"0x0002b000\", \"virtual_size\": \"0x002200f8\", \"size_of_data\": \"0x00220200\", \"characteristics\": \"IMAGE_SCN_CNT_CODE|IMAGE_SCN"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "packer_vmprotect",
                                               "name":  "packer_vmprotect",
                                               "description":  "The executable is likely packed with VMProtect",
                                               "match_data":  [
                                                                  "{\"section\": {\"name\": \".vmp0\", \"raw_address\": \"0x0000f200\", \"virtual_address\": \"0x0002b000\", \"virtual_size\": \"0x002200f8\", \"size_of_data\": \"0x00220200\", \"characteristics\": \"IMAGE_SCN_CNT_CODE|IMAGE_SCN"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "binary_yara",
                                               "name":  "binary_yara",
                                               "description":  "Binary file triggered YARA rule",
                                               "match_data":  [
                                                                  "{\"Binary triggered YARA rule\": \"INDICATOR_EXE_Packed_VMProtect\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           },
                                           {
                                               "id":  "static_pe_anomaly",
                                               "name":  "static_pe_anomaly",
                                               "description":  "Anomalous binary characteristics",
                                               "match_data":  [
                                                                  "{\"anomaly\": \"Entrypoint of binary is located outside of any mapped sections\"}",
                                                                  "{\"anomaly\": \"Actual checksum does not match that reported in PE header\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           }
                                       ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "2984",
                                            "name":  "%WINDIR%\\explorer.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2824",
                                                                 "name":  "%SAMPLEPATH%\\6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421.exe"
                                                             }
                                                         ]
                                        }
                                    ],
                 "mbc":  [
                             {
                                 "id":  "F0001.010",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Software Packing",
                                 "method":  "VMProtect",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "packed with VMProtect"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0002"
                             },
                             {
                                 "id":  "OB0001"
                             },
                             {
                                 "id":  "OB0002"
                             },
                             {
                                 "id":  "OB0006"
                             },
                             {
                                 "id":  "F0001"
                             },
                             {
                                 "id":  "F0001.010"
                             }
                         ],
                 "attack_techniques":  {
                                           "T1027.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "packed with VMProtect",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "packed with VMProtect"
                                                                              }
                                                                          ]
                                                             },
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "Adversaries may perform software packing or virtual machine software protection to conceal their code."
                                                             }
                                                         ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                         }
                                                     ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit."
                                                         }
                                                     ]
                                       }
             }
}
