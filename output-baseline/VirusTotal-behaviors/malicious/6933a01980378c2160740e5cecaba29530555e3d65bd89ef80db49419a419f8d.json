{
    "data":  {
                 "files_written":  [
                                       "/dev/null",
                                       "/tmp/CCCCCCCCCC",
                                       "/var/log/auth.log.1.gz",
                                       "/var/log/kern.log.1.gz"
                                   ],
                 "text_decoded":  [
                                      "{\"C2 url\": [\"23.228.73:80\", \"static.ltdigi.com:80\"]}"
                                  ],
                 "mbc":  [
                             {
                                 "id":  "C0058",
                                 "objective":  "Data",
                                 "behavior":  "Modulo",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "calculate modulo 256 via x86 assembly"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0016",
                                 "objective":  "File System",
                                 "behavior":  "Create File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create or open file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.020",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Argument Obfuscation",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.017",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Stack Strings",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.011",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Create TCP Socket",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create TCP socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using XOR"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using XOR"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0003.003",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Dynamic Analysis Evasion",
                                 "method":  "Delayed Execution",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delay execution"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create process on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0050",
                                 "objective":  "File System",
                                 "behavior":  "Set File Attributes",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "change file permission on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0038",
                                 "objective":  "Process",
                                 "behavior":  "Create Thread",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create thread"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "read file on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1082",
                                 "objective":  "Discovery",
                                 "behavior":  "System Information Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get hostname"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.012",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Get Socket Status",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "get socket status"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0011.001",
                                 "objective":  "Communication",
                                 "behavior":  "DNS Communication",
                                 "method":  "Resolve",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "resolve DNS"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.001",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Set Socket Config",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "set socket configuration"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0027.009",
                                 "objective":  "Cryptography",
                                 "behavior":  "Encrypt Data",
                                 "method":  "RC4",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encrypt data using RC4 PRGA"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0021.004",
                                 "objective":  "Cryptography",
                                 "behavior":  "Generate Pseudo-random Sequence",
                                 "method":  "RC4 PRGA",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encrypt data using RC4 PRGA"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0046",
                                 "objective":  "File System",
                                 "behavior":  "Create Directory",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create directory"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0052",
                                 "objective":  "File System",
                                 "behavior":  "Writes File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "write file on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "enumerate files on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "enumerate files recursively"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0047",
                                 "objective":  "File System",
                                 "behavior":  "Delete File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "delete file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0023",
                                 "objective":  "Execution",
                                 "behavior":  "Install Additional Program",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "write and execute a file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.006",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0030.002",
                                 "objective":  "Command and Control",
                                 "behavior":  "C2 Communication",
                                 "method":  "Receive Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "receive data"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.007",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Send Data",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "send data on socket"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0063",
                                 "objective":  "File System",
                                 "behavior":  "Move File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "move file"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using Base64"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.001",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "Base64",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encode data using Base64"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0022.001",
                                 "objective":  "Impact",
                                 "behavior":  "Remote Access",
                                 "method":  "Reverse Shell",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "create reverse shell on Linux"
                                              }
                                          ]
                             },
                             {
                                 "id":  "OC0006"
                             },
                             {
                                 "id":  "C0005.001"
                             },
                             {
                                 "id":  "C0002"
                             },
                             {
                                 "id":  "OB0006"
                             },
                             {
                                 "id":  "F0007"
                             },
                             {
                                 "id":  "OC0001"
                             },
                             {
                                 "id":  "C0047"
                             }
                         ],
                 "processes_created":  [
                                           "sh -c /tmp/base",
                                           "/tmp/base",
                                           "(fork)",
                                           "/tmp/CCCCCCCCCC",
                                           "/bin/gzip",
                                           "/bin/sh sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/syslog",
                                           "/usr/lib/rsyslog/rsyslog-rotate",
                                           "/usr/bin/systemctl systemctl kill -s HUP rsyslog.service",
                                           "/bin/sh sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/mail.info/var/log/mail.warn/var/log/mail.err/var/log/mail.log/var/log/daemon.log/var/log/kern.log/var/log/auth.log/var/log/user.log/var/log/lpr.log/var/log/cron.log/var/log/debug/var/log/messages",
                                           "/tmp/base -",
                                           "/tmp/CCCCCCCCCC -",
                                           "/usr/libexec/xfce4-screensaver-gl-helper",
                                           "/usr/bin/python3.8 -"
                                       ],
                 "files_attribute_changed":  [
                                                 "/tmp/CCCCCCCCCC"
                                             ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "static.ltdigi.com",
                                         "resolved_ips":  [
                                                              "15.197.172.60"
                                                          ]
                                     }
                                 ],
                 "files_dropped":  [
                                       {
                                           "path":  "/tmp/CCCCCCCCCC",
                                           "sha256":  "6933a01980378c2160740e5cecaba29530555e3d65bd89ef80db49419a419f8d",
                                           "type":  "ELF",
                                           "process_name":  "/tmp/base",
                                           "process_id":  "3081"
                                       },
                                       {
                                           "path":  "/var/log/auth.log.1.gz",
                                           "sha256":  "3011c3dfaa01e8ebaec0466158e482b4b583da30296b36fd73d4c6e933f9fb34",
                                           "type":  "GZIP",
                                           "process_name":  "/bin/gzip",
                                           "process_id":  "3046"
                                       },
                                       {
                                           "path":  "/var/log/kern.log.1.gz",
                                           "sha256":  "c43122dba100ffd3b4dfdce1f7a353abcfdd364ef2257d6395a2b0bf666e9f7d",
                                           "type":  "GZIP",
                                           "process_name":  "/bin/gzip",
                                           "process_id":  "3045"
                                       }
                                   ],
                 "tags":  [
                              "SELF_DELETE",
                              "DETECT_DEBUG_ENVIRONMENT"
                          ],
                 "memory_dumps":  [
                                      {
                                          "file_name":  "3081.1.00007f277b091000.00007f277b095000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "16384",
                                          "base_address":  "139807544659968",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.00007fff5f57c000.00007fff5f57d000.r-x.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "140734792978432",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.00007f277b0ea000.00007f277b0eb000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "139807545012224",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.0000000000615000.0000000000618000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "12288",
                                          "base_address":  "6389760",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.00007f277b06e000.00007f277b072000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "16384",
                                          "base_address":  "139807544516608",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.00007fcac591d000.00007fcac5921000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "16384",
                                          "base_address":  "140508874805248",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.00007f277ae7e000.00007f277ae80000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "8192",
                                          "base_address":  "139807542476800",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.00007fcac5999000.00007fcac599a000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "140508875300864",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.00007ffcb17da000.00007ffcb17fb000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "135168",
                                          "base_address":  "140723286421504",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.0000000000615000.0000000000618000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "12288",
                                          "base_address":  "6389760",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.0000000000614000.0000000000615000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "6377472",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.0000000000400000.0000000000414000.r-x.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "81920",
                                          "base_address":  "4276224",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "refs":  [
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "287"
                                                       },
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "7037"
                                                       },
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "101889"
                                                       }
                                                   ]
                                      },
                                      {
                                          "file_name":  "3082.1.00007ffcb17ff000.00007ffcb1800000.r-x.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "140723286441984",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.00007fff5f54b000.00007fff5f56c000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "135168",
                                          "base_address":  "140734792908800",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.0000000000614000.0000000000615000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "6377472",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.0000000000400000.0000000000414000.r-x.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "81920",
                                          "base_address":  "4276224",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "refs":  [
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "287"
                                                       },
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "7037"
                                                       },
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "101889"
                                                       }
                                                   ]
                                      },
                                      {
                                          "file_name":  "3080.1.00007f277b091000.00007f277b095000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "16384",
                                          "base_address":  "139807544659968",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.0000000000615000.0000000000618000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "12288",
                                          "base_address":  "6389760",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.00007fff5f54b000.00007fff5f56c000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "135168",
                                          "base_address":  "140734792908800",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.00007f277b06e000.00007f277b072000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "16384",
                                          "base_address":  "139807544516608",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.00007f277b0a4000.00007f277b0a6000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "8192",
                                          "base_address":  "139807544729600",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.00007fcac5940000.00007fcac5944000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "16384",
                                          "base_address":  "140508874948608",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.0000000000400000.0000000000414000.r-x.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "81920",
                                          "base_address":  "4276224",
                                          "stage":  "MEM_STAGE_EXIT",
                                          "refs":  [
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "287"
                                                       },
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "7037"
                                                       },
                                                       {
                                                           "ref":  "#signature_matches",
                                                           "value":  "101889"
                                                       }
                                                   ]
                                      },
                                      {
                                          "file_name":  "3080.1.00007f277b0a4000.00007f277b0a6000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "8192",
                                          "base_address":  "139807544729600",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.00007fff5f57c000.00007fff5f57d000.r-x.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "140734792978432",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.00007fcac572d000.00007fcac572f000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "8192",
                                          "base_address":  "140508872765440",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.00007f277b0ea000.00007f277b0eb000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "139807545012224",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.00007fcac5953000.00007fcac5955000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "8192",
                                          "base_address":  "140508875018240",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3081.1.0000000001e39000.0000000001e5a000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "135168",
                                          "base_address":  "31825920",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3080.1.00007f277ae7e000.00007f277ae80000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "8192",
                                          "base_address":  "139807542476800",
                                          "stage":  "MEM_STAGE_EXIT"
                                      },
                                      {
                                          "file_name":  "3082.1.0000000000614000.0000000000615000.rw-.sdmp",
                                          "process":  "/tmp/base",
                                          "size":  "4096",
                                          "base_address":  "6377472",
                                          "stage":  "MEM_STAGE_EXIT"
                                      }
                                  ],
                 "http_conversations":  [
                                            {
                                                "url":  "http://169.254.169.254/latest/meta-data/ami-id",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Python-urllib/3.8",
                                                                        "Host":  "169.254.169.254"
                                                                    },
                                                "response_headers":  {
                                                                         "Content-Length":  "1584",
                                                                         "Content-Type":  "text/html"
                                                                     },
                                                "response_status_code":  404,
                                                "response_body_filetype":  "HTML"
                                            }
                                        ],
                 "command_executions":  [
                                            "/bin/gzip",
                                            "sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/syslog",
                                            "/usr/lib/rsyslog/rsyslog-rotate",
                                            "systemctl kill -s HUP rsyslog.service",
                                            "sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/mail.info/var/log/mail.warn/var/log/mail.err/var/log/mail.log/var/log/daemon.log/var/log/kern.log/var/log/auth.log/var/log/user.log/var/log/lpr.log/var/log/cron.log/var/log/debug/var/log/messages",
                                            "/tmp/CCCCCCCCCC",
                                            "/usr/libexec/xfce4-screensaver-gl-helper"
                                        ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "195.123.228.73",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "169.254.169.254",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "15.197.172.60",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "memory_pattern_urls":  [
                                             "23.228.73:80",
                                             "static.ltdigi.com:80"
                                         ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "1684",
                                            "name":  "sh -c /tmp/base",
                                            "children":  [
                                                             {
                                                                 "process_id":  "1685",
                                                                 "name":  "/tmp/base",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "1686",
                                                                                      "name":  "(fork)",
                                                                                      "children":  [
                                                                                                       {
                                                                                                           "process_id":  "1687",
                                                                                                           "name":  "/tmp/CCCCCCCCCC",
                                                                                                           "children":  [
                                                                                                                            "@{process_id=1688; name=(fork)}"
                                                                                                                        ]
                                                                                                       }
                                                                                                   ]
                                                                                  }
                                                                              ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3041",
                                            "name":  "/bin/gzip"
                                        },
                                        {
                                            "process_id":  "3042",
                                            "name":  "/bin/sh sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/syslog",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3043",
                                                                 "name":  "/usr/lib/rsyslog/rsyslog-rotate",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3044",
                                                                                      "name":  "/usr/bin/systemctl systemctl kill -s HUP rsyslog.service",
                                                                                      "files_opened":  [
                                                                                                           "/lib/systemd/tls/avx512_1/libc.so.6",
                                                                                                           "/lib/systemd/tls/avx512_1/x86_64/libc.so.6",
                                                                                                           "/lib/systemd/tls/haswell/avx512_1/libc.so.6",
                                                                                                           "/lib/systemd/tls/haswell/avx512_1/x86_64/libc.so.6",
                                                                                                           "/lib/systemd/tls/haswell/libc.so.6",
                                                                                                           "/lib/systemd/tls/haswell/x86_64/libc.so.6",
                                                                                                           "/proc/1/environ",
                                                                                                           "/proc/1/sched",
                                                                                                           "/proc/3044/stat",
                                                                                                           "/proc/cmdline",
                                                                                                           "/proc/filesystems",
                                                                                                           "/proc/self/stat",
                                                                                                           "/proc/sys/kernel/osrelease",
                                                                                                           "/run/systemd/container",
                                                                                                           "/sys/firmware/efi/efivars/SystemdOptions-8cf2644b-4b0b-428f-9387-6d876050dc67"
                                                                                                       ]
                                                                                  }
                                                                              ],
                                                                 "files_opened":  [
                                                                                      "/usr/lib/rsyslog/rsyslog-rotate"
                                                                                  ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3045",
                                            "name":  "/bin/gzip",
                                            "files_opened":  [
                                                                 "/var/log/kern.log.1"
                                                             ],
                                            "files_written":  [
                                                                  "/var/log/kern.log.1.gz"
                                                              ]
                                        },
                                        {
                                            "process_id":  "3046",
                                            "name":  "/bin/gzip",
                                            "files_opened":  [
                                                                 "/var/log/auth.log.1"
                                                             ],
                                            "files_written":  [
                                                                  "/var/log/auth.log.1.gz"
                                                              ]
                                        },
                                        {
                                            "process_id":  "3047",
                                            "name":  "/bin/sh sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/mail.info/var/log/mail.warn/var/log/mail.err/var/log/mail.log/var/log/daemon.log/var/log/kern.log/var/log/auth.log/var/log/user.log/var/log/lpr.log/var/log/cron.log/var/log/debug/var/log/messages",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3048",
                                                                 "name":  "/usr/lib/rsyslog/rsyslog-rotate",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3049",
                                                                                      "name":  "/usr/bin/systemctl systemctl kill -s HUP rsyslog.service",
                                                                                      "files_opened":  [
                                                                                                           "/proc/1/environ",
                                                                                                           "/proc/1/sched",
                                                                                                           "/proc/3049/stat",
                                                                                                           "/proc/cmdline",
                                                                                                           "/proc/filesystems",
                                                                                                           "/proc/self/stat",
                                                                                                           "/proc/sys/kernel/osrelease",
                                                                                                           "/run/systemd/container",
                                                                                                           "/sys/firmware/efi/efivars/SystemdOptions-8cf2644b-4b0b-428f-9387-6d876050dc67"
                                                                                                       ]
                                                                                  }
                                                                              ],
                                                                 "files_opened":  [
                                                                                      "/usr/lib/rsyslog/rsyslog-rotate"
                                                                                  ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3080",
                                            "name":  "/tmp/base",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3081",
                                                                 "name":  "/tmp/base -",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "3082",
                                                                                      "name":  "/tmp/CCCCCCCCCC",
                                                                                      "children":  [
                                                                                                       {
                                                                                                           "process_id":  "3083",
                                                                                                           "name":  "/tmp/CCCCCCCCCC -",
                                                                                                           "files_opened":  [
                                                                                                                                "/etc/host.conf",
                                                                                                                                "/etc/hosts",
                                                                                                                                "/etc/issue.net",
                                                                                                                                "/etc/resolv.conf",
                                                                                                                                "/proc/version",
                                                                                                                                "/run/systemd/resolve/stub-resolv.conf",
                                                                                                                                "/tmp/.llock",
                                                                                                                                "/usr/include/sdfwex.h",
                                                                                                                                "/usr/share/zoneinfo/Etc/UTC"
                                                                                                                            ]
                                                                                                       }
                                                                                                   ]
                                                                                  }
                                                                              ],
                                                                 "files_opened":  [
                                                                                      "/tmp/CCCCCCCCCC",
                                                                                      "/tmp/base"
                                                                                  ],
                                                                 "files_written":  [
                                                                                       "/tmp/CCCCCCCCCC"
                                                                                   ],
                                                                 "files_deleted":  [
                                                                                       "/tmp/CCCCCCCCCC"
                                                                                   ]
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3093",
                                            "name":  "/usr/libexec/xfce4-screensaver-gl-helper",
                                            "files_opened":  [
                                                                 "/etc/drirc",
                                                                 "/etc/locale.alias",
                                                                 "/home/lonestar/.Xdefaults-buffalo",
                                                                 "/home/lonestar/.drirc",
                                                                 "/proc/filesystems",
                                                                 "/run/user/1000/gdm/Xauthority",
                                                                 "/sys/devices/system/cpu",
                                                                 "/usr/lib/avx512_1/libdxcore.so",
                                                                 "/usr/lib/avx512_1/x86_64/libdxcore.so",
                                                                 "/usr/lib/haswell/avx512_1/libdxcore.so",
                                                                 "/usr/lib/haswell/avx512_1/x86_64/libdxcore.so",
                                                                 "/usr/lib/haswell/libdxcore.so",
                                                                 "/usr/lib/haswell/x86_64/libdxcore.so",
                                                                 "/usr/lib/libdxcore.so",
                                                                 "/usr/lib/tls/avx512_1/libdxcore.so",
                                                                 "/usr/lib/tls/avx512_1/x86_64/libdxcore.so",
                                                                 "/usr/lib/tls/haswell/avx512_1/libdxcore.so",
                                                                 "/usr/lib/tls/haswell/avx512_1/x86_64/libdxcore.so",
                                                                 "/usr/lib/tls/haswell/libdxcore.so",
                                                                 "/usr/lib/tls/haswell/x86_64/libdxcore.so",
                                                                 "/usr/lib/tls/libdxcore.so",
                                                                 "/usr/lib/tls/x86_64/libdxcore.so",
                                                                 "/usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache",
                                                                 "/usr/share/X11/locale/en_US.UTF-8/XLC_LOCALE",
                                                                 "/usr/share/X11/locale/locale.alias",
                                                                 "/usr/share/X11/locale/locale.dir",
                                                                 "/usr/share/drirc.d",
                                                                 "/usr/share/drirc.d/00-mesa-defaults.conf",
                                                                 "/usr/share/locale/en.UTF-8/LC_MESSAGES/xfce4-screensaver.mo",
                                                                 "/usr/share/locale/en.utf8/LC_MESSAGES/xfce4-screensaver.mo",
                                                                 "/usr/share/locale/en_US.UTF-8/LC_MESSAGES/xfce4-screensaver.mo",
                                                                 "/usr/share/locale/en_US.utf8/LC_MESSAGES/xfce4-screensaver.mo",
                                                                 "/usr/share/locale/en_US/LC_MESSAGES/xfce4-screensaver.mo",
                                                                 "/usr/share/locale/locale.alias"
                                                             ]
                                        },
                                        {
                                            "process_id":  "3096",
                                            "name":  "/usr/bin/python3.8 -"
                                        }
                                    ],
                 "files_deleted":  [
                                       "/tmp/CCCCCCCCCC"
                                   ],
                 "text_highlighted":  [
                                          ""
                                      ],
                 "verdict_confidence":  68,
                 "verdicts":  [
                                  "MALWARE",
                                  "TROJAN",
                                  "EVADER"
                              ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027.005",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "contain obfuscated stackstrings",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "contain obfuscated stackstrings"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encode data using XOR"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get hostname",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get hostname"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1016",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get networking interfaces",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get networking interfaces"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1016",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get socket status",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "get socket status"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using RC4 PRGA",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encrypt data using RC4 PRGA"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate files on Linux",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "enumerate files on Linux"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate files recursively",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "enumerate files recursively"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using Base64",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encode data using Base64"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1059.004",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "create reverse shell on Linux",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "create reverse shell on Linux"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "signature_description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                 },
                                                 {
                                                     "id":  "T1070",
                                                     "signature_description":  "Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses."
                                                 },
                                                 {
                                                     "id":  "T1070.004",
                                                     "signature_description":  "Adversaries may delete files left behind by the actions of their intrusion activity."
                                                 },
                                                 {
                                                     "id":  "T1064",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Executes commands using a shell command-line interpreter",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "2075"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1543.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Executes the \"systemctl\" command used for controlling the systemd system and service manager",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4032"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1222",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Sample tries to set the executable flag",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4023"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1564.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Creates hidden files, links and/or directories",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4044"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1070.004",
                                                     "severity":  "IMPACT_SEVERITY_LOW",
                                                     "signature_description":  "Sample deletes itself",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4019"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1518.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Uses the \"uname\" system call to query kernel version information (possible evasion)",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4049"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Downloads files from webservers via HTTP",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "127"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Performs DNS lookups",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "206"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1095",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing HTTP route (HTTP/1.1 404 Not Found / 503 Service Unavailable)",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "128"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Downloads files from webservers via HTTP",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "127"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Performs DNS lookups",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "206"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1071",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing HTTP route (HTTP/1.1 404 Not Found / 503 Service Unavailable)",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "128"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Some HTTP requests failed (404). It is likely that the sample will exhibit less behavior.",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "850"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Downloads files from webservers via HTTP",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "127"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1105",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "Tries to download or post to a non-existing HTTP route (HTTP/1.1 404 Not Found / 503 Service Unavailable)",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "128"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "verdict_labels":  [
                                        "Rekoobe"
                                    ],
                 "files_opened":  [
                                      "/dev/null",
                                      "/tmp/base",
                                      "/usr/include/sdfwex.h",
                                      "/tmp/.llock",
                                      "/etc/drirc",
                                      "/etc/host.conf",
                                      "/etc/hosts",
                                      "/etc/issue.net",
                                      "/etc/locale.alias",
                                      "/etc/resolv.conf",
                                      "/home/lonestar/.Xdefaults-buffalo",
                                      "/home/lonestar/.drirc",
                                      "/lib/systemd/tls/avx512_1/libc.so.6",
                                      "/lib/systemd/tls/avx512_1/x86_64/libc.so.6",
                                      "/lib/systemd/tls/haswell/avx512_1/libc.so.6",
                                      "/lib/systemd/tls/haswell/avx512_1/x86_64/libc.so.6",
                                      "/lib/systemd/tls/haswell/libc.so.6",
                                      "/lib/systemd/tls/haswell/x86_64/libc.so.6",
                                      "/proc/1/environ",
                                      "/proc/1/sched",
                                      "/proc/3044/stat",
                                      "/proc/3049/stat",
                                      "/proc/cmdline",
                                      "/proc/filesystems",
                                      "/proc/self/stat",
                                      "/proc/sys/kernel/osrelease",
                                      "/proc/version",
                                      "/run/systemd/container",
                                      "/run/systemd/resolve/stub-resolv.conf",
                                      "/run/user/1000/gdm/Xauthority",
                                      "/sys/devices/system/cpu",
                                      "/sys/firmware/efi/efivars/SystemdOptions-8cf2644b-4b0b-428f-9387-6d876050dc67",
                                      "/tmp/CCCCCCCCCC",
                                      "/usr/lib/avx512_1/libdxcore.so",
                                      "/usr/lib/avx512_1/x86_64/libdxcore.so",
                                      "/usr/lib/haswell/avx512_1/libdxcore.so",
                                      "/usr/lib/haswell/avx512_1/x86_64/libdxcore.so",
                                      "/usr/lib/haswell/libdxcore.so",
                                      "/usr/lib/haswell/x86_64/libdxcore.so",
                                      "/usr/lib/libdxcore.so",
                                      "/usr/lib/rsyslog/rsyslog-rotate",
                                      "/usr/lib/tls/avx512_1/libdxcore.so",
                                      "/usr/lib/tls/avx512_1/x86_64/libdxcore.so",
                                      "/usr/lib/tls/haswell/avx512_1/libdxcore.so",
                                      "/usr/lib/tls/haswell/avx512_1/x86_64/libdxcore.so",
                                      "/usr/lib/tls/haswell/libdxcore.so",
                                      "/usr/lib/tls/haswell/x86_64/libdxcore.so",
                                      "/usr/lib/tls/libdxcore.so",
                                      "/usr/lib/tls/x86_64/libdxcore.so",
                                      "/usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache",
                                      "/usr/share/X11/locale/en_US.UTF-8/XLC_LOCALE",
                                      "/usr/share/X11/locale/locale.alias",
                                      "/usr/share/X11/locale/locale.dir",
                                      "/usr/share/drirc.d",
                                      "/usr/share/drirc.d/00-mesa-defaults.conf",
                                      "/usr/share/locale/en.UTF-8/LC_MESSAGES/xfce4-screensaver.mo",
                                      "/usr/share/locale/en.utf8/LC_MESSAGES/xfce4-screensaver.mo",
                                      "/usr/share/locale/en_US.UTF-8/LC_MESSAGES/xfce4-screensaver.mo",
                                      "/usr/share/locale/en_US.utf8/LC_MESSAGES/xfce4-screensaver.mo",
                                      "/usr/share/locale/en_US/LC_MESSAGES/xfce4-screensaver.mo",
                                      "/usr/share/locale/locale.alias",
                                      "/usr/share/zoneinfo/Etc/UTC",
                                      "/var/log/auth.log.1",
                                      "/var/log/kern.log.1"
                                  ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "calculate modulo 256 via x86 assembly",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create or open file",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain obfuscated stackstrings",
                                               "description":  "anti-analysis/obfuscation/string/stackstring",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create TCP socket",
                                               "description":  "communication/socket/tcp",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - and:\n        - number: 6 = IPPROTO_TCP\n        - number: 1 = SOCK_STREAM\n        - number: 2 = AF_INET\n        - or:\n          - api: socket\n          - api: ws2_32.socket\n          - api: ws2_32.#23 = socket\n          - api: ws2_32.WSASocket\n          - api: ws2_32.#82 = WSASocketA\n          - api: ws2_32.#83 = WSASocketW\n          - api: System.Net.Sockets.Socket::ctor\n      - property/read: System.Net.Sockets.TcpClient::Client\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delay execution",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "@ramen0x3f"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - or:\n          - api: sleep\n          - api: usleep\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                                                            },
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create process on Linux",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create process on Linux\n    namespace: host-interaction/process/create\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x40236D\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: execve\n        - and:\n          - match: execute syscall\n          - arch: aarch64\n          - number: 0xdd = execve\n        - api: execl\n        - api: execlp\n        - api: execle\n        - api: execv\n        - api: execvp\n        - api: execvpe\n        - api: posix_spawn\n        - api: posix_spawnp\n        - api: popen\n        - api: fork\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "change file permission on Linux",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: change file permission on Linux\n    namespace: host-interaction/file-system\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x407C68\n  features:\n    - and:\n      - or:\n        - os: android\n        - os: linux\n      - or:\n        - api: chown\n        - api: fchown\n        - api: lchown\n        - api: fchownat\n        - api: chmod\n        - api: fchmod\n        - api: fchmodat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "duplicate stdin and stdout",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: duplicate stdin and stdout\n    authors:\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x40236D\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - api: dup2\n      - number: 0 = STDIN\n      - number: 1 = STDOUT\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create thread",
                                               "description":  "host-interaction/thread/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "communicate with kernel module via Netlink socket on Linux",
                                               "description":  "host-interaction/kernel : Netlink is used to transfer information between the kernel and user-space processes (https://man7.org/linux/man-pages/man7/netlink.7.html)",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: communicate with kernel module via Netlink socket on Linux\n    namespace: host-interaction/kernel\n    authors:\n      - michael.hunhoff@mandiant.com\n    description: Netlink is used to transfer information between the kernel and user-space processes (https://man7.org/linux/man-pages/man7/netlink.7.html)\n    scopes:\n      static: basic block\n      dynamic: call\n  features:\n    - and:\n      - os: linux\n      - api: socket\n      - number: 0x10 = AF_NETLINK\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Linux",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Linux\n    namespace: host-interaction/file-system/read\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x4059AD\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - optional:\n        - match: create or open file\n      - or:\n        - api: fgetc\n        - api: fgets\n        - api: getc\n        - api: getchar\n        - api: read\n        - api: getline\n        - api: getdelim\n        - api: fgetwc\n        - api: getwc\n        - api: fscanf\n        - api: vfscanf\n        - api: fread\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get hostname",
                                               "description":  "host-interaction/os/hostname",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get networking interfaces",
                                               "description":  "host-interaction/network/interface",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get networking interfaces\n    namespace: host-interaction/network/interface\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    examples:\n      - B7841B9D5DC1F511A93CC7576672EC0C:0x1000EBF0\n  features:\n    - or:\n      - and:\n        - os: windows\n        - api: iphlpapi.GetIfTable\n        - api: iphlpapi.GetAdaptersInfo\n      - and:\n        - os: linux\n        - api: getifaddrs\n      - and:\n        - or:\n          - api: System.Net.NetworkInformation.NetworkInterface::GetIPProperties\n          - api: System.Net.NetworkInformation.NetworkInterface::GetIPStatistics\n          - api: System.Net.NetworkInformation.NetworkInterface::GetIPv4Statistics\n        - optional:\n          - api: System.Net.NetworkInformation.NetworkInterface::GetAllNetworkInterfaces\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get socket status",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: get socket status\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    mbc:\n      - Communication::Socket Communication::Get Socket Status [C0001.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.select\n      - api: ws2_32.#18 = select\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve DNS",
                                               "description":  "communication/dns",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "johnk3r",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve DNS\n    namespace: communication/dns\n    authors:\n      - william.ballenthin@mandiant.com\n      - johnk3r\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::DNS Communication::Resolve [C0011.001]\n    examples:\n      - 17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0\n  features:\n    - or:\n      - api: gethostbyname\n      - api: ws2_32.gethostbyname\n      - api: ws2_32.#52 = gethostbyname\n      - api: DnsQuery_A\n      - api: DnsQuery_W\n      - api: DnsQuery_UTF8\n      - api: DnsQueryEx\n      - api: GetAddrInfo\n      - api: ws2_32.#24 = GetAddrInfoW\n      - api: GetAddrInfoEx\n      - api: getaddrinfo\n      - api: ws2_32.#98 = getaddrinfo\n      - api: getnameinfo\n      - api: ws2_32.#99 = getnameinfo\n      - api: gethostent\n      - api: System.Net.Dns::GetHostAddresses\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set socket configuration",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: set socket configuration\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Set Socket Config [C0001.001]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.setsockopt\n      - api: ws2_32.#21 = setsockopt\n      - api: ws2_32.ioctlsocket\n      - api: ws2_32.#10 = ioctlsocket\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using RC4 PRGA",
                                               "description":  "data-manipulation/encryption/rc4",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, mnemonic, basicblock features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple or too complex (50 is picked by intuition)\n      - count(basic blocks): (4, 50)\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create directory",
                                               "description":  "host-interaction/file-system/create",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create directory\n    namespace: host-interaction/file-system/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Create Directory [C0046]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x10008f62\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.CreateDirectory\n      - api: kernel32.CreateDirectoryEx\n      - api: kernel32.CreateDirectoryTransacted\n      - api: NtCreateDirectoryObject\n      - api: ZwCreateDirectoryObject\n      - api: SHCreateDirectory\n      - api: SHCreateDirectoryEx\n      - api: mkdir\n      - api: _mkdir\n      - api: _wmkdir\n      - api: System.IO.Directory::CreateDirectory\n      - api: System.IO.DirectoryInfo::Create\n      - api: System.IO.DirectoryInfo::CreateSubdirectory\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Linux",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Linux\n    namespace: host-interaction/file-system/write\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x401E14\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: fputc\n        - api: fputs\n        - api: putc\n        - api: write\n        - api: fputwc\n        - api: putwc\n        - api: fputws\n        - api: write\n        - api: fwrite\n        - api: putwchar\n        - api: dprintf\n        - api: vdprintf\n        - api: fprintf\n        - api: vfprintf\n      - optional:\n        - match: create or open file\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate files on Linux",
                                               "description":  "host-interaction/file-system/files/list",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate files on Linux\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - and:\n          - match: create or open file\n          - or:\n            - api: getdents\n            - api: getdents64\n        - and:\n          - api: opendir\n          - api: readdir\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate files recursively",
                                               "description":  "host-interaction/file-system/files/list",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate files recursively\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - \"@_re_fox\"\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 5f66b82558ca92e54e77f216ef4c066c:0x40640E\n  features:\n    - and:\n      - or:\n        - match: enumerate files on Windows\n        - match: enumerate files on Linux\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete file",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      # static\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n      # dynamic\n      - call:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write and execute a file",
                                               "description":  "communication/c2/file-transfer",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: write and execute a file\n    namespace: communication/c2/file-transfer\n    maec/malware-category: launcher\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403A40\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n  features:\n    - and:\n      - match: host-interaction/file-system/write\n      - match: host-interaction/process/create\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data on socket",
                                               "description":  "communication/socket/receive",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: recv\n      - api: ws2_32.recv\n      - api: ws2_32.#16 = recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.#17 = recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.#71 = WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.#72 = WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.#73 = WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recvmsg\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "receive data",
                                               "description":  "communication : all known techniques for receiving data from a potential C2 server",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "send data on socket",
                                               "description":  "communication/socket/send",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: send\n      - api: ws2_32.send\n      - api: ws2_32.#19 = send\n      - api: ws2_32.sendto\n      - api: ws2_32.#20 = sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.#76 = WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: ws2_32.#78 = WSASendTo\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "move file",
                                               "description":  "host-interaction/file-system/move",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 1 = FO_MOVE\n          - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check file permission on Linux",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "mehunhoff@google.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: check file permission on Linux\n    namespace: host-interaction/file-system\n    authors:\n      - mehunhoff@google.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - and:\n      - or:\n        - os: android\n        - os: linux\n      - or:\n        - api: access\n        - api: faccessat\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using Base64",
                                               "description":  "data-manipulation/encoding/base64",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using Base64\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::Base64 [C0026.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314889C\n      - 074072B261FC27B65C72671F13510C05:0x100049B2\n      - 5DB2D2BE20D59AA0BE6709A6850F1775:0x18001CC30\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - and:\n        - mnemonic: shl\n        - mnemonic: shr\n        - number: 0x3F = modulo 64\n        - or:\n          - number: 0x3D = \u0027=\u0027\n          - number: 0x3D3D = \u0027==\u0027\n        - match: contain loop\n        - optional:\n          - number: 2\n          - number: 3\n          - number: 4\n          - number: 6\n          - number: 0xF\n          - string: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n      - api: System.Convert::ToBase64String\n      - api: System.Convert::ToBase64CharArray\n      - api: System.Convert::TryToBase64Chars\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create reverse shell on Linux",
                                               "description":  "communication/c2/shell",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: create reverse shell on Linux\n    namespace: communication/c2/shell\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att\u0026ck:\n      - Execution::Command and Scripting Interpreter::Unix Shell [T1059.004]\n    mbc:\n      - Impact::Remote Access::Reverse Shell [B0022.001]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x40231E\n  features:\n    - and:\n      - os: linux\n      - match: duplicate stdin and stdout\n      - match: host-interaction/process/create\n"
                                           },
                                           {
                                               "id":  "stealth_network",
                                               "name":  "stealth_network",
                                               "description":  "Network activity detected but not expressed in monitor API logs",
                                               "match_data":  [
                                                                  "{\"ip\": \"195.123.228.73\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "reads_files",
                                               "name":  "reads_files",
                                               "description":  "Reads files from disk",
                                               "match_data":  [
                                                                  "{\"ReadFile\": \"/lib/x86_64-linux-gnu/libc.so.6\"}",
                                                                  "{\"ReadFile\": \"/lib/x86_64-linux-gnu/libutil.so.1\"}",
                                                                  "{\"ReadFile\": \"/lib/x86_64-linux-gnu/librt.so.1\"}",
                                                                  "{\"ReadFile\": \"/lib/x86_64-linux-gnu/libpthread.so.0\"}",
                                                                  "{\"ReadFile\": \"/tmp/base\"}",
                                                                  "{\"ReadFile\": \"/etc/localtime\"}",
                                                                  "{\"ReadFile\": \"/etc/host.conf\"}",
                                                                  "{\"ReadFile\": \"/etc/resolv.conf\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "drops_files",
                                               "name":  "drops_files",
                                               "description":  "Drops files onto disk",
                                               "match_data":  [
                                                                  "{\"DroppedFile\": \"/tmp/CCCCCCCCCC\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "writes_files",
                                               "name":  "writes_files",
                                               "description":  "Writes to files on disk",
                                               "match_data":  [
                                                                  "{\"WriteFile\": \"/tmp/CCCCCCCCCC\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "deletes_files",
                                               "name":  "deletes_files",
                                               "description":  "Deletes files from disk",
                                               "match_data":  [
                                                                  "{\"DeletedFile\": \"\\\"/tmp/CCCCCCCCCC\\\"\"}",
                                                                  "{\"DeletedFile\": \"\\\"/tmp/CCCCCCCCCC\\\"\"}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_MEDIUM"
                                           },
                                           {
                                               "id":  "7037",
                                               "description":  "Malicious sample detected (through community Yara rule)",
                                               "match_data":  [
                                                                  "Linux_Trojan_Rekoobe_de9e7bdf Author: unknown"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_HIGH"
                                           },
                                           {
                                               "id":  "4117",
                                               "description":  "Contains symbols related to standard C library sleeps (sometimes used to evade sandboxing)",
                                               "match_data":  [
                                                                  "usleep"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4035",
                                               "description":  "Writes ELF files to disk",
                                               "match_data":  [
                                                                  "/tmp/CCCCCCCCCC"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4019",
                                               "description":  "Sample deletes itself",
                                               "match_data":  [
                                                                  "/tmp/CCCCCCCCCC"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_LOW"
                                           },
                                           {
                                               "id":  "7051",
                                               "description":  "Found malware configuration",
                                               "match_data":  [
                                                                  "Rekoobe {\"C2 url\": [\"23.228.73:80\", \"static.ltdigi.com:80\"]}"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_HIGH"
                                           },
                                           {
                                               "id":  "287",
                                               "description":  "Yara signature match",
                                               "match_data":  [
                                                                  "Linux_Trojan_Rekoobe_de9e7bdf reference_sample = 447da7bee72c98c2202f1919561543e54ec1b9b67bd67e639b9fb6e42172d951, os = linux, severity  = x86, creation_date = 2021-01-12, scan_context = file, memory,"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "206",
                                               "description":  "Performs DNS lookups",
                                               "match_data":  [
                                                                  "DNS query: static.ltdigi.com"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#dns_lookups",
                                                                "value":  "DNS query: static.ltdigi.com"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "715",
                                               "description":  "Classification label",
                                               "match_data":  [
                                                                  "mal68.troj.evad.lin@0/3@1/0"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4044",
                                               "description":  "Creates hidden files and/or directories",
                                               "match_data":  [
                                                                  "/tmp/.llock",
                                                                  "/home/lonestar/.Xdefaults-buffalo",
                                                                  "/home/lonestar/.drirc"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "5034",
                                               "description":  "Reads the \u0027hosts\u0027 file potentially containing internal network hosts",
                                               "match_data":  [
                                                                  "/etc/hosts"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4013",
                                               "description":  "Sample has stripped symbol table",
                                               "match_data":  [
                                                                  "no"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "850",
                                               "description":  "Some HTTP requests failed (404). It is likely that the sample will exhibit less behavior.",
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4023",
                                               "description":  "Sample tries to set the executable flag",
                                               "match_data":  [
                                                                  "/tmp/CCCCCCCCCC (bits: -v usr: wx grp: rw all: wx)"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "7021",
                                               "description":  "Connects to IPs without corresponding DNS lookups",
                                               "match_data":  [
                                                                  "195.123.228.73",
                                                                  "169.254.169.254"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4125",
                                               "description":  "Reads system version information",
                                               "match_data":  [
                                                                  "/proc/version"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "127",
                                               "description":  "Downloads files from webservers via HTTP",
                                               "match_data":  [
                                                                  "GET /latest/meta-data/ami-id HTTP/1.1Accept-Encoding: identityHost: 169.254.169.254User-Agent: Python-urllib/3.8Connection: close"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#http_conversations",
                                                                "value":  "GET /latest/meta-data/ami-id HTTP/1.1Accept-Encoding: identityHost: 169.254.169.254User-Agent: Python-urllib/3.8Connection: close"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "4049",
                                               "description":  "Uses the \"uname\" system call to query kernel version information (possible evasion)",
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "2075",
                                               "description":  "Executes commands using a shell command-line interpreter",
                                               "match_data":  [
                                                                  "sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/syslog",
                                                                  "sh -c /usr/lib/rsyslog/rsyslog-rotate logrotate_script /var/log/mail.info/var/log/mail.warn/var/log/mail.err/var/log/mail.log/var/log/daemon.log/var/log/kern.log/var/log/auth.log/var/log/user.log/var/"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "4032",
                                               "description":  "Executes the \"systemctl\" command used for controlling the systemd system and service manager",
                                               "match_data":  [
                                                                  "/usr/bin/systemctl -\u003e systemctl kill -s HUP rsyslog.service"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO"
                                           },
                                           {
                                               "id":  "128",
                                               "description":  "Tries to download or post to a non-existing HTTP route (HTTP/1.1 404 Not Found / 503 Service Unavailable / 403 Forbidden)",
                                               "match_data":  [
                                                                  "HTTP/1.1 404 Not FoundMetadata-Flavor: GoogleDate: Sat, 29 Jun 2024 12:06:01 GMTContent-Type: text/html; charset=UTF-8Server: Metadata Server for VMConnection: CloseContent-Length: 1584X-XSS-Protectio"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_INFO",
                                               "refs":  [
                                                            {
                                                                "ref":  "#http_conversations",
                                                                "value":  "HTTP/1.1 404 Not FoundMetadata-Flavor: GoogleDate: Sat, 29 Jun 2024 12:06:01 GMTContent-Type: text/html; charset=UTF-8Server: Metadata Server for VMConnection: CloseContent-Length: 1584X-XSS-Protectio"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "101889",
                                               "description":  "Yara detected Rekoobe",
                                               "match_data":  [
                                                                  "base, type: SAMPLE",
                                                                  "3082.1.0000000000400000.0000000000414000.r-x.sdmp, type: MEMORY",
                                                                  "3080.1.0000000000400000.0000000000414000.r-x.sdmp, type: MEMORY",
                                                                  "3081.1.0000000000400000.0000000000414000.r-x.sdmp, type: MEMORY",
                                                                  "/tmp/CCCCCCCCCC, type: DROPPED"
                                                              ],
                                               "severity":  "IMPACT_SEVERITY_HIGH"
                                           }
                                       ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "ET POLICY Python-urllib/ Suspicious User Agent",
                                        "rule_category":  "Attempted Information Leak",
                                        "rule_id":  "1:2013031",
                                        "alert_severity":  "medium",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "hostname":  "169.254.169.254",
                                                              "url":  "http://169.254.169.254/latest/meta-data/ami-id"
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_references":  [
                                                                "https://www.useragentstring.com/pages/useragentstring.php"
                                                            ],
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET any (msg:\"ET POLICY Python-urllib/ Suspicious User Agent\"; flow:established,to_server; http.user_agent; content:\"Python-urllib/\"; nocase; depth:14; http.host; content:!\"dropbox.com\"; endswith; content:!\"downloads.ironport.com\"; endswith; content:!\".ubuntu.com\"; endswith; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:2013031; rev:9; metadata:created_at 2011_06_14, updated_at 2020_09_17;)"
                                    },
                                    {
                                        "rule_msg":  "TGI HUNT Python User-Agent to Bare IP Address",
                                        "rule_category":  "Potentially Bad Traffic",
                                        "rule_id":  "1:2610810",
                                        "alert_severity":  "low",
                                        "rule_source":  "Travis Green: Threat hunting rules",
                                        "alert_context":  {
                                                              "hostname":  "169.254.169.254",
                                                              "url":  "http://169.254.169.254/latest/meta-data/ami-id"
                                                          },
                                        "rule_url":  "https://raw.githubusercontent.com/travisbgreen/hunting-rules/master/hunting.rules",
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET any (msg:\"TGI HUNT Python User-Agent to Bare IP Address\"; flow:established,to_server; http.user_agent; content:\"Python\"; nocase; fast_pattern; http.host; pcre:\"/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/\"; classtype:bad-unknown; sid:2610810; rev:1;)"
                                    }
                                ],
                 "attack_techniques":  {
                                           "T1027.005":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "contain obfuscated stackstrings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "contain obfuscated stackstrings"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encode data using XOR"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using RC4 PRGA",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encrypt data using RC4 PRGA"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using Base64",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encode data using Base64"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get hostname",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get hostname"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1016":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get networking interfaces",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get networking interfaces"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get socket status",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "get socket status"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate files on Linux",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "enumerate files on Linux"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate files recursively",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "enumerate files recursively"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1059.004":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "create reverse shell on Linux",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "create reverse shell on Linux"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1071":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Downloads files from webservers via HTTP",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "127"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Performs DNS lookups",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "206"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing HTTP route (HTTP/1.1 404 Not Found / 503 Service Unavailable)",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "128"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1070":  [
                                                         {
                                                             "severity":  "UNKNOWN",
                                                             "description":  "Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses."
                                                         }
                                                     ],
                                           "T1070.004":  [
                                                             {
                                                                 "severity":  "UNKNOWN",
                                                                 "description":  "Adversaries may delete files left behind by the actions of their intrusion activity."
                                                             },
                                                             {
                                                                 "severity":  "LOW",
                                                                 "description":  "Sample deletes itself",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "4019"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1064":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Executes commands using a shell command-line interpreter",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "2075"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1543.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Executes the \"systemctl\" command used for controlling the systemd system and service manager",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "4032"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1222":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Sample tries to set the executable flag",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "4023"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1564.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Creates hidden files, links and/or directories",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "4044"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1518.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "Uses the \"uname\" system call to query kernel version information (possible evasion)",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "4049"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1095":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Downloads files from webservers via HTTP",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "127"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Performs DNS lookups",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "206"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing HTTP route (HTTP/1.1 404 Not Found / 503 Service Unavailable)",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "128"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1105":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Some HTTP requests failed (404). It is likely that the sample will exhibit less behavior.",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "850"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Downloads files from webservers via HTTP",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "127"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "Tries to download or post to a non-existing HTTP route (HTTP/1.1 404 Not Found / 503 Service Unavailable)",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "128"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
