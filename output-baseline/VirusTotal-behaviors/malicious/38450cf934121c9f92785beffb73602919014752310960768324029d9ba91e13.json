{
    "data":  {
                 "processes_tree":  [
                                        {
                                            "process_id":  "2728",
                                            "name":  "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2756",
                                                                 "name":  "%windir%\\system32\\WerFault.exe -u -p 2676 -s 320"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3024",
                                            "name":  "wmiadap.exe /F /T /R"
                                        },
                                        {
                                            "process_id":  "3060",
                                            "name":  "%windir%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "2584",
                                            "name":  "%SANDBOX_DLL_LOADER_AMD64% %SAMPLEPATH% %WORKDIR% 483",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2668",
                                                                 "name":  "rundll32.exe %SAMPLEPATH%,run"
                                                             },
                                                             {
                                                                 "process_id":  "2660",
                                                                 "name":  "rundll32.exe %SAMPLEPATH%,follower"
                                                             },
                                                             {
                                                                 "process_id":  "2676",
                                                                 "name":  "rundll32.exe %SAMPLEPATH%,scub",
                                                                 "children":  [
                                                                                  {
                                                                                      "process_id":  "2716",
                                                                                      "name":  "rundll32.exe \"%APPDATA%\\Custom_update\\Update_bf7203dc.dll\", scub ",
                                                                                      "time_offset":  1
                                                                                  }
                                                                              ]
                                                             },
                                                             {
                                                                 "process_id":  "2652",
                                                                 "name":  "rundll32.exe %SAMPLEPATH%,extra"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2896",
                                            "name":  "rundll32.exe \"%APPDATA%\\Custom_update\\Update_bf7203dc.dll\" , scub"
                                        }
                                    ],
                 "verdict_labels":  [
                                        "LatrodectusLoader"
                                    ],
                 "processes_terminated":  [
                                              "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                                              "%windir%\\system32\\WerFault.exe -u -p 2676 -s 320",
                                              "wmiadap.exe /F /T /R",
                                              "rundll32.exe %SAMPLEPATH%,run",
                                              "rundll32.exe %SAMPLEPATH%,follower",
                                              "rundll32.exe %SAMPLEPATH%,scub",
                                              "rundll32.exe \"%APPDATA%\\Custom_update\\Update_bf7203dc.dll\", scub ",
                                              "rundll32.exe %SAMPLEPATH%,extra",
                                              "rundll32.exe \"%APPDATA%\\Custom_update\\Update_bf7203dc.dll\" , scub"
                                          ],
                 "memory_pattern_urls":  [
                                             "https://grebiunti.top/live/",
                                             "https://saicetyapy.space/live/"
                                         ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027.005",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "contain obfuscated stackstrings",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "contain obfuscated stackstrings"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using RC4 PRGA",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "encrypt data using RC4 PRGA"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "registry_keys_set":  [
                                           {
                                               "key":  "HKEY_USERS\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\SystemCertificates\\Root\\Certificates\\0174E68C97DDF1E0EEEA415EA336A163D2B61AFD\\Blob",
                                               "value":  "5C 00 00 00 01 00 00 00 04 00 00 00 00 10 00 00 04 00 00 00 01 00 00 00 10 00 00 00 0D BE 92 DE FF 7D 36 BB 48 C4 A6 B1 15 24 95 38 0F 00 00 00 01 00 00 00 20 00 00 00 53 FE B9 19 2E D4 80 F2 09 12 4A 2C 57 D7 E8 97 7A 2E 9F 39 46 1D BF 21 4D F1 12 CB 16 02 4F A2 14 00 00 00 01 00 00 00 14 00 00 00 78 B8 30 FD 63 AC 7B 89 4A 07 3B ED F6 8A 83 9C C3 52 02 65 19 00 00 00 01 00 00 00 10 00 00 00 B5 74 AF 30 C5 C1 BA 3A 69 A7 10 02 00 82 4D D0 03 00 00 00 01 00 00 00 14 00 00 00 01 74 E6 8C 97 DD F1 E0 EE EA 41 5E A3 36 A1 63 D2 B6 1A FD 20 00 00 00 01 00 00 00 F8 05 00 00 30 82 05 F4 30 82 03 DC A0 03 02 01 02 02 09 00 E0 EA 61 4C 28 56 32 64 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 30 81 8E 31 0B 30 09 06 03 55 04 06 13 02 49 4C 31 0F 30 0D 06 03 55 04 08 0C 06 43 65 6E 74 65 72 31 0C 30 0A 06 03 55 04 07 0C 03 4C 6F 64 31 10 30 0E 06 03 55 04 0A 0C 07 47 6F 50 72 6F 78 79 31 10 30 0E 06 03 55 04 0B 0C 07 47 6F 50 72 6F 78 79 31 1A 30 18 06 03 55 04 03 0C 11 67 6F 70 72 6F 78 79 2E 67 69 74 68 75 62 2E 69 6"
                                           },
                                           {
                                               "key":  "HKEY_USERS\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\Windows Error Reporting\\Debug\\StoreLocation",
                                               "value":  "%LOCALAPPDATA%\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_rundll32.exe_S22_98901d1981fc9a87a092152da4fd685ec559b8f9_0ac5586b"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\DynamicInfo"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\Path"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\Hash"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\Triggers"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Updater\\Index"
                                           },
                                           {
                                               "key":  "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Updater\\Id"
                                           }
                                       ],
                 "mbc":  [
                             {
                                 "id":  "C0058",
                                 "objective":  "Data",
                                 "behavior":  "Modulo",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "calculate modulo 256 via x86 assembly"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0001.019",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Debugger Detection",
                                 "method":  "Process Environment Block",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "PEB access"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.020",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Argument Obfuscation",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0032.017",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Executable Code Obfuscation",
                                 "method":  "Stack Strings",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "contain obfuscated stackstrings"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0032.001",
                                 "objective":  "Data",
                                 "behavior":  "Checksum",
                                 "method":  "CRC32",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "hash data with CRC32"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0030.005",
                                 "objective":  "Data",
                                 "behavior":  "Non-Cryptographic Hash",
                                 "method":  "FNV",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "hash data using fnv"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0027.009",
                                 "objective":  "Cryptography",
                                 "behavior":  "Encrypt Data",
                                 "method":  "RC4",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encrypt data using RC4 PRGA"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0021.004",
                                 "objective":  "Cryptography",
                                 "behavior":  "Generate Pseudo-random Sequence",
                                 "method":  "RC4 PRGA",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "encrypt data using RC4 PRGA"
                                              }
                                          ]
                             }
                         ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "EventID":  "13",
                                                                                             "EventType":  "SetValue",
                                                                                             "TargetObject":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\DynamicInfo"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "EventType":  "SetValue",
                                                                                             "EventID":  "13",
                                                                                             "TargetObject":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\Path"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "EventID":  "13",
                                                                                             "EventType":  "SetValue",
                                                                                             "TargetObject":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\Hash"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "EventType":  "SetValue",
                                                                                             "EventID":  "13",
                                                                                             "TargetObject":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{3D1466AF-4A63-41BA-876C-CBB25DDA03BB}\\Triggers"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "EventType":  "SetValue",
                                                                                             "EventID":  "13",
                                                                                             "TargetObject":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Updater\\Index"
                                                                                         }
                                                                          },
                                                                          {
                                                                              "values":  {
                                                                                             "EventType":  "SetValue",
                                                                                             "EventID":  "13",
                                                                                             "TargetObject":  "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Updater\\Id"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "high",
                                                    "rule_id":  "d62173552d7fce98c24a7040b784edf35cc6650d2e68ecf2d04f40c58d58cfda",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Scheduled TaskCache Change by Uncommon Program",
                                                    "rule_description":  "Monitor the creation of a new key under \u0027TaskCache\u0027 when a new scheduled task is registered by a process that is not svchost.exe, which is suspicious",
                                                    "rule_author":  "Syed Hasan (@syedhasan009)"
                                                }
                                            ],
                 "verdict_confidence":  80,
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "memory_pattern_domains":  [
                                                "grebiunti.top",
                                                "saicetyapy.space"
                                            ],
                 "command_executions":  [
                                            "rundll32.exe %SAMPLEPATH%,run",
                                            "rundll32.exe %SAMPLEPATH%,follower",
                                            "rundll32.exe %SAMPLEPATH%,scub",
                                            "rundll32.exe \"%APPDATA%\\Custom_update\\Update_bf7203dc.dll\", scub ",
                                            "rundll32.exe %SAMPLEPATH%,extra"
                                        ],
                 "signature_matches":  [
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "calculate modulo 256 via x86 assembly",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "PEB access",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain obfuscated stackstrings",
                                               "description":  "anti-analysis/obfuscation/string/stackstring",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "contain loop",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "hash data with CRC32",
                                               "description":  "data-manipulation/checksum/crc32",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: hash data with CRC32\n    namespace: data-manipulation/checksum/crc32\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires operand[1].number, characteristic, bytes, mnemonic features\n    mbc:\n      - Data::Checksum::CRC32 [C0032.001]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403CBD\n      - 7D28CB106CB54876B2A5C111724A07CD:0x402350  # RtlComputeCrc32\n      - 7EFF498DE13CC734262F87E6B3EF38AB:0x100084A6\n  features:\n    - or:\n      - and:\n        - number: 1 = bits in a byte\n        - instruction:\n          - description: is bit set?\n          - or:\n            - mnemonic: and\n            - mnemonic: test\n          - operand[1].number: 1\n        - instruction:\n          - mnemonic: shr\n          - number: 1\n        - characteristic: nzxor\n        - operand[1].number: 0xEDB88320\n      - and:\n        - number: 0x8320\n        - number: 0xEDB8\n        - characteristic: nzxor\n      - api: RtlComputeCrc32\n      - bytes: 00 00 00 00 96 30 07 77 2C 61 0E EE BA 51 09 99 19 C4 6D 07 8F F4 6A 70 35 A5 63 E9 A3 95 64 9E = crc32_tab\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "hash data using fnv",
                                               "description":  "data-manipulation/hashing/fnv : can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "@_re_fox",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: hash data using fnv\n    namespace: data-manipulation/hashing/fnv\n    authors:\n      - moritz.raabe@mandiant.com\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    description: can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, mnemonic features\n    mbc:\n      - Data::Non-Cryptographic Hash::FNV [C0030.005]\n    references:\n      - https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\n      - http://isthe.com/chongo/tech/comp/fnv/\n      - https://create.stephan-brumme.com/fnv-hash/\n    examples:\n      - ad4229879180e267f431ac6666b6a0a2:0x14007B4D4\n      - 09BF850BE5DA44A1C3629A1F62813A83:0x10006010\n  features:\n    - and:\n      - optional:\n        - characteristic: loop\n        - number: 0xcbf29ce484222325 = FNV_offset_basis, unused by FNV-0\n        - number: 0x811c9dc5 = FNV_offset_basis, unused by FNV-0\n        - and:\n          - number: 0xcbf29ce4 = FNV_offset_basis 64 bits, 32-bit value\n          - number: 0x84222325 = FNV_offset_basis 64 bits, 32-bit value\n      - or:\n        - number: 0x100000001b3 = FNV prime\n        - number: 0x01000193 = FNV prime\n        - and:\n          - number: 0x100 = FNV prime 64 bits, split in DWORD\n          - number: 0x1b3 = FNV prime 64 bits, split in DWORD\n      - basic block:\n        # FNV-1 hash does multiply then XOR\n        # FNV-1a hash does XOR then multiply\n        - and:\n          - characteristic: nzxor\n          - or:\n            - mnemonic: imul\n            - mnemonic: mul\n            - api: _allmul\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function"
                                                            },
                                                            {
                                                                "ref":  "http://isthe.com/chongo/tech/comp/fnv/"
                                                            },
                                                            {
                                                                "ref":  "https://create.stephan-brumme.com/fnv-hash/"
                                                            }
                                                        ]
                                           },
                                           {
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using RC4 PRGA",
                                               "description":  "data-manipulation/encryption/rc4",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, mnemonic, basicblock features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple or too complex (50 is picked by intuition)\n      - count(basic blocks): (4, 50)\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n"
                                           }
                                       ],
                 "attack_techniques":  {
                                           "T1027.005":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "contain obfuscated stackstrings",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "contain obfuscated stackstrings"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using RC4 PRGA",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "encrypt data using RC4 PRGA"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
