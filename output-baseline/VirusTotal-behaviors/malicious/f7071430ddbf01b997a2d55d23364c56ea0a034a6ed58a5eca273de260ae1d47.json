{
    "data":  {
                 "ja3_digests":  [
                                     "5ce9cdcb77837c5b314809ab59f16eb0"
                                 ],
                 "processes_terminated":  [
                                              "C:\\ioypzcf\\bsbk.exe"
                                          ],
                 "files_dropped":  [
                                       {
                                           "path":  "%APPDATA%\\ruhytale-launcher\\app.exe.new",
                                           "sha256":  "69e10010829063ff06cf194fdd7b937f8fde5b2e73f76028e1c5630dcee705e1",
                                           "type":  "PE_EXE"
                                       },
                                       {
                                           "path":  "%APPDATA%\\ruhytale-launcher\\discord_cache.txt",
                                           "sha256":  "604d760faa4c946992c6bc7a5743aa08586dd49f2267f910004c6493577de3a0"
                                       },
                                       {
                                           "path":  "%APPDATA%\\ruhytale-launcher\\launcher.log",
                                           "sha256":  "a175d33aebaa9671e691ff8547fb696b731b1c0bec0a5d196d4c283768eb37a4"
                                       },
                                       {
                                           "path":  "%APPDATA%\\ruhytale-launcher\\launcher_config.json",
                                           "sha256":  "ce36eb488e21d30682f619101c93183d8995f8a0e5951b3d4236d2a538ef178b"
                                       },
                                       {
                                           "path":  "%APPDATA%\\ruhytale-launcher\\userdata\\serverlist.json",
                                           "sha256":  "08a8b5d714ffe023942587f1cb52765a64e292daa8d323dcbffd6574f72b6ec6"
                                       }
                                   ],
                 "mbc":  [
                             {
                                 "id":  "B0013.001",
                                 "objective":  "Discovery",
                                 "behavior":  "Analysis Tool Discovery",
                                 "method":  "Process detection",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "F0001.008",
                                 "objective":  "Anti-Static Analysis",
                                 "behavior":  "Software Packing",
                                 "method":  "UPX",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "2"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "5"
                                              }
                                          ]
                             }
                         ],
                 "registry_keys_opened":  [
                                              "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters"
                                          ],
                 "processes_created":  [
                                           "%WINDIR%\\system32\\taskhostw.exe",
                                           "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                           "%WINDIR%\\system32\\cmd.exe",
                                           "C:\\ioypzcf\\bsbk.exe",
                                           "%WINDIR%\\system32\\svchost.exe",
                                           "%WINDIR%\\system32\\consent.exe"
                                       ],
                 "tags":  [
                              "EXECUTES_DROPPED_FILE",
                              "SELF_DELETE"
                          ],
                 "http_conversations":  [
                                            {
                                                "url":  "http://cdn2.ililililiilliilililiilii.site/launcher/0.1.9/app.exe",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
                                                                        "Host":  "cdn2.ililililiilliilililiilii.site",
                                                                        "Accept-Encoding":  "gzip",
                                                                        "Range":  "bytes=0-"
                                                                    }
                                            },
                                            {
                                                "url":  "http://cdn2.ililililiilliilililiilii.site/versions.js",
                                                "request_method":  "GET",
                                                "request_headers":  {
                                                                        "User-Agent":  "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
                                                                        "Host":  "cdn2.ililililiilliilililiilii.site",
                                                                        "Accept-Encoding":  "gzip"
                                                                    }
                                            }
                                        ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "3160",
                                            "name":  "C:\\ioypzcf\\bsbk.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3048",
                                                                 "name":  "C:\\ioypzcf\\bsbk.exe",
                                                                 "time_offset":  5
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "1852",
                                            "name":  "%WINDIR%\\system32\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "3048",
                                            "name":  "C:\\ioypzcf\\bsbk.exe",
                                            "time_offset":  5
                                        },
                                        {
                                            "process_id":  "2824",
                                            "name":  "%WINDIR%\\system32\\taskhostw.exe"
                                        },
                                        {
                                            "process_id":  "4468",
                                            "name":  "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2312",
                                                                 "name":  "%WINDIR%\\system32\\conhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "2520",
                                            "name":  "%WINDIR%\\system32\\cmd.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2188",
                                                                 "name":  "%WINDIR%\\system32\\ipconfig.exe"
                                                             },
                                                             {
                                                                 "process_id":  "3124",
                                                                 "name":  "%WINDIR%\\system32\\reg.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1480",
                                                                 "name":  "%WINDIR%\\system32\\conhost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "4028",
                                                                 "name":  "%WINDIR%\\system32\\ping.exe"
                                                             },
                                                             {
                                                                 "process_id":  "1536",
                                                                 "name":  "%WINDIR%\\system32\\find.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "3704",
                                            "name":  "%WINDIR%\\system32\\svchost.exe",
                                            "time_offset":  119
                                        },
                                        {
                                            "process_id":  "3444",
                                            "name":  "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3876",
                                                                 "name":  "%WINDIR%\\system32\\conhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "4768",
                                            "name":  "%WINDIR%\\system32\\consent.exe",
                                            "time_offset":  2
                                        },
                                        {
                                            "process_id":  "3656",
                                            "name":  "%WINDIR%\\system32\\consent.exe"
                                        },
                                        {
                                            "process_id":  "788",
                                            "name":  "%WINDIR%\\system32\\taskhostw.exe"
                                        },
                                        {
                                            "process_id":  "668",
                                            "name":  "%WINDIR%\\system32\\svchost.exe"
                                        },
                                        {
                                            "process_id":  "2312",
                                            "name":  "%WINDIR%\\system32\\conhost.exe"
                                        },
                                        {
                                            "process_id":  "2188",
                                            "name":  "%WINDIR%\\system32\\ipconfig.exe"
                                        },
                                        {
                                            "process_id":  "3124",
                                            "name":  "%WINDIR%\\system32\\reg.exe"
                                        },
                                        {
                                            "process_id":  "1480",
                                            "name":  "%WINDIR%\\system32\\conhost.exe"
                                        },
                                        {
                                            "process_id":  "4028",
                                            "name":  "%WINDIR%\\system32\\ping.exe"
                                        },
                                        {
                                            "process_id":  "1536",
                                            "name":  "%WINDIR%\\system32\\find.exe"
                                        },
                                        {
                                            "process_id":  "3876",
                                            "name":  "%WINDIR%\\system32\\conhost.exe"
                                        }
                                    ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027.002",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "packed with UPX",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "2"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Windows",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "7"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "files_deleted":  [
                                       "%APPDATA%\\ruhytale-launcher\\app.exe.new",
                                       "c:\\ioypzcf\\bsbk.exe",
                                       "C:\\ioypzcf\\bsbk.exe.old"
                                   ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "171.22.18.4",
                                        "destination_port":  80,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "34.160.144.191",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    }
                                ],
                 "dns_lookups":  [
                                     {
                                         "hostname":  "cdn2.ililililiilliilililiilii.site",
                                         "resolved_ips":  [
                                                              "171.22.18.4"
                                                          ]
                                     },
                                     {
                                         "hostname":  "mozilla.map.fastly.net",
                                         "resolved_ips":  [
                                                              "151.101.1.91",
                                                              "151.101.193.91",
                                                              "151.101.129.91",
                                                              "151.101.65.91"
                                                          ]
                                     },
                                     {
                                         "hostname":  "content-signature-2.cdn.mozilla.net",
                                         "resolved_ips":  [
                                                              "34.160.144.191"
                                                          ]
                                     },
                                     {
                                         "hostname":  "time.windows.com",
                                         "resolved_ips":  [
                                                              "20.101.57.9"
                                                          ]
                                     }
                                 ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "%WINDIR%\\system32\\svchost.exe",
                                                                                             "Image":  "C:\\Windows\\system32\\svchost.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "high",
                                                    "rule_id":  "f4143907bd6e32636e7bc2f3b4f1fca7dde5ff6787f10a17b360a798f52c6357",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Uncommon Svchost Command Line Parameter",
                                                    "rule_description":  "Detects instances of svchost.exe running with an unusual or uncommon command line parameter by excluding known legitimate or common patterns.\nThis could point at a file masquerading as svchost, a process injection, or hollowing of a legitimate svchost instance.\n",
                                                    "rule_author":  "Liran Ravich"
                                                },
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                                                                             "Image":  "C:\\Windows\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "low",
                                                    "rule_id":  "1c2e4db94ca79f939e94e29c04fb3b71467fc6f5b9c31db34fcce5a2fb3b856f",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Non Interactive PowerShell Process Spawned",
                                                    "rule_description":  "Detects non-interactive PowerShell activity by looking at the \"powershell\" process with a non-user GUI process such as \"explorer.exe\" as a parent.",
                                                    "rule_author":  "Roberto Rodriguez @Cyb3rWard0g (rule), oscd.community (improvements)"
                                                }
                                            ],
                 "files_written":  [
                                       "%APPDATA%\\ruhytale-launcher\\userdata\\serverlist.json",
                                       "c:\\ioypzcf\\bsbk.exe",
                                       "%APPDATA%\\ruhytale-launcher\\launcher_config.json",
                                       "%APPDATA%\\ruhytale-launcher\\app.exe.new",
                                       "%APPDATA%\\ruhytale-launcher\\discord_cache.txt",
                                       "nul",
                                       "%APPDATA%\\ruhytale-launcher\\launcher.log"
                                   ],
                 "ids_alerts":  [
                                    {
                                        "rule_msg":  "FILE-EXECUTABLE download of executable content",
                                        "rule_category":  "policy-violation",
                                        "rule_id":  "1:11192",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "src_ip":  "171.22.18.4",
                                                              "src_port":  80
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_references":  [
                                                                "https://www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx"
                                                            ],
                                        "rule_raw":  "alert tcp $EXTERNAL_NET $HTTP_PORTS -\u003e $HOME_NET any ( msg:\"FILE-EXECUTABLE download of executable content\"; flow:to_client,established; http_header; content:\"application/octet-stream\",fast_pattern,nocase; pcre:\"/^Content-Type\\x3a[\\x20\\x09]+application\\/octet-stream/ims\"; file_data; content:\"MZ\",within 2; metadata:policy max-detect-ips drop; service:http; reference:url,www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx; classtype:policy-violation; sid:11192; rev:20; )"
                                    },
                                    {
                                        "rule_msg":  "FILE-EXECUTABLE Portable Executable binary file magic detected",
                                        "rule_category":  "policy-violation",
                                        "rule_id":  "1:15306",
                                        "alert_severity":  "high",
                                        "rule_source":  "Snort registered user ruleset",
                                        "alert_context":  {
                                                              "src_ip":  "171.22.18.4",
                                                              "src_port":  80
                                                          },
                                        "rule_url":  "https://www.snort.org/downloads/#rule-downloads",
                                        "rule_raw":  "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -\u003e $HOME_NET any ( msg:\"FILE-EXECUTABLE Portable Executable binary file magic detected\"; flow:to_client,established; file_data; content:\"MZ\"; byte_jump:4,58,relative,little; content:\"PE|00 00|\",within 4,distance -64; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:policy-violation; sid:15306; rev:22; )"
                                    },
                                    {
                                        "rule_msg":  "ET HUNTING SUSPICIOUS Firesale gTLD EXE DL with no Referer June 13 2016",
                                        "rule_category":  "A Network Trojan was detected",
                                        "rule_id":  "1:2022896",
                                        "alert_severity":  "high",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "171.22.18.4",
                                                              "dest_port":  80,
                                                              "hostname":  "cdn2.ililililiilliilililiilii.site",
                                                              "url":  "http://cdn2.ililililiilliilililiilii.site/launcher/0.1.9/app.exe"
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET any (msg:\"ET HUNTING SUSPICIOUS Firesale gTLD EXE DL with no Referer June 13 2016\"; flow:established,to_server; http.uri; content:\".exe\"; nocase; fast_pattern; http.host; pcre:\"/\\.(?:s(?:(?:(?:cien|pa)c|it)e|tream)|c(?:l(?:ick|ub)|ountry|ricket)|m(?:(?:aiso|e)n|o(?:bi|m))|p(?:r(?:ess|o)|arty|ink|w)|r(?:e(?:[dn]|view)|acing)|w(?:eb(?:site|cam)|in)|b(?:(?:outiq|l)ue|id)|d(?:ownload|ate|esi)|(?:accountan|hos)t|l(?:o(?:an|l)|ink)|t(?:rade|ech|op)|v(?:oyage|ip)|g(?:dn|b)|online|faith|kim|xyz)(?:\\x3a\\d{1,5})?$/\"; http.header_names; content:!\"Referer\"; content:!\"Cookie\"; classtype:trojan-activity; sid:2022896; rev:7; metadata:created_at 2016_06_14, performance_impact Moderate, confidence Medium, signature_severity Major, tag Description_Generated_By_Proofpoint_Nexus, updated_at 2024_04_22, reviewed_at 2024_04_11;)"
                                    },
                                    {
                                        "rule_msg":  "ET MALWARE Terse alphanumeric executable downloader high likelihood of being hostile",
                                        "rule_category":  "Potentially Bad Traffic",
                                        "rule_id":  "1:2019714",
                                        "alert_severity":  "low",
                                        "rule_source":  "Proofpoint Emerging Threats Open",
                                        "alert_context":  {
                                                              "dest_ip":  "171.22.18.4",
                                                              "dest_port":  80,
                                                              "hostname":  "cdn2.ililililiilliilililiilii.site",
                                                              "url":  "http://cdn2.ililililiilliilililiilii.site/launcher/0.1.9/app.exe"
                                                          },
                                        "rule_url":  "https://rules.emergingthreats.net/",
                                        "rule_raw":  "alert http $HOME_NET any -\u003e $EXTERNAL_NET any (msg:\"ET MALWARE Terse alphanumeric executable downloader high likelihood of being hostile\"; flow:established,to_server; http.uri; content:\"/\"; content:\".exe\"; distance:1; within:8; fast_pattern; endswith; pcre:\"/\\/[A-Z]?[a-z]{1,3}[0-9]?\\.exe$/\"; http.header; content:!\"koggames\"; http.host; content:!\"download.bitdefender.com\"; endswith; content:!\".appspot.com\"; endswith; content:!\"kaspersky.com\"; endswith; content:!\".sophosxl.net\"; endswith; http.header_names; content:!\"Referer\"; nocase; classtype:bad-unknown; sid:2019714; rev:13; metadata:created_at 2014_11_15, performance_impact Significant, confidence Medium, signature_severity Informational, tag Description_Generated_By_Proofpoint_Nexus, updated_at 2024_04_22;)"
                                    }
                                ],
                 "signature_matches":  [
                                           {
                                               "id":  "1",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference analysis tools strings",
                                               "description":  "anti-analysis",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "regex: /(?\u003c!\\w)ida[gqtuw]?(\\.exe)?$/i"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference analysis tools strings\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /ollydbg(\\.exe)?/i\n      - string: /ProcessHacker(\\.exe)?/i\n      - string: /tcpview(\\.exe)?/i\n      - string: /autoruns(\\.exe)?/i\n      - string: /autorunsc(\\.exe)?/i\n      - string: /filemon(\\.exe)?/i\n      - string: /procmon(\\.exe)?/i\n      - string: /regmon(\\.exe)?/i\n      - string: /procexp(\\.exe)?/i\n      - string: /(?\u003c!\\w)ida[gqtuw]?(\\.exe)?$/i\n      - string: /ida[gqtuw]?64(\\.exe)?$/i\n      - string: /ImmunityDebugger(\\.exe)?/i\n      - string: /Wireshark(\\.exe)?/i\n      - string: /dumpcap(\\.exe)?/i\n      - string: /HookExplorer(\\.exe)?/i\n      - string: /ImportREC(\\.exe)?/i\n      - string: /PETools(\\.exe)?/i\n      - string: /LordPE(\\.exe)?/i\n      - string: /SysInspector(\\.exe)?/i\n      - string: /proc_analyzer(\\.exe)?/i\n      - string: /sysAnalyzer(\\.exe)?/i\n      - string: /sniff_hit(\\.exe)?/i\n      - string: /windbg(\\.exe)?/i\n      - string: /joeboxcontrol(\\.exe)?/i\n      - string: /joeboxserver(\\.exe)?/i\n      - string: /ResourceHacker(\\.exe)?/i\n      - string: /x32dbg(\\.exe)?/i\n      - string: /x64dbg(\\.exe)?/i\n      - string: /Fiddler(\\.exe)?/i\n      - string: /httpdebugger(\\.exe)?/i\n      - string: /fakenet(\\.exe)?/i\n      - string: /netmon(\\.exe)?/i\n      - string: /WPE PRO(\\.exe)?/i\n      - string: /decompile(\\.exe)?/i\n      - string: /scylla/i\n      - string: /megadumper/i\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "2",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "packed with UPX",
                                               "description":  "anti-analysis/packer/upx",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "section: UPX0",
                                                                  "section: UPX1"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: packed with UPX\n    namespace: anti-analysis/packer/upx\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]\n    mbc:\n      - Anti-Static Analysis::Software Packing::UPX [F0001.008]\n    examples:\n      - CD2CBA9E6313E8DF2C1273593E649682\n      - Practical Malware Analysis Lab 01-02.exe_:0x0401000\n  features:\n    - or:\n      - and:\n        - format: pe\n        - or:\n          - section: UPX0\n          - section: UPX1\n      - and:\n        - format: elf\n        - or:\n          - string: \"UPX!\"\n"
                                           },
                                           {
                                               "id":  "5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "mehunhoff@google.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: ExitProcess"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - mehunhoff@google.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - api: RstrtMgr.RmShutdown\n      - and:\n        - os: linux\n        - api: exit_group\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n          - api: ZwTerminateProcess\n"
                                           },
                                           {
                                               "id":  "7",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Windows",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: GetProcAddress"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - mehunhoff@google.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n        - api: ntdll.LdrGetProcedureAddressEx\n        - api: ntdll.LdrGetProcedureAddressForCaller\n        - api: MmGetSystemRoutineAddress\n"
                                           }
                                       ],
                 "files_opened":  [
                                      "%WINDIR%\\system32\\ntdll.dll",
                                      "%WINDIR%\\system32\\drivers\\etc\\hosts",
                                      "%APPDATA%\\ruhytale-launcher\\userdata\\serverlist.json",
                                      "%APPDATA%\\ruhytale-launcher\\launcher_config.json",
                                      "%APPDATA%\\ruhytale-launcher\\discord_cache.txt"
                                  ],
                 "files_copied":  [
                                      {
                                          "source":  "c:\\ioypzcf\\bsbk.exe",
                                          "destination":  "C:\\ioypzcf\\bsbk.exe.old"
                                      },
                                      {
                                          "source":  "%APPDATA%\\ruhytale-launcher\\app.exe.new",
                                          "destination":  "C:\\ioypzcf\\bsbk.exe"
                                      }
                                  ],
                 "attack_techniques":  {
                                           "T1027.002":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "packed with UPX",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "2"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Windows",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "7"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
