{
    "data":  {
                 "processes_terminated":  [
                                              "%WINDIR%\\system32\\wbem\\wmiprvse.exe"
                                          ],
                 "files_opened":  [
                                      "%LOCALAPPDATA%\\config"
                                  ],
                 "signature_matches":  [
                                           {
                                               "id":  "1",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "nzxor",
                                                                  "tight loop"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "id":  "3",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference analysis tools strings",
                                               "description":  "anti-analysis",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "regex: /scylla/i"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference analysis tools strings\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /ollydbg(\\.exe)?/i\n      - string: /ProcessHacker(\\.exe)?/i\n      - string: /tcpview(\\.exe)?/i\n      - string: /autoruns(\\.exe)?/i\n      - string: /autorunsc(\\.exe)?/i\n      - string: /filemon(\\.exe)?/i\n      - string: /procmon(\\.exe)?/i\n      - string: /regmon(\\.exe)?/i\n      - string: /procexp(\\.exe)?/i\n      - string: /(?\u003c!\\w)ida[gqtuw]?(\\.exe)?$/i\n      - string: /ida[gqtuw]?64(\\.exe)?$/i\n      - string: /ImmunityDebugger(\\.exe)?/i\n      - string: /Wireshark(\\.exe)?/i\n      - string: /dumpcap(\\.exe)?/i\n      - string: /HookExplorer(\\.exe)?/i\n      - string: /ImportREC(\\.exe)?/i\n      - string: /PETools(\\.exe)?/i\n      - string: /LordPE(\\.exe)?/i\n      - string: /SysInspector(\\.exe)?/i\n      - string: /proc_analyzer(\\.exe)?/i\n      - string: /sysAnalyzer(\\.exe)?/i\n      - string: /sniff_hit(\\.exe)?/i\n      - string: /windbg(\\.exe)?/i\n      - string: /joeboxcontrol(\\.exe)?/i\n      - string: /joeboxserver(\\.exe)?/i\n      - string: /ResourceHacker(\\.exe)?/i\n      - string: /x32dbg(\\.exe)?/i\n      - string: /x64dbg(\\.exe)?/i\n      - string: /Fiddler(\\.exe)?/i\n      - string: /httpdebugger(\\.exe)?/i\n      - string: /fakenet(\\.exe)?/i\n      - string: /netmon(\\.exe)?/i\n      - string: /WPE PRO(\\.exe)?/i\n      - string: /decompile(\\.exe)?/i\n      - string: /scylla/i\n      - string: /megadumper/i\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "6",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "reference anti-VM strings targeting Xen",
                                               "description":  "anti-analysis/anti-vm/vm-detection",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "regex: /^Xen/i"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: reference anti-VM strings targeting Xen\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att\u0026ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /^Xen/i\n      - string: /XenVMMXenVMM/i\n      - string: /xenservice\\.exe/i\n      - string: /HVM domU/i\n",
                                               "refs":  [
                                                            {
                                                                "ref":  "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Xen.cpp"
                                                            }
                                                        ]
                                           },
                                           {
                                               "id":  "8",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve function by parsing PE exports",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "sara-rn"
                                                           ],
                                               "match_data":  [
                                                                  "loop",
                                                                  "mnemonic: movzx"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n"
                                           },
                                           {
                                               "id":  "9",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "parse PE header",
                                               "description":  "load-code/pe",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "mnemonic: cmp",
                                                                  "IMAGE_DOS_SIGNATURE (MZ)",
                                                                  "IMAGE_NT_SIGNATURE (PE)"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n"
                                           }
                                       ],
                 "sigma_analysis_results":  [
                                                {
                                                    "match_context":  [
                                                                          {
                                                                              "values":  {
                                                                                             "CommandLine":  "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                                                                             "Image":  "C:\\Windows\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                                                                             "EventID":  "1"
                                                                                         }
                                                                          }
                                                                      ],
                                                    "rule_level":  "low",
                                                    "rule_id":  "1c2e4db94ca79f939e94e29c04fb3b71467fc6f5b9c31db34fcce5a2fb3b856f",
                                                    "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                    "rule_title":  "Non Interactive PowerShell Process Spawned",
                                                    "rule_description":  "Detects non-interactive PowerShell activity by looking at the \"powershell\" process with a non-user GUI process such as \"explorer.exe\" as a parent.",
                                                    "rule_author":  "Roberto Rodriguez @Cyb3rWard0g (rule), oscd.community (improvements)"
                                                }
                                            ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "1"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1497.001",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "reference anti-VM strings targeting Xen",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "6"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "parse PE header",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "9"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "processes_created":  [
                                           "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                           "%WINDIR%\\system32\\consent.exe",
                                           "%WINDIR%\\system32\\cmd.exe",
                                           "%WINDIR%\\system32\\taskhostw.exe",
                                           "C:\\bhyft\\aaadfxpr.exe",
                                           "C:\\qepuq\\jzvmlj.exe",
                                           "%WINDIR%\\system32\\sppextcomobj.exe",
                                           "%WINDIR%\\system32\\slui.exe",
                                           "%WINDIR%\\system32\\sppsvc.exe"
                                       ],
                 "ja3_digests":  [
                                     "075b102409434354fe8cc2a05af8465e"
                                 ],
                 "files_dropped":  [
                                       {
                                           "path":  "%LOCALAPPDATA%\\config",
                                           "sha256":  "0a7ca51aa8934ebf8bec6b9369ffa0d605252d7a13cf75b645de81e4711ba977"
                                       },
                                       {
                                           "path":  "%LOCALAPPDATA%\\config",
                                           "sha256":  "a83150f1a85260db75e2876bdf3f0390ed2814105a038da430a1eac988b7aa17"
                                       },
                                       {
                                           "sha256":  "5023d3e73635e0bb006b65a22b3364bef689551905d0018b43aee311d2309a74"
                                       }
                                   ],
                 "files_written":  [
                                       "%LOCALAPPDATA%\\config"
                                   ],
                 "ip_traffic":  [
                                    {
                                        "destination_ip":  "62.84.103.78",
                                        "destination_port":  29774,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.212.166.19",
                                        "destination_port":  443,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "62.84.103.78",
                                        "destination_port":  22231,
                                        "transport_layer_protocol":  "TCP"
                                    },
                                    {
                                        "destination_ip":  "91.212.166.51"
                                    },
                                    {
                                        "destination_ip":  "91.212.166.19"
                                    }
                                ],
                 "processes_tree":  [
                                        {
                                            "process_id":  "4660",
                                            "name":  "C:\\bhyft\\aaadfxpr.exe"
                                        },
                                        {
                                            "process_id":  "808",
                                            "name":  "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "3688",
                                                                 "name":  "%WINDIR%\\system32\\conhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "4592",
                                            "name":  "%WINDIR%\\system32\\consent.exe",
                                            "time_offset":  14
                                        },
                                        {
                                            "process_id":  "2044",
                                            "name":  "%WINDIR%\\system32\\cmd.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2392",
                                                                 "name":  "%WINDIR%\\system32\\conhost.exe"
                                                             },
                                                             {
                                                                 "process_id":  "4152",
                                                                 "name":  "%WINDIR%\\system32\\ping.exe"
                                                             },
                                                             {
                                                                 "process_id":  "768",
                                                                 "name":  "%WINDIR%\\system32\\reg.exe"
                                                             },
                                                             {
                                                                 "process_id":  "3864",
                                                                 "name":  "%WINDIR%\\system32\\ipconfig.exe"
                                                             },
                                                             {
                                                                 "process_id":  "2196",
                                                                 "name":  "%WINDIR%\\system32\\find.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "4352",
                                            "name":  "%WINDIR%\\system32\\taskhostw.exe"
                                        },
                                        {
                                            "process_id":  "3456",
                                            "name":  "%WINDIR%\\system32\\consent.exe"
                                        },
                                        {
                                            "process_id":  "4904",
                                            "name":  "%WINDIR%\\system32\\taskhostw.exe"
                                        },
                                        {
                                            "process_id":  "1136",
                                            "name":  "%WINDIR%\\system32\\windowspowershell\\v1.0\\powershell.exe",
                                            "children":  [
                                                             {
                                                                 "process_id":  "2708",
                                                                 "name":  "%WINDIR%\\system32\\conhost.exe"
                                                             }
                                                         ]
                                        },
                                        {
                                            "process_id":  "4180",
                                            "name":  "%WINDIR%\\system32\\wbem\\wmiprvse.exe"
                                        },
                                        {
                                            "process_id":  "3688",
                                            "name":  "%WINDIR%\\system32\\conhost.exe"
                                        },
                                        {
                                            "process_id":  "2392",
                                            "name":  "%WINDIR%\\system32\\conhost.exe"
                                        },
                                        {
                                            "process_id":  "4152",
                                            "name":  "%WINDIR%\\system32\\ping.exe"
                                        },
                                        {
                                            "process_id":  "768",
                                            "name":  "%WINDIR%\\system32\\reg.exe"
                                        },
                                        {
                                            "process_id":  "3864",
                                            "name":  "%WINDIR%\\system32\\ipconfig.exe"
                                        },
                                        {
                                            "process_id":  "2196",
                                            "name":  "%WINDIR%\\system32\\find.exe"
                                        },
                                        {
                                            "process_id":  "2708",
                                            "name":  "%WINDIR%\\system32\\conhost.exe"
                                        }
                                    ],
                 "verdicts":  [
                                  "MALWARE"
                              ],
                 "mbc":  [
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "1"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0013.001",
                                 "objective":  "Discovery",
                                 "behavior":  "Analysis Tool Discovery",
                                 "method":  "Process detection",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "B0009",
                                 "objective":  "Anti-Behavioral Analysis",
                                 "behavior":  "Virtual Machine Detection",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "6"
                                              }
                                          ]
                             }
                         ],
                 "attack_techniques":  {
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "1"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1497.001":  [
                                                             {
                                                                 "severity":  "INFO",
                                                                 "description":  "reference anti-VM strings targeting Xen",
                                                                 "refs":  [
                                                                              {
                                                                                  "ref":  "#signature_matches",
                                                                                  "value":  "6"
                                                                              }
                                                                          ]
                                                             }
                                                         ],
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "parse PE header",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "9"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
