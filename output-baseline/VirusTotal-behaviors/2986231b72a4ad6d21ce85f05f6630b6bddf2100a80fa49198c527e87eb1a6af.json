{
    "data":  {
                 "signature_matches":  [
                                           {
                                               "id":  "0",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "check file permission on Linux",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "mehunhoff@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: faccessat",
                                                                  "api: access"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: check file permission on Linux\n    namespace: host-interaction/file-system\n    authors:\n      - mehunhoff@google.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - and:\n      - or:\n        - os: android\n        - os: linux\n      - or:\n        - api: access\n        - api: faccessat\n"
                                           },
                                           {
                                               "id":  "1",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get current PID on Linux",
                                               "description":  "host-interaction/process",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: getppid",
                                                                  "api: getpid"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: get current PID on Linux\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: getpid\n        - api: getppid\n"
                                           },
                                           {
                                               "id":  "3",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encode data using XOR",
                                               "description":  "data-manipulation/encoding/xor",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "nzxor",
                                                                  "tight loop"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) \u0026 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
                                           },
                                           {
                                               "id":  "4",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get system information on Linux",
                                               "description":  "host-interaction/os/info",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: sysconf"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: get system information on Linux\n    namespace: host-interaction/os/info\n    authors:\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n  features:\n    - and:\n      - os: linux\n      - or:\n        - api: sysconf\n        - and:\n          - api: system\n          - string: \"lshw\"\n        - api: sysinfo\n"
                                           },
                                           {
                                               "id":  "5",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate files on Linux",
                                               "description":  "host-interaction/file-system/files/list",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: opendir",
                                                                  "api: readdir"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate files on Linux\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - and:\n          - match: create or open file\n          - or:\n            - api: getdents\n            - api: getdents64\n        - and:\n          - api: opendir\n          - api: readdir\n"
                                           },
                                           {
                                               "id":  "6",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get socket status",
                                               "description":  "communication/socket",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: select"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: get socket status\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    mbc:\n      - Communication::Socket Communication::Get Socket Status [C0001.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.select\n      - api: ws2_32.#18 = select\n"
                                           },
                                           {
                                               "id":  "8",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "parse credit card information",
                                               "description":  "collection/credit-card",
                                               "authors":  [
                                                               "@_re_fox"
                                                           ],
                                               "match_data":  [
                                                                  "\u0027=\u0027 (Track 2 separator)",
                                                                  "mnemonic: cmp",
                                                                  "\u0027B\u0027 (Format code)"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: parse credit card information\n    namespace: collection/credit-card\n    authors:\n      - \"@_re_fox\"\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Check String [C0019]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x402860\n  features:\n    - and:\n      - 3 or more:\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x5E = \u0027^\u0027 (Track 1 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3D = \u0027=\u0027 (Track 2 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x25 = \u0027%\u0027 (Track 1 start sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x42 = \u0027B\u0027 (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x44 = \u0027D\u0027 (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3F = \u0027?\u0027 (Track 1 \u0026 2 end sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3B = \u0027;\u0027 (Track 2 start sentinel)\n      - not:\n        - description: if a function also compares these non-hex characters it\u0027s most likely NOT parsing CC data\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6D = \u0027m\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6E = \u0027n\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6F = \u0027o\u0027\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x70 = \u0027p\u0027\n"
                                           },
                                           {
                                               "id":  "9",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get current user on Linux",
                                               "description":  "host-interaction/session",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: getpwuid",
                                                                  "api: geteuid"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: get current user on Linux\n    namespace: host-interaction/session\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att\u0026ck:\n      - Discovery::System Owner/User Discovery [T1033]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: geteuid\n        - api: getpwuid\n        - api: getlogin\n        - api: getlogin_r\n        - api: cuserid\n"
                                           },
                                           {
                                               "id":  "10",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "read file on Linux",
                                               "description":  "host-interaction/file-system/read",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: open",
                                                                  "api: fgets",
                                                                  "api: fdopen"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: read file on Linux\n    namespace: host-interaction/file-system/read\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x4059AD\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - optional:\n        - match: create or open file\n      - or:\n        - api: fgetc\n        - api: fgets\n        - api: getc\n        - api: getchar\n        - api: read\n        - api: getline\n        - api: getdelim\n        - api: fgetwc\n        - api: getwc\n        - api: fscanf\n        - api: vfscanf\n        - api: fread\n"
                                           },
                                           {
                                               "id":  "11",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "move file",
                                               "description":  "host-interaction/file-system/move",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: rename"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 1 = FO_MOVE\n          - api: kernel32.SHFileOperation\n"
                                           },
                                           {
                                               "id":  "12",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "write file on Linux",
                                               "description":  "host-interaction/file-system/write",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: fwrite",
                                                                  "api: write",
                                                                  "api: putc"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: write file on Linux\n    namespace: host-interaction/file-system/write\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: instruction\n      dynamic: call\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x401E14\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: fputc\n        - api: fputs\n        - api: putc\n        - api: write\n        - api: fputwc\n        - api: putwc\n        - api: fputws\n        - api: fwrite\n        - api: putwchar\n        - api: dprintf\n        - api: vdprintf\n        - api: fprintf\n        - api: vfprintf\n"
                                           },
                                           {
                                               "id":  "13",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "encrypt data using RC4 PRGA",
                                               "description":  "data-manipulation/encryption/rc4",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "contain loop",
                                                                  "tight loop"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, mnemonic, basicblock features\n    att\u0026ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple or too complex (50 is picked by intuition)\n      - count(basic blocks): (4, 50)\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n"
                                           },
                                           {
                                               "id":  "14",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "create process on Linux",
                                               "description":  "host-interaction/process/create",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: fork",
                                                                  "api: execve"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: create process on Linux\n    namespace: host-interaction/process/create\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x40236D\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: execve\n        - and:\n          - match: execute syscall\n          - arch: aarch64\n          - number: 0xdd = execve\n        - api: execl\n        - api: execlp\n        - api: execle\n        - api: execv\n        - api: execvp\n        - api: execvpe\n        - api: posix_spawn\n        - api: posix_spawnp\n        - api: popen\n        - api: fork\n"
                                           },
                                           {
                                               "id":  "15",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "delete file on Linux",
                                               "description":  "host-interaction/file-system/delete",
                                               "authors":  [
                                                               "mehunhoff@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: unlink"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: delete file on Linux\n    namespace: host-interaction/file-system/delete\n    authors:\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Delete File [C0047]\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: unlink\n        - api: unlinkat\n"
                                           },
                                           {
                                               "id":  "16",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get password database entry on Linux",
                                               "description":  "host-interaction/session",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "jonathanlepore@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: getpwuid",
                                                                  "api: getpwent",
                                                                  "api: getpwnam"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: get password database entry on Linux\n    namespace: host-interaction/session\n    authors:\n      - michael.hunhoff@mandiant.com\n      - jonathanlepore@google.com\n    scopes:\n      static: instruction\n      dynamic: call\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: getpwuid\n        - api: getpwuid_r\n        - api: getpwnam\n        - api: getpwnam_r\n        - api: getpwent\n        - api: fgetpwent\n        - api: getpwent_r\n        - api: fgetpwent_r\n"
                                           },
                                           {
                                               "id":  "17",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "resolve DNS",
                                               "description":  "communication/dns",
                                               "authors":  [
                                                               "william.ballenthin@mandiant.com",
                                                               "johnk3r",
                                                               "joakim@intezer.com",
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: getaddrinfo"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: resolve DNS\n    namespace: communication/dns\n    authors:\n      - william.ballenthin@mandiant.com\n      - johnk3r\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::DNS Communication::Resolve [C0011.001]\n    examples:\n      - 17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0\n  features:\n    - or:\n      - api: gethostbyname\n      - api: ws2_32.gethostbyname\n      - api: ws2_32.#52 = gethostbyname\n      - api: DnsQuery_A\n      - api: DnsQuery_W\n      - api: DnsQuery_UTF8\n      - api: DnsQueryEx\n      - api: GetAddrInfo\n      - api: ws2_32.#24 = GetAddrInfoW\n      - api: GetAddrInfoEx\n      - api: getaddrinfo\n      - api: ws2_32.#98 = getaddrinfo\n      - api: getnameinfo\n      - api: ws2_32.#99 = getnameinfo\n      - api: gethostent\n      - api: System.Net.Dns::GetHostAddresses\n"
                                           },
                                           {
                                               "id":  "18",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get hostname",
                                               "description":  "host-interaction/os/hostname",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: gethostname"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                                           },
                                           {
                                               "id":  "19",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "get file attributes",
                                               "description":  "host-interaction/file-system/meta",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: lstat",
                                                                  "api: stat",
                                                                  "api: fstat"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n      - api: stat\n      - api: fstat\n      - api: lstat\n      - api: fstatat\n"
                                           },
                                           {
                                               "id":  "21",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "connect socket",
                                               "description":  "communication/socket : Detects socket connection attempts using common APIs or ConnectEx setup.",
                                               "authors":  [
                                                               "moritz.raabe@mandiant.com",
                                                               "joakim@intezer.com",
                                                               "mrhafizfarhad@gmail.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: connect"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: connect socket\n    namespace: communication/socket\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - mrhafizfarhad@gmail.com\n    description: Detects socket connection attempts using common APIs or ConnectEx setup.\n    scopes:\n      static: basic block\n      dynamic: span of calls\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: connect\n      - api: ws2_32.connect\n      - api: ws2_32.#4 = connect\n      - api: ws2_32.WSAConnect\n      - api: ws2_32.#33 = WSAConnect\n      - api: ConnectEx\n      - or:\n        - and:\n          # static\n          - basic block:\n            # candidate for GUID: WSAID_CONNECTEX/25a207b9-ddf3-4660-8ee9-76e58c74063e\n            - and:\n              - number: 0x25A207B9\n              - number: 0x4660DDF3\n              - number: 0xE576E98E\n              - number: 0x3E06748C\n          - basic block:\n            - and:\n              - or:\n                - api: ws2_32.WSAIoctl\n                - api: ws2_32.#60 = WSAIoctl\n              - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n          - basic block:\n            - and:\n              - or:\n                - api: setsockopt\n                - api: ws2_32.#21 = setsockopt\n              - number: 0xFFFF = SOL_SOCKET\n              - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n          # socket must be bound to ConnectEx\n          # https://gist.github.com/joeyadams/4158972\n          - or:\n            - api: bind\n            - api: ws2_32.#2 = bind\n        - and:\n          # dynamic\n          - call:\n            - and:\n              - or:\n                - api: ws2_32.WSAIoctl\n                - api: ws2_32.#60 = WSAIoctl\n              - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n          - call:\n            - and:\n              - or:\n                - api: setsockopt\n                - api: ws2_32.#21 = setsockopt\n              - number: 0xFFFF = SOL_SOCKET\n              - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n          # socket must be bound to ConnectEx\n          # https://gist.github.com/joeyadams/4158972\n          - or:\n            - api: bind\n            - api: ws2_32.#2 = bind\n"
                                           },
                                           {
                                               "id":  "22",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "terminate process via kill",
                                               "description":  "host-interaction/process/terminate",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "match_data":  [
                                                                  "SIGINT - interupt process stream, ctrl-C",
                                                                  "api: kill",
                                                                  "SIGHUP - controlling terminal closed"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: terminate process via kill\n    namespace: host-interaction/process/terminate\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x402424\n  features:\n    - and:\n      - os: linux\n      - api: kill\n      - or:\n        - number: 1 = SIGHUP - controlling terminal closed\n        - number: 2 = SIGINT - interupt process stream, ctrl-C\n        - number: 3 = SIGQUIT - like ctrl-C but with a core dump\n        - number: 6 = SIGABRT\n        - number: 9 = SIGKILL - terminate immediately/hard kill\n        - number: 15 = SIGTERM - terminate whenever/soft kill\n        - number: 19 = SIGSTOP - Pause the process / free command line, ctrl-Z\n"
                                           },
                                           {
                                               "id":  "23",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "link function at runtime on Linux",
                                               "description":  "linking/runtime-linking",
                                               "authors":  [
                                                               "joakim@intezer.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: dlsym"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: link function at runtime on Linux\n    namespace: linking/runtime-linking\n    authors:\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: call\n    att\u0026ck:\n      - Execution::Shared Modules [T1129]\n  features:\n    - and:\n      - or:\n        - os: linux\n        - os: android\n      - or:\n        - api: dlsym\n        - api: dlvsym\n"
                                           },
                                           {
                                               "id":  "24",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "set current directory",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "michael.hunhoff@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: chdir"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: set current directory\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.IO.Directory::SetCurrentDirectory\n      - api: kernel32.SetCurrentDirectory\n      - api: chdir\n      - api: fchdir\n"
                                           },
                                           {
                                               "id":  "25",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "enumerate files recursively",
                                               "description":  "host-interaction/file-system/files/list",
                                               "authors":  [
                                                               "@_re_fox",
                                                               "anushka.virgaonkar@mandiant.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: readdir",
                                                                  "recursive call",
                                                                  "api: opendir"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: enumerate files recursively\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - \"@_re_fox\"\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported\n    att\u0026ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 5f66b82558ca92e54e77f216ef4c066c:0x40640E\n  features:\n    - and:\n      - or:\n        - match: enumerate files on Windows\n        - match: enumerate files on Linux\n      - characteristic: recursive call\n"
                                           },
                                           {
                                               "id":  "26",
                                               "format":  "SIG_FORMAT_CAPA",
                                               "name":  "change file permission on Linux",
                                               "description":  "host-interaction/file-system",
                                               "authors":  [
                                                               "joakim@intezer.com",
                                                               "mehunhoff@google.com"
                                                           ],
                                               "match_data":  [
                                                                  "api: chown"
                                                              ],
                                               "rule_src":  "rule:\n  meta:\n    name: change file permission on Linux\n    namespace: host-interaction/file-system\n    authors:\n      - joakim@intezer.com\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 7351f8a40c5450557b24622417fc478d:0x407C68\n  features:\n    - and:\n      - or:\n        - os: android\n        - os: linux\n      - or:\n        - api: chown\n        - api: fchown\n        - api: lchown\n        - api: fchownat\n        - api: chmod\n        - api: fchmod\n        - api: fchmodat\n"
                                           }
                                       ],
                 "mitre_attack_techniques":  [
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encode data using XOR",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "3"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get system information on Linux",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "4"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate files on Linux",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "5"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1016",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get socket status",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "6"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1033",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get current user on Linux",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "9"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1027",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "encrypt data using RC4 PRGA",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "13"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1082",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "get hostname",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "18"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1129",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "link function at runtime on Linux",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "23"
                                                                  }
                                                              ]
                                                 },
                                                 {
                                                     "id":  "T1083",
                                                     "severity":  "IMPACT_SEVERITY_INFO",
                                                     "signature_description":  "enumerate files recursively",
                                                     "refs":  [
                                                                  {
                                                                      "ref":  "#signature_matches",
                                                                      "value":  "25"
                                                                  }
                                                              ]
                                                 }
                                             ],
                 "mbc":  [
                             {
                                 "id":  "E1027.m02",
                                 "objective":  "Defense Evasion",
                                 "behavior":  "Obfuscated Files or Information",
                                 "method":  "Encoding-Standard Algorithm",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0026.002",
                                 "objective":  "Data",
                                 "behavior":  "Encode Data",
                                 "method":  "XOR",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "3"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "5"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0001.012",
                                 "objective":  "Communication",
                                 "behavior":  "Socket Communication",
                                 "method":  "Get Socket Status",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "6"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0019",
                                 "objective":  "Data",
                                 "behavior":  "Check String",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "8"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0051",
                                 "objective":  "File System",
                                 "behavior":  "Read File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "10"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0063",
                                 "objective":  "File System",
                                 "behavior":  "Move File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "11"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0052",
                                 "objective":  "File System",
                                 "behavior":  "Writes File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "12"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0027.009",
                                 "objective":  "Cryptography",
                                 "behavior":  "Encrypt Data",
                                 "method":  "RC4",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "13"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0021.004",
                                 "objective":  "Cryptography",
                                 "behavior":  "Generate Pseudo-random Sequence",
                                 "method":  "RC4 PRGA",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "13"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0017",
                                 "objective":  "Process",
                                 "behavior":  "Create Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "14"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0047",
                                 "objective":  "File System",
                                 "behavior":  "Delete File",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "15"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0011.001",
                                 "objective":  "Communication",
                                 "behavior":  "DNS Communication",
                                 "method":  "Resolve",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "17"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1082",
                                 "objective":  "Discovery",
                                 "behavior":  "System Information Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "18"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0049",
                                 "objective":  "File System",
                                 "behavior":  "Get File Attributes",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "19"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0018",
                                 "objective":  "Process",
                                 "behavior":  "Terminate Process",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "22"
                                              }
                                          ]
                             },
                             {
                                 "id":  "E1083",
                                 "objective":  "Discovery",
                                 "behavior":  "File and Directory Discovery",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "25"
                                              }
                                          ]
                             },
                             {
                                 "id":  "C0050",
                                 "objective":  "File System",
                                 "behavior":  "Set File Attributes",
                                 "refs":  [
                                              {
                                                  "ref":  "#signature_matches",
                                                  "value":  "26"
                                              }
                                          ]
                             }
                         ],
                 "attack_techniques":  {
                                           "T1027":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encode data using XOR",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "3"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "encrypt data using RC4 PRGA",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "13"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1082":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get system information on Linux",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "4"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get hostname",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "18"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1083":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate files on Linux",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "5"
                                                                          }
                                                                      ]
                                                         },
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "enumerate files recursively",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "25"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1016":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get socket status",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "6"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1033":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "get current user on Linux",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "9"
                                                                          }
                                                                      ]
                                                         }
                                                     ],
                                           "T1129":  [
                                                         {
                                                             "severity":  "INFO",
                                                             "description":  "link function at runtime on Linux",
                                                             "refs":  [
                                                                          {
                                                                              "ref":  "#signature_matches",
                                                                              "value":  "23"
                                                                          }
                                                                      ]
                                                         }
                                                     ]
                                       }
             }
}
